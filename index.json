[{"content":" ä»å¯¼å¸ˆé‚£é‡Œå¬è¯´äº† WebGPUï¼Œåšäº†ç‚¹è°ƒæŸ¥å‘ç°è¿™ä¸ª API è¿˜æŒºæ–°çš„ï¼Œæ­£å¥½ä¹‹å‰åªé›¶é›¶ç¢ç¢å­¦äº†ä¸€ç‚¹ OpenGLï¼Œç›¸æ¯”äºä¸é€‚åˆäººç±»å­¦çš„ Vulkanï¼Œè¿˜æ˜¯ WebGPU æ˜¾å¾—å‹å¥½ä¸€ç‚¹ã€‚\nğŸš© 0x00 To begin with è¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\nä»€ä¹ˆæ˜¯ WebGPU é…ç½® WebGPU å¼€å‘ç¯å¢ƒ ç¬¬ä¸€ä¸ª WebGPU é¡¹ç›®ï¼šHelloTriangleï¼ For referenceğŸ‘‡ï¼š\nğŸª WebGPU Samples ğŸ“– WebGPU API Spec ğŸ“– WebGPU Shading Language ğŸ“º WebGPUå°ç™½å…¥é—¨ï¼ˆä¸€ï¼‰ï¼šå¦‚ä½•é›¶åŸºç¡€åˆ›å»ºç¬¬ä¸€ä¸ªWebGPUé¡¹ç›®ï¼ ğŸ“– æ‚¨çš„ç¬¬ä¸€ä¸ª WebGPU åº”ç”¨ ğŸ“– lil-gui 0.20.0 0x01 è®¤è¯† WebGPU WebGPU æ˜¯ä¸€ä¸ªç”± W3C GPU å·¥ä½œç»„åˆ¶å®šçš„æ–°çš„ç°ä»£å›¾å½¢ APIï¼Œç”¨äºåœ¨ Web åº”ç”¨ä¸­è®¿é—® GPU åŠŸèƒ½ã€‚\nåœ¨ WebGPU å‡ºç°ä¹‹å‰ï¼ŒWeb ç«¯çš„å›¾å½¢ç¼–ç¨‹åº”ç”¨ä¸»è¦é‡‡ç”¨ WebGL å’Œ WebGL 2ï¼Œè™½ç„¶å®ƒä»¬æœ‰ç€è·¨å¹³å°èƒ½åŠ›å’Œå¼ºå¤§çš„ç¤¾åŒºæ”¯æŒï¼Œä½†æ¶æ„è¿‡äºå¤è€ï¼Œæœ€æ–°çš„ WebGL 2 åªæ˜¯å°è£…äº† 2009 å¹´ OpenGL 3.2 çš„å®ç°ã€‚Khronos ä¹ŸæŒ‡å‡º WebGL åç»­æ›´æ–°ä¸­ä¸å†å¼•å…¥ç°ä»£ GPU çš„æ–°ç‰¹æ€§ã€‚\nè¿‘ 10 å¹´æ¥ï¼ŒGPU å–å¾—äº†é£é€Ÿå‘å±•ï¼Œä¹ŸåŒæ—¶å¸¦æ¥äº†ä¸å…¶äº¤äº’çš„ç°ä»£å›¾å½¢ API çš„å‘å±•ï¼Œä¾‹å¦‚ Metalã€D3D å’Œ Vulkanã€‚WebGPU ç»§æ‰¿äº†è¿™äº›å‘å±•ï¼Œå¹¶å°†å…¶å¸¦åˆ°äº† Web å¹³å°ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨ä¸­é«˜æ•ˆè¿è¡Œ GPU çš„é€šç”¨è®¡ç®—èƒ½åŠ›ã€‚\nä½œä¸º WebGL çš„ç»§ä»»è€…ï¼ŒWebGPU ä¸åªæ˜¯ä¸€ä¸ªèƒ½ç”»å›¾ APIï¼Œè¿˜å…·å¤‡å¼ºå¤§çš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›ï¼Œè¿™ä½¿å¾— WebGPU å¯ä»¥åˆ©ç”¨ ComputeShader æ‰¿æ‹…æ›´å¹¿æ³›çš„è®¡ç®—ä»»åŠ¡ï¼Œä¾‹å¦‚ç²’å­æ¨¡æ‹Ÿã€åŒè°ƒæ’åºç­‰ã€‚\n0x02 åˆ›å»º WebGPU é¡¹ç›® åˆ›å»ºåŸºæœ¬ Vite é¡¹ç›® é¦–å…ˆï¼Œç¡®ä¿ç”µè„‘ä¸Šæœ‰å¦‚ä¸‹é…ç½®ï¼š\nNode.js æ”¯æŒ WebGPU çš„æµè§ˆå™¨ï¼Œå¦‚ Chrome å’Œ Edgeï¼ˆç‰ˆæœ¬ 113 ä»¥ä¸Šï¼‰ ä»£ç ç¼–è¾‘å™¨ï¼Œå¦‚ VSCode è¿›å…¥é¡¹ç›®æ ¹ç›®å½•æ‰€åœ¨æ–‡ä»¶å¤¹ï¼Œåœ¨ç»ˆç«¯è¿è¡Œï¼š\n1npm create vite@latest webgpu-render-lab -- --template vanilla-ts è¿™é‡Œçš„ webgpu-render-lab æ˜¯é¡¹ç›®åï¼Œå¯ä»»å–\næŒ‰ç…§æŒ‡ç¤ºé€‰æ‹©å¼€å‘æ¨¡æ¿å’Œå˜ä½“ï¼Œè¿™é‡Œé€‰æ‹© Vanilla å’Œ TypeScriptï¼Œå³åŸç”Ÿ HTML + TypeScript çš„æ¨¡æ¿ã€‚\nç„¶åæŒ‰ç…§ä¸‹æ–¹æç¤ºä¾æ¬¡è¿è¡Œï¼š\n1cd webgpu-render-lab 2npm install 3npm run dev åœ¨æµè§ˆå™¨è®¿é—®å¯¹åº”çš„ç«¯å£å³å¯çœ‹åˆ°åˆå§‹çš„æ¨¡æ¿ç½‘é¡µã€‚\nç›®å‰çš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š\n1my-webgpu-app/ 2â”œâ”€â”€ node_modules # dependencies 3â”œâ”€â”€ public # static assets 4â”œâ”€â”€ index.html # initial html 5â”œâ”€â”€ src/ 6â”‚ â””â”€â”€ main.ts # main TypeScript file 7â”œâ”€â”€ tsconfig.json # TypeScript configure 8â”œâ”€â”€ package.json # Node.js configure 9â””â”€â”€ ...others é…ç½® WebGPU é¡¹ç›® é¡¹ç›®ç›®å½•ä¸‹ï¼Œç»ˆç«¯è¿è¡Œï¼š\n1npm install -D @webgpu/types å®‰è£… WebGPU çš„ Ts ç±»å‹å®šä¹‰æ–‡ä»¶ï¼Œç„¶ååœ¨ tsconfig.json çš„ compilerOptions ä¸­å¢åŠ ä¸€æ¡ï¼š\n1// tsconfig.json 2\u0026#34;compilerOptions\u0026#34;: { 3\t... 4\t\u0026#34;types\u0026#34;: [\u0026#34;vite/client\u0026#34;,\u0026#34;@webgpu/types\u0026#34;] 5} ä»¥å¯ç”¨ Vite å’Œ WebGPU ç±»å‹çš„æ™ºèƒ½æç¤ºå’Œç±»å‹æ£€æŸ¥ã€‚\ntsconfig.json ä¸­è¿˜æœ‰ä¸€ä¸ªå­—æ®µ includeï¼Œç”¨äºå‘Šè¯‰ TypeScript ç¼–è¯‘å™¨åªå¤„ç†/ç±»å‹æ£€æŸ¥æ‰€åˆ—å‡ºè·¯å¾„ä¸‹çš„ Ts æ–‡ä»¶ï¼Œä»¥æå‡é€Ÿåº¦ã€‚\n1// tsconfig.json 2\t\u0026#34;include\u0026#34;: [\u0026#34;src\u0026#34;] æ‰€ä»¥å¦‚æœæœ‰ Ts æ–‡ä»¶è·¯å¾„ä¸åœ¨ src ä¸‹ï¼Œéœ€è¦åœ¨è¿™é‡ŒåŒ…å«å…¶æ‰€å±è·¯å¾„ã€‚\n0x03 HelloTriangle è¦ç”»ä¸–ç•Œï¼Œå…ˆç”»ä¸‰è§’å½¢ï¼\nWebGPU æ¸²æŸ“æµç¨‹ åœ¨æ­£å¼å†™ç¨‹åºä¹‹å‰ï¼Œç®€å•ä»‹ç»ä¸€ä¸‹ WebGPU çš„æ¶æ„å’Œæ¸²æŸ“æµç¨‹ã€‚\nå®é™…ä¸Šï¼ŒWebGPU å¹¶éç›´æ¥æ“çºµç¡¬ä»¶ï¼Œè€Œæ˜¯è¿è¡Œåœ¨æµè§ˆå™¨å†…éƒ¨çš„ä¸€ä¸ªæŠ½è±¡å±‚ã€‚Web åº”ç”¨çš„ä¸€ä¸ªé¡µé¢å¤„äºä¸€ä¸ªç‹¬ç«‹çš„æ¸²æŸ“è¿›ç¨‹ä¸­ï¼Œç”± JS çš„ API è´Ÿè´£ä¸æµè§ˆå™¨è¿›è¡Œæ²Ÿé€šï¼Œåè€…é€šè¿‡è¿›ç¨‹é—´é€šè®¯ï¼ˆIPCï¼‰å°†å‰è€…ä¼ é€’ç»™ Native Moduleï¼Œå†ç”± Native Module æ ¹æ®æ“ä½œç³»ç»Ÿæ˜ å°„åˆ°ä¸åŒçš„åŸç”Ÿå›¾å½¢ APIï¼ˆMetalã€D3Dã€Vulkanï¼‰ï¼Œå®Œæˆæœ€ç»ˆçš„æ¸²æŸ“å’Œè®¡ç®—ä»»åŠ¡ã€‚\nNative Moduleï¼ˆåŸç”Ÿæ¨¡ç»„ï¼‰ï¼šæŒ‡ç”±æœ¬åœ°ç³»ç»Ÿä»£ç ï¼ˆå¦‚ C/C++ã€Rustï¼‰ç¼–å†™ã€ç»è¿‡ç¼–è¯‘åä¾›é«˜çº§è¯­è¨€ï¼ˆå¦‚ JavaScriptã€Pythonï¼‰è°ƒç”¨çš„æ¨¡å—ï¼Œç›´æ¥ä¸æ“ä½œç³»ç»Ÿæˆ–åº•å±‚ç¡¬ä»¶äº¤äº’ã€‚Chrome ä¸­çš„ Dawn å°±æ˜¯ä¸€ä¸ª Native Module\nWebGPU çš„å·¥ä½œæµç¨‹å¤§è‡´å¯ä»¥åˆ†æˆï¼šåˆå§‹åŒ–ã€é…ç½®ç®¡çº¿å’Œå½•åˆ¶å‘½ä»¤é˜Ÿåˆ—ä¸‰ä¸ªé˜¶æ®µï¼š\nåˆå§‹åŒ–ï¼šè·å–å¯ä¾› JS æ“ä½œçš„ GPU é€»è¾‘å®ä¾‹ï¼Œé…ç½®ä¸Šä¸‹æ–‡ é…ç½®ç®¡çº¿ï¼šåˆ›å»ºç®¡çº¿ï¼Œåˆ›å»º Shader æ¨¡å—ï¼Œåˆ›å»º GPU å˜é‡ï¼ˆBuffersã€BindGroupsï¼‰ å½•åˆ¶å‘½ä»¤é˜Ÿåˆ—ï¼šå¼€å§‹ Passï¼Œç»˜åˆ¶é¡¶ç‚¹ï¼Œæäº¤é˜Ÿåˆ— ä¸ªäººæ„Ÿè§‰ï¼Œå…¶å®ä¹Ÿå¯ä»¥æŠŠè¿™ä¸‰ä¸ªè¿‡ç¨‹åˆå¹¶èµ·æ¥å½“ä½œä¸€ä¸ªåˆå§‹åŒ–è¿‡ç¨‹ï¼Œæ¯•ç«Ÿåœ¨ TS é‡Œå†™çš„åªæ˜¯æ•´ä¸ªæ¸²æŸ“é€»è¾‘ï¼ŒçœŸæ­£æ‰§è¡Œç»˜åˆ¶è¡Œä¸ºæ˜¯ç”± Native è¿›ç¨‹å®Œæˆçš„ã€‚\nåˆå§‹åŒ– WebGPU å› ä¸º WebGPU å°†æ¸²æŸ“ç»“æœç»˜åˆ¶åˆ° GPUCanvasContext ä¸Šï¼Œè€Œè¿™ä¸ª context æ˜¯é€šè¿‡ HTML çš„ \u0026lt;canvas\u0026gt; è·å–çš„ï¼Œæ‰€ä»¥ç¡®ä¿ç½‘é¡µçš„ HTML æ–‡ä»¶ä¸­è‡³å°‘æœ‰ä¸€ä¸ª canvas å…ƒç´ ï¼Œä½œä¸º GPU çš„æ¸²æŸ“ç›®æ ‡ã€‚\n1\u0026lt;canvas\u0026gt;\u0026lt;/canvas\u0026gt; é¦–å…ˆæ£€æŸ¥ä¸€ä¸‹ç›®å‰çš„æµè§ˆå™¨æ˜¯å¦æ”¯æŒ WebGPUï¼Œå¯ä»¥ç”¨ navigator.gpu åˆ¤æ–­ï¼Œå®ƒæ˜¯ WebGPU æä¾›ç»™ JS çš„å…¥å£å¯¹è±¡ï¼Œå¦‚æœæµè§ˆå™¨ä¸æ”¯æŒ WebGPUï¼Œåˆ™å…¶ä¸º undefinedï¼Œéœ€è¦æ›´æ¢åˆé€‚çš„æµè§ˆå™¨æˆ–è€…å¼€å¯æŸä¸ª flagã€‚\n1 if (!navigator.gpu) { 2 throw new Error(\u0026#34;WebGPU is not supported in this browser.\u0026#34;); 3 } 4 else{ 5 console.log(\u0026#34;Hello, WebGPU!\u0026#34;); 6 } è·å¾—äº† WebGPU æ”¯æŒåï¼Œåˆ™å¯ä»¥è°ƒç”¨ navigator.gpu çš„ requestAdapter è·å¾—ä¸€ä¸ª GPU çš„é€»è¾‘é€‚é…å™¨ï¼ˆadapterï¼‰ï¼Œå†ç”± adapter è°ƒç”¨ requestDevice è·å¾—ä¸€ä¸ªå®é™…ä½¿ç”¨ JS è¿›è¡Œäº¤äº’çš„ GPU è®¾å¤‡ï¼ˆdeviceï¼‰ã€‚\n1const adapter = await navigator.gpu.requestAdapter(); 2const device = await gpuAdapter.requestDevice(); adapter å’Œ deviceï¼šGPUAdapter å°è£…äº†ä¸€ä¸ªé€‚é…å™¨ï¼Œå¹¶æè¿°å…¶ç‰¹æ€§ï¼ˆfeaturesï¼‰ã€é™åˆ¶ï¼ˆlimitsï¼‰åŠé€‚é…å™¨ä¿¡æ¯ï¼ˆInfoï¼‰ï¼Œæ˜¯æµè§ˆå™¨å¯¹ GPU çš„æŠ½è±¡ï¼Œå¯ä»¥ç”¨å®ƒé€‰æ‹©å¤šä¸ª GPUï¼ˆé›†æ˜¾ï¼Œç‹¬æ˜¾ï¼‰ï¼›GPUDevice å°è£…äº†ä¸€ä¸ªè®¾å¤‡ï¼Œå¹¶æš´éœ²è¯¥è®¾å¤‡çš„åŠŸèƒ½ï¼ˆåªè¯»ï¼‰ï¼Œä»£è¡¨ä¸ GPU çš„é€»è¾‘è¿æ¥ï¼Œå¯ä»¥ç”¨ device è°ƒç”¨ WebGPU æ¥å£ã€‚\næ­£å¦‚å¼€å¤´æ‰€è¯´ï¼ŒGPUCanvasContext æ˜¯é€šè¿‡ HTMLCanvasElement å®ä¾‹è°ƒç”¨ getContext æ–¹æ³•åˆ›å»ºçš„ï¼Œå¯¹äº WebGPU åˆ›å»ºä¸€ä¸ª WebGPU ä¸“ç”¨çš„ç”»å¸ƒä¸Šä¸‹æ–‡ï¼Œä¼ é€’ webgpu ä½œä¸ºå…¶ contextType å‚æ•°ã€‚\n1const canvas = document.querySelector(\u0026#39;canvas\u0026#39;) as HTMLCanvasElement; 2const context = canvas.getContext(\u0026#39;webgpu\u0026#39;); canvas å’Œ contextï¼šç±»ä¼¼äº adapter å’Œ deviceï¼Œcanvas åªæ˜¯ä¸€ä¸ª HTML çš„ DOM å…ƒç´ ï¼Œéœ€è¦é€šè¿‡ getContext åˆ›å»ºä¸€ä¸ª WebGPU å¯ä»¥æ§åˆ¶çš„é€»è¾‘ç”»å¸ƒï¼Œåœ¨ context ä¸Šè¿›è¡Œç»˜åˆ¶ã€‚åˆ›å»º context ä¹‹åï¼Œå¯ä»¥é€šè¿‡ configure æ–¹æ³•é…ç½®ç”»å¸ƒä¸Šä¸‹æ–‡ï¼Œè‡³å°‘åŒ…æ‹¬ device å’Œ formatï¼ˆGPUTextureFormatï¼‰ï¼Œåè€…ä¸€èˆ¬ä¸º bgra8unormã€‚\nrequestAdapter å’Œ requestDevice éƒ½æ˜¯å¼‚æ­¥æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ª Promiseï¼Œéœ€è¦ä½¿ç”¨ await è·å–å®é™…è¿”å›å¯¹è±¡ï¼Œè€Œ await å¿…é¡»åœ¨ async å‡½æ•°å†…éƒ¨ä½¿ç”¨ï¼Œæ‰€ä»¥å¯ä»¥åœ¨å¤–é¢åŒ…è£¹ä¸€ä¸ª async functionï¼š\n1async function initWebGPU() { 2 // check webgpu support ... 3 // request GPU adapter 4 const adapter = await navigator.gpu.requestAdapter(); 5 if (!adapter) { 6 throw new Error(\u0026#34;Cannot get GPU adapter.\u0026#34;); 7 } 8 9 // request a logical device 10 const device = await adapter.requestDevice(); 11 12 // get canvas and configure webgpu context 13 const canvas = document.querySelector(\u0026#39;canvas\u0026#39;) as HTMLCanvasElement; 14 const context = canvas.getContext(\u0026#39;webgpu\u0026#39;)!; 15 const presentationFormat = navigator.gpu.getPreferredCanvasFormat(); 16 17 context.configure({ 18 device, 19 format: presentationFormat, 20 alphaMode: \u0026#39;premultiplied\u0026#39;, 21 }); 22 // other code ... 23} è‡³æ­¤ï¼ŒWebGPU åˆå§‹åŒ–å®Œæ¯•ã€‚\né…ç½®ç®¡çº¿ WebGPU ä¸€å…±æœ‰ä¸¤ç§ç®¡çº¿ï¼šGPUComputePipelineï¼ˆè®¡ç®—ç®¡çº¿ï¼‰ å’Œ GPURenderPipelineï¼ˆæ¸²æŸ“ç®¡çº¿ï¼‰ï¼Œæ— è®ºå“ªç§ç®¡çº¿éƒ½è§„å®šäº† GPU çš„ä»»åŠ¡æµç¨‹ï¼ŒåŒ…æ‹¬ä» bindings æˆ–è€… buffers è·å–è¾“å…¥ï¼Œå¹¶äº§ç”Ÿè¾“å‡ºï¼ˆä¾‹å¦‚æ¸²æŸ“çº¹ç†ï¼‰çš„è¿‡ç¨‹ã€‚\nä»ç»“æ„ä¸Šçœ‹ï¼Œç®¡çº¿ç”±ä¸€ç³»åˆ—å¯ç¼–ç¨‹é˜¶æ®µï¼ˆshadersï¼‰å’Œå›ºå®šåŠŸèƒ½çŠ¶æ€ï¼ˆæ··åˆæ¨¡å¼ï¼‰ç»„æˆï¼Œä¸€ä¸ªæ¸²æŸ“ç®¡çº¿ä¸€èˆ¬åŒ…æ‹¬é¡¶ç‚¹ç€è‰²å™¨ï¼ˆvertex shaderï¼‰ã€ç‰‡å…ƒç€è‰²å™¨ï¼ˆfragment shaderï¼‰ç­‰ï¼Œè®¡ç®—ç®¡çº¿åˆ™åŒ…æ‹¬è®¡ç®—ç€è‰²å™¨ï¼ˆcompute shaderï¼‰ã€‚\nå¯¹äºä¸€ä¸ªæ¸²æŸ“ç®¡çº¿ï¼Œå¯ä»¥é€šè¿‡ createRenderPipeline æ–¹æ³•ç«‹å³åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿå¯é€šè¿‡ createRenderPipelineAsync æ–¹æ³•å¼‚æ­¥åˆ›å»ºã€‚createRenderPipeline æ–¹æ³•æ¥å—ä¸€ä¸ªå­—å…¸å¯¹è±¡ GPURenderPipelineDescriptorï¼ŒåŒ…å«å¦‚ä¸‹æˆå‘˜ï¼š\nvertexï¼ˆGPUVertexStateï¼‰ï¼šæè¿°ç®¡çº¿é¡¶ç‚¹ç€è‰²å™¨å…¥å£åŠå…¶è¾“å…¥ç¼“å†²åŒºå¸ƒå±€ primitiveï¼ˆGPUPrimitiveStateï¼‰ï¼šæè¿°ç®¡çº¿ä¸­åŸå§‹å›¾å…ƒç›¸å…³å±æ€§ depthStencilï¼ˆGPUDepthStencilStateï¼‰ï¼šå¯é€‰çš„æ·±åº¦æ¨¡æ¿å±æ€§ multisampleï¼ˆGPUMultisampleStateï¼‰ï¼šå¤šé‡é‡‡æ ·å±æ€§ fragmentï¼ˆGPUFragmentStateï¼‰ï¼šæè¿°ç®¡çº¿ç‰‡å…ƒç€è‰²å™¨å…¥å£åŠå…¶è¾“å‡ºé¢œè‰² å¯¹äºæ­¤æ¬¡ç»˜åˆ¶ä¸‰è§’å½¢çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬å¿…é¡»è¦æä¾›çš„æ˜¯ vertexï¼Œprimitive å’Œ fragmentã€‚å…¶ä¸­ vertex å’Œ fragment éƒ½ç»§æ‰¿ GPUProgrammableStageï¼Œåè€…æè¿°ç”¨æˆ·æä¾›çš„ GPUShaderModule ä¸­çš„å…¥å£ç‚¹ï¼Œå³ç€è‰²å™¨çš„å…¥å£å‡½æ•°ã€‚\né¡¶ç‚¹ç€è‰²å™¨æ¥å—æ¥è‡ªé¡¶ç‚¹ç¼“å†²åŒºçš„è¾“å…¥æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦å…ˆå®šä¹‰éœ€è¦ä¼ è¾“åˆ° GPU çš„é¡¶ç‚¹æ•°æ®ï¼Œç„¶åé€šè¿‡ GPUBuffer æè¿°å¦‚ä½•è§£æè¿™äº›æ•°æ®ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸‰è§’å½¢çš„æ¯ä¸ªé¡¶ç‚¹ï¼Œå®šä¹‰å…¶ç”±ä½ç½®å’Œé¢œè‰²ä¸¤ä¸ªå±æ€§ç»„æˆï¼š\n1// data preparation 2const triangleData = new Float32Array([ 3// position color 40.0, 0.5, 0.0, 1.0, 0.0, 0.0, 1.0, 5-0.5, -0.5, 0.0, 0.0, 1.0, 0.0, 1.0, 60.5, -0.5, 0.0, 0.0, 0.0, 1.0, 1.0, 7]); ç„¶åå¯ä»¥é€šè¿‡ createBuffer æ–¹æ³•åˆ›å»ºä¸€ä¸ª GPUbufferï¼Œè¯¥æ–¹æ³•æ¥å—ä¸€ä¸ª GPUBufferDescriptor ç±»å‹çš„å­—å…¸å¯¹è±¡ï¼Œè‡³å°‘éœ€è¦æä¾›ä¸¤ä¸ªå‚æ•°ï¼š\nsizeï¼šç¼“å†²åŒºä»¥å­—èŠ‚ä¸ºå•ä½çš„å¤§å° usageï¼šç¼“å†²åŒºå…è®¸çš„ä½¿ç”¨æ–¹å¼ï¼ˆä¾‹å¦‚ Vertexï¼ŒUniformï¼ŒStorageï¼‰ å¯ä»¥é€šè¿‡ä¸Šè¿°å®šä¹‰çš„é¡¶ç‚¹æ•°ç»„çš„å­—èŠ‚é•¿åº¦è·å– sizeï¼›ä¸ºäº†èƒ½å¤Ÿæ‹·è´ç»™ GPUï¼Œå¹¶ä¼ é€’ç»™ VertexBufferï¼Œåœ¨ usage ä¸­éœ€è¦åŒæ—¶å¯ç”¨ VERTEX å’Œ COPY_DSTã€‚\n1// create and write gpu buffer 2const vertexBuffer = device.createBuffer({ 3size: triangleData.byteLength, 4usage: GPUBufferUsage.VERTEX | GPUBufferUsage.COPY_DST, 5}); 6 7device.queue.writeBuffer(vertexBuffer, 0, triangleData); å®šä¹‰å¥½äº†é¡¶ç‚¹ç€è‰²å™¨çš„è¾“å…¥ï¼Œå°±å¯ä»¥å¼€å§‹ç¼–å†™ shader äº†ã€‚æ­£å¦‚ OpenGL æœ‰ GLSLï¼ŒD3D æœ‰ HLSLï¼ŒWebGPU çš„å¼€å‘ç»„ä¹Ÿä¸ºå…¶å¸¦æ¥äº†ä¸€å¥—æ–°çš„ç€è‰²å™¨è¯­è¨€â€”â€”WGSLã€‚ç»˜åˆ¶ä¸€ä¸ªä¸‰è§’å½¢æ‰€éœ€çš„æœ€ç®€å•çš„ shader å¦‚ä¸‹ï¼š\n1// shader code 2const shaderCode = ` 3struct VertexOutput { 4 @builtin(position) position: vec4\u0026lt;f32\u0026gt;, 5 @location(0) color: vec4\u0026lt;f32\u0026gt;, 6}; 7 8@vertex 9fn vs_main( 10 @location(0) pos: vec3\u0026lt;f32\u0026gt;, 11 @location(1) color: vec4\u0026lt;f32\u0026gt; 12) -\u0026gt; VertexOutput { 13 var output: VertexOutput; 14 output.position = vec4\u0026lt;f32\u0026gt;(pos, 1.0); 15 output.color = color; 16 return output; 17} 18 19@fragment 20fn fs_main(input: VertexOutput) -\u0026gt; @location(0) vec4\u0026lt;f32\u0026gt; { 21 return input.color; 22} 23`; 24 25// create shader module 26const shaderModule = device.createShaderModule({ 27code: shaderCode, 28}); shader ä¹Ÿå¯ä»¥å†™åœ¨ .wgsl æ–‡ä»¶ä¸­ï¼Œé€šè¿‡ import å¯¼å…¥\nè‡³æ­¤ï¼Œå¯ä»¥è°ƒç”¨ createRenderPipeline æ–¹æ³•ï¼Œä¾æ¬¡å¡«å…¥ GPURenderPipelineDescriptor çš„å„ä¸ªå­—æ®µï¼š\nlayoutï¼šä½¿ç”¨ \u0026lsquo;auto\u0026rsquo;ï¼Œè®©ç®¡çº¿è‡ªåŠ¨æ¨æ–­èµ„æºç»‘å®šå¸ƒå±€ vertexï¼šshaderModule åŠé¡¶ç‚¹ç€è‰²å™¨å…¥å£å‡½æ•°ï¼Œé¡¶ç‚¹ç¼“å†²åŒºå¸ƒå±€å’Œæ ¼å¼ fragmentï¼šshaderModule åŠç‰‡å…ƒç€è‰²å™¨å…¥å£å‡½æ•°ï¼Œè¾“å‡ºæ ¼å¼ï¼ˆå¿…é¡»ä¸ context çš„ format åŒ¹é…ï¼‰ primitiveï¼šå…¶ä¸­çš„ topology è§„å®šå›¾å…ƒç±»å‹ï¼Œç”±äºæˆ‘ä»¬æ˜¯ç”»ä¸‰è§’å½¢æ‰€ä»¥ä½¿ç”¨ \u0026rsquo;triangle-list\u0026rsquo; 1 // create render pipeline 2 const pipeline = device.createRenderPipeline({ 3 layout: \u0026#39;auto\u0026#39;, 4 vertex: { 5 module: shaderModule, 6 entryPoint: \u0026#39;vs_main\u0026#39;, 7 buffers: [ 8 { 9 arrayStride: 7 * 4, // position: 3 + color: 4 10 attributes: [ 11 { // position 12 shaderLocation: 0, 13 offset: 0, 14 format: \u0026#39;float32x3\u0026#39;, 15 }, 16 { // color 17 shaderLocation: 1, 18 offset: 3 * 4, 19 format: \u0026#39;float32x4\u0026#39;, 20 }, 21 ], 22 }, 23 ], 24 }, 25 fragment: { 26 module: shaderModule, 27 entryPoint: \u0026#39;fs_main\u0026#39;, 28 targets: [ 29 { 30 format: presentationFormat, 31 }, 32 ], 33 }, 34 primitive: { 35 topology: \u0026#39;triangle-list\u0026#39;, 36 }, 37 }); è‡³æ­¤ï¼Œç®¡çº¿é…ç½®ç»“æŸã€‚\nå½•åˆ¶æ¸²æŸ“é˜Ÿåˆ— ç†Ÿæ‚‰ Unity çš„åŒå­¦å¯èƒ½ä¼šçŸ¥é“ï¼Œå½“è°ƒç”¨æ¸²æŸ“å‘½ä»¤æ—¶ï¼ŒGPU å¹¶éç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯æŠŠä¸€ç³»åˆ—å‘½ä»¤å†™å…¥ä¸€ä¸ªå‘½ä»¤ç¼“å†²åŒºï¼ˆCommandBufferï¼‰ï¼Œç„¶åå†å°†è¿™ä¸ª CommandBuffer æ³¨å…¥åˆ°ç®¡çº¿çš„ç‰¹å®šé˜¶æ®µï¼ˆä¾‹å¦‚ä¸é€æ˜ç‰©ä½“æ¸²æŸ“åæˆ–è€…é˜´å½±æ¸²æŸ“å‰ï¼‰ã€‚å½“æ¸²æŸ“å¾ªç¯æ‰§è¡Œåˆ°æ³¨å…¥ç‚¹æ—¶ï¼Œæ‰ä¼šä¾æ¬¡æ‰§è¡Œç¼“å†²åŒºä¸­çš„å‘½ä»¤ã€‚\nWebGPU ä¸­çš„ CommandEncoder æ­£æ˜¯å¯¹åº”äº†å†™å…¥æ¸²æŸ“ç¼“å†²åŒºçš„å½•åˆ¶æ“ä½œï¼Œç›´åˆ° submit å‰çš„å†…å®¹éƒ½æ˜¯åœ¨æ„å»ºå‘½ä»¤åˆ—è¡¨ï¼š\n1const commandEncoder = device.createCommandEncoder(); 2// record command here 3// ... 4const commandBuffer = commandEncoder.finish(); 5device.queue.submit([commandBuffer]); å¦‚æœè¯´ GPUCommandEncoder æ˜¯ä¸€æ•´ä¸ªå½•åˆ¶å™¨ï¼Œé‚£ä¹ˆ GPURenderPassEncoder å°±æ˜¯å…¶ä¸­çš„ä¸€ä¸ªå­å½•åˆ¶å™¨ï¼Œå½•åˆ¶ä¸€ä¸ª Pass è¿‡ç¨‹ä¸­çš„å‘½ä»¤ã€‚ç®€å•æ¥è¯´ï¼Œä¸€ä¸ª Pass å°±æ˜¯ä» GPU è¾“å…¥æ•°æ®åˆ°è¾“å‡ºæ¸²æŸ“ç›®æ ‡çš„è¿‡ç¨‹ã€‚ä¸€ä¸ª CommandEncoder å¯ä»¥åˆ›å»ºå¤šä¸ª Passã€‚\nåœ¨ WebGPU ä¸­åˆ›å»ºä¸€ä¸ª Pass å¯ä»¥ä½¿ç”¨ beginRenderPass æ–¹æ³•ï¼Œæ¥å—ä¸€ä¸ª GPURenderPassDescripter å­—å…¸å¯¹è±¡ï¼Œè‡³å°‘éœ€è¦åŒ…å« colorAttachments å­—æ®µã€‚colorAttachments å®šä¹‰äº†å½“å‰ Pass è¾“å‡ºçš„æ‰€æœ‰é¢œè‰²é™„ä»¶ï¼Œæ¯ä¸ª colorAttachment æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå¿…é¡»æä¾›ä»¥ä¸‹ä¸‰ä¸ªå­—æ®µï¼š\nviewï¼ˆGPUTextureViewï¼‰ï¼šæè¿°è¾“å‡ºæ­¤ colorAttachment çš„çº¹ç†å­èµ„æº loadOpï¼ˆGPULoadOpï¼‰ï¼šæ‰§è¡Œ Pass å‰å¯¹ view çš„åŠ è½½æ“ä½œï¼ˆä¸€èˆ¬ä¸º clearï¼‰ storeOpï¼ˆGPUStoreOpï¼‰ï¼šæ‰§è¡Œ Pass åå¯¹ view çš„å­˜å‚¨æ“ä½œ åˆ›å»º GPUPassEncoder åï¼Œå°±å¯ä»¥å½•åˆ¶æ¸²æŸ“å‘½ä»¤äº†ï¼Œå…·ä½“åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š\nè®¾ç½®ç®¡çº¿ï¼šè®¾ç½®è¯¥ Pass ä½¿ç”¨çš„ç®¡çº¿ã€æ¸²æŸ“çŠ¶æ€ ç»‘å®šèµ„æºï¼šè®¾ç½®é¡¶ç‚¹ç¼“å†²ã€ç´¢å¼•ç¼“å†²å’Œ BindingGroup æ‰§è¡Œç»˜åˆ¶ï¼šè°ƒç”¨ draw æ–¹æ³•ç»˜åˆ¶é¡¶ç‚¹ ä¸Šè¿°æµç¨‹å®Œæˆåï¼Œä¾¿å¯ä»¥é€šè¿‡ end æ–¹æ³•ç»“æŸ Pass çš„å½•åˆ¶ã€‚å¯¹äºæœ¬æ¬¡çš„ä¸‰è§’å½¢ï¼Œå…¶æ¸²æŸ“é˜Ÿåˆ—çš„å½•åˆ¶è¿‡ç¨‹å¦‚ä¸‹ï¼š\n1function frame() { 2 // cmdEncoder to record commands 3 const commandEncoder = device.createCommandEncoder(); 4 5 // get current texture view 6 const textureView = context.getCurrentTexture().createView(); 7 8 // begin render pass 9 const renderPassDescriptor: GPURenderPassDescriptor = { 10 colorAttachments: [ 11 { 12 view: textureView, 13 clearValue: { r: 0.0, g: 0.0, b: 0.0, a: 1.0 }, 14 loadOp: \u0026#39;clear\u0026#39;, 15 storeOp: \u0026#39;store\u0026#39;, 16 }, 17 ], 18 }; 19 20 const passEncoder = commandEncoder.beginRenderPass(renderPassDescriptor); 21 22 // set pipeline and vertex buffer 23 passEncoder.setPipeline(pipeline); 24 passEncoder.setVertexBuffer(0, vertexBuffer); 25 26 // draw triangle: 3 vertices 27 passEncoder.draw(3); 28 29 // end render pass 30 passEncoder.end(); 31 32 // finish encode and submit 33 device.queue.submit([commandEncoder.finish()]); 34 35 // request next frame 36 requestAnimationFrame(frame); 37 } 38 39 // start render loop 40 requestAnimationFrame(frame); åœ¨ç»ˆç«¯è¿è¡Œ npm run devï¼Œä¸å‡ºæ„å¤–å°±èƒ½çœ‹åˆ°ä¸€ä¸ªäº”å½©æ–‘æ–“çš„ä¸‰è§’å½¢ï¼š\nCSS è‡ªå·±å†™\nGUI ç›®å‰æˆ‘ä»¬å‚æ•°æ˜¯å†™æ­»åœ¨ TS ä¸­ï¼Œæ›´æ–¹ä¾¿çš„æ–¹å¼æ˜¯åŠ å…¥äº¤äº’çš„ GUIï¼Œå¯ä»¥åœ¨æµè§ˆå™¨ä¸­å®æ—¶è°ƒæ•´å‚æ•°å¹¶æŸ¥çœ‹ç»“æœã€‚\nOpenGL çš„æ—¶å€™ç”¨çš„æ˜¯ imguiï¼Œä½†ä¸çŸ¥ä¸ºä½•ä¸‹è½½ä¸äº†å…¶å¯¹ js çš„å°è£…ï¼Œæ‰€ä»¥è¿™é‡Œé€‰æ‹©çš„æ˜¯å¦ä¸€ä¸ªè½»é‡çº§çš„ lil-guiï¼Œåœ¨ç»ˆç«¯ä¸‹è½½å®ƒçš„åŒ…ï¼š\n1npm install lil-gui ç„¶ååœ¨ TypeScript æ–‡ä»¶ä¸­å¼•å…¥ï¼š\n1import {GUI} from \u0026#39;lil-gui\u0026#39; åˆå§‹åŒ– GUI å¹¶æ·»åŠ ä¸‰ä¸ª color å‚æ•°æ§åˆ¶ä¸‰è§’å½¢æ¯ä¸ªé¡¶ç‚¹çš„é¢œè‰²ï¼š\n1const gui = new GUI(); 2 3const params = { 4colorA: [1, 0, 0, 1], 5colorB: [0, 1, 0, 1], 6colorC: [0, 0, 1, 1], 7}; 8 9gui.addColor(params, \u0026#39;colorA\u0026#39;); 10gui.addColor(params, \u0026#39;colorB\u0026#39;); 11gui.addColor(params, \u0026#39;colorC\u0026#39;); åˆ›å»ºä¸€ä¸ª GPUBufferï¼Œå°†å…¶è®¾ç½®ä¸º UNIFORMï¼Œå¹¶ç»‘å®šåˆ° bindGroupï¼š\n1const colorBuffer = device.createBuffer({ 2 size: 4 * 3 * 4, // 3 colors, each with 4 floats 3 usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST, 4}) 5 6const bindGroup = device.createBindGroup({ 7 layout: pipeline.getBindGroupLayout(0), 8 entries: [{ 9 binding: 0, 10 resource: { 11\tbuffer: colorBuffer 12 } 13}], 14}); ç„¶åæ¯å¸§æ›´æ–°è¿™ä¸ª Buffer å¹¶è®¾ç½®ç»‘å®šç»„ï¼š\n1function updateColors(){ 2 device.queue.writeBuffer(colorBuffer, 0, new Float32Array([...params.colorA, ...params.colorB, ...params.colorC])); 3} 4 5function frame(){ 6\t// ... 7 updateColors(); 8 passEncoder.setBindGroup(0, bindGroup); 9} æœ€åå¯ä»¥åœ¨ VertexShader ä¸­è§£æè¿™ä¸ª uniformï¼š\n1struct ColorUniform { 2 colorA: vec4\u0026lt;f32\u0026gt;, 3 colorB: vec4\u0026lt;f32\u0026gt;, 4 colorC: vec4\u0026lt;f32\u0026gt;, 5}; 6 7@group(0) @binding(0) var\u0026lt;uniform\u0026gt; uColors: ColorUniform; 8 9fn getColorByIndex(index: u32) -\u0026gt; vec4\u0026lt;f32\u0026gt; { 10 if (index == 0u) { 11\treturn uColors.colorA; 12 } else if (index == 1u) { 13\treturn uColors.colorB; 14 } else { 15\treturn uColors.colorC; 16 } 17} 18 19@vertex 20fn vs_main( 21 @builtin(vertex_index) vertexindex: u32, 22 @location(0) pos: vec3\u0026lt;f32\u0026gt;, 23 @location(1) color: vec4\u0026lt;f32\u0026gt; 24) -\u0026gt; VertexOutput { 25 var output: VertexOutput; 26 output.position = vec4\u0026lt;f32\u0026gt;(pos, 1.0); 27 output.color = getColorByIndex(vertexindex); 28 return output; 29} å›åˆ°æµè§ˆå™¨ï¼Œè°ƒæ•´é¢œè‰²ï¼Œå°±å¯ä»¥çœ‹åˆ°å˜åŒ–äº†ï¼š\n0x0F After words å¥½äº†ï¼Œä½ å·²ç»å­¦ä¼šå¦‚ä½•ä½¿ç”¨ WebGPU ç»˜åˆ¶ä¸‰è§’å½¢äº†ï¼Œå¯ä»¥å°è¯•æŒ‘æˆ˜ä¸€ä¸‹åˆ¶ä½œä¸€ä¸ª 3DGS çš„å®æ—¶æ¸²æŸ“é¢„è§ˆå™¨äº†ï¼\nå¥½å§ä¸å¼€ç©ç¬‘äº†ï¼ŒWebGPU è¿˜æœ‰æå¤§éƒ¨åˆ†å†…å®¹æ˜¯æœ¬æ–‡æ²¡æœ‰æ¶µç›–çš„ï¼Œå¦‚æœè¯»è€…æœ‰æ›´è¿›ä¸€æ­¥çš„éœ€æ±‚ï¼Œæ–‡ç« å¼€å¤´ä¹Ÿåˆ—å‡ºäº†ä¸€äº›æ›´è¯¦ç»†çš„æ–‡æ¡£å’Œæ•™ç¨‹å¯ä¾›å‚è€ƒã€‚å¦‚æœæœ‰ä¸€äº› OpenGL æˆ–è€… WebGL åŸºç¡€ï¼Œå­¦ WebGPU ä¹Ÿä¼šæ›´è½»æ¾äº›å§â€¦â€¦\n","permalink":"https://congyuxiaoyoudao.github.io/posts/interludes/webgpu-from-scratch/","summary":"\u003cblockquote\u003e\n\u003cp\u003eä»å¯¼å¸ˆé‚£é‡Œå¬è¯´äº† WebGPUï¼Œåšäº†ç‚¹è°ƒæŸ¥å‘ç°è¿™ä¸ª API è¿˜æŒºæ–°çš„ï¼Œæ­£å¥½ä¹‹å‰åªé›¶é›¶ç¢ç¢å­¦äº†ä¸€ç‚¹ OpenGLï¼Œç›¸æ¯”äºä¸é€‚åˆäººç±»å­¦çš„ Vulkanï¼Œè¿˜æ˜¯ WebGPU æ˜¾å¾—å‹å¥½ä¸€ç‚¹ã€‚\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2 id=\"-0x00-to-begin-with\"\u003eğŸš© 0x00 To begin with\u003c/h2\u003e\n\u003cp\u003eè¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e ä»€ä¹ˆæ˜¯ WebGPU\u003c/li\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e é…ç½® WebGPU å¼€å‘ç¯å¢ƒ\u003c/li\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e ç¬¬ä¸€ä¸ª WebGPU é¡¹ç›®ï¼šHelloTriangleï¼\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eFor reference\u003c/strong\u003eğŸ‘‡ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eğŸª \n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://webgpu.github.io/webgpu-samples/\"\u003eWebGPU Samples\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“– \n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://gpuweb.github.io/gpuweb/\"\u003eWebGPU API Spec\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“– \n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://www.w3.org/TR/WGSL/\"\u003eWebGPU Shading Language\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“º \n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://www.bilibili.com/video/BV1uu411B7uq/\"\u003eWebGPUå°ç™½å…¥é—¨ï¼ˆä¸€ï¼‰ï¼šå¦‚ä½•é›¶åŸºç¡€åˆ›å»ºç¬¬ä¸€ä¸ªWebGPUé¡¹ç›®ï¼\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“– \n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://codelabs.developers.google.com/your-first-webgpu-app?hl=zh-cn\u0026amp;authuser=0#0\"\u003eæ‚¨çš„ç¬¬ä¸€ä¸ª WebGPU åº”ç”¨\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“– \n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://lil-gui.georgealways.com/\"\u003elil-gui 0.20.0\u003c/a\u003e\n\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"0x01-è®¤è¯†-webgpu\"\u003e0x01 è®¤è¯† WebGPU\u003c/h2\u003e\n\u003cp\u003eWebGPU æ˜¯ä¸€ä¸ªç”± W3C GPU å·¥ä½œç»„åˆ¶å®šçš„æ–°çš„ç°ä»£å›¾å½¢ APIï¼Œç”¨äºåœ¨ Web åº”ç”¨ä¸­è®¿é—® GPU åŠŸèƒ½ã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨ WebGPU å‡ºç°ä¹‹å‰ï¼ŒWeb ç«¯çš„å›¾å½¢ç¼–ç¨‹åº”ç”¨ä¸»è¦é‡‡ç”¨ WebGL å’Œ WebGL 2ï¼Œè™½ç„¶å®ƒä»¬æœ‰ç€è·¨å¹³å°èƒ½åŠ›å’Œå¼ºå¤§çš„ç¤¾åŒºæ”¯æŒï¼Œä½†æ¶æ„è¿‡äºå¤è€ï¼Œæœ€æ–°çš„ WebGL 2 åªæ˜¯å°è£…äº† 2009 å¹´ OpenGL 3.2 çš„å®ç°ã€‚Khronos ä¹ŸæŒ‡å‡º WebGL åç»­æ›´æ–°ä¸­ä¸å†å¼•å…¥ç°ä»£ GPU çš„æ–°ç‰¹æ€§ã€‚\u003c/p\u003e","title":"Interlude 3. WebGPU From Scratch"},{"content":" 202 ç³»åˆ—å®Œç»“æ’’èŠ± âœ¿âœ¿ãƒ½(Â°â–½Â°)ãƒâœ¿ï¼\n0x00 To begin with è¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\néƒ¨åˆ†è¯¾ç¨‹å†…å®¹å›é¡¾ GAMES202 ä½œä¸š 5 For referenceğŸ‘‡ï¼š\nğŸ“ºB ç«™è§†é¢‘ï¼š GAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“ ğŸ“¦ä»£ç ä»“åº“ï¼š congyuxiaoyoudao/GAMES202_Homework at working ä½œä¸š5å‘å¸ƒå…¬å‘ŠåŠåœºæ™¯ä¸‹è½½ ğŸ“– GAMES202-ä½œä¸š5ï¼šå®æ—¶å…‰çº¿è¿½è¸ªé™å™ª master åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…\n0x01 é—®é¢˜ä¿®å¤ TroubleShooting åšä½œä¸šæ—¶é‡åˆ°ä¸€äº›å‡ºç°é—®é¢˜çš„åœ°æ–¹ï¼Œè¿™é‡Œä¸€å¹¶æä¸€ä¸‹ï¼š\nè¿è¡Œ build.bat å build ç›®å½•ä¸‹æ²¡æœ‰å‡ºç°å¯æ‰§è¡Œæ–‡ä»¶ ReadFloatImage æ–¹æ³•æŠ¥é”™ mathutil.h ä¸­ uint32_t was not declared in this scope ç¬¬ä¸€ä¸ªé—®é¢˜çº¯å±å¯¹ Cmake ä¸ç†Ÿç»ƒï¼Œbuild.bat æä¾›çš„å‘½ä»¤åªæ˜¯ç”Ÿæˆå·¥ç¨‹æ–‡ä»¶ï¼Œè¦è¿è¡Œæ„å»ºè¿˜éœ€è¦å¦‚ä¸‹å‘½ä»¤ï¼ˆæˆ–è€…ç›´æ¥ç”¨ VS ç­‰ IDE è¿è¡Œï¼‰ï¼š\n1cmake --build build è¿™é‡Œä¸ºäº†ç®€åŒ–è¿è¡Œæ“ä½œï¼Œæ–°å¢äº†ä¸€ä¸ª run.batï¼š\n1cmake --build build 2cd build 3Denoise.exe 4cd .. ç¬¬äºŒä¸ªé—®é¢˜ä¸ºè·¯å¾„é”™è¯¯ï¼Œä¸‹è½½å®Œåœºæ™¯åæˆ‘çš„æ ¹ç›®å½•æ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š\n1assignment5/ 2â”œâ”€â”€ examples/ 3|\tâ””â”€â”€ ... 4â”œâ”€â”€ src/ 5| â”œâ”€â”€ main.cpp 6â”‚ â””â”€â”€ ... 7â””â”€â”€ ... æ‰€ä»¥éœ€è¦åœ¨ main.cpp ä¸­æ›´æ”¹ä¸€ä¸‹è·¯å¾„ï¼ˆæˆ–è€…ç›´æ¥æŠŠ examples æ”¾åˆ° src ä¸‹ï¼‰ï¼š\n1filesystem::path inputDir(\u0026#34;../examples/box/input\u0026#34;); 2filesystem::path outputDir(\u0026#34;../examples/box/output\u0026#34;); ç¬¬ä¸‰ä¸ªé—®é¢˜ï¼Œç¼ºå°‘å¤´æ–‡ä»¶ï¼Œåœ¨ mathutil.h ä¸­åŒ…å« \u0026lt;cstdint\u0026gt; å³å¯ã€‚\n0x02 è”åˆåŒè¾¹æ»¤æ³¢ Joint Bilateral Filter å¯¹äºå•å¸§å›¾åƒçš„é™å™ªï¼Œå®é™…ä¸Šå°±æ˜¯ä½é€šæ»¤æ³¢çš„è¿‡ç¨‹ï¼Œä½†æ˜¯å¸¸è§çš„ä½é€šæ»¤æ³¢æ ¸ï¼ˆä¾‹å¦‚é«˜æ–¯æ ¸ï¼‰ä¼šæ— æ¡ä»¶åœ°æŠ¹é™¤è¾“å…¥å›¾åƒä¸­çš„é«˜é¢‘éƒ¨åˆ†ï¼ŒåŒ…æ‹¬å›¾åƒä¸­ä¸åŒç‰©ä½“çš„è¾¹ç•Œã€‚è€Œæˆ‘ä»¬å¸Œæœ›åœ¨é™å™ªçš„è¿‡ç¨‹ä¸­èƒ½å¤Ÿä¿ç•™è¿™äº›è¾¹ç¼˜ï¼Œé¿å… Overblurï¼Œå°±éœ€è¦å¯»æ‰¾åˆ«çš„æ–¹æ³•ã€‚\nåŒè¾¹æ»¤æ³¢æä¾›äº†ä¸€ä¸ªä¸é”™çš„æ€è·¯ï¼šåŒè¾¹æ»¤æ³¢æ ¸çš„æƒé‡ä¸ä»…è€ƒè™‘äº†åƒç´ é—´å‡ ä½•è·ç¦»çš„å·®å¼‚ï¼Œè¿˜è€ƒè™‘äº†å›¾åƒå€¼åŸŸä¸Šçš„å·®å¼‚ï¼š\n$$ w(i, j, k, l) = \\exp\\left( -\\frac{(i - k)^2 + (j - l)^2}{2\\sigma_d^2} - \\frac{\\|I(i, j) - I(k, l)\\|^2}{2\\sigma_r^2} \\right) $$ å½“ä¸¤ä¸ªåƒç´ åœ¨å€¼ï¼ˆé¢œè‰²ã€æ·±åº¦ç­‰ï¼‰ä¸Šå·®å¼‚è¿‡å¤§æ—¶ï¼Œé‡‡æ ·åƒç´ å¯¹ä¸­å¿ƒåƒç´ çš„è´¡çŒ®å°±å‡å°‘ï¼Œè¿™æ ·å°±å¯ä»¥ç»´æŒä½è¾¹ç¼˜ä¿¡æ¯ã€‚\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨åŒè¾¹æ»¤æ³¢çš„åŸºç¡€ä¸Šï¼Œä¸ºæ ¸åŠ å…¥æ›´å¤šæ§åˆ¶ä»¥åº”å¯¹å¤šç§å¤æ‚è¾¹ç¼˜æƒ…å†µï¼Œè¿™å°±æ˜¯è”åˆåŒè¾¹æ»¤æ³¢çš„æ€æƒ³ã€‚\nä½¿ç”¨è”åˆåŒè¾¹æ»¤æ³¢å¯¹å•å¸§å›¾åƒè¿›è¡Œé™å™ªï¼Œä½œä¸šä¸­ç»™å‡ºçš„æ ¸ä¸ºï¼š\n$$ J(\\mathbf{i}, \\mathbf{j}) = \\exp\\left( -\\frac{\\|\\mathbf{i} - \\mathbf{j}\\|^2}{2\\sigma_p^2} - \\frac{\\|\\tilde{C}[i] - \\tilde{C}[j]\\|^2}{2\\sigma_c^2} - \\frac{D_{\\text{normal}}(\\mathbf{i}, \\mathbf{j})^2}{2\\sigma_n^2} - \\frac{D_{\\text{plane}}(\\mathbf{i}, \\mathbf{j})^2}{2\\sigma_d^2} \\right) $$ å…¶ä¸­ï¼š\n$\\lVert \\mathbf{i} - \\mathbf{j} \\rVert$ï¼šåƒç´ åæ ‡å·®å€¼ $\\lVert \\tilde{C}[i] - \\tilde{C}[j] \\rVert$ï¼šé¢œè‰²å·®å€¼ $D_{\\text{normal}}(\\mathbf{i}, \\mathbf{j}) = \\arccos\\left( \\text{Normal}[\\mathbf{i}] \\cdot \\text{{Normal}}[\\mathbf{j}] \\right)$ï¼Œæè¿°é¢æœå‘å·®å¼‚ $D_{\\text{plane}}(\\text{i}, \\text{j}) = \\text{Normal}[\\text{i}] \\cdot \\frac{\\text{Position}[\\text{j}] - \\text{Position}[\\text{i}]}{\\lVert \\text{Position}[\\text{j}] - \\text{Position}[\\text{i}] \\rVert}$ï¼Œæè¿°è·ç¦»å·®å¼‚ï¼ˆæ²¿æ³•å‘å˜åŒ–çš„è·ç¦»ï¼‰ ä¸€ç›´æœ‰ç‚¹ç–‘æƒ‘ä¸ºä»€ä¹ˆå¾ˆå¤šä½œä¸šå®ç°éƒ½æ˜¯æŠŠç¬¬ä¸€é¡¹å½“ä½œä¸–ç•Œä½ç½®å·®å¼‚ï¼Œè¯•äº†ä¸€ä¸‹æ•ˆæœä¹Ÿçš„ç¡®å·®ä¸å¤š\nå„ä¸ª $\\sigma$ ä¸ºæ§åˆ¶ä¸åŒé¡¹çš„å¹³æ»‘ç¨‹åº¦çš„æ ‡å‡†å·®ï¼Œ$\\sigma$ è¶Šå¤§è¡¨ç¤ºå¯¹ä¸Šè¿°è·ç¦»å·®å¼‚è¶Šä¸æ•æ„Ÿï¼Œå³æ›´èƒ½å®¹å¿æƒé‡å·®å¼‚ã€‚\nåœ¨ denoise.cpp ä¸­å®Œæˆ Filter å‡½æ•°ï¼ŒæŒ‰ç…§ä¸Šè¿°å…¬å¼å®Œæˆè”åˆåŒè¾¹æ»¤æ³¢é€»è¾‘ï¼š\n1Buffer2D\u0026lt;Float3\u0026gt; Denoiser::Filter(const FrameInfo \u0026amp;frameInfo) { 2 int height = frameInfo.m_beauty.m_height; 3 int width = frameInfo.m_beauty.m_width; 4 Buffer2D\u0026lt;Float3\u0026gt; filteredImage = CreateBuffer2D\u0026lt;Float3\u0026gt;(width, height); 5 int kernelRadius = 16; 6#pragma omp parallel for 7 for (int y = 0; y \u0026lt; height; y++) { 8 for (int x = 0; x \u0026lt; width; x++) { 9 // Joint bilateral filter 10 // get current pixel vals 11 Float3 color = frameInfo.m_beauty(x, y); 12 Float3 normal = frameInfo.m_normal(x, y); 13 Float3 pos = frameInfo.m_position(x, y); 14 15 float weight_sum = 0.f; 16 Float3 color_sum = Float3(0.f); 17 for(int i = -kernelRadius; i \u0026lt;= kernelRadius; i++){ 18 for(int j = -kernelRadius; j \u0026lt;= kernelRadius; j++){ 19 // clamp coordinate 20 int sampleCoord_x = std::min(std::max(0,x+i),width-1); 21 int sampleCoord_y = std::min(std::max(0,y+j),height-1); 22 23 // sample sampled pixel vals 24 Float3 sampledColor = frameInfo.m_beauty(sampleCoord_x,sampleCoord_y); 25 Float3 sampledNormal = frameInfo.m_normal(sampleCoord_x,sampleCoord_y); 26 Float3 sampledPos = frameInfo.m_position(sampleCoord_x,sampleCoord_y); 27 28 // calculate weight 29 float weight = 0.0; 30 float d_coord2 = i*i+j*j; 31 32 float d_color2 = SqrDistance(color,sampledColor); 33 34 float cosTheta = Dot(normal,sampledNormal); 35 float d_normal2 = SafeAcos(cosTheta)*SafeAcos(cosTheta); 36 37 float d_plane = 0.f; 38 float d_pos = Distance(pos, sampledPos); 39 if (d_pos \u0026gt; 0) 40 d_plane = Dot(normal,Normalize(sampledPos-pos)); 41 float d_plane2 = d_plane*d_plane; 42 43 float w_coord = - d_coord2/(2*m_sigmaCoord*m_sigmaCoord); 44 float w_color = - d_color2/(2*m_sigmaColor*m_sigmaColor); 45 float w_normal = - d_normal2/(2*m_sigmaNormal*m_sigmaNormal); 46 float w_plane = - d_plane2/(2*m_sigmaPlane*m_sigmaPlane); 47 48 weight = exp(w_coord+w_color+w_normal+w_plane); 49 // accumulate weight and color buffer 50 weight_sum += weight; 51 color_sum += sampledColor * weight; 52 } 53 } 54 // protect 0 weight 55 if(weight_sum == 0.0f){ 56 filteredImage(x, y) = color; 57 } 58 else{ 59 filteredImage(x, y) = color_sum / weight_sum; 60 } 61 } 62 } 63 return filteredImage; 64} 0x03 åæŠ•å½± Reprojection åæŠ•å½±åˆ©ç”¨å½“å‰å¸§çš„ä¿¡æ¯æ‰¾åˆ°ä¸Šä¸€å¸§çš„å¯¹åº”åƒç´ ä½ç½®ï¼Œé€šè¿‡åæŠ•å½±å¯ä»¥åœ¨æ—¶é—´ä¸Šå¤ç”¨å·²ç»æ»¤æ³¢çš„ä¸Šä¸€å¸§ä¿¡æ¯ã€‚\nå·²çŸ¥å½“å‰å¸§çš„åƒç´ åæ ‡ï¼Œå¯ä»¥åœ¨ GBuffer ä¸Šè·å–ä¸–ç•Œä½ç½®å’Œå„ç±»å˜æ¢çŸ©é˜µï¼Œä½¿ç”¨ä¸‹å¼å³å¯é€šè¿‡åƒç´ ä¸–ç•Œä½ç½®æ‰¾åˆ°ä¸Šä¸€å¸§è¯¥åƒç´ çš„å±å¹•åæ ‡ï¼š\n$$ \\text{Screen}_{i-1} = P_{i-1} V_{i-1} M_{i-1} M_i^{-1} \\, \\text{World}_i $$ æŠ•å½±åˆ°å±å¹•åæ ‡ä¸‹ä¼šå­˜åœ¨ä¸€äº›å±å¹•ç©ºé—´å›ºæœ‰çš„é—®é¢˜ï¼Œå¯¼è‡´åæŠ•å½±åçš„åƒç´ ä¸åˆæ³•ï¼Œè‹¥å¼ºè¡Œå¤ç”¨ä¼šå¯¼è‡´ lagging ï¼Œå¯¹äºè¿™äº›æƒ…å†µæˆ‘ä»¬è¦æ‰‹åŠ¨è¿›è¡Œåˆ¤æ–­ï¼š\nåæŠ•å½±åçš„åƒç´ åœ¨å±å¹•å¤–ï¼Œå³å½“å‰å¸§åƒç´ å¯¹åº”æ–°è¿›å…¥å±å¹•çš„ç‰©ä½“ åæŠ•å½±åçš„åƒç´ å’Œå½“å‰å¸§åƒç´ å¯¹åº”ç‰©ä½“çš„ id ä¸åŒ ç¬¬ä¸€ç§æƒ…å†µå¯ä»¥é€šè¿‡åˆ¤æ–­åæŠ•å½±åçš„åƒç´ åæ ‡æ˜¯å¦åˆæ³•å±å¹•èŒƒå›´å†…ï¼ˆ$[0,w-1],[0,h-1]$ï¼‰ï¼›ç¬¬äºŒç§æƒ…å†µå¯ä»¥é€šè¿‡åˆ¤æ–­ GBuffer Id æ˜¯å¦ç›¸ç­‰ã€‚ä»…å¯¹ä¸Šè¿°åˆ¤æ–­ååˆæ³•çš„åƒç´ è¿›è¡Œæ—¶é—´ç´¯ç§¯ï¼Œæ›´æ–° m_valid å’Œ m_miscã€‚\næŒ‰ç…§ä¸Šè¿°æ€è·¯å®Œæˆ Reprojection å‡½æ•°ï¼š\n1void Denoiser::Reprojection(const FrameInfo \u0026amp;frameInfo) { 2 int height = m_accColor.m_height; 3 int width = m_accColor.m_width; 4 Matrix4x4 preWorldToScreen = 5 m_preFrameInfo.m_matrix[m_preFrameInfo.m_matrix.size() - 1]; 6 Matrix4x4 preWorldToCamera = 7 m_preFrameInfo.m_matrix[m_preFrameInfo.m_matrix.size() - 2]; 8#pragma omp parallel for 9 for (int y = 0; y \u0026lt; height; y++) { 10 for (int x = 0; x \u0026lt; width; x++) { 11 // Reproject 12 m_valid(x, y) = false; 13 m_misc(x, y) = Float3(0.f); 14 15 float id = frameInfo.m_id(x, y); 16 // skip ivalid id 17 if(id == -1) 18 continue; 19 20 Float3 pos = frameInfo.m_position(x, y); 21 Matrix4x4 WorldToLocal = Inverse(frameInfo.m_matrix[id]); 22 Matrix4x4 preLocalToWorld = m_preFrameInfo.m_matrix[id]; 23 // P_{i-1}V_{i-1}M_{-1}M_{i}^{-1} 24 Matrix4x4 ReprojectionMatrix = preWorldToScreen*preLocalToWorld*WorldToLocal; 25 26 Float3 prePosScreen = ReprojectionMatrix(pos, Float3::EType::Point); 27 float pre_x = prePosScreen.x; 28 float pre_y = prePosScreen.y; 29 30 // is in viewport 31 if(pre_x\u0026lt;0 || pre_x\u0026gt;width-1 || pre_y\u0026lt;0 || pre_y\u0026gt;height-1) 32 continue; 33 34 float preId = m_preFrameInfo.m_id(pre_x, pre_y); 35 36 if(preId == id){ 37 m_valid(x, y) = true; 38 m_misc(x, y) = m_accColor(pre_x, pre_y); 39 } 40 } 41 } 42 std::swap(m_misc, m_accColor); 43} 0x04 æ—¶é—´ç´¯ç§¯ Temporal Accumulation åæŠ•å½±å°†å½“å‰å¸§æ‰€æœ‰åƒç´ å¯¹åº”çš„ä¸Šä¸€å¸§åæŠ•å½±çš„åƒç´ é¢œè‰²ï¼ˆè‹¥åˆæ³•ï¼‰å­˜å…¥ m_accColorï¼Œä»¥ä¾¿æ—¶é—´ç´¯ç§¯å¤ç”¨ã€‚\nå¦‚æœç›´æ¥ä½¿ç”¨ä¸Šä¸€å¸§çš„ä¿¡æ¯ï¼Œå½“å…¶é¢œè‰²ä¸å½“å‰é¢œè‰²å·®å¼‚è¿‡å¤§æ—¶å¯èƒ½å¯¼è‡´ ghostingï¼Œä¸ºäº†é¿å…è¿™ä¸ªæƒ…å†µï¼Œéœ€è¦å¯¹ä¸Šä¸€å¸§ä¿¡æ¯å’Œå½“å‰å¸§ä¿¡æ¯åšé’³åˆ¶ï¼Œå³ï¼š\n$$ C^{(i-1)}=\\text{clamp}(C^{(i-1)}, \\mu - k\\sigma, \\mu + k\\sigma) $$ å…¶ä¸­ï¼Œ$\\mu,\\sigma$ åˆ†åˆ«ä¸ºå½“å‰å¸§åƒç´ æŸä¸€é‚»åŸŸçš„å‡å€¼å’Œæ–¹å·®ã€‚é’³åˆ¶åå³å¯ä½¿ç”¨ä¸‹å¼æ··åˆé¢œè‰²ï¼š\n$$ C^{(i)} = \\alpha \\bar{C}^{(i)} + (1 - \\alpha) C^{(i-1)} $$ å…¶ä¸­ï¼Œ$\\bar{C}^{(i)}$ ä¸ºå½“å‰å¸§å·²é™å™ªåƒç´ ä¿¡æ¯ï¼Œ$C^{(i-1)}$ ä¸ºä¸Šä¸€å¸§å·²é™å™ªåæŠ•å½±åƒç´ ä¿¡æ¯ï¼Œ$\\alpha$ é€šå¸¸å– 0.2ï¼Œè¡¨ç¤ºæ›´å¤šåœ°ä½¿ç”¨ä¸Šä¸€å¸§ä¿¡æ¯ã€‚\nåœ¨ denoise.cpp ä¸­å®Œæˆ TemporalAccumulation å‡½æ•°ï¼Œé€šè¿‡éå†å½“å‰åƒç´ çš„ 7Ã—7 é‚»åŸŸè®¡ç®—å‡å€¼å’Œæ–¹å·®ï¼Œå¹¶å°†ä¸Šä¸€å¸§ä¿¡æ¯é™åˆ¶åˆ° $(\\mu-k\\sigma,\\mu+k\\sigma)$ èŒƒå›´å†…ã€‚ä¸ºäº†é¿å…æ±‚æ–¹å·®å†åšä¸€éå¾ªç¯ï¼Œå¯ä»¥åˆ©ç”¨æ–¹å·®çš„å¦ä¸€ä¸ªè®¡ç®—å…¬å¼ï¼š\n$$ Var(X)=E(X^{2})-E(X)^{2} $$ 1void Denoiser::TemporalAccumulation(const Buffer2D\u0026lt;Float3\u0026gt; \u0026amp;curFilteredColor) { 2 int height = m_accColor.m_height; 3 int width = m_accColor.m_width; 4 int kernelRadius = 3; 5 int kernelSize = 2*kernelRadius+1; 6 int sampleNum = kernelSize * kernelSize; 7#pragma omp parallel for 8 for (int y = 0; y \u0026lt; height; y++) { 9 for (int x = 0; x \u0026lt; width; x++) { 10 // Temporal clamp 11 float alpha = 1.0f; 12 // previous frame color 13 Float3 color = m_accColor(x, y); 14 15 if(m_valid(x, y)){ 16 alpha = m_alpha; 17 // calculate mu and sigma in 7*7 block 18 Float3 mu, mu2 = Float3(0.f); 19 Float3 sigma = Float3(0.f); 20 for(int i = -kernelRadius; i \u0026lt;= kernelRadius; i++){ 21 for(int j = -kernelRadius; j \u0026lt;= kernelRadius; j++){ 22 int sampleCoord_x = std::min(std::max(0,x+i),width-1); 23 int sampleCoord_y = std::min(std::max(0,y+j),height-1); 24 25 Float3 curSampledColor = curFilteredColor(sampleCoord_x, sampleCoord_y); 26 mu+=curSampledColor; 27 mu2+=Sqr(curSampledColor); 28 } 29 } 30 mu /= sampleNum; 31 mu2 /= sampleNum; 32 sigma = SafeSqrt(mu2 - mu*mu); 33 34 color = Clamp(color, mu-sigma*m_colorBoxK, mu+sigma*m_colorBoxK); 35 } 36 37 // Exponential moving average 38 m_misc(x, y) = Lerp(color, curFilteredColor(x, y), alpha); 39 } 40 } 41 std::swap(m_misc, m_accColor); 42} 0x05 A-Torus Wavelet åŠ é€Ÿ A-Torus Waveletï¼Œå³è¿›è¡Œå¤šæ¬¡æ»¤æ³¢ï¼Œæ¯æ¬¡ä½¿ç”¨é€æ¸å¢åŠ çš„æ»¤æ³¢æ ¸å°ºå¯¸å’Œæ­¥é•¿ï¼Œä»¥ä¿è¯æ¯æ¬¡æ»¤æ³¢çš„é‡‡æ ·ç‚¹æ•°ä¸å˜ã€‚æ€»å…±è¿›è¡Œ 5 æ¬¡æ»¤æ³¢ï¼Œæ¯æ¬¡æ»¤æ³¢è¾“å…¥å›¾åƒä¸ºä¸Šä¸€æ¬¡æ»¤æ³¢ç»“æœï¼Œç¬¬ $i$ æ¬¡æ»¤æ³¢çš„æ­¥é•¿ä¸º $2^{i}$ï¼Œæ ¸å°ºå¯¸ä¸º $2^{i+2}+1$ ã€‚é€šè¿‡ A-Torus Wavelet çš„åŠ é€Ÿï¼Œå¯ä»¥å°†åŸæœ¬ $64^{2}$ çš„é‡‡æ ·æ•°å‡å°‘ä¸º $125$ï¼Œå¤§å¹…æå‡å•å¸§é™å™ªé€Ÿåº¦ã€‚\nåœ¨ Denoise ç±»ä¸­æ–°å¢ä¸€ä¸ª ATWFilter å‡½æ•°ï¼Œå®ç°ç”± A-Trous Wavelet åŠ é€Ÿçš„æ»¤æ³¢ï¼Œåœ¨åŸæœ¬çš„ä¸¤å±‚ for å¾ªç¯å¤–éƒ¨å†åµŒå¥—ä¸€å±‚ forï¼š\n1Buffer2D\u0026lt;Float3\u0026gt; Denoiser::ATWFilter(const FrameInfo \u0026amp;frameInfo) { 2 int height = frameInfo.m_beauty.m_height; 3 int width = frameInfo.m_beauty.m_width; 4 Buffer2D\u0026lt;Float3\u0026gt; filteredImage = CreateBuffer2D\u0026lt;Float3\u0026gt;(width, height); 5 int passes = 5; 6#pragma omp parallel for 7 // Accelerated by A-Trous Wavelet 8 for (int y = 0; y \u0026lt; height; y++) { 9 for (int x = 0; x \u0026lt; width; x++) { 10 // Joint bilateral filter 11 // get current pixel vals 12 Float3 color = frameInfo.m_beauty(x, y); 13 Float3 normal = frameInfo.m_normal(x, y); 14 Float3 pos = frameInfo.m_position(x, y); 15 16 float weight_sum = 0.f; 17 Float3 color_sum = Float3(0.f); 18 19 for(int pass = 0; pass \u0026lt; passes; pass++){ 20 int stride = pow(2, pass); 21 int kernelRadius = stride * 2; 22 for(int i = -kernelRadius; i \u0026lt;= kernelRadius; i+=stride){ 23 for(int j = -kernelRadius; j \u0026lt;= kernelRadius; j+=stride){ 24 // clamp coordinate 25 int sampleCoord_x = std::min(std::max(0,x+i),width-1); 26 int sampleCoord_y = std::min(std::max(0,y+j),height-1); 27 28 // sample sampled pixel vals 29 Float3 sampledColor = frameInfo.m_beauty(sampleCoord_x,sampleCoord_y); 30 Float3 sampledNormal = frameInfo.m_normal(sampleCoord_x,sampleCoord_y); 31 Float3 sampledPos = frameInfo.m_position(sampleCoord_x,sampleCoord_y); 32 33 // calculate weight 34 float weight = 0.0; 35 float d_coord2 = i*i+j*j; 36 37 float d_color2 = SqrDistance(color,sampledColor); 38 39 float cosTheta = Dot(normal,sampledNormal); 40 float d_normal2 = SafeAcos(cosTheta)*SafeAcos(cosTheta); 41 42 float d_plane = 0.f; 43 float d_pos = Distance(pos, sampledPos); 44 if (d_pos \u0026gt; 0) 45 d_plane = Dot(normal,Normalize(sampledPos-pos)); 46 float d_plane2 = d_plane*d_plane; 47 48 float w_coord = - d_coord2/(2*m_sigmaCoord*m_sigmaCoord); 49 float w_color = - d_color2/(2*m_sigmaColor*m_sigmaColor); 50 float w_normal = - d_normal2/(2*m_sigmaNormal*m_sigmaNormal); 51 float w_plane = - d_plane2/(2*m_sigmaPlane*m_sigmaPlane); 52 53 weight = exp(w_coord+w_color+w_normal+w_plane); 54 // accumulate weight and color buffer 55 weight_sum += weight; 56 color_sum += sampledColor * weight; 57 } 58 } 59 // protect 0 weight 60 if(weight_sum == 0.0f){ 61 filteredImage(x, y) = color; 62 } 63 else{ 64 filteredImage(x, y) = color_sum / weight_sum; 65 } 66 } 67 } 68 } 69 return filteredImage; 70} åŠ é€Ÿæ•ˆæœä¹Ÿæ˜¯ååˆ†æ˜æ˜¾çš„ï¼ŒATWFilter æ¯” Filter å‡ ä¹å¿«äº†ä¸¤åˆ†é’Ÿï¼Œä½†æ˜¯å°±å•å¸§é™å™ªè´¨é‡æ¥è¯´æ˜¯ä¸å¦‚ Filter çš„ã€‚\n0x06 Afterwords æ‰€ä»¥é—«å¤§çš„ç¦»çº¿æ¸²æŸ“è¯¾ä»€ä¹ˆæ—¶å€™å¼€ :p\n","permalink":"https://congyuxiaoyoudao.github.io/posts/assignments/games202-homework-5/","summary":"\u003cblockquote\u003e\n\u003cp\u003e202 ç³»åˆ—å®Œç»“æ’’èŠ± âœ¿âœ¿ãƒ½(Â°â–½Â°)ãƒâœ¿ï¼\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2 id=\"0x00-to-begin-with\"\u003e0x00 To begin with\u003c/h2\u003e\n\u003cp\u003eè¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e éƒ¨åˆ†è¯¾ç¨‹å†…å®¹å›é¡¾\u003c/li\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e GAMES202 ä½œä¸š 5\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eFor reference\u003c/strong\u003eğŸ‘‡ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eğŸ“ºB ç«™è§†é¢‘ï¼š\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://www.bilibili.com/video/BV1YK4y1T7yY/?spm_id_from=333.337.top_right_bar_window_custom_collection.content.click\u0026amp;vd_source=b6584cebba3a7a1a34d2f60d63bdc868\"\u003eGAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“¦ä»£ç ä»“åº“ï¼š\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://github.com/congyuxiaoyoudao/GAMES202_Homework/tree/working\"\u003econgyuxiaoyoudao/GAMES202_Homework at working\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003e\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://games-cn.org/forums/topic/zuoye5fabugonggao/\"\u003eä½œä¸š5å‘å¸ƒå…¬å‘ŠåŠåœºæ™¯ä¸‹è½½\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“–\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://zhuanlan.zhihu.com/p/607012514\"\u003eGAMES202-ä½œä¸š5ï¼šå®æ—¶å…‰çº¿è¿½è¸ªé™å™ª\u003c/a\u003e\n\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003emaster åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2 id=\"0x01-é—®é¢˜ä¿®å¤-troubleshooting\"\u003e0x01 é—®é¢˜ä¿®å¤ TroubleShooting\u003c/h2\u003e\n\u003cp\u003eåšä½œä¸šæ—¶é‡åˆ°ä¸€äº›å‡ºç°é—®é¢˜çš„åœ°æ–¹ï¼Œè¿™é‡Œä¸€å¹¶æä¸€ä¸‹ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eè¿è¡Œ build.bat å build ç›®å½•ä¸‹æ²¡æœ‰å‡ºç°å¯æ‰§è¡Œæ–‡ä»¶\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eReadFloatImage\u003c/code\u003e æ–¹æ³•æŠ¥é”™\u003c/li\u003e\n\u003cli\u003emathutil.h ä¸­ \u003ccode\u003euint32_t\u003c/code\u003e was not declared in this scope\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eç¬¬ä¸€ä¸ªé—®é¢˜çº¯å±å¯¹ Cmake ä¸ç†Ÿç»ƒï¼Œbuild.bat æä¾›çš„å‘½ä»¤åªæ˜¯ç”Ÿæˆå·¥ç¨‹æ–‡ä»¶ï¼Œè¦è¿è¡Œæ„å»ºè¿˜éœ€è¦å¦‚ä¸‹å‘½ä»¤ï¼ˆæˆ–è€…ç›´æ¥ç”¨ VS ç­‰ IDE è¿è¡Œï¼‰ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e1\u003c/span\u003e\u003cspan class=\"cl\"\u003ecmake --build build\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eè¿™é‡Œä¸ºäº†ç®€åŒ–è¿è¡Œæ“ä½œï¼Œæ–°å¢äº†ä¸€ä¸ª run.batï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e1\u003c/span\u003e\u003cspan class=\"cl\"\u003ecmake --build build\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e2\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e build\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e3\u003c/span\u003e\u003cspan class=\"cl\"\u003eDenoise.exe\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e4\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e ..\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eç¬¬äºŒä¸ªé—®é¢˜ä¸ºè·¯å¾„é”™è¯¯ï¼Œä¸‹è½½å®Œåœºæ™¯åæˆ‘çš„æ ¹ç›®å½•æ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š\u003c/p\u003e","title":"Assignment 8. GAMES202 Homework 5"},{"content":" å¥½ä¹…ä¸è§ï¼æœ€è¿‘åœ¨å¿™åˆ«çš„å·¥ä½œï¼Œè¿™å‡ å¤©éš¾å¾—æœ‰æ—¶é—´ï¼Œèµ¶ç´§æŠŠ 202 ç³»åˆ—ä½œä¸šåšä¸ªæ”¶å°¾ÎµÙ©(à¹‘\u0026gt; â‚ƒ \u0026lt;)Û¶Ğ·ï¼\n0x00 To begin with è¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\néƒ¨åˆ†è¯¾ç¨‹å†…å®¹å›é¡¾ GAMES202 ä½œä¸š 4 For referenceğŸ‘‡ï¼š\nğŸ“ºB ç«™è§†é¢‘ï¼š GAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“ ğŸ“¦ä»£ç ä»“åº“ï¼š congyuxiaoyoudao/GAMES202_Homework at working ğŸ“ƒ Revisiting Physically Based Shading at Imageworks master åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…\n0x01 è¯¾ç¨‹å›é¡¾ Recap èƒ½é‡å®ˆæ’çš„ BSDF Energy-Preserving BSDFs Cook-Torrance æå‡ºçš„å¾®è¡¨é¢ BRDF åªè€ƒè™‘å…‰çº¿åœ¨è¡¨é¢ç»è¿‡ä¸€æ¬¡å¼¹å°„åå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡ï¼Œç„¶è€Œå¿½ç•¥äº†å¤šæ¬¡å¼¹å°„æœ€ç»ˆå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡ï¼Œè¿™å°±é€ æˆäº†èƒ½é‡æŸå¤±ã€‚å°¤å…¶æ˜¯å½“æè´¨çš„ roughness è¾ƒé«˜æ—¶ï¼ŒG é¡¹å‡å°ï¼Œå¤šæ¬¡å¼¹å°„çš„æ¯”ä¾‹å¢åŠ ï¼Œèƒ½é‡æŸå¤±è¶Šä¸¥é‡ã€‚\n2017 å¹´ Kulla å’Œ Conty å—åˆ° Disney Principle BRDF çš„å¯å‘ï¼Œæå‡ºäº†ä¸€ç§æ”¹è¿›çš„æ–¹æ³•ï¼Œå³é€šè¿‡å¼•å…¥ä¸€ä¸ªèƒ½é‡è¡¥å¿é¡¹ï¼Œå°†å¤šæ¬¡å¼¹å°„å‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡è¡¥å……å›æ¥ï¼Œå°±èƒ½è¿‘ä¼¼åœ°ä¿æŒèƒ½é‡å®ˆæ’ã€‚\næœ‰äº†æ¸²æŸ“æ–¹ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°æ±‚å¾—å¾®è¡¨é¢ BRDF åœ¨è§‚å¯Ÿæ–¹å‘ $\\mu_{o}$ ä¸Šå‡ºå°„çš„æ€»èƒ½é‡ï¼š\n$$ E(\\mu_{o})=\\int_{0}^{2\\pi}\\int_{0}^{1}f(\\mu_{o},\\mu_{i},\\phi)\\mu_{i}d\\mu_{i}d\\phi $$ è¿™é‡Œè®° $\\mu_{i}=\\sin \\theta,\\theta=n\\cdot \\mu_{i}$ï¼Œä¹‹åå°±å¯ä»¥å°† $f_{r}\\cos \\theta \\sin \\theta d\\theta d\\phi$ å†™ä¸º $f_{r}\\mu_{i} d\\mu_{i}d\\phi$ã€‚ç„¶è€ŒåŸ PPT é‡Œæåˆ°çš„æ˜¯è®°ä¸º $\\cos \\theta$ï¼Œä¸è¿‡å°±ç§¯åˆ†ç»“æœæ¥è¯´éƒ½ä¸€æ ·\n$E(\\mu_{o})$ çš„èŒƒå›´ä¸º 0-1ï¼Œå¯¹äºä¸åŒçš„ $\\mu_{o}$ï¼Œ$E(\\mu_{o})$ çš„å€¼ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚å¾®è¡¨é¢ BRDF çš„ $E(\\mu_{o})$ ä¼šéšç€ roughness çš„å¢åŠ è€Œè¡°å‡ã€‚ä¸ºäº†å¼¥è¡¥è¿™éƒ¨åˆ†èƒ½é‡ï¼ŒKulla å’Œ Conty è®¾è®¡äº†ä¸€ä¸ªæ–°çš„ BRDF lobeï¼š\n$$ f_{ms}=\\frac{(1-E(\\mu_{o}))(1-E(\\mu_{i}))}{\\pi(1-E_{avg})},E_{avg}=2\\int_{0}^1E(\\mu)\\mu d\\mu $$ å…¶ä¸­ $f_{ms}$ ä¸ºå¼¥è¡¥æŸå¤±çš„ BRDFï¼Œ$E_{avg}$ ä¸ºåœ¨æ‰€æœ‰è§‚å¯Ÿæ–¹å‘ä¸‹å‡ºå°„èƒ½é‡çš„å¹³å‡å€¼ã€‚åŒæ ·è®¡ç®—è¿™ä¸ª BRDF åœ¨è§‚å¯Ÿæ–¹å‘ $\\mu_{o}$ ä¸Šçš„ç§¯åˆ†ï¼š\n$$ \\begin{aligned} E_{ms}(\\mu_{o})\u0026=\\int_{0}^{2\\pi}\\int_{0}^{1}f_{ms}(\\mu_{o},\\mu_{i},\\phi)\\mu_{i}d\\mu_{i}d\\phi \\\\ \u0026=2 \\int_{0}^1 \\frac{(1-E(\\mu_{o}))(1-E(\\mu_{i}))}{\\pi(1-E_{avg})}\\mu_{i}d\\mu_{i}\\\\ \u0026=2 \\frac{1-E(\\mu_{o})}{1-E_{avg}}\\int_{0}^1(1-E(\\mu_{i}))\\mu_{i}d\\mu_{i}\\\\ \u0026= \\frac{1-E(\\mu_{o})}{1-E_{avg}}(1-E_{avg})\\\\ \u0026= 1-E(\\mu_{o}) \\end{aligned} $$ å°†å…¶åŠ åˆ°åŸæ¥çš„å¾®è¡¨é¢ BRDF ä¸Šå³å¯å¼¥è¡¥æŸå¤±ï¼š\n$$ E(\\mu_{o})+E_{ms}(\\mu_{o})\\equiv 1 $$ è®¡ç®— $E(\\mu)$ å’Œ $E_{avg}$ éƒ½éœ€è¦ç§¯åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¦»çº¿ç«¯é¢„å…ˆè®¡ç®—å¥½è¿™ä¸¤é¡¹ï¼Œå°†å…¶æŒ‰éœ€è¦çš„å˜é‡æ‰“è¡¨ï¼Œå­˜å‚¨åœ¨çº¹ç†ä¸Šï¼Œç„¶åæ¸²æŸ“æ—¶å¯¹åº”æŸ¥è¯¢å³å¯ã€‚PPT ä¸­æŒ‡å‡º 32Ã—32 çš„å¤§å°çš„çº¹ç†å°±è¶³å¤Ÿäº†ï¼Œä½œä¸šä¸­åˆ™ä½¿ç”¨äº†æ›´å¤§çš„ 128Ã—128ã€‚\né¢œè‰²è¡¨é¢ Colored Surfaces åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œè¡¨é¢å°†æ‰€æœ‰å…¥å°„çš„å…‰å…¨éƒ¨åå°„ï¼Œå³å…‰çº¿ä¸å­˜åœ¨è¢«å¸æ”¶æˆ–è€…é€å°„çš„æƒ…å†µã€‚ç„¶è€Œï¼Œç»å¤§å¤šæ•°è¡¨é¢æ˜¯å¸¦æœ‰é¢œè‰²çš„ï¼Œå³å…¶ä¼šå¸æ”¶æŸç§æˆåˆ†çš„å…‰ï¼Œè¿™ç§æƒ…å†µä¸‹çš„èƒ½é‡æŸå¤±æ˜¯ç¬¦åˆç‰©ç†çš„ï¼Œå³ $E(\\mu)\u0026lt;1$ã€‚\nKulla å’Œ Conty å—åˆ° Jakob ç­‰äººçš„å¯å‘ï¼Œå¤šæ¬¡å¼¹å°„ä¸‹èƒ½é‡æ˜¯ diffuse çš„ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ä½™å¼¦åŠ æƒçš„ Fresnel é¡¹ä»£è¡¨å¹³å‡è¢«åå°„çš„èƒ½é‡ï¼š\n$$ F_{avg}=2\\int_{0}^1F(\\mu)\\mu d\\mu $$ æˆ‘ä»¬å·²ç»çŸ¥é“æ‰€æœ‰åå°„å‡ºå°„çš„èƒ½é‡æ¯”ä¾‹ä¸º $E_{avg}$ï¼Œé‚£ä¹ˆå› ä¸ºå¾®è¡¨é¢çš„é®æŒ¡è€Œæ²¡æœ‰å‡ºå°„çš„èƒ½é‡æ¯”ä¾‹åˆ™ä¸º $1-E_{avg}$ï¼Œè¿™éƒ¨åˆ†èƒ½é‡ï¼ˆå³å‘ç”Ÿäº†äºŒæ¬¡ bounceï¼‰ä¸­åˆæœ‰ $F_{avg}$ çš„æ¯”ä¾‹èƒ½å¤Ÿè¢«åå°„ï¼Œæ‰€ä»¥ç»è¿‡ $n$ æ¬¡åå°„å‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡å¯ä»¥å½’çº³ä¸ºï¼š\n$$ \\begin{aligned} E_{0}\u0026=F_{avg}E_{avg}\\\\ E_{1}\u0026=F_{avg}(1-E_{avg})F_{avg}E_{avg}\\\\ \\dots\\\\ E_{n}\u0026=F_{avg}^n (1-E_{avg})^n F_{avg}E_{avg} \\end{aligned} $$ å¾ˆæ˜¾ç„¶è¿™æ˜¯ä¸€ä¸ªç­‰æ¯”æ•°åˆ—ï¼Œå°†å…¶æ±‚å’Œåå³å¯å¾—åˆ°æ‰€æœ‰ç»è¿‡å¤šæ¬¡å¼¹å°„æœ€ç»ˆå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„æ€»èƒ½é‡ï¼š\n$$ E=F_{avg}E_{avg}\\sum_{k=0}^{\\infty}F_{avg}^k(1-E_{avg})^k=\\frac{F_{avg}E_{avg}}{1-F_{avg}(1-E_{avg})} $$ $E_{avg}$ å¯ä»¥é€šè¿‡é¢„è®¡ç®—å¾—åˆ°ï¼Œä½†æ˜¯ $F_{avg}$ æ— æ³•è¿™ä¹ˆåšã€‚æ‰€ä»¥ Kulla å’Œ Conty åˆ†åˆ«å¯¹ä»‹ç”µè´¨å’Œå¯¼ä½“åˆ—å‡ºäº†ä¸¤ç§å‰äººç”¨åˆ°çš„æ•°å€¼è¿‘ä¼¼æ–¹æ³•ï¼š\nå¦‚æ­¤ï¼Œåœ¨æ¸²æŸ“æ—¶å³å¯é‡‡æ · $E_{avg}$ å’Œæ ¹æ®è¡¨é¢æ€§è´¨è¿‘ä¼¼ $F_{avg}$ è®¡ç®—å‡ºé¢œè‰²è¡¨é¢çš„å‡ºå°„èƒ½é‡æ¯”ä¾‹ï¼Œç„¶åå†å°†å…¶ä¸ä¸ŠèŠ‚ä¸­æ²¡æœ‰èƒ½é‡å¸æ”¶çš„ $f_{ms}$ ç›¸ä¹˜å³å¯ã€‚\n0x02 é—®é¢˜ä¿®å¤ TroubleShooting åšä½œä¸šæ—¶é‡åˆ°ä¸€äº›å‡ºç°é—®é¢˜çš„åœ°æ–¹ï¼Œè¿™é‡Œä¸€å¹¶æä¸€ä¸‹ï¼š\næ‰¾ä¸åˆ° vec.h æœªå®šä¹‰æ ‡è¯†ç¬¦â€œM_PIâ€ uniform å˜é‡ uEavgFLut å‘½åé”™è¯¯ ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯é…ç½®é—®é¢˜ï¼Œç”¨ vscode åœ¨ task.json çš„ args å­—æ®µåŠ ä¸Šï¼š\n1 \u0026#34;-I\u0026#34;, 2\u0026#34;${workspaceFolder}/assignment4/lut-gen/ext\u0026#34;, ç¬¬äºŒä¸ªé—®é¢˜æŠŠæ‰€æœ‰ M_PI æ”¹æˆ PIã€‚\nç¬¬ä¸‰ä¸ªé—®é¢˜åœ¨ KullaContyMaterial.js ä¸­ï¼Œè°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°æ—¶ä¼ å…¥äº†å‘½åå’Œ Shader ä¸­ä¸å¯¹åº”çš„ uniform å˜é‡ï¼ŒæŠŠ uEavgFLut æ”¹æˆ uEavgLut å³å¯ã€‚\n0x03 é¢„ç§¯åˆ† $E(\\mu)$ è’™ç‰¹å¡æ´›æ±‚è§£ Monte Carlo åœ¨ Emu_MC.cpp çš„ IntegrateBRDF ä¸­å®Œæˆå¯¹ $E(\\mu)$ çš„ç§¯åˆ†ï¼Œä½¿ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•åœ¨åŠçƒä¸Šå‡åŒ€é‡‡æ ·å…¥å°„å…‰æ–¹å‘ï¼Œæ±‚è§£è¿™ä¸ªç§¯åˆ†ã€‚ç§¯åˆ†å†…éƒ¨ä¸º BRDF ä»¥åŠ cos é¡¹ï¼š\n$$ f_{r}(i,o)=\\frac{F(i,h)G(i,o,h)D(h)}{4(n\\cdot i)(n\\cdot o)},\\cos \\theta=n\\cdot i $$ Fï¼ŒGï¼ŒD çš„å®ç°æ¡†æ¶ä¸­å‡å·²ç»™å‡ºï¼ŒæŒ‰éœ€è°ƒç”¨å³å¯ã€‚\n1Vec3f IntegrateBRDF(Vec3f V, float roughness, float NdotV) { 2 float A = 0.0; 3 float B = 0.0; 4 float C = 0.0; 5 const int sample_count = 1024; 6 Vec3f N = Vec3f(0.0, 0.0, 1.0); 7 8 samplePoints sampleList = squareToCosineHemisphere(sample_count); 9 for (int i = 0; i \u0026lt; sample_count; i++) { 10 // calculate (fr * ni) / p_o here 11 Vec3f L = sampleList.directions[i]; 12 float pdf = sampleList.PDFs[i]; 13 14 float NdotL = dot(N,L); 15 Vec3f H = normalize(V+L); 16 17 // here we assume all lights are reflected, no absorption! 18 // deal with color later 19 float F = 1.0; 20 float NDF = DistributionGGX(N, H, roughness); 21 float G = GeometrySmith(roughness, NdotV, NdotL); 22 23 float nom = F * NDF * G; 24 float denom = std::max(4.0 * NdotL * NdotV,0.001); 25 float fr = nom / denom; 26 27 // accumulate each component 28 A = B = C +=fr*NdotL/pdf; 29 30 } 31 32 return {A / sample_count, B / sample_count, C / sample_count}; 33} è¿è¡Œç¨‹åºå³å¯å¾—åˆ°è¿™æ ·ä¸€å¼  LUTï¼š\nå¯ä»¥çœ‹åˆ°éšç€ç²—ç³™åº¦é™ä½ï¼ˆè‡ªä¸Šè€Œä¸‹ï¼‰ï¼Œå™ªå£°è¶Šæ¥è¶Šæ˜æ˜¾ã€‚è¿™æ˜¯å› ä¸ºä½ç²—ç³™åº¦çš„å¾®è¡¨é¢æ³•çº¿ $m$ é›†ä¸­åœ¨å®è§‚æ³•çº¿ $n$ é™„è¿‘ï¼Œä½†é€šè¿‡éšæœºé‡‡æ ·å…¥å°„å…‰æ–¹å‘ $i$ è®¡ç®—å¾—åˆ°çš„åŠç¨‹å‘é‡ $h$ åˆ™ä¸ç„¶ï¼Œå› æ­¤å¯¼è‡´ä½ç²—ç³™åº¦ä¸‹ç§¯åˆ†å€¼çš„æ–¹å·®æ˜¾è‘—å¢åŠ ã€‚ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹å¾®è¡¨é¢æ³•çº¿ $m$ è¿›è¡Œé‡è¦æ€§é‡‡æ ·æ¥æ”¹å–„è¿™ä¸ªé—®é¢˜ï¼Œå³ä½¿å¾—é‡‡æ ·çš„ $m$ æ›´å¤šåœ°ä½äº $n$ é™„è¿‘ã€‚\né‡è¦æ€§é‡‡æ ·æ±‚è§£ Importance Sampling æœ€ç»ˆçš„ä»»åŠ¡ä»ç„¶æ˜¯é‡‡æ · $i$ å’Œè®¡ç®— $\\frac{f_{r}(i,o,h)(i,n)}{pdf_{i}(i)}$ï¼Œä½†ç°åœ¨ $i$ å¹¶ä¸ç”±ç›´æ¥é‡‡æ ·å¾—åˆ°ï¼Œè€Œæ˜¯æ ¹æ®æŸä¸ªå¾®è¡¨é¢æ³•çº¿åˆ†å¸ƒæ¨¡å‹é‡è¦æ€§é‡‡æ ·å¾—åˆ°çš„å¾®è¡¨é¢æ³•å‘ $m$ é—´æ¥æ±‚è§£ã€‚\næ¡†æ¶ä¸­ä½¿ç”¨çš„ NDF ä¸º GGX åˆ†å¸ƒï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®è¯¥åˆ†å¸ƒç”Ÿæˆé‡‡æ ·çš„å¾®è¡¨é¢æ³•å‘ $m$ï¼Œå†ç”± $m$ å’Œ $o$ åæ±‚å…¥å°„æ–¹å‘ $i$ã€‚\nç”±å¾®è¡¨é¢æ³•çº¿åˆ†å¸ƒæ¨¡å‹çš„æ€§è´¨ï¼Œå¯ä»¥è®¡ç®—å‡ºé‡‡æ · $m$ çš„æ¦‚ç‡å¯†åº¦ï¼š\n$$ pdf_{m}(m)=D(m)(m\\cdot n) $$ é€šè¿‡è¯¥æ¦‚ç‡å¯†åº¦ï¼Œå¯ä»¥è®¡ç®—å‡ºè¯¥åˆ†å¸ƒä¸‹å¯¹åº”çš„é‡‡æ ·ç‚¹ï¼š\n$$ \\begin{aligned} \\theta_{m}\u0026=\\arctan\\left( \\frac{\\alpha \\sqrt{ \\xi_{1} }}{\\sqrt{ 1-\\xi_{1} }} \\right)\\\\ \\phi_{h}\u0026=2\\pi \\xi_{2} \\end{aligned} $$ å…¶ä¸­ï¼Œ$\\alpha=roughness^{2},\\xi_{1},\\xi_{2}\\in[0,1)$ã€‚\nåœ¨ Emu_IS.cpp çš„ ImportanceSampleGGX å‡½æ•°ä¸­ï¼Œå®Œæˆé‡è¦æ€§é‡‡æ ·çš„é€»è¾‘ï¼Œå¹¶è¿”å›åˆ‡çº¿ç©ºé—´çš„å¾®è¡¨é¢æ³•çº¿ $h$ã€‚\n1Vec3f ImportanceSampleGGX(Vec2f Xi, Vec3f N, float roughness) { 2 float a = roughness * roughness; 3 4 // in spherical space - Bonus 1 5 float Xi1 = Xi.x; 6 float Xi2 = Xi.y; 7 float theta = atan(a*sqrt(Xi1)/sqrt(1-Xi1)); 8 float phi = 2.0 * PI * Xi2; 9 10 // from spherical space to cartesian space - Bonus 1 11 float x = cos(phi)*sin(theta); 12 float y = sin(phi)*sin(theta); 13 float z = cos(theta); 14 15 // tangent coordinates - Bonus 1 16 Vec3f up = abs(N.z) \u0026lt; 0.999 ? Vec3f(0.0, 0.0, 1.0) : Vec3f(1.0, 0.0, 0.0); // N is fixed 001 so not select 001 17 Vec3f tangent = normalize(cross(up,N)); 18 Vec3f bitangent = cross(N,tangent); 19 20 // transform H to tangent space - Bonus 1 21 Vec3f H = normalize(tangent*x + bitangent*y + N*z); 22 return H; 23} æ¥ä¸‹æ¥è®¡ç®— $\\frac{f_{r}(i,o,h)(i,n)}{pdf_{i}(i)}$ çš„å€¼ï¼Œéœ€è¦å…ˆå°†é‡‡æ · $m$ çš„æ¦‚ç‡å¯†åº¦è½¬åŒ–ä¸ºé‡‡æ · $i$ çš„æ¦‚ç‡å¯†åº¦ï¼š\n$$ pdf_{i}(i)=pdf_{m}(m)\\left\\lvert \\left\\lvert \\frac{\\partial\\omega_{m}}{\\partial \\omega_{i}} \\right\\rvert \\right\\rvert =\\frac{D(m)(m\\cdot n)}{4(i\\cdot m)} $$ æ‰€ä»¥æœ€ç»ˆéœ€è¦ç´¯åŠ çš„æƒé‡ä¸ºï¼š\n$$ \\begin{aligned} weight(i)\u0026=\\frac{f_{r}(i,o,h)(i,n)}{pdf_{i}(i)} \\\\ \u0026=\\frac{F(i,m)G(i,o,m)D(m)}{4(n\\cdot i)(n\\cdot o)}\\cdot(n\\cdot i)\\cdot \\frac{4(i\\cdot m)}{D(m)(n\\cdot m)} \\\\ \u0026=\\frac{(o\\cdot m)G(i,o,h)}{(o\\cdot n)(m\\cdot n)} \\end{aligned} $$ è¿™é‡Œæš‚ä¸”è€ƒè™‘æ‰€æœ‰èƒ½é‡éƒ½è¢«åå°„ï¼Œå³ F ä¸º 1ï¼›æœ€åç•™åœ¨åˆ†å­ä¸Šçš„å®é™…ä¸Šæ˜¯ $i\\cdot m$ï¼Œä½†æ˜¯ $i\\cdot m=o\\cdot m$ï¼Œæ‰€ä»¥å¯ä»¥æ›¿æ¢\nåœ¨ Emu_IS.cpp çš„ IntegrateBRDF å‡½æ•°ä¸­æ¯æ¬¡é‡‡æ ·ç´¯åŠ è¯¥æƒé‡å³å¯ï¼š\n1Vec3f IntegrateBRDF(Vec3f V, float roughness) { 2 3 const int sample_count = 1024; 4 Vec3f N = Vec3f(0.0, 0.0, 1.0); 5 Vec3f Emu = Vec3f(0.0f); 6 for (int i = 0; i \u0026lt; sample_count; i++) { 7 Vec2f Xi = Hammersley(i, sample_count); 8 Vec3f H = ImportanceSampleGGX(Xi, N, roughness); 9 Vec3f L = normalize(H * 2.0f * dot(V, H) - V); 10 11 float NoL = std::max(L.z, 0.0f); 12 float NoH = std::max(H.z, 0.0f); 13 float VoH = std::max(dot(V, H), 0.0f); 14 float NoV = std::max(dot(N, V), 0.0f); 15 16 // calculate (fr * ni) / p_o here - Bonus 1 17 float w = VoH * GeometrySmith(roughness,NoV,NoL)/(NoV*NoH); 18 Emu += Vec3f(w); 19 // Split Sum - Bonus 2 20 } 21 22 return Emu / sample_count; 23} å®Œæˆé‡è¦æ€§é‡‡æ ·ä¹‹åå¾—åˆ°çš„ $E(\\mu)$ å°±æ²¡æœ‰å™ªç‚¹äº†ï¼š\n0x04 é¢„ç§¯åˆ† $E_{avg}$ é¢„ç§¯åˆ† $E_{avg}$ çš„è¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œç”šè‡³å› ä¸º $E(\\mu),\\mu$ éƒ½æ˜¯å®šå€¼ç›´æ¥è¿”å› $2E(\\mu)\\mu$ å³å¯ã€‚\n1Vec3f IntegrateEmu(Vec3f V, float roughness, float NdotV, Vec3f Ei) { 2 return Ei * NdotV * 2.0f; 3 Vec3f Eavg = Vec3f(0.0f); 4 const int sample_count = 1024; 5 Vec3f N = Vec3f(0.0, 0.0, 1.0); 6 7 for (int i = 0; i \u0026lt; sample_count; i++) 8 { 9 Vec2f Xi = Hammersley(i, sample_count); 10 Vec3f H = ImportanceSampleGGX(Xi, N, roughness); 11 Vec3f L = normalize(H * 2.0f * dot(V, H) - V); 12 13 float NoL = std::max(L.z, 0.0f); 14 float NoH = std::max(H.z, 0.0f); 15 float VoH = std::max(dot(V, H), 0.0f); 16 float NoV = std::max(dot(N, V), 0.0f); 17 18 // calculate Eavg here - Bonus 1 19 Eavg += Ei * NoV * 2.0f; 20 } 21 22 return Eavg / sample_count; 23} æ±‚è§£ $E_{avg}$ çš„è¿‡ç¨‹ä»…ä¾èµ–äºé‡‡æ ·åˆ°çš„ $E(\\mu)$ ï¼Œæ‰€ä»¥ Eavg_IS.cpp å’Œ E_avg_MC.cpp çš„å®ç°æ˜¯ä¸€æ ·çš„ã€‚\nè¿è¡Œç¨‹åºå¯ä»¥å¾—åˆ°è¿™æ ·ä¸€å¼  LUTï¼š\nå¦‚æœæ­£ç¡®å®ç°äº† $E(\\mu)$ çš„é‡è¦æ€§é‡‡æ ·ï¼Œä¸Šå›¾å°±ä¼šå˜å¾— Smooth ä¸€ç‚¹ï¼š\n0x05 å®æ—¶æ¸²æŸ“ Realtime Rendering PBR æè´¨çš„å®ç°å°±ä¸è´´äº†ï¼Œå…¬å¼å·²ç»ç»™å‡ºäº†ï¼Œå¯ä»¥ç›´æ¥æ¬ç¦»çº¿ç«¯çš„å®ç°\nåœ¨å®æ—¶ç«¯éœ€è¦é‡‡æ ·é¢„ç§¯åˆ†çš„ $E(\\mu)$ å’Œ $E_{avg}$ çš„ LUTï¼Œç„¶åä»ç„¶æ˜¯å¥—å…¬å¼è®¡ç®—èƒ½é‡å®ˆæ’çš„ BRDFï¼š\n$$ f_{r}=f_{micro}+f_{add}*f_{ms} $$ åœ¨ MultiScatterBRDF å‡½æ•°ä¸­ï¼Œéœ€è¦å®Œæˆå¯¹ $f_{add},f_{ms}$ çš„è®¡ç®—ï¼š\n$$ \\begin{aligned} f_{add}\u0026=\\frac{F_{avg}E_{avg}}{1-F_{avg}(1-E_{avg})}\\\\ f_{ms}(\\mu_{o},\\mu_{i})\u0026=\\frac{(1-E(\\mu_{o}))(1-E(\\mu_{i}))}{\\pi(1-E_{avg})} \\end{aligned} $$ 1vec3 MultiScatterBRDF(float NdotL, float NdotV) 2{ 3 vec3 albedo = pow(texture2D(uAlbedoMap, vTextureCoord).rgb, vec3(2.2)); 4 5 vec3 E_o = texture2D(uBRDFLut, vec2(NdotL, uRoughness)).xxx; 6 vec3 E_i = texture2D(uBRDFLut, vec2(NdotV, uRoughness)).xxx; 7 8 vec3 E_avg = texture2D(uEavgLut, vec2(0, uRoughness)).xxx; 9 // copper 10 vec3 edgetint = vec3(0.827, 0.792, 0.678); 11 vec3 F_avg = AverageFresnel(albedo, edgetint); 12 13 // calculate fms and missing energy here 14 vec3 f_add = F_avg * E_avg / (1.0 - F_avg * (1.0 - E_avg)); 15 vec3 f_ms = (1.0 - E_o) * (1.0 - E_i) / (PI * (1.0 - E_avg)); 16 return f_add*f_ms; 17 18} å®Œæˆåå³å¯è¾¾åˆ°å¦‚å›¾æ‰€ç¤ºçš„æ•ˆæœï¼š\n0x06 Split Sum ä»ç„¶æ˜¯è®¡ç®— $E(\\mu)$ï¼Œç»“æœä¿å­˜åˆ°ä¸€å¼ ä¸ roughness å’Œæ›²ç‡ç›¸å…³çš„ LUT ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ F é¡¹ä» BRDF ä¸­åˆ†ç¦»å‡ºæ¥ï¼ˆè¿™ä¸ªæ€è·¯åœ¨ Lecture5 Real-time Environment Mapping 1h 15min å·¦å³æœ‰æåŠï¼‰ï¼š\n$$ \\begin{aligned} E\u0026=\\int_{\\Omega^+}f_{r}(n\\cdot i) d\\omega_{i} \\\\ \u0026=\\int_{\\Omega^+} \\frac{f_{r}}{F}(n\\cdot i) Fd\\omega_{i}\\\\ \u0026=\\int_{\\Omega^+} \\frac{f_{r}}{F}(n\\cdot i) (F_{0}+(1-F_{0})(1-\\cos \\theta)^5)d\\omega_{i}\\\\ \u0026=\\int_{\\Omega^+} \\frac{f_{r}}{F}(n\\cdot i) (F_{0}+(1-F_{0})\\alpha)d\\omega_{i}\\\\ \u0026=\\int_{\\Omega^+} \\frac{f_{r}}{F}(n\\cdot i) (F_{0}(1-\\alpha)+\\alpha)d\\omega_{i}\\\\ \u0026=F_{0}\\int_{\\Omega^+} \\frac{f_{r}}{F}(n\\cdot i) (1-\\alpha)d\\omega_{i}+\\int_{\\Omega^+} \\frac{f_{r}}{F}(n\\cdot i) \\alpha d\\omega_{i} \\end{aligned} $$ è®° $\\alpha=(1-\\cos \\theta)^5$\næ›´æ”¹ä¸€ä¸‹ IntegrateBRDFï¼Œå°†è¿™ä¸¤ä¸ª Split çš„ç»“æœåˆ†åˆ«å­˜å…¥ LUT çš„ GB é€šé“ï¼ŒR é€šé“ä»ç„¶å­˜åŸæ¥çš„ $E(\\mu)$ï¼š\nç„¶ååœ¨å®æ—¶ç«¯é‡è½½ä¸€ä¸ª MultiScatterBRDFï¼Œå¢åŠ ä¸€ä¸ª F0 ä½œä¸ºå‚æ•°ï¼Œç”¨ä¸¤ä¸ª Split çš„ç§¯åˆ†è¿˜åŸ $E(\\mu),E_{avg}$ï¼š\nè°ƒç”¨è¿™ä¸ªæ–°çš„å‡½æ•°å¹¶ä¼ å…¥ F0 å³å¯çœ‹åˆ°ä½¿ç”¨ Split Sum è®¡ç®—å‡ºæ¥çš„ç»“æœï¼š\n","permalink":"https://congyuxiaoyoudao.github.io/posts/assignments/games202-homework-4/","summary":"\u003cblockquote\u003e\n\u003cp\u003eå¥½ä¹…ä¸è§ï¼æœ€è¿‘åœ¨å¿™åˆ«çš„å·¥ä½œï¼Œè¿™å‡ å¤©éš¾å¾—æœ‰æ—¶é—´ï¼Œèµ¶ç´§æŠŠ 202 ç³»åˆ—ä½œä¸šåšä¸ªæ”¶å°¾ÎµÙ©(à¹‘\u0026gt; â‚ƒ \u0026lt;)Û¶Ğ·ï¼\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2 id=\"0x00-to-begin-with\"\u003e0x00 To begin with\u003c/h2\u003e\n\u003cp\u003eè¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e éƒ¨åˆ†è¯¾ç¨‹å†…å®¹å›é¡¾\u003c/li\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e GAMES202 ä½œä¸š 4\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eFor reference\u003c/strong\u003eğŸ‘‡ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eğŸ“ºB ç«™è§†é¢‘ï¼š\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://www.bilibili.com/video/BV1YK4y1T7yY/?spm_id_from=333.337.top_right_bar_window_custom_collection.content.click\u0026amp;vd_source=b6584cebba3a7a1a34d2f60d63bdc868\"\u003eGAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“¦ä»£ç ä»“åº“ï¼š\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://github.com/congyuxiaoyoudao/GAMES202_Homework/tree/working\"\u003econgyuxiaoyoudao/GAMES202_Homework at working\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“ƒ \n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://blog.selfshadow.com/publications/s2017-shading-course/imageworks/s2017_pbs_imageworks_slides_v2.pdf\"\u003eRevisiting Physically Based Shading at Imageworks\u003c/a\u003e\n\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003emaster åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2 id=\"0x01-è¯¾ç¨‹å›é¡¾-recap\"\u003e0x01 è¯¾ç¨‹å›é¡¾ Recap\u003c/h2\u003e\n\u003ch3 id=\"èƒ½é‡å®ˆæ’çš„-bsdf-energy-preserving-bsdfs\"\u003eèƒ½é‡å®ˆæ’çš„ BSDF Energy-Preserving BSDFs\u003c/h3\u003e\n\u003cp\u003eCook-Torrance æå‡ºçš„å¾®è¡¨é¢ BRDF åªè€ƒè™‘å…‰çº¿åœ¨è¡¨é¢ç»è¿‡ä¸€æ¬¡å¼¹å°„åå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡ï¼Œç„¶è€Œå¿½ç•¥äº†å¤šæ¬¡å¼¹å°„æœ€ç»ˆå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡ï¼Œè¿™å°±é€ æˆäº†èƒ½é‡æŸå¤±ã€‚å°¤å…¶æ˜¯å½“æè´¨çš„ roughness è¾ƒé«˜æ—¶ï¼ŒG é¡¹å‡å°ï¼Œå¤šæ¬¡å¼¹å°„çš„æ¯”ä¾‹å¢åŠ ï¼Œèƒ½é‡æŸå¤±è¶Šä¸¥é‡ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"Missing Energy of Microfacet BRDF, Revisiting Physically Based Shading at Imageworks, SIGGRAPH 2017\" loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506151740381.png#center\"\u003e\u003c/p\u003e\n\u003cp\u003e2017 å¹´ Kulla å’Œ Conty å—åˆ° Disney Principle BRDF çš„å¯å‘ï¼Œæå‡ºäº†ä¸€ç§æ”¹è¿›çš„æ–¹æ³•ï¼Œå³é€šè¿‡å¼•å…¥ä¸€ä¸ªèƒ½é‡è¡¥å¿é¡¹ï¼Œå°†å¤šæ¬¡å¼¹å°„å‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡è¡¥å……å›æ¥ï¼Œå°±èƒ½è¿‘ä¼¼åœ°ä¿æŒèƒ½é‡å®ˆæ’ã€‚\u003c/p\u003e","title":"Assignment 7. GAMES202 Homework 4"},{"content":" HiZ è¿˜åœ¨æ–½å·¥ä¸­â€¦â€¦\n0x00 To begin with è¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\néƒ¨åˆ†è¯¾ç¨‹å†…å®¹å›é¡¾ GAMES202 ä½œä¸š 3 For referenceğŸ‘‡ï¼š\nğŸ“ºB ç«™è§†é¢‘ï¼š GAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“ ğŸ“¦ä»£ç ä»“åº“ï¼š congyuxiaoyoudao/GAMES202_Homework at working master åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…\n0x01 è¯¾ç¨‹å›é¡¾ Recap SSRï¼ˆScreen Space Reflectionï¼‰æ˜¯ä¸€ç§åŸºäºå±å¹•ç©ºé—´çš„åå°„ç®—æ³•ï¼Œä¹Ÿè¢«åº”ç”¨äºæ¨¡æ‹Ÿå…¨å±€å…‰ç…§ã€‚å› ä¸ºæ˜¯å±å¹•ç©ºé—´çš„ç®—æ³•ï¼Œä¸èƒ½ä¸”æ— éœ€åƒä¼ ç»Ÿå…¨å±€å…‰ç…§ç®—æ³•é‚£æ ·éœ€è¦è·å–åœºæ™¯çš„åŸå§‹å‡ ä½•ä¿¡æ¯ï¼Œè€Œæ˜¯åªåœ¨å½“å‰ç›¸æœºçš„è§†é‡èŒƒå›´è®¡ç®—åå°„ï¼Œæ‰€ä»¥æ•ˆç‡ç›¸å¯¹è¾ƒé«˜ï¼Œä½†ä¹Ÿå­˜åœ¨ä¸€äº›å±å¹•ç©ºé—´çš„ Artifactsã€‚\nSSR ç®—æ³•æœ‰ä¸¤ä¸ªå‡è®¾ï¼š\nå±å¹•èŒƒå›´å†…çš„åå°„å…‰ï¼Œå…¶åå°„æºä¹ŸåŒæ ·æ¥è‡ªå±å¹•ç©ºé—´çš„æŸä¸ªåƒç´ ï¼› æ‰€æœ‰è¢«ç›´æ¥å…‰ç…§äº®çš„ç‰©ä½“ï¼ˆåœ¨å±å¹•ç©ºé—´ä¸­åˆ™è¡¨ç°ä¸ºåƒç´ ï¼‰ï¼Œéƒ½å¯ä»¥ä½œä¸ºæ¬¡çº§å…‰æºå‚ä¸å¯¹åå°„çš„è´¡çŒ®ï¼› SSR å¯¹åå°„è¡¨é¢æ²¡æœ‰è¦æ±‚ï¼Œå³ä¸ä»…èƒ½æ¨¡æ‹Ÿé•œé¢åå°„ï¼Œè¿˜å¯ä»¥æ¨¡æ‹Ÿå„ç§ç²—ç³™åº¦çš„åå°„\nSSR ç®—æ³•çš„æ­¥éª¤å¦‚ä¸‹ï¼š\nå¯¹æ¯ä¸ªéœ€è¦è®¡ç®—åå°„çš„åƒç´ æ²¿åå°„æ–¹å‘å‘å°„ä¸€æ¡å…‰çº¿ï¼› æ²¿å…‰çº¿æ–¹å‘æ­¥è¿›åœ¨å±å¹•ç©ºé—´ä¸­æŸ¥æ‰¾æ·±åº¦ç¼“å†²å¹¶ä¸åœºæ™¯æ±‚äº¤ï¼› è‹¥æœ‰äº¤ç‚¹ï¼Œåˆ™å°†äº¤ç‚¹é¢œè‰²ä½œä¸ºåå°„é¢œè‰²æ·»åŠ åˆ°åŸå§‹åƒç´ ä¸Šï¼› å…¶ä¸­æœ€å…³é”®çš„æ­¥éª¤å°±æ˜¯å…‰çº¿æ±‚äº¤ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ Linear RayMarchingï¼Œå…‰çº¿æ¯æ¬¡è¡Œè¿›ä¸€ä¸ªå›ºå®šçš„è·ç¦»ï¼Œæ¯æ¬¡è¡Œè¿›åè·å–è¯¥ä½ç½®çš„æ·±åº¦å€¼å†ä¸åœºæ™¯æ·±åº¦è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœæŸæ¬¡åˆ¤æ–­å…‰çº¿æ·±åº¦å¤§äºåœºæ™¯æ·±åº¦ï¼Œåˆ™è®¤ä¸ºå‘ç”Ÿäº†ç›¸äº¤ã€‚\nå½“ç„¶è¿™ç§æ–¹æ³•çš„ç²¾ç»†åº¦å¾ˆä¾èµ–å…‰çº¿æ­¥é•¿ï¼Œå°çš„æ­¥é•¿æ•ˆæœæ›´å¥½ä½†æ¶ˆè€—å¤§ï¼Œåä¹‹ï¼Œæ›´å¤§çš„æ­¥é•¿åˆ™å¯èƒ½å¯¼è‡´å…‰çº¿â€œç©¿è¿‡â€åœºæ™¯è€Œè¯¯åˆ¤ç›¸äº¤ï¼Œé€ æˆé”™è¯¯è®¡ç®—åå°„çš„æƒ…å†µã€‚\nä¸ºäº†åœ¨æé«˜ç²¾åº¦çš„åŒæ—¶èŠ‚çœå¼€é”€ï¼Œç ”ç©¶äººå‘˜åˆæå‡ºäº†ä¸€ç§åŠ¨æ€æ­¥é•¿çš„æ–¹æ³•ï¼Œå³ Hierarchical ray traceã€‚å…è®¸å…‰çº¿æ ¹æ®åœºæ™¯ä¿¡æ¯åœ¨è¡Œè¿›æœŸé—´é€‰å–ä¸åŒçš„æ­¥é•¿ï¼Œä¾‹å›¾ä¸­å…‰çº¿ä¸€å¼€å§‹è‡³å°‘å¯ä»¥ä»¥ 7 å€çš„ gap ä½œä¸ºæ­¥é•¿ï¼Œä¹‹åå†ç¼©å‡åˆ°åŸå§‹çš„æ­¥é•¿ã€‚\nè¯´åˆ°å®æ—¶æ¸²æŸ“ä¸­çš„ä¸€äº›åŠ¨æ€æ“ä½œï¼Œå‡ ä¹å°±ç¦»ä¸å¼€é¢„å¤„ç†ã€‚åŒæ ·çš„ï¼Œè¿™ç§æ–¹æ³•è¿è¡Œçš„å‰ææ˜¯ï¼Œå…‰çº¿éœ€è¦çŸ¥é“è¡Œè¿›çš„â€œæœ€å¤§å®‰å…¨è·ç¦»â€ï¼Œå³å¯ä»¥è¿ˆå¤šå¤§çš„æ­¥å­è€Œä¸ä¸åœºæ™¯å‘ç”Ÿç›¸äº¤ã€‚\nè¿™é‡Œæœ€å¤§å®‰å…¨è·ç¦»æ˜¯ç±»æ¯” SDF çš„è¯´æ³•ï¼Œæˆ–è€…åº”è¯¥è¯´å½“å‰å±‚çº§è§„å®šçš„æ­¥é•¿\nä¸€ç§å®ç°å®ƒçš„æ–¹æ³•æ˜¯é¢„å…ˆç”Ÿæˆæ·±åº¦å›¾çš„ Mip-Mapï¼Œè¿™é‡Œå››ä¸ªåƒç´ çš„æœ€å°å€¼ä½œä¸º Mip ç”Ÿæˆçš„é€»è¾‘ï¼Œå…·ä½“åŸå› æ¶‰åŠåˆ°æ¯”è¾ƒçš„ä¿å·æ€§ï¼šå¦‚æœå…‰çº¿ä¸ä¸Šä¸€çº§ Mip éƒ½ä¸ç›¸äº¤ï¼ˆ$D_{ray}\u0026lt;D_{M_{i+1}}$ï¼‰ï¼Œåˆ™å…¶ä¸€å®šä¸ä¸‹çº§ä¸ç›¸äº¤ï¼ˆ$D_{ray}\u0026lt;any_{4}{D_{M_{i}}}$ ï¼‰ã€‚\næ‹¿åˆ°è¿™äº› Mip ä¹‹åå°±å¯ä»¥å¯¹ RayMarching ç®—æ³•è¿›è¡Œæ”¹è‰¯ï¼šä¸€å¼€å§‹ä»ç„¶ä»¥ä¸€ä¸ªæ¯”è¾ƒå°çš„æ­¥é•¿ï¼Œå¦‚æœè¡Œè¿›åæ²¡æœ‰äº¤ç‚¹ï¼Œåˆ™ä¸‹æ¬¡æ­¥è¿›åˆ™åœ¨ä¸Šä¸€ä¸ªå±‚çº§è¿›è¡Œï¼ˆå¢åŠ æ­¥é•¿ï¼‰ï¼›åä¹‹è‹¥æœ‰äº¤ç‚¹ï¼Œåˆ™ä¸èµ°è¿™æ­¥ï¼Œå›åˆ°ä¸‹ä¸€ä¸ªå±‚çº§ï¼ˆå›é€€æ­¥é•¿ï¼‰å†æ¬¡å°è¯•æ­¥è¿›ã€‚\nè¿™é‡Œå±‚çº§çš„ä¸Šä¸‹æ˜¯åŸºäºå›¾åƒé‡‘å­—å¡”çš„ä½ç½®å…³ç³»ï¼Œä¸Šé¢çš„å±‚çº§ä¿¡æ¯æ›´ç²—ç³™ï¼Œä¸‹é¢çš„å±‚çº§ä¿¡æ¯æ›´ç²¾ç»†\nè¿™ç§å±‚çº§æ–¹æ³•å«åš HiZï¼ˆHierarchical Z-bufferï¼‰ï¼Œèƒ½å¤Ÿæ˜¾è‘—å‡å°‘ RayMarching çš„è¿­ä»£æ¬¡æ•°ã€‚\n0x02 ç›´æ¥å…‰ç…§ Direct Lighting ç›´æ¥å…‰ç…§æ€»æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œè€Œä¸”ä¹‹å‰çš„ä¸¤ä¸ª Pass å·²ç»å¸®æˆ‘ä»¬æŠŠæ¼«åå°„ã€ä¸–ç•Œç©ºé—´æ³•çº¿å’Œå¯è§æ€§ä¿¡æ¯ï¼ˆå…¶å®å°±æ˜¯ ShadowMapï¼‰å†™å…¥äº† GBufferï¼Œç›´æ¥æ ¹æ®å±å¹• UV é‡‡æ ·å°±èƒ½è·å–å¯¹åº”ä¿¡æ¯ã€‚å…·ä½“è€Œè¨€è¦å®Œå–„ä¸¤ä¸ªå‡½æ•°ï¼šEvalDiffuse å’Œ EvalDirectionalLightã€‚\nEvalDiffuse å‡½æ•°è¿”å›æ¼«åå°„ BSDF çš„å€¼ï¼Œæ³¨æ„è¦æŠŠ cos é¡¹ç®—è¿›å»ï¼š\n1vec3 EvalDiffuse(vec3 wi, vec3 wo, vec2 uv) { 2 vec3 L = vec3(0.0); 3 4 vec3 rho = GetGBufferDiffuse(uv); 5 vec3 normalWS = GetGBufferNormalWorld(uv); 6 7 float cosTheta = max(dot(normalWS, wi), 0.0); 8 L = rho * INV_PI * cosTheta; 9 10 return L; 11} EvalDirectionalLight è¿”å› Shading Point è·å¾—çš„ Light çš„ Radienceï¼Œè¿™é‡Œè€ƒè™‘é˜´å½±ï¼Œä» ShadowMap ä¸­è·å–å¯è§æ€§å…³ç³»ï¼Œç„¶åç›´æ¥å’Œ uLightRadience ç›¸ä¹˜å³å¯ã€‚\n1vec3 EvalDirectionalLight(vec2 uv) { 2 vec3 Le = vec3(0.0); 3 4 float visibility = GetGBufferuShadow(uv); 5 Le = uLightRadiance * visibility; 6 7 return Le; 8} ç„¶ååœ¨ main å‡½æ•°æ›´æ–°ä¸€ä¸‹ L çš„è®¡ç®—é€»è¾‘ï¼š\n0x03 å±å¹•ç©ºé—´å…‰çº¿è¿½è¸ª SSR RayMarch å‡½æ•°ç”¨æ¥åˆ¤æ–­é‡‡æ ·çš„å…‰çº¿æ˜¯å¦ä¸åœºæ™¯ç›¸äº¤ï¼Œç›¸äº¤æ—¶å°†å‚æ•° hitPos è®¾ç½®ä¸ºäº¤ç‚¹ï¼Œå¹¶è¿”å› trueã€‚å‚æ•° ori å’Œ dir åˆ†åˆ«ä¸ºä¸–ç•Œåæ ‡ä¸‹å…‰çº¿çš„èµ·ç‚¹ä½ç½®å’Œå•ä½æ–¹å‘å‘é‡ã€‚\nå…·ä½“æ€è·¯æ˜¯ï¼šå¯¹äºä¸€æ¡ç»™å®šçš„å°„çº¿ï¼Œè®°å½•å®ƒçš„èµ·ç‚¹å’Œæ–¹å‘ï¼Œæ¯æ¬¡è¿­ä»£æ—¶åˆ¤æ–­å½“å‰å°„çº¿çš„èµ·ç‚¹å¤„çš„æ·±åº¦ä¸ GBuffer ä¸­è®°å½•çš„æ·±åº¦çš„å¤§å°ï¼Œå¦‚æœå…¶ç›¸å‡å¤§äºé¢„å…ˆè®¾å®šçš„é˜ˆå€¼ï¼Œåˆ™è®¤ä¸ºå…‰çº¿åœ¨è¯¥å¤„ç›¸äº¤ï¼›åä¹‹åˆ™ç»§ç»­å‘å…‰çº¿æ–¹å‘å‰è¿›ä¸€æ®µè·ç¦»ã€‚åˆ°è¾¾æœ€å¤§è¿­ä»£æ¬¡æ•°æˆ–æ‰¾åˆ°äº¤ç‚¹æ—¶ï¼Œç®—æ³•ç»ˆæ­¢ã€‚\n1#define MAX_ITERATION 100 2#define INTERSECTION_THRESH 1e-5 3#define RAY_STEP 0.02 4 5bool RayMarch(vec3 ori, vec3 dir, out vec3 hitPos) { 6 vec3 curPos = ori; 7 vec3 rayStride = normalize(dir) * RAY_STEP; 8 9 for(int i = 0; i \u0026lt; MAX_ITERATION; i++){ 10 // get GBuffer infos 11 vec2 screenUV = GetScreenCoordinate(curPos); 12 float rayDepth = GetDepth(curPos); 13 float sceneDepth = GetGBufferDepth(screenUV); 14 15 // test intersection 16 if(rayDepth - sceneDepth \u0026gt;= INTERSECTION_THRESH){ 17 hitPos = curPos; 18 return true; 19 } 20 curPos += rayStride; 21 } 22 return false; 23} è¿™é‡Œçš„å‚æ•°éœ€è¦è°ƒæ•´è‡³åˆé€‚å€¼ï¼Œå°¤å…¶æ˜¯æ­¥é•¿å’Œé˜ˆå€¼\nå¯ä»¥å†™ä¸€ä¸ªå‡½æ•°ï¼Œå‡è®¾è¡¨é¢æ˜¯ç»å¯¹é•œé¢ï¼Œæ£€æŸ¥ä¸€ä¸‹ SSR çš„å®ç°ï¼Œç›´æ¥è¿”å›äº¤ç‚¹çš„æ¼«åå°„é¢œè‰²ä½œä¸º SSR çš„ç»“æœï¼š\n1vec3 EvalSSR(vec3 wi, vec3 wo, vec2 uv) { 2 vec3 L = vec3(0.0); 3 4 vec3 posWS = vPosWorld.xyz; 5 vec3 normalWS = GetGBufferNormalWorld(uv); 6 vec3 reflectDir = normalize(reflect(-wo, normalWS)); 7 vec3 hitPos = vec3(0.0); 8 9 if(RayMarch(posWS, reflectDir, hitPos)){ 10 vec2 screenReflectUV = GetScreenCoordinate(hitPos); 11 L = GetGBufferDiffuse(screenReflectUV); 12 } 13 14 return L; 15} main å‡½æ•°ä¸­å†å°†è¿™ä¸ªé•œåå°„çš„è´¡çŒ®åŠ ä¸Šï¼Œæœ€ç»ˆçš„æ•ˆæœåº”è¯¥æ˜¯è¿™æ ·çš„ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯æ­£ç¡®åå°„äº†åœ°é¢çš„é¢œè‰²ï¼š\n0x04 é—´æ¥å…‰ç…§æ˜ Indirect Lighting è¿™å—çš„é€»è¾‘ä¼ªä»£ç ä¹Ÿç»™å¾—å¾ˆæ¸…æ¥šäº†ï¼Œè¦æ³¨æ„çš„æœ‰ä¸¤ä¸ªç‚¹ï¼š\nä¸¤ä¸ªé‡‡æ ·å‡½æ•°è¿”å›çš„å‘é‡ä½äºå±€éƒ¨/çƒé¢/åˆ‡çº¿åæ ‡ç³»ä¸‹ï¼Œéœ€è¦å˜æ¢åˆ°ä¸–ç•Œåæ ‡ï¼› æ‰€æœ‰ RayMarching æ‰¾åˆ°çš„äº¤ç‚¹éƒ½è§†ä¸ºæ¬¡çº§å…‰æºï¼Œæ¬¡çº§å…‰æºçš„ wi ä¸ºç›´æ¥å…‰æ–¹å‘ï¼ˆå› ä¸ºæ˜¯ Directionnal Lightï¼‰ï¼Œwo ä¸ºæŠ•å°„å…‰çº¿çš„é€†ï¼ˆç›¸å½“æ¬¡çº§å…‰ç…§ï¼‰ï¼› å¯¹äº 1ï¼Œæ¡†æ¶ä¸­ç»™å‡ºäº† LocalBasis ç”¨äºè®¡ç®—å±€éƒ¨ç©ºé—´ä¸­çš„åŸºå‘é‡ï¼Œç»™å®šæ³•çº¿ nï¼Œå³å¯æ„é€ å‡ºå±€éƒ¨ç©ºé—´åˆ°ä¸–ç•Œç©ºé—´çš„å˜æ¢çŸ©é˜µ TBNï¼›è‡³äº 2ï¼Œå¯¹æ¬¡çº§å…‰æºè°ƒç”¨ EvalDiffuse æ—¶åˆ†åˆ«å¯¹åº”è®¾ç½®å…¶ wi å’Œ wo å³å¯ã€‚\n1vec3 EvalIndirectLight(vec3 wi, vec3 wo, vec2 uv, float s) { 2 vec3 Li,L = vec3(0.0); 3 4 // load TBN matrix 5 vec3 n = GetGBufferNormalWorld(uv); 6 vec3 t, b; 7 LocalBasis(n, t, b); 8 mat3 TBN = mat3(t,b,n); 9 10 float pdf = 0.0; 11 vec3 ori = vPosWorld.xyz; 12 vec3 hitPos = vec3(0.0); 13 vec2 screenIndirectUV = vec2(0.0); 14 15 for(int i=0; i\u0026lt;SAMPLE_NUM; i++){ 16 // transform from tangent space to world space 17 // this ray cast from pos0 to pos1 18 // pos1 also serve as a light source 19 vec3 rayDir = normalize(TBN * SampleHemisphereCos(s,pdf)); 20 21 if(RayMarch(ori,rayDir,hitPos)){ 22 screenIndirectUV = GetScreenCoordinate(hitPos); 23 // light is directional hence for each shading point uses the same wi for lightDir 24 L = EvalDiffuse(rayDir,wo,uv)/pdf * EvalDiffuse(wi,-rayDir,screenIndirectUV) * EvalDirectionalLight(screenIndirectUV); 25 Li += L; 26 } 27 28 } 29 30 Li /= float(SAMPLE_NUM); 31 return Li; 32} ä¸€åˆ‡æ­£å¸¸çš„è¯å¯ä»¥æ¢ä¸ªåœºæ™¯çœ‹çœ‹æ•ˆæœï¼Œengine.js ä¸­ï¼Œä¿®æ”¹ä»¥ä¸‹å‡ å¤„åœ°æ–¹ï¼š\næ›´æ¢å…‰æºä¿¡æ¯ï¼ˆ65-71 è¡Œï¼‰å’ŒåŠ è½½çš„æ¨¡å‹ï¼ˆ90 è¡Œï¼‰ï¼š\næ›´æ¢æ‘„åƒæœºä½ç½®ï¼ˆ34-35 è¡Œï¼‰ï¼š\nå»åˆ°ç½‘é¡µå°±èƒ½çœ‹åˆ°å¤§æ¦‚è¿™æ ·çš„æ•ˆæœï¼Œå¯ä»¥çœ‹åˆ°æš—éƒ¨ä¹Ÿæœ‰ä¸é”™çš„é—´æ¥å…‰æ•ˆæœï¼Œå¦‚æœè§‰å¾—å™ªç‚¹å¤ªå¤šå¯ä»¥ä¿®æ”¹é‡‡æ ·æ•°æˆ– RayMarching çš„å‚æ•°ï¼Œä½†æ˜¯é…ç½®å¤ªç²¾ç»†ç½‘é¡µä¼šæ¯”è¾ƒå¡ã€‚\n","permalink":"https://congyuxiaoyoudao.github.io/posts/assignments/games202-homework-3/","summary":"\u003cblockquote\u003e\n\u003cp\u003eHiZ è¿˜åœ¨æ–½å·¥ä¸­â€¦â€¦\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2 id=\"0x00-to-begin-with\"\u003e0x00 To begin with\u003c/h2\u003e\n\u003cp\u003eè¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e éƒ¨åˆ†è¯¾ç¨‹å†…å®¹å›é¡¾\u003c/li\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e GAMES202 ä½œä¸š 3\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eFor reference\u003c/strong\u003eğŸ‘‡ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eğŸ“ºB ç«™è§†é¢‘ï¼š\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://www.bilibili.com/video/BV1YK4y1T7yY/?spm_id_from=333.337.top_right_bar_window_custom_collection.content.click\u0026amp;vd_source=b6584cebba3a7a1a34d2f60d63bdc868\"\u003eGAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“¦ä»£ç ä»“åº“ï¼š\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://github.com/congyuxiaoyoudao/GAMES202_Homework/tree/working\"\u003econgyuxiaoyoudao/GAMES202_Homework at working\u003c/a\u003e\n\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003emaster åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2 id=\"0x01-è¯¾ç¨‹å›é¡¾-recap\"\u003e0x01 è¯¾ç¨‹å›é¡¾ Recap\u003c/h2\u003e\n\u003cp\u003eSSRï¼ˆScreen Space Reflectionï¼‰æ˜¯ä¸€ç§åŸºäºå±å¹•ç©ºé—´çš„åå°„ç®—æ³•ï¼Œä¹Ÿè¢«åº”ç”¨äºæ¨¡æ‹Ÿå…¨å±€å…‰ç…§ã€‚å› ä¸ºæ˜¯å±å¹•ç©ºé—´çš„ç®—æ³•ï¼Œä¸èƒ½ä¸”æ— éœ€åƒä¼ ç»Ÿå…¨å±€å…‰ç…§ç®—æ³•é‚£æ ·éœ€è¦è·å–åœºæ™¯çš„åŸå§‹å‡ ä½•ä¿¡æ¯ï¼Œè€Œæ˜¯åªåœ¨å½“å‰ç›¸æœºçš„è§†é‡èŒƒå›´è®¡ç®—åå°„ï¼Œæ‰€ä»¥æ•ˆç‡ç›¸å¯¹è¾ƒé«˜ï¼Œä½†ä¹Ÿå­˜åœ¨ä¸€äº›å±å¹•ç©ºé—´çš„ Artifactsã€‚\u003c/p\u003e\n\u003cp\u003eSSR ç®—æ³•æœ‰ä¸¤ä¸ªå‡è®¾ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eå±å¹•èŒƒå›´å†…çš„åå°„å…‰ï¼Œå…¶åå°„æºä¹ŸåŒæ ·æ¥è‡ªå±å¹•ç©ºé—´çš„æŸä¸ªåƒç´ ï¼›\u003c/li\u003e\n\u003cli\u003eæ‰€æœ‰è¢«ç›´æ¥å…‰ç…§äº®çš„ç‰©ä½“ï¼ˆåœ¨å±å¹•ç©ºé—´ä¸­åˆ™è¡¨ç°ä¸ºåƒç´ ï¼‰ï¼Œéƒ½å¯ä»¥ä½œä¸ºæ¬¡çº§å…‰æºå‚ä¸å¯¹åå°„çš„è´¡çŒ®ï¼›\u003c/li\u003e\n\u003c/ol\u003e\n\u003cblockquote\u003e\n\u003cp\u003eSSR å¯¹åå°„è¡¨é¢æ²¡æœ‰è¦æ±‚ï¼Œå³ä¸ä»…èƒ½æ¨¡æ‹Ÿé•œé¢åå°„ï¼Œè¿˜å¯ä»¥æ¨¡æ‹Ÿå„ç§ç²—ç³™åº¦çš„åå°„\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg alt=\"é‡ç”¨å±å¹•ç©ºé—´ä¿¡æ¯ GAMES202\" loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%206.GAMES202HW3/202505192155513.png#center\"\u003e\u003c/p\u003e\n\u003cp\u003eSSR ç®—æ³•çš„æ­¥éª¤å¦‚ä¸‹ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eå¯¹æ¯ä¸ªéœ€è¦è®¡ç®—åå°„çš„åƒç´ æ²¿åå°„æ–¹å‘å‘å°„ä¸€æ¡å…‰çº¿ï¼›\u003c/li\u003e\n\u003cli\u003eæ²¿å…‰çº¿æ–¹å‘æ­¥è¿›åœ¨å±å¹•ç©ºé—´ä¸­æŸ¥æ‰¾æ·±åº¦ç¼“å†²å¹¶ä¸åœºæ™¯æ±‚äº¤ï¼›\u003c/li\u003e\n\u003cli\u003eè‹¥æœ‰äº¤ç‚¹ï¼Œåˆ™å°†äº¤ç‚¹é¢œè‰²ä½œä¸ºåå°„é¢œè‰²æ·»åŠ åˆ°åŸå§‹åƒç´ ä¸Šï¼›\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eå…¶ä¸­æœ€å…³é”®çš„æ­¥éª¤å°±æ˜¯å…‰çº¿æ±‚äº¤ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ Linear RayMarchingï¼Œå…‰çº¿æ¯æ¬¡è¡Œè¿›ä¸€ä¸ªå›ºå®šçš„è·ç¦»ï¼Œæ¯æ¬¡è¡Œè¿›åè·å–è¯¥ä½ç½®çš„æ·±åº¦å€¼å†ä¸åœºæ™¯æ·±åº¦è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœæŸæ¬¡åˆ¤æ–­å…‰çº¿æ·±åº¦å¤§äºåœºæ™¯æ·±åº¦ï¼Œåˆ™è®¤ä¸ºå‘ç”Ÿäº†ç›¸äº¤ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"å›ºå®šæ­¥é•¿çš„å…‰çº¿æ­¥è¿› GAMES202\" loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%206.GAMES202HW3/202505192214607.png#center\"\u003e\u003c/p\u003e\n\u003cp\u003eå½“ç„¶è¿™ç§æ–¹æ³•çš„ç²¾ç»†åº¦å¾ˆä¾èµ–å…‰çº¿æ­¥é•¿ï¼Œå°çš„æ­¥é•¿æ•ˆæœæ›´å¥½ä½†æ¶ˆè€—å¤§ï¼Œåä¹‹ï¼Œæ›´å¤§çš„æ­¥é•¿åˆ™å¯èƒ½å¯¼è‡´å…‰çº¿â€œç©¿è¿‡â€åœºæ™¯è€Œè¯¯åˆ¤ç›¸äº¤ï¼Œé€ æˆé”™è¯¯è®¡ç®—åå°„çš„æƒ…å†µã€‚\u003c/p\u003e\n\u003cp\u003eä¸ºäº†åœ¨æé«˜ç²¾åº¦çš„åŒæ—¶èŠ‚çœå¼€é”€ï¼Œç ”ç©¶äººå‘˜åˆæå‡ºäº†ä¸€ç§åŠ¨æ€æ­¥é•¿çš„æ–¹æ³•ï¼Œå³ Hierarchical ray traceã€‚å…è®¸å…‰çº¿æ ¹æ®åœºæ™¯ä¿¡æ¯åœ¨è¡Œè¿›æœŸé—´é€‰å–ä¸åŒçš„æ­¥é•¿ï¼Œä¾‹å›¾ä¸­å…‰çº¿ä¸€å¼€å§‹è‡³å°‘å¯ä»¥ä»¥ 7 å€çš„ gap ä½œä¸ºæ­¥é•¿ï¼Œä¹‹åå†ç¼©å‡åˆ°åŸå§‹çš„æ­¥é•¿ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"å±‚çº§å…‰çº¿è¿½è¸ª GAMES202\" loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%206.GAMES202HW3/202505192226586.png#center\"\u003e\u003c/p\u003e\n\u003cp\u003eè¯´åˆ°å®æ—¶æ¸²æŸ“ä¸­çš„ä¸€äº›åŠ¨æ€æ“ä½œï¼Œå‡ ä¹å°±ç¦»ä¸å¼€é¢„å¤„ç†ã€‚åŒæ ·çš„ï¼Œè¿™ç§æ–¹æ³•è¿è¡Œçš„å‰ææ˜¯ï¼Œå…‰çº¿éœ€è¦çŸ¥é“è¡Œè¿›çš„â€œæœ€å¤§å®‰å…¨è·ç¦»â€ï¼Œå³å¯ä»¥è¿ˆå¤šå¤§çš„æ­¥å­è€Œä¸ä¸åœºæ™¯å‘ç”Ÿç›¸äº¤ã€‚\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eè¿™é‡Œæœ€å¤§å®‰å…¨è·ç¦»æ˜¯ç±»æ¯” SDF çš„è¯´æ³•ï¼Œæˆ–è€…åº”è¯¥è¯´å½“å‰å±‚çº§è§„å®šçš„æ­¥é•¿\u003c/p\u003e","title":"Assignment 6. GAMES202 Homework 3"},{"content":" (âˆ©^o^)âŠƒâ”â˜†ï¾Ÿ.*ï½¥ï½¡\n0x00 To begin with è¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\néƒ¨åˆ†è¯¾ç¨‹å†…å®¹å›é¡¾ GAMES202 ä½œä¸š 2 For referenceğŸ‘‡ï¼š\nğŸ“ºB ç«™è§†é¢‘ï¼š GAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“ ğŸ“¦ä»£ç ä»“åº“ï¼š congyuxiaoyoudao/GAMES202_Homework at working ğŸ“ƒ The rendering equation | ACM SIGGRAPH Computer Graphics ğŸ“ƒ Precomputed radiance transfer for real-time rendering in dynamic, low-frequency lighting environments | ACM Transactions on Graphics master åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…\n0x01 å‰ç½®å‡†å¤‡ Warm Up æ¸²æŸ“æ–¹ç¨‹ Render Equation James T. Kajiyaï¼ˆæ²¡é”™å°±æ˜¯é‚£ä¸ªæå‡º Kajiya-Kay å¤´å‘ç€è‰²æ¨¡å‹çš„ Kajiyaï¼‰åœ¨ 1986 å¹´æå‡ºäº†æ¸²æŸ“æ–¹ç¨‹ï¼ˆThe Render Equationï¼‰ï¼ŒåŸè®ºæ–‡é‡Œé•¿è¿™æ ·ï¼š\n$$ I(x,x')=g(x,x')\\left[ \\epsilon(x,x')+\\int_{S}\\rho(x,x',x'')I(x',x'')dx'' \\right] $$ å½“ç„¶ç°åœ¨çœ‹å¾—æ›´èˆ’æœçš„å½¢å¼é•¿è¿™æ ·ï¼š\n$$ L_{o}(p,\\omega_{o})=L_{e}(p,\\omega_{o})+\\int_{\\Omega^+}L_{i}(p,\\omega_{i})f_{r}(p,\\omega_{i},\\omega_{o})\\cos\\theta_{i}\\space d\\omega_{i} $$ å…¶ä¸­ï¼š\n$L_{o}(p,\\omega_{o})$ï¼šè¦æ±‚å‡ºå°„æ–¹å‘çš„è¾å°„ç‡ï¼ˆRadienceï¼‰ $L_{e}(p,\\omega_{o})$ï¼šè‡ªå‘å…‰é¡¹ $\\Omega^+$ï¼šç§¯åˆ†åŸŸï¼Œä»…å¯¹è¡¨é¢æ­£åŠçƒç§¯åˆ† $L_{i}(p,\\omega_{i})$ï¼šLightingï¼ŒæŸä¸€å…¥å°„æ–¹å‘çš„è¾å°„ç‡ $f_{r}(p,\\omega_{i},\\omega_{o})$ï¼šBRDFï¼Œæè¿°æŸä¸€å…¥å°„æ–¹å‘çš„å…‰çº¿åœ¨å‡ºå°„æ–¹å‘çš„è´¡çŒ® $\\cos \\theta_{i}$ï¼šè¡¨é¢æ³•å‘ä¸æŸä¸€å…¥å°„æ–¹å‘å½¢æˆçš„å¤¹è§’ä½™å¼¦ æ‰€ä»¥æ¸²æŸ“æ–¹ç¨‹å…¶å®å°±æè¿°äº†åœ¨å½“å‰ Shading Point ä¸Šï¼Œç»™å®šå…¥å°„å…‰ä¸å‡ºå°„æ–¹å‘ï¼ˆè§‚å¯Ÿæ–¹å‘ï¼‰ï¼Œåœ¨å‡ºå°„æ–¹å‘ä¸Šèƒ½å¤Ÿæ¥æ”¶åˆ°çš„ Radianceï¼Œä»»ä½•åœ¨è¡¨é¢ä¸Šè¿›è¡Œçš„å…‰çº¿ä¼ æ’­çš„ Shading éƒ½éœ€è¦è§£è¿™ä¸ªæ–¹ç¨‹ã€‚\nSplit Sum å¯¹äºç¯å¢ƒå…‰ï¼Œé€šå¸¸ä½¿ç”¨ CubeMap æˆ–è€…ç­‰è·æŸ±å½¢æŠ•å½±å°†å›¾åƒæŠ•å°„åˆ°æ— é™è¿œçš„çƒé¢ä¸Šï¼Œè¦è·å¾—ç¯å¢ƒå…‰çš„ Shadingï¼ˆç›®å‰æš‚ä¸è€ƒè™‘ Shadowingï¼‰ï¼Œå°±éœ€è¦æ±‚è§£æ¸²æŸ“æ–¹ç¨‹ï¼Œæ ¸å¿ƒæ˜¯å¯¹äº Lighting éƒ¨åˆ†çš„æ±‚è§£ã€‚\nå…ˆæŠ›å¼€æ¸²æŸ“æ–¹ç¨‹ï¼Œæƒ³è±¡ä¸€ä¸‹å½“è¡¨é¢æ˜¯ç†æƒ³é•œé¢çš„æƒ…å†µï¼šå¯¹äºæŸä¸ª Shading Pointï¼Œå…¶åå°„è¡Œä¸ºæ˜¯é•œé¢åå°„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°æ±‚å‡ºå°„æ–¹å‘å¯¹åº”çš„å…¥å°„æ–¹å‘ï¼Œæ ¹æ®è¿™ä¸ªæ–¹å‘æŸ¥è¯¢ç¯å¢ƒå…‰çš„é¢œè‰²ã€‚\næ›´ General ä¸€ç‚¹ï¼Œå½“è¡¨é¢æ¯”è¾ƒç²—ç³™çš„æƒ…å†µï¼Œèƒ½å¤Ÿåå°„åˆ°å‡ºå°„æ–¹å‘çš„å…¥å°„è§’åœ¨é•œåå°„æ–¹å‘ä¸Šä¼šåœ¨æŸä¸ªè§’åº¦ $\\phi$ èŒƒå›´å†…æŠ–åŠ¨åˆ†å¸ƒï¼Œæœ€ç»ˆåå°„åˆ°å‡ºå°„æ–¹å‘çš„ Lighting å—åˆ°è¿™ä¸ªèŒƒå›´å†…æ‰€æœ‰é‡‡æ ·ç‚¹é¢œè‰²çš„å½±å“ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç±»æ¯”äºå¯¹åŸå§‹çš„ç¯å¢ƒè´´å›¾è¿›è¡Œæ»¤æ³¢ï¼Œä¸”ç²—ç³™åº¦è¶Šå¤§ï¼Œæ»¤æ³¢æ ¸è¶Šå¤§ï¼Œè¿™æ ·å°±å¯ä»¥ä»ä½¿ç”¨é•œåå°„æ–¹å‘æŸ¥è¯¢æ»¤æ³¢åçš„å›¾åƒã€‚è¿™äº›æ»¤æ³¢åçš„å›¾åƒå½“ç„¶å¯ä»¥é¢„è®¡ç®—ï¼Œå½¢æˆä¸€ä¸ªæ¨¡ç³Šå±‚çº§ï¼Œç„¶åæ¸²æŸ“æ—¶æ ¹æ®ä¸åŒç²—ç³™åº¦ä½¿ç”¨ä¸åŒå›¾åƒã€‚\nä½†æ˜¯ç›®å‰ Lighting é¡¹åœ¨ç§¯åˆ†å†…éƒ¨ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦å¯¹æ•´ä¸ªåŠçƒé¢ä¸Šçš„å…¥å°„æ–¹å‘éƒ½è¿›è¡Œä¸€æ¬¡æŸ¥è¯¢ï¼Œè¿˜æ˜¯æ¯”è¾ƒ Costy çš„ï¼Œæœ‰æ²¡æœ‰åŠæ³•æŠŠ Lighting ä»ç§¯åˆ†é‡Œç‹¬ç«‹å‡ºæ¥ï¼Ÿä¸‹é¢æœ‰ä¸€ç§è¿‘ä¼¼æ–¹æ³•ï¼š\n$$ \\int_{\\Omega}f(x)g(x)dx\\approx \\frac{\\int_{\\Omega_{G}}f(x)dx}{\\int_{\\Omega_{G}}dx} \\cdot \\int_{\\Omega}g(x)dx $$ è¿™ä¸ªè¿‘ä¼¼åœ¨ $g(x)$ è´¡çŒ®æ¯”è¾ƒå°æˆ–è€…æ¯”è¾ƒå¹³æ»‘ï¼ˆä½é¢‘ï¼‰æ—¶æ˜¯ç›¸å¯¹å‡†ç¡®çš„ã€‚æ¼«åå°„ BRDF å°±å¾ˆå¥½åœ°æ»¡è¶³è¿™ä¸ªæ€§è´¨ï¼Œæ‰€ä»¥å¯ä»¥å¯¹æ¸²æŸ“æ–¹ç¨‹åº”ç”¨è¿™ä¸ªè¿‘ä¼¼ï¼š\n$$ L_{o}(p,\\omega_{o})\\approx\\frac{\\int_{\\Omega_{f_{r}}}L_{i}(p,\\omega_{i})d\\omega_{i}}{\\int_{\\Omega_{f_{r}}}d\\omega_{i}}\\cdot \\int_{\\Omega^+}f_{r}(p,\\omega_{i},\\omega_{o})\\cos \\theta_{i} \\space d\\omega_{i} $$ ä¹˜å·å·¦è¾¹çš„éƒ¨åˆ†ä»£è¡¨ Lighting åœ¨ BRDF èŒƒå›´å†…çš„å¹³å‡ Radienceï¼Œå¯ä»¥è®¤ä¸ºæ˜¯å¯¹å‡ºå°„æ–¹å‘æœ‰è´¡çŒ®çš„å…¥å°„æ–¹å‘èŒƒå›´å†…åœ¨ç¯å¢ƒè´´å›¾ä¸Šé‡‡æ ·é¢œè‰²çš„å¹³å‡å€¼ã€‚é€šè¿‡å¯¹ç¯å¢ƒè´´å›¾çš„é¢„æ»¤æ³¢ï¼Œå¯ä»¥é€šè¿‡ä¸€æ¬¡æŸ¥è¯¢å¾—åˆ°è¿™ä¸ªå€¼ã€‚\nçƒè°å‡½æ•° Spherical Harmonics çƒè°å‡½æ•° ç»´åŸºç™¾ç§‘ä¸Šçƒè°å‡½æ•°æ˜¯ä¸‹é¢è¿™ä¸ªå¼å­åœ¨ $m,l$ ä¸åŒå–å€¼æ—¶çš„è§£ï¼š\n$$ Y^m_{l}(\\theta, \\phi)=(-1)^m\\sqrt{ \\frac{2l+1}{4\\pi}\\frac{(l-|m|)!}{(l+|m|)!} }P^m_{l}(\\cos \\theta)e^{im\\phi} $$ å®æ•°å½¢å¼ä¸‹å¯è§†åŒ–å‡ºæ¥æ˜¯é•¿è¿™æ ·çš„ï¼š\nçœ‹ä¸Šå»æ˜¯ä¸æ˜¯å¾ˆåƒç‰©ç†/é‡å­åŒ–å­¦é‡Œé¢çš„ç”µå­äº‘å•¥çš„ï¼ˆè¿™ä¿©è¿˜çœŸæœ‰å…³ç³»ï¼‰ï¼Œä½†åœ¨å›¾å½¢å­¦é‡Œé¢ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç†è§£å…¶ç‰©ç†æ„ä¹‰ï¼Œå¯ä»¥ç®€å•å°†å…¶ç†è§£ä¸ºä¸€ç»„å®šä¹‰åœ¨çƒé¢ä¸Šçš„ä¸¤ä¸¤æ­£äº¤çš„åŸºå‡½æ•°ï¼Œæœ‰äº†å®ƒæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‚…é‡Œå¶å˜æ¢çš„æ€æƒ³å»æ‹Ÿåˆä»»ä½•çš„çƒé¢å‡½æ•°ã€‚\nåŸºå‡½æ•°ï¼ˆBasis Functionï¼‰ï¼šä¸€ç»„ä¸¤ä¸¤ä¹‹é—´ç›¸äº’ç‹¬ç«‹çš„å‡½æ•°ï¼Œå³åœ¨å½¼æ­¤ä¹‹ä¸Šçš„æŠ•å½±ä¸º 0ï¼Œå¯ä»¥ç±»æ¯”çº¿æ€§ä»£æ•°çš„åŸºå‘é‡ã€‚ä¸€ç»„åŸºå‡½æ•°å¼ æˆçš„ç©ºé—´æ˜¯å…¶ç»è¿‡çº¿æ€§ç»„åˆèƒ½å¤Ÿè¡¨ç¤ºçš„æ‰€æœ‰å‡½æ•°çš„é›†åˆ\n$$ \\mathcal{F} = \\left\\{ f(x) = \\sum_{i=1}^n c_{i}B_{i}(x) \\,\\middle|\\, c_{i} \\in \\mathbb{R} \\right\\} $$ å¯ä»¥é€šè¿‡å°†åŸå‡½æ•°æŠ•å½±åˆ°æŸä¸ªåŸºå‡½æ•°ä¸Šè·å–è¯¥åŸºå‡½æ•°å‰çš„ç³»æ•° $c_{i}$ï¼š\n$$ c_{i}=\\int_{\\Omega}f(x)B_{i}(x)\\,dx $$ å®é™…ä½¿ç”¨æ—¶éœ€è¦æŠŠç§¯åˆ†ç¦»æ•£åŒ–ä¸ºä¸€ç³»åˆ—æ±‚å’Œçš„å½¢å¼ï¼Œç»™å®šä¸€ä¸ªå‡½æ•° $f(\\omega_{i})$ï¼Œå¯ä»¥é€šè¿‡æŠ•å½±æ±‚å¾—å…¶åœ¨ $Y^m_{l}(\\omega_{i})$ ä¸Šçš„ç³»æ•°ï¼š\n$$ c^m_{l}\\approx\\sum_{i=1}^Nf(\\omega_{i})\\cdot Y^m_{l}(\\omega_{i})\\cdot \\omega_{i} $$ ç„¶åå°±å¯ä»¥ç”¨ç±»ä¼¼æ³°å‹’å±•å¼€çš„æ ·å­ç”¨åŸºå‡½æ•°è¡¨ç¤ºåŸå‡½æ•°ï¼š\n$$ \\begin{aligned} f(x)=\u0026\\sum^{\\infty}_{l=0}\\sum^l_{m=-l}c^m_{l}\\cdot Y^m_{l}(\\omega_{i}) \\\\ =\u0026 \\, c^0_{0}Y^0_{0}(\\omega_{i})+c^1_{-1}Y^1_{-1}(\\omega_{i})+c^1_{0}Y^1_{0}(\\omega_{i})+\\,\\dots \\end{aligned} $$ å¯¹äºä½é¢‘çš„å‡½æ•°ï¼Œåªå–å‰å‡ é¡¹è¿›è¡Œè¿‘ä¼¼ï¼Œå°±èƒ½è¾¾åˆ° Adequate çš„æ•ˆæœã€‚å¦‚æœ BRDF æ˜¯ç²—ç³™çš„ï¼Œå°±ç›¸å½“äºä¸€ä¸ªä½é€šæ»¤æ³¢å™¨ï¼Œå…¶å’Œ Lighting çš„ä¹˜ç§¯çš„ç§¯åˆ†ä»ç„¶æ˜¯ä½é¢‘çš„ã€‚\nPRTï¼ˆPrecomputerd Radience Transferï¼‰ çƒè°å‡½æ•°ç”¨ä¸€ç»„åŸºå‡½æ•°æ‹Ÿåˆæ¸²æŸ“æ–¹ç¨‹ä¸­çš„ Lighting é¡¹ï¼Œè§£å†³äº† Shading çš„é—®é¢˜ï¼Œå¦‚æœéœ€è¦ Shadowingï¼Œå°±éœ€è¦åŠ å…¥å¯è§æ€§é¡¹ $V(p,\\omega_{i})$ï¼Œæ¸²æŸ“æ–¹ç¨‹å˜ä¸ºï¼š\n$$ L_{o}(p,\\omega_{o})=\\int_{\\Omega} \\underbrace {L_{i}(p,\\omega_{i})}_{Lighting} \\, \\underbrace {f_{r}(p,\\omega_{i},\\omega_{o})}_{BRDF} \\, \\underbrace {V(p,\\omega_{i})}_{Visibility} \\, \\max(0,\\cos \\theta_{i})\\,d\\omega_{i} $$ æš´åŠ›ç®—æ³•å°±æ˜¯æœå„ä¸ªæ–¹å‘åˆ†åˆ«å¯¹ Lightingï¼ŒBRDF å’Œ Visibility è®¡ç®—ï¼Œç„¶åå†é€é¡¹ç›¸ä¹˜ï¼Œå¼€é”€å¤ªå¤§ã€‚Sloan åœ¨ 2002 å¹´æå‡ºäº†PRTï¼ˆPrecomputed Radience Transferï¼‰ï¼Œå°†ç§¯åˆ†å†…éƒ¨åˆ†ä¸º Lighting å’Œ Light Transportï¼ˆå…‰çº¿ä¼ è¾“ï¼‰ä¸¤ä¸ªéƒ¨åˆ†ï¼š\n$$ L_{o}(p,\\omega_{o})=\\int_{\\Omega} \\underbrace {L_{i}(p,\\omega_{i})}_{Lighting} \\, \\underbrace {f_{r}(p,\\omega_{i},\\omega_{o}) \\, V(p,\\omega_{i}) \\, \\max(0,\\cos \\theta_{i})}_{Light \\,Transport} \\, d\\omega_{i} $$ å‡è®¾ BRDF é¡¹æ˜¯ Diffuse çš„ï¼ŒBRDF é¡¹æ˜¯ä¸€ä¸ªå®šå€¼ $\\frac{\\rho}{\\pi}$ï¼Œå°† Lighting è¡¨ç¤ºä¸ºç³»æ•°å’ŒåŸºå‡½æ•°çš„å½¢å¼ï¼Œç„¶åäº¤æ¢ç§¯åˆ†ä¸æ±‚å’Œçš„ä½ç½®ï¼Œå°±å¯ä»¥å°†ç§¯åˆ†å†…éƒ¨å†æ¬¡è¡¨ç¤ºä¸ºåœ¨åŸºå‡½æ•°ä¸Šçš„æŠ•å½±ï¼š\n$$ \\begin{aligned} L(p,\\omega_{o})=\u0026 \\frac{\\rho}{\\pi} \\int_{\\Omega}\\sum l_{i}B_{i}(\\omega_{i})V(p,\\omega_{i})\\max(0,\\cos \\theta_{i}) \\, d\\omega_{i} \\\\ \\approx\u0026 \\frac{\\rho}{\\pi} \\sum l_{i} \\underbrace{ \\int_{\\Omega}B_{i}(\\omega_{i})V(p,\\omega_{i})\\max(0,\\cos \\theta_{i}) }_{Precomputed} \\, d\\omega_{i} \\\\ \\approx\u0026 \\frac{\\rho}{\\pi} \\sum l_{i}T_{i} \\end{aligned} $$ æ³¨æ„è¿™é‡Œæ˜¯å¯¹ $\\omega_{i}$ è¿›è¡Œç§¯åˆ†ï¼Œå¯¹æ¯ä¸€ä¸ªåŸºå‡½æ•°ä¸Šçš„æŠ•å½±è¿›è¡Œæ±‚å’Œ\nå…¶ä¸­ $l_{i}$ æ˜¯ Lighting é¡¹åœ¨åŸºå‡½æ•°ä¸ŠæŠ•å½±çš„ä¸€ç»„ç³»æ•°ï¼Œ$T_{i}$ æ˜¯ Light Transport é¡¹åœ¨åŸºå‡½æ•°ä¸ŠæŠ•å½±çš„ç³»æ•°ã€‚è¿™æ ·å°±æŠŠå¤šä¸ªå‡½æ•°ä¹˜ç§¯çš„ç§¯åˆ†è½¬å˜ä¸ºä¸€ä¸ªç®€å•çš„ç‚¹ä¹˜ã€‚\nç„¶è€Œè¿™äº›é¢„è®¡ç®—éœ€è¦ä¸€äº›å‰æï¼š\nVisibility æ˜¯å›ºå®šçš„ï¼Œå³è¦æ±‚åœºæ™¯ä¸­çš„ç‰©ä½“ä¸èƒ½åŠ¨ Lighting æ˜¯â€œå›ºå®šâ€çš„ï¼ŒLighting çš„æˆåˆ†ä¸èƒ½åŠ¨æ€å˜åŒ–ï¼Œä½† Lighting å¯ä»¥æ—‹è½¬ï¼ˆç›¸å½“äºå¯¹åŸºå‡½æ•°å¼ æˆçš„çº¿æ€§ç©ºé—´è¿›è¡Œæ—‹è½¬ï¼‰ å¾ˆåˆç†ï¼Œå°±åƒçƒ˜ç„™çš„å…‰ç…§ä¿¡æ¯æ˜¯é™æ€çš„ä¸€æ ·ã€‚\n0x02 é¢„è®¡ç®—çƒè°ç³»æ•° Precompute SH Coef å…‰ç…§é¡¹ç³»æ•° Lighting è¦ç®— SH ç³»æ•°ï¼Œå°±è¦æŠŠç¯å¢ƒå…‰ç…§æŠ•å½±åˆ°çƒè°å‡½æ•°ä¸Šï¼Œçƒè°å‡½æ•°å¯ä»¥è°ƒç”¨ sh::EvalSH è·å–ï¼ŒLighting é¡¹å¯ä»¥é€šè¿‡é¢„å­˜çš„ images æ•°ç»„è·å–ï¼Œå‰©ä¸‹ä¸€ä¸ªç«‹ä½“è§’ $d\\omega_{i}$ï¼š\n$$ d\\omega_{i}=\\sin \\theta \\, d\\theta \\, d\\phi $$ å…¶ä¸­ $\\theta$ æ˜¯æè§’ï¼Œ$\\phi$ æ˜¯æ–¹ä½è§’ã€‚å¯¹äºæ¯ä¸€ä¸ªç¯å¢ƒè´´å›¾ä¸Šçš„åƒç´ ï¼Œéœ€è¦è®¡ç®—å…¶æŠ•å½±åˆ°å•ä½çƒé¢çš„é¢ç§¯ï¼Œæ¡†æ¶ç»™äº† CalcArea è¿™ä¸ªå‡½æ•°è®¡ç®—è¿™ä¸ªé¢ç§¯ã€‚\nå…ˆæŠŠ texel ä» $[0,res-1]$ æ˜ å°„åˆ°ä»¥ CubeMap å½“å‰é¢ä¸­å¿ƒä¸ºåŸç‚¹çš„ $\\left[ \\frac{1}{res}-1,1-\\frac{1}{res} \\right]$ åæ ‡èŒƒå›´å†…ã€‚ç„¶åé€šè¿‡å››ä¸ªè§’ç‚¹çš„å·®å€¼è®¡ç®—é¢ç§¯ï¼Œæ¯ä¸ªç‚¹æ‰€å¯¹åº”çš„é¢ç§¯å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå…¬å¼æ±‚è§£ï¼š\n$$ A(x,y)=\\arctan\\left( \\frac{xy}{\\sqrt{ x^2+y^2+1 }} \\right) $$ æ‰€ä»¥åœ¨ PrecomputeCubemapSH ä¸­ï¼Œåªéœ€è¦ä¸ºæ¯ä¸ª SH åŸºå‡½æ•°ä¸Šç´¯åŠ æ¯ä¸ª texel çš„è´¡çŒ®ï¼Œå°±å¯ä»¥å¾—åˆ° Lighting é¡¹çš„çƒè°ç³»æ•°ã€‚\næ— é˜´å½±ä¼ è¾“é¡¹ç³»æ•° UnShadowed ä¼ è¾“é¡¹çƒè°ç³»æ•°çš„è®¡ç®—åœ¨ preprocess å‡½æ•°ä¸­ï¼Œassignmet sheet é‡Œç»™çš„è®¡ç®—ä¼ è¾“é¡¹ä¼ªä»£ç æ¯”è¾ƒé•¿ï¼Œä½†æ¡†æ¶é‡Œä¸»è¦å…³æ³¨åˆ° shFunc è¿™ä¸ª lambda è¡¨è¾¾å¼ï¼Œè¯¥è¡¨è¾¾å¼è¿”å›éœ€è¦æŠ•å½±çš„å‡½æ•°åœ¨ç»™å®šæ–¹å‘ä¸Šçš„å‡½æ•°å€¼ï¼Œåç»­ä¼šä¼ å…¥ sh::ProjectFunction è¿›è¡Œè®¡ç®—ã€‚\nå¯¹äºæ— é˜´å½±çš„æƒ…å†µï¼Œè¦æŠ•å½±çš„å‡½æ•°å°±æ˜¯ç®€å•çš„ cos é¡¹ï¼š\n$$ M_{DU}=\\max(N_{x}\\cdot \\omega_{i},0) $$ è¿™é‡Œ H åæ¥æˆ‘æ”¾ if å¤–é¢äº†ï¼Œå…å¾—ä¸‹é¢å†å†™ä¸€é\næœ‰é˜´å½±ä¼ è¾“é¡¹ç³»æ•° Shadowed $$ M_{DU}=V(\\omega_{i})\\max(N_{x}\\cdot \\omega_{i},0) $$ è¦æŠ•å½±çš„å‡½æ•°å†ä¹˜ä¸Šä¸€ä¸ª Visibility é¡¹å³å¯ï¼š\nå¦‚æœæƒ³çœ‹è¿™æ­¥çš„ç»“æœï¼Œå°±æŠŠ prt.xml é‡Œæ”¹æˆ shadowedï¼Œç„¶åè¿è¡Œä¸‹ nori.exeã€‚\n1\u0026lt;string name=\u0026#34;type\u0026#34; value=\u0026#34;shadowed\u0026#34; /\u0026gt; è®°å¾—æ”¹å®Œä»£ç  build ä¸€ä¸‹ï¼Œä¸ç„¶ .exe è¿˜æ˜¯ä¸Šä¸€æ¬¡çš„ç»“æœ\nåå°„ä¼ è¾“é¡¹ç³»æ•° Inter-reflection å¯¹äºå…·æœ‰ç›¸äº’åå°„çš„ä¼ è¾“é¡¹ï¼Œå…¶æ–¹ç¨‹å˜ä¸ºï¼š\n$$ L_{DI}=L_{DS}+\\frac{\\rho}{\\pi}\\int_{S}\\hat{L}(x',\\omega_{i})(1-V(\\omega_{i}))\\max(N_{x}\\cdot \\omega_{i},0)\\,d\\omega_{i} $$ æˆ‘ä»¬å·²ç»è®¡ç®—äº†æ¯ä¸ªé¡¶ç‚¹çš„ç›´æ¥å¯è§å…‰æºçš„ Lightningï¼ˆ$L_{DS}$ï¼‰ï¼Œè¿˜éœ€è¦è®¡ç®—é—´æ¥å…‰çš„ Lightingï¼Œå…¶ä¸­ï¼š\n$\\hat{L}(x\u0026rsquo;,\\omega_{i})$ï¼šä» $\\omega_{i}$ åˆ°ç‚¹ $x\u0026rsquo;$ çš„ Radiance $1-V(\\omega_{i})$ï¼šè¢«é®æŒ¡çš„éƒ¨åˆ† æ‰€ä»¥è¿™ä¸ªå¼å­å¯¹æ¯ä¸ªé¡¶ç‚¹è®¡ç®—æ¥è‡ªç›´æ¥å¯è§å…‰æºçš„ Lightingï¼Œç„¶åéå†æ‰€æœ‰å¯èƒ½çš„ $\\omega_{i}$ è®¡ç®—é—´æ¥å…‰çš„ Lightingï¼Œå¯¹äºæ¯ä¸ªäº¤ç‚¹è¿”å›é‡å¿ƒåæ ‡æ’å€¼åçš„çƒè°ç³»æ•°ï¼Œç„¶åä»¥å½“å‰äº¤ç‚¹ä¸ºåŸç‚¹ï¼Œè¿­ä»£è®¡ç®—ä¼ è¾“é¡¹ç³»æ•°ã€‚\nå› ä¸ºè§‰å¾— lambda æœ‰ç‚¹å¥½ç©ï¼Œå°±æ‹¿ lambda å†™äº†ä¸€ä¸ªé€’å½’ï¼Œå…¶å®ä¹Ÿå¯ä»¥å¦å¤–å°è£…ä¸€ä¸ªå‡½æ•°ï¼Œå›¾ç‰‡å¤ªé•¿ä¸å¥½æˆªï¼Œç›´æ¥æ”¾ä»£ç ï¼š\n1 if (m_Type == Type::Interreflection) 2 { 3 // for each vertex cast a ray to the scene 4 // if occluded return interpolated sh coef 5 // then recursively call this function 6 for(int i = 0;i \u0026lt; mesh-\u0026gt;getVertexCount(); i++) 7 { 8 const Point3f \u0026amp;v = mesh-\u0026gt;getVertexPositions().col(i); 9 const Normal3f \u0026amp;n = mesh-\u0026gt;getVertexNormals().col(i); 10 11 // iterate lambda 12 // need to pass pos, normal, scene, original coeff and current bounce 13 std::function\u0026lt;std::unique_ptr\u0026lt;std::vector\u0026lt;double\u0026gt;\u0026gt;(Eigen::MatrixXf*, const Point3f\u0026amp;, const Normal3f\u0026amp;, const Scene*, int)\u0026gt; iterateSHFunc; 14 iterateSHFunc = [\u0026amp;](Eigen::MatrixXf* TransportSHCoeffs, const Point3f \u0026amp;pos, const Normal3f \u0026amp;normal, const Scene* s, int bounce) -\u0026gt; std::unique_ptr\u0026lt;std::vector\u0026lt;double\u0026gt;\u0026gt; 15 { 16 // Step 1: allocate and assign 0 to coeffs 17 std::unique_ptr\u0026lt;std::vector\u0026lt;double\u0026gt;\u0026gt; coeffs(new std::vector\u0026lt;double\u0026gt;()); 18 coeffs-\u0026gt;assign(SHCoeffLength, 0.0); 19 20 // Step 2: judge by bounce to terminate 21 if (bounce \u0026gt; m_Bounce) 22 return coeffs; 23 24 // Step 3: generate sample_side^2 uniformly and stratified samples over the sphere 25 const int sample_side = static_cast\u0026lt;int\u0026gt;(floor(sqrt(m_SampleCount))); 26 std::random_device rd; 27 std::mt19937 gen(rd()); 28 std::uniform_real_distribution\u0026lt;\u0026gt; rng(0.0, 1.0); 29 for (int t = 0; t \u0026lt; sample_side; t++) 30 { 31 for (int p = 0; p \u0026lt; sample_side; p++) 32 { 33 double alpha = (t + rng(gen)) / sample_side; 34 double beta = (p + rng(gen)) / sample_side; 35 double phi = 2.0 * M_PI * beta; 36 double theta = acos(2.0 * alpha - 1.0); 37 38 // Step 4: for each wi cast a ray to the scene 39 Eigen::Array3d d = sh::ToVector(phi, theta); 40 const auto wi = Vector3f(d.x(), d.y(), d.z()); 41 float H = wi.dot(normal); 42 43 Ray3f ray = Ray3f(pos, wi); 44 Intersection its; 45 if(H \u0026gt; 0.0 \u0026amp;\u0026amp; s-\u0026gt;rayIntersect(ray, its)) 46 { 47 // Step 5: if occluded, get the intersected point and its normal 48 Point3f intersectPos = its.p; 49 Vector3f baryCoord = its.bary; 50 Point3f idx = its.tri_index; 51 MatrixXf normals = mesh-\u0026gt;getVertexNormals(); 52 Normal3f intersectNormal = Normal3f(normals.col(idx.x()).normalized() * baryCoord.x() + 53 normals.col(idx.y()).normalized() * baryCoord.y() + 54 normals.col(idx.z()).normalized() * baryCoord.z()).normalized(); 55 auto nextBounceCoeffs = iterateSHFunc(TransportSHCoeffs, intersectPos, intersectNormal, scene, bounce + 1); 56 57 // Step 6: accumulate the coeffs 58 for (int k = 0; k \u0026lt; SHCoeffLength; k++) 59 { 60 auto interpolateSH = (TransportSHCoeffs-\u0026gt;col(idx.x()).coeffRef(k) * baryCoord.x() + 61 TransportSHCoeffs-\u0026gt;col(idx.y()).coeffRef(k) * baryCoord.y() + 62 TransportSHCoeffs-\u0026gt;col(idx.z()).coeffRef(k) * baryCoord.z()); 63 64 (*coeffs)[k] += (interpolateSH + (*nextBounceCoeffs)[k]) * H; 65 } 66 } 67 } 68 } 69 // Step 7: return the coeffs 70 double weight = (sample_side * sample_side); 71 for (unsigned int c = 0; c \u0026lt; coeffs-\u0026gt;size(); c++) { 72 (*coeffs)[c] /= weight; 73 } 74 75 return coeffs; 76 }; 77 78 // Step 8: call the iterateSHFunc 79 auto interreflectCoeffs = iterateSHFunc(\u0026amp;m_TransportSHCoeffs, v, n, scene, 1); 80 for (int j = 0; j \u0026lt; SHCoeffLength; j++) 81 { 82 m_TransportSHCoeffs.col(i).coeffRef(j) += (*interreflectCoeffs)[j]; 83 } 84 } 85 } è¿™é‡Œä½¿ç”¨ std::function åŒ…è£…äº†ä¸€ä¸‹è¿™ä¸ª lambdaï¼Œä¸ç„¶å…¶å†…éƒ¨ä¸èƒ½è°ƒç”¨è‡ªå·±ï¼›ç”Ÿæˆé‡‡æ ·ç‚¹çš„è¿‡ç¨‹å¯ä»¥ç…§ç€ sh::ProjectFunction é‡Œé¢æŠ„\nåœ¨è°ƒç”¨æ—¶å¯ä»¥ä¿®æ”¹ m_Bounce çš„å€¼æ§åˆ¶å…‰çº¿åå¼¹æ¬¡æ•°ï¼ˆlambda è¿­ä»£æ¬¡æ•°ï¼‰ï¼Œæˆ‘è¿™é‡Œä»ç„¶æ˜¯é»˜è®¤å€¼ 1ï¼Œä¹‹å‰æ”¹äº†ä¸€æ¬¡ 2 ç»™æˆ‘è·‘äº†ä¸€ä¸ªå¤šå°æ—¶ï¼Œ(à¹‘â•¹â—¡â•¹à¹‘)ã€‚\n0x03 å®æ—¶çƒè°å…‰ç…§ Realtime SH Lighting è¿è¡Œ nori.exe åï¼Œè®¡ç®—å¾—åˆ°çš„çƒè°ç³»æ•°å°†ä¿å­˜åœ¨ prt/scenes/cubemap/ å¯¹åº”ç¯å¢ƒè´´å›¾æ–‡ä»¶å¤¹ä¸‹ï¼Œéœ€è¦æ‰‹å·¥å…ˆæŠŠ light.txt å’Œ transport.txt æ”¾åˆ° homework2/assets/cubemap/ å¯¹åº”çš„ç¯å¢ƒè´´å›¾æ–‡ä»¶å¤¹ä¸‹ã€‚\nengine.js ä¸­çš„ç¬¬ 88-114 è¡Œå·²ç»å¸®æˆ‘ä»¬å®Œæˆäº†è§£æè¿™äº›æ–‡ä»¶çš„å·¥ä½œï¼Œæœ€ç»ˆ Lighting å’Œ Transport é¡¹çš„çƒè°ç³»æ•°è¢«ä¿å­˜åœ¨ precomputeL å’Œ precomputeLT ä¸¤ä¸ªæ•°ç»„ä¸­ï¼Œè¿™ä¸¤ä¸ªæ•°ç»„åŒ…å«åœ¨ envmap ä¸­æ‰€æœ‰ç¯å¢ƒçº¹ç†çš„çƒè°ç³»æ•°ï¼Œå…¶å½¢çŠ¶ä¸ºï¼š\n$$ \\begin{aligned} precomputeL =\u0026 EnvMapNum*3*(SHOrder+1)^{2} \\\\ precomputeLT =\u0026 EnvMapNum*VertexCount*(SHOrder+1)^{2} \\end{aligned} $$ å¯ä»¥é€šè¿‡ guiParams.envmapId è·å–å½“å‰ GUI ä¸­æ¿€æ´»çš„ç¯å¢ƒçº¹ç†ç´¢å¼•ï¼Œä»¥ä»ä»¥ä¸Šæ•°ç»„ä¸­è·å–å¯¹åº”çš„çƒè°ç³»æ•°ã€‚\næ–°å»º PRT æè´¨ New PRT Material åœ¨ src/material/ ä¸‹æ–°å»ºPRTMaterial.jsï¼Œç¼–å†™ä¸€ä¸ªæœ€ç®€å•çš„æè´¨ï¼Œä¼ çš„ç»Ÿä¸€å˜é‡ä»…ä¸ºé¢„è®¡ç®—å…‰ç…§é¡¹çš„å„åˆ†é‡ï¼ˆRGBï¼‰ï¼Œattributeï¼ˆaPrecomputeLTï¼‰æŒ‰ç…§ assignment sheet é‡Œçš„è¦æ±‚ä¼ å…¥ï¼š\n1class PRTMaterial extends Material { 2 3 constructor(vertexShader, fragmentShader) { 4 super({ 5 // PRT 6 \u0026#39;uPrecomputeL[0]\u0026#39;: { type: \u0026#39;precomputeL\u0026#39;, value: null }, 7 \u0026#39;uPrecomputeL[1]\u0026#39;: { type: \u0026#39;precomputeL\u0026#39;, value: null }, 8 \u0026#39;uPrecomputeL[2]\u0026#39;: { type: \u0026#39;precomputeL\u0026#39;, value: null }, 9 }, [\u0026#39;aPrecomputeLT\u0026#39;], vertexShader, fragmentShader, null); 10 } 11} 12 13async function buildPRTMaterial(vertexPath, fragmentPath) { 14 15 16 let vertexShader = await getShaderString(vertexPath); 17 let fragmentShader = await getShaderString(fragmentPath); 18 19 return new PRTMaterial(vertexShader, fragmentShader); 20 21} åœ¨ Shader ä¸­ï¼ŒuPrecomputeL æ˜¯ä¸€ä¸ªç±»å‹ä¸º mat3 çš„æ•°ç»„ï¼Œç´¢å¼•å¯¹åº” RGB åˆ†é‡çš„çƒè°ç³»æ•°ï¼Œéœ€è¦é€ä¸€ç»‘å®š\nutils/tools.js ä¸­æä¾›äº†ç”¨äºå°† precomputeL åˆ†è§£ä¸ºä¸‰ä¸ª mat3 ç±»å‹çš„æ•°ç»„çš„å‡½æ•° getMat3ValueFromRGBï¼Œæ¯å¸§çš„ render ä¸­éœ€è¦å¯¹å…¶è¿›è¡Œç»‘å®šï¼ŒWebGLRenderer.js ä¸­ï¼š\n1let precomputeL_RGBMat3 = getMat3ValueFromRGB(precomputeL[guiParams.envmapId]); 2for(let j = 0; j \u0026lt; 3 ; j++){ 3\tif(k == `uPrecomputeL[${j}]`){ 4\tgl.uniformMatrix3fv(this.meshes[i].shader.program.uniforms[k],false,precomputeL_RGBMat3[j]); 5\t} 6} ä¹‹åå¯ä»¥å…ˆåœ¨ index.html ä¸­å¼•å…¥ï¼š\n1\u0026lt;script src=\u0026#34;src/materials/PRTMaterial.js\u0026#34; defer\u0026gt;\u0026lt;/script\u0026gt; ç„¶ååœ¨ loadOBJ.js ä¸­å¢åŠ  PRT æè´¨çš„ caseï¼š\n1case \u0026#39;PRTMaterial\u0026#39;: 2\tmaterial = buildPRTMaterial(\u0026#34;./src/shaders/PRTShader/PRTVertex.glsl\u0026#34;, \u0026#34;./src/shaders/PRTShader/PRTFragment.glsl\u0026#34;); 3\tbreak; ç¼–å†™ç€è‰²å™¨ Write Shader åœ¨ shaders/PRTShader/ ä¸‹æ–°å»º PRT çš„é¡¶ç‚¹å’Œç‰‡å…ƒç€è‰²å™¨æ–‡ä»¶ï¼Œä½œä¸šä¸­éœ€è¦æˆ‘ä»¬åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­å®Œæˆå¯¹ Lighting å’Œ Transport çš„çƒè°ç³»æ•°çš„ç‚¹ä¹˜ï¼Œç»“æœ vColor ç»æ’å€¼åä¼ è‡³ç‰‡å…ƒç€è‰²å™¨ï¼Œç›´æ¥è¾“å‡ºã€‚\næ‰€ä»¥ç‰‡å…ƒç€è‰²å™¨å¾ˆç®€å•ï¼š\n1// prtFragment.glsl 2#ifdef GL_ES 3precision mediump float; 4#endif 5 6varying highp vec3 vColor; 7 8void main(void) { 9 gl_FragColor = vec4(vColor, 1.0); 10} é¡¶ç‚¹ç€è‰²å™¨ä¸­éœ€è¦å®Œæˆå¯¹ vColor çš„è®¡ç®—ï¼Œçœ‹ä¸€ä¸‹ä¼ è¿‡æ¥çš„ uPrecomputeL[3] å’Œ aPrecomputeLT é•¿ä»€ä¹ˆæ ·å­ï¼š\nemmï¼Œéƒ½æ˜¯ mat3 æ²¡åŠæ³•ç®€å•ç‚¹ä¹˜ï¼Œé‚£å°±å†™ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠå®ƒä»¬éƒ½åˆ†æˆä¸‰ä¸ª vec3ï¼Œç„¶åç‚¹ä¹˜æ±‚å’Œå³å¯ã€‚\n1// prtVertex.glsl 2attribute vec3 aVertexPosition; 3attribute vec3 aNormalPosition; 4attribute mat3 aPrecomputeLT; 5 6uniform mat4 uModelMatrix; 7uniform mat4 uViewMatrix; 8uniform mat4 uProjectionMatrix; 9uniform mat3 uPrecomputeL[3]; 10 11varying highp vec3 vNormal; 12varying highp vec3 vColor; 13 14float LoT (mat3 L, mat3 LT) { 15 vec3 L0 = L[0]; 16 vec3 L1 = L[1]; 17 vec3 L2 = L[2]; 18 vec3 LT0 = LT[0]; 19 vec3 LT1 = LT[1]; 20 vec3 LT2 = LT[2]; 21 return dot(L0, LT0) + dot(L1, LT1) + dot(L2, LT2); 22} 23 24void main(void) { 25 26 vNormal = (uModelMatrix * vec4(aNormalPosition, 0.0)).xyz; 27 28 gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * 29 vec4(aVertexPosition, 1.0); 30 31 // rgb color from precomputed light transport 32 float r = LoT(uPrecomputeL[0],aPrecomputeLT); 33 float g = LoT(uPrecomputeL[1],aPrecomputeLT); 34 float b = LoT(uPrecomputeL[2],aPrecomputeLT); 35 vColor = vec3(r, g, b); 36} ç»“æœ Outcome æœ€ååœ¨ engine.js ä¸­è°ƒç”¨ loadOBJ åŠ è½½ 202 å¨˜ï¼Œé¡ºä¾¿æŠŠè¿˜æœ‰ä¸€å¼ æ²¡åœ¨ GUI ä¸Šçš„ç¯å¢ƒçº¹ç†æ”¾ä¸Šå»ï¼š\n1var envmap = [ 2\t\u0026#39;assets/cubemap/GraceCathedral\u0026#39;, 3\t\u0026#39;assets/cubemap/Indoor\u0026#39;, 4\t\u0026#39;assets/cubemap/Skybox\u0026#39;, 5\t// Begin TOP changes Add envmap CornellBox 6\t\u0026#39;assets/cubemap/CornellBox\u0026#39; 7\t// End TOP changes 8]; 9// ... 10 11\tloadOBJ(renderer, \u0026#39;assets/mary/\u0026#39;, \u0026#39;mary\u0026#39;, \u0026#39;PRTMaterial\u0026#39;, boxTransform); 12// ... 13 14function createGUI() { 15\tconst gui = new dat.gui.GUI(); 16\tconst panelModel = gui.addFolder(\u0026#39;Switch Environemtn Map\u0026#39;); 17\t// Begin TOP changes Add envmap CornellBox case in UI 18\tpanelModel.add(guiParams, \u0026#39;envmapId\u0026#39;, { \u0026#39;GraceGathedral\u0026#39;: 0, \u0026#39;Indoor\u0026#39;: 1, \u0026#39;Skybox\u0026#39;: 2, \u0026#39;CornellBox\u0026#39;:3}).name(\u0026#39;Envmap Name\u0026#39;); 19\t// End TOP changes 20\tpanelModel.open(); 21} 0x04 çƒè°æ—‹è½¬ SH Rotation çƒè°å‡½æ•°å…·æœ‰ä¸¤ä¸ªå¾ˆå¥½çš„æ€§è´¨ï¼š\næ—‹è½¬ä¸å˜æ€§ï¼šæ—‹è½¬çƒè°å±•å¼€åçš„å‡½æ•°ï¼Œç›¸å½“äºæ—‹è½¬è¿™äº›çƒè°å‡½æ•° ç‹¬ç«‹çš„çº¿æ€§æ—‹è½¬ï¼šå¯¹äºæ¯å±‚çƒè°å‡½æ•°ä¸Šçš„ç³»æ•°ï¼Œå¯ä»¥åˆ†åˆ«è¿›è¡Œæ—‹è½¬ï¼Œå¹¶ä¸”è¯¥æ—‹è½¬æ˜¯çº¿æ€§çš„ æŠŠçƒè°å‡½æ•°å’ŒåŸºå‘é‡ç±»æ¯”å°±æ¯”è¾ƒæ¸…æ¥šäº†ï¼šæ—‹è½¬ä¸€ä¸ªä¸‰ç»´ç©ºé—´ä¸­çš„å‘é‡ï¼Œç›¸å½“äºæ—‹è½¬åæ ‡åŸºï¼Œåœ¨è¿™ç»„æ–°çš„åæ ‡åŸºä¸‹ï¼Œå…¶ç³»æ•°å’Œæ—‹è½¬å‰å…¶åœ¨åŸåæ ‡ç³»çš„ç³»æ•°ç›¸ç­‰ã€‚é‚£ä¹ˆè¦æ±‚æ—‹è½¬ååœ¨åŸåæ ‡ç³»ä¸‹çš„ç³»æ•°ï¼Œåªéœ€è¦å°†æ–°çš„åæ ‡åŸºä½¿ç”¨åŸæ¥çš„åæ ‡åŸºè¡¨ç¤ºï¼Œç„¶åé‡æ–°æ•´ç†ç³»æ•°å³å¯ã€‚\nå¯¹çƒè°æ¯é˜¶ $l$ï¼Œæœ‰ $2l+1$ ç»´çš„çƒè°ç³»æ•°ç»„æˆçš„å‘é‡ï¼Œå‡è®¾å­˜åœ¨ $2l + 1$ ä¸ªä»»æ„çš„ä¸‰ç»´æ³•å‘ $n$ï¼Œæ—‹è½¬å‡½æ•° $R$ï¼Œèƒ½å¤Ÿè¿”å›è¯¥é˜¶çƒè°æŠ•å½±ç³»æ•°çš„å‡½æ•° $P$ï¼Œéœ€è¦æ±‚å¾—æ—‹è½¬æ•´ä¸ªçƒé¢å‡½æ•°çš„çŸ©é˜µ $M$ï¼Œæœ‰ï¼š\n$$ MP(n_{i})=P(R(n_{i}))\\,,\\,i \\in[-l,l] $$ LHSï¼šå¯¹æ•´ä¸ªçƒé¢å‡½æ•°è¿›è¡Œæ—‹è½¬ï¼›RHSï¼šå…ˆæ—‹è½¬æ–¹å‘ $n_i$ï¼Œå†ä»£å…¥çƒé¢å‡½æ•°\nè®°çŸ©é˜µ $A=[P(n_{-l}),\\dots,P(n_{l})]$ï¼Œè‹¥å…¶å¯é€†ï¼Œåˆ™ç­‰å¼ä¸¤è¾¹åŒæ—¶å³ä¹˜ä¸€ä¸ª $A^{-1}$ï¼Œç­‰å¼å˜ä¸ºï¼š\n$$ M=[P(R(n_{-l})),\\dots,P(R(n_{l}))]A^{-1} $$ Lighting é¡¹æœ‰ RGB ä¸‰ä¸ªåˆ†é‡ï¼Œæ‰€ä»¥è¿™é‡Œçš„ $P(R(n_{i}))$ å®é™…ä¸Šæ˜¯ä¸€ä¸ªä¸‰ç»´å‘é‡\næ€»ç»“ä¸€ä¸‹æ€è·¯ï¼š\nå¯¹äºç¯å¢ƒçº¹ç†çš„æ—‹è½¬ï¼Œå¯ä»¥è·å–å…¶æ—‹è½¬çŸ©é˜µ $R$ï¼› åœ¨æ¯é˜¶ $l$ é€‰å– $2l+1$ ä¸ªå•ä½æ–¹å‘å‘é‡ï¼Œè·å–å…¶åœ¨è¯¥é˜¶ä¸Šçš„çƒè°ç³»æ•°æ„æˆçŸ©é˜µ $A$ï¼› å¯¹è¯¥çŸ©é˜µæ±‚é€†å¾—åˆ° $A^{-1}$ï¼› ä½¿ç”¨æ—‹è½¬çŸ©é˜µä¾æ¬¡æ—‹è½¬æ¯é˜¶çš„å•ä½æ–¹å‘å‘é‡ï¼Œè·å–è¿™äº›æ—‹è½¬åçš„å‘é‡åœ¨è¯¥é˜¶ä¸Šçš„çƒè°ç³»æ•° $S$ï¼› è§£å¾— $M=SA^{-1}$ ä¸»è¦çš„å®ç°åœ¨ utils/tools.js ä¸­ï¼Œç›´æ¥ä¸Šä»£ç ï¼š\n1function getRotationPrecomputeL(precompute_L, rotationMatrix){ 2 3\t// Step 1: Calc each band\u0026#39;s rotation matrix 4\t// Caution: for each dir the Rotation matrix is a inverse of the rotation matrix 5 let r = mat4Matrix2mathMatrix(rotationMatrix); 6 7 let shRotateMatrix3x3 = computeSquareMatrix_3by3(r); 8 let shRotateMatrix5x5 = computeSquareMatrix_5by5(r); 9 10\t// Step 2: Initialize rotated L // R G B 11 let result = []; // SH0 12 for(let i = 0; i \u0026lt; 9; i++){ // SH1 13 result[i] = []; // SH2 14 } // ... 15 16\t// Step 3: Calc SH coeffs for RGB component of precompute_L 17 for(let i = 0; i \u0026lt; 3; i++){ 18 let L_SH_R_3 = math.multiply([precompute_L[1][i], precompute_L[2][i], precompute_L[3][i]], shRotateMatrix3x3); 19 let L_SH_R_5 = math.multiply([precompute_L[4][i], precompute_L[5][i], precompute_L[6][i], precompute_L[7][i], precompute_L[8][i]], shRotateMatrix5x5); 20\t21\tlet L_SH_R_3_arr = L_SH_R_3.toArray(); 22\tlet L_SH_R_5_arr = L_SH_R_5.toArray(); 23 24 result[0][i] = precompute_L[0][i]; // Y1^{0} remains the same 25\tresult[1][i] = L_SH_R_3_arr[0]; 26 result[2][i] = L_SH_R_3_arr[1]; 27 result[3][i] = L_SH_R_3_arr[2]; 28 result[4][i] = L_SH_R_5_arr[0]; 29 result[5][i] = L_SH_R_5_arr[1]; 30 result[6][i] = L_SH_R_5_arr[2]; 31 result[7][i] = L_SH_R_5_arr[3]; 32 result[8][i] = L_SH_R_5_arr[4]; 33 } 34 35\treturn result; 36} 37 38function computeSquareMatrix_3by3(rotationMatrix){ // è®¡ç®—æ–¹é˜µSA(-1) 3*3 39\t40\t// 1ã€pick ni - {ni} 41\tlet n1 = [1, 0, 0, 0]; let n2 = [0, 0, 1, 0]; let n3 = [0, 1, 0, 0]; 42 43\t// 2ã€{P(ni)} - A A_inverse 44\tlet pSHn1 = SHEval(n1[0], n1[1], n1[2], 3); 45\tlet pSHn2 = SHEval(n2[0], n2[1], n2[2], 3); 46\tlet pSHn3 = SHEval(n3[0], n3[1], n3[2], 3); 47\t48\tlet A = math.matrix([ 49\t[pSHn1[1], pSHn2[1], pSHn3[1]], // Y1^{-1} 50\t[pSHn1[2], pSHn2[2], pSHn3[2]], // Y1^{0} 51\t[pSHn1[3], pSHn2[3], pSHn3[3]] // Y1^{1} 52\t]); 53\tlet A_inverse = math.inv(A); 54 55\t// 3ã€ç”¨ R æ—‹è½¬ ni - {R(ni)} 56\tlet Rn1 = math.multiply(rotationMatrix, n1); 57\tlet Rn2 = math.multiply(rotationMatrix, n2); 58\tlet Rn3 = math.multiply(rotationMatrix, n3); 59 60\t// get array from math matrix 61\tlet Rn1_arr = Rn1.toArray(); 62\tlet Rn2_arr = Rn2.toArray(); 63\tlet Rn3_arr = Rn3.toArray(); 64 65\t// 4ã€R(ni) SHæŠ•å½± - S 66\tlet pSHRn1 = SHEval(Rn1_arr[0], Rn1_arr[1], Rn1_arr[2], 3); 67\tlet pSHRn2 = SHEval(Rn2_arr[0], Rn2_arr[1], Rn2_arr[2], 3); 68\tlet pSHRn3 = SHEval(Rn3_arr[0], Rn3_arr[1], Rn3_arr[2], 3); 69 70\tlet S = math.matrix([ 71\t[pSHRn1[1], pSHRn2[1], pSHRn3[1]], // Y1^{-1} 72\t[pSHRn1[2], pSHRn2[2], pSHRn3[2]], // Y1^{0} 73\t[pSHRn1[3], pSHRn2[3], pSHRn3[3]] // Y1^{1} 74\t]); 75 76\t// 5ã€S*A_inverse 77\tlet SA_inverse = math.multiply(S, A_inverse); 78\treturn SA_inverse; 79} 80 81function computeSquareMatrix_5by5(rotationMatrix){ // è®¡ç®—æ–¹é˜µSA(-1) 5*5 82\t83\t// 1ã€pick ni - {ni} 84\tlet k = 1 / math.sqrt(2); 85\tlet n1 = [1, 0, 0, 0]; let n2 = [0, 0, 1, 0]; let n3 = [k, k, 0, 0]; 86\tlet n4 = [k, 0, k, 0]; let n5 = [0, k, k, 0]; 87 88\t// 2ã€{P(ni)} - A A_inverse 89\tlet pSHn1 = SHEval(n1[0], n1[1], n1[2], 3); 90\tlet pSHn2 = SHEval(n2[0], n2[1], n2[2], 3); 91\tlet pSHn3 = SHEval(n3[0], n3[1], n3[2], 3); 92\tlet pSHn4 = SHEval(n4[0], n4[1], n4[2], 3); 93\tlet pSHn5 = SHEval(n5[0], n5[1], n5[2], 3); 94 95\tlet A = math.matrix([ 96\t[pSHn1[4], pSHn2[4], pSHn3[4], pSHn4[4], pSHn5[4]], // Y2^{-2} 97\t[pSHn1[5], pSHn2[5], pSHn3[5], pSHn4[5], pSHn5[5]], // Y2^{-1} 98\t[pSHn1[6], pSHn2[6], pSHn3[6], pSHn4[6], pSHn5[6]], // Y2^{0} 99\t[pSHn1[7], pSHn2[7], pSHn3[7], pSHn4[7], pSHn5[7]], // Y2^{1} 100\t[pSHn1[8], pSHn2[8], pSHn3[8], pSHn4[8], pSHn5[8]] // Y2^{2} 101\t]); 102\tlet A_inverse = math.inv(A); 103 104\t// 3ã€ç”¨ R æ—‹è½¬ ni - {R(ni)} 105\tlet Rn1 = math.multiply(rotationMatrix, n1); 106\tlet Rn2 = math.multiply(rotationMatrix, n2); 107\tlet Rn3 = math.multiply(rotationMatrix, n3); 108\tlet Rn4 = math.multiply(rotationMatrix, n4); 109\tlet Rn5 = math.multiply(rotationMatrix, n5); 110 111\t// get array from math matrix 112\tlet Rn1_arr = Rn1.toArray(); 113\tlet Rn2_arr = Rn2.toArray(); 114\tlet Rn3_arr = Rn3.toArray(); 115\tlet Rn4_arr = Rn4.toArray(); 116\tlet Rn5_arr = Rn5.toArray(); 117 118\t// 4ã€R(ni) SHæŠ•å½± - S 119\tlet pSHRn1 = SHEval(Rn1_arr[0], Rn1_arr[1], Rn1_arr[2], 3); 120\tlet pSHRn2 = SHEval(Rn2_arr[0], Rn2_arr[1], Rn2_arr[2], 3); 121\tlet pSHRn3 = SHEval(Rn3_arr[0], Rn3_arr[1], Rn3_arr[2], 3); 122\tlet pSHRn4 = SHEval(Rn4_arr[0], Rn4_arr[1], Rn4_arr[2], 3); 123\tlet pSHRn5 = SHEval(Rn5_arr[0], Rn5_arr[1], Rn5_arr[2], 3); 124 125\tlet S = math.matrix([ 126\t[pSHRn1[4], pSHRn2[4], pSHRn3[4], pSHRn4[4], pSHRn5[4]], // Y2^{-2} 127\t[pSHRn1[5], pSHRn2[5], pSHRn3[5], pSHRn4[5], pSHRn5[5]], // Y2^{-1} 128\t[pSHRn1[6], pSHRn2[6], pSHRn3[6], pSHRn4[6], pSHRn5[6]], // Y2^{0} 129\t[pSHRn1[7], pSHRn2[7], pSHRn3[7], pSHRn4[7], pSHRn5[7]], // Y2^{1} 130\t[pSHRn1[8], pSHRn2[8], pSHRn3[8], pSHRn4[8], pSHRn5[8]] // Y2^{2} 131\t]); 132 133\t// 5ã€S*A_inverse 134\tlet SA_inverse = math.multiply(S, A_inverse); 135\treturn SA_inverse; 136} æœ‰ä¸€äº›è¦æ³¨æ„çš„ç‚¹ï¼Œæ—‹è½¬å¤©ç©ºç›’çš„çŸ©é˜µæ˜¯å¦‚ä¸‹ä»£ç ç”Ÿæˆå¹¶ä¼ å…¥ Shader çš„ï¼š\n1// WebGLRenderer.js 2let cameraModelMatrix = mat4.create(); 3mat4.fromRotation(cameraModelMatrix, timer, [0, 1, 0]); 4 5if (k == \u0026#39;uMoveWithCamera\u0026#39;) { // The rotation of the skybox 6\tgl.uniformMatrix4fv( 7\tthis.meshes[i].shader.program.uniforms[k], 8\tfalse, 9\tcameraModelMatrix); 10} å¯¹æ•´ä¸ªç¯å¢ƒçº¹ç†è¿›è¡Œæ—‹è½¬ï¼Œå¯¹æŸä¸€ä¸ªæ–¹å‘ $n_{i}$ æ¥è¯´ï¼Œæ—‹è½¬åçš„ Lighting ç›¸å½“äºå¯¹è¿™ä¸ªæ–¹å‘åº”ç”¨æ—‹è½¬çŸ©é˜µçš„é€†ï¼Œå³åœ¨åŸå§‹å¤©ç©ºç›’çš„ $R^{-1}n_{i}$ æ–¹å‘çš„ Lighting çš„å€¼ï¼Œæ‰€ä»¥ä¼ å…¥è®¡ç®—çƒè°å‡½æ•°çš„æ—‹è½¬çŸ©é˜µæ˜¯å¤©ç©ºç›’æ—‹è½¬çŸ©é˜µçš„é€†ï¼ˆç”±äºæ—‹è½¬çŸ©é˜µæ˜¯å•ä½é˜µï¼Œæ‰€ä»¥ç­‰ä»·äºè½¬ç½®ï¼‰ã€‚\ntools.js æœ‰ä¸€ä¸ªå‡½æ•° mat4Matrix2mathMatrixï¼ŒæŒ‰ç…§åå­—åº”è¯¥æ˜¯æŠŠ WebGL çš„çŸ©é˜µæ ¼å¼è½¬æ¢ä¸º math.js çš„çŸ©é˜µæ ¼å¼ï¼š\n1function mat4Matrix2mathMatrix(rotationMatrix){ 2 3\tlet mathMatrix = []; 4\tfor(let i = 0; i \u0026lt; 4; i++){ 5\tlet r = []; 6\tfor(let j = 0; j \u0026lt; 4; j++){ 7\tr.push(rotationMatrix[i*4+j]); 8\t} 9\tmathMatrix.push(r); 10\t} 11\treturn math.matrix(mathMatrix) 12 13} çœ‹èµ·æ¥å¥½åƒæ˜¯æŠŠä¸œè¥¿éƒ½æå‡ºæ¥å†å¡å›å»ï¼Œä¸è¿‡è¿™ä¿©çŸ©é˜µå­˜å‚¨æ–¹å¼æ˜¯ä¸ä¸€æ ·çš„ï¼ŒWebGL æ˜¯æŒ‰è¡Œä¼˜å…ˆå­˜å‚¨ï¼Œè€Œ math.js æ˜¯æŒ‰åˆ—ä¼˜å…ˆï¼Œå¦‚æœåšä¸‹æ‰“å°ï¼š\n1console.log(\u0026#34;WebGL mat4:\u0026#34;, cameraModelMatrix); 2console.log(\u0026#34;math matrix:\u0026#34;, mat4Matrix2mathMatrix(cameraModelMatrix)); ä¼šå‘ç°è¿™ä¿©çœ‹èµ·æ¥ä¼¼ä¹ä¸€æ ·ï¼Œä½†æ˜¯åœ¨å†…å­˜ä¸­å­˜å‚¨çš„æ–¹å¼æœ‰åŒºåˆ«ã€‚WebGL åœ¨å†…å­˜ä¸­ä»¥ä¸€ç»´æ•°ç»„å½¢å¼æ’å¸ƒï¼Œmath.js çš„çŸ©é˜µåœ¨å†…å­˜ä¸­æŒ‰è¡Œä»¥äºŒç»´æ•°ç»„å­˜å‚¨ï¼š\n$$ WebGLMatrix=\\begin{bmatrix} m_{00} \u0026 m_{10} \u0026 m_{20} \u0026m_{30} \\\\ m_{01} \u0026 m_{11} \u0026 m_{21} \u0026m_{31} \\\\ m_{02} \u0026 m_{12} \u0026 m_{22} \u0026m_{32} \\\\ m_{03} \u0026 m_{13} \u0026 m_{23} \u0026m_{33} \\end{bmatrix},\\quad mathMatrix=\\begin{bmatrix} \\left[ m_{00},m_{01},m_{02},m_{03} \\right] \\\\ \\left[ m_{10},m_{11},m_{12},m_{13} \\right] \\\\ \\left[ m_{20},m_{21},m_{22},m_{23} \\right] \\\\ \\left[ m_{30},m_{31},m_{32},m_{33} \\right] \\end{bmatrix} $$ æ‰€ä»¥ mat4Matrix2mathMatrix è¿™ä¸ªå‡½æ•°å®é™…ä¸Šå°±æ˜¯æŠŠ WebGL çŸ©é˜µè½¬åˆ° math.js çš„çŸ©é˜µï¼Œè¿˜åšäº†ä¸€æ¬¡è½¬ç½®ï¼Œç›¸å½“äºç›´æ¥æ‹¿åˆ°äº†æ—‹è½¬çŸ©é˜µçš„é€†ï¼Œå¯ä»¥åœ¨ getRotationPrecomputeL ä¸­ç›´æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°è·å¾—å¤©ç©ºç›’æ—‹è½¬çŸ©é˜µçš„é€†ï¼Œç„¶åå†ä¼ å…¥ computeSquareMatrix_xbyx è®¡ç®—çƒè°ç³»æ•°çš„æ—‹è½¬çŸ©é˜µã€‚å¦å¤–ï¼Œç”±äºè¯¥çŸ©é˜µæ˜¯ math.js å°è£…çš„ matrixï¼Œè°ƒç”¨ math.multiply æ–¹æ³•çš„è¿”å›å€¼è¿˜æ˜¯ matrixï¼ˆå³ä¾¿æ˜¯çŸ©é˜µä¹˜å‘é‡ï¼‰ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡ä¸‹æ ‡è®¿é—®ï¼Œå¯ä»¥ä½¿ç”¨ ._data[i] æˆ–è€…å…ˆç”¨ .toArray æ–¹æ³•æ‹¿åˆ°æ•°ç»„ï¼Œå†æŒ‰ä¸‹æ ‡è®¿é—®ã€‚\næœ€åå°† WebGLRenderer.js ç¬¬ 53 å’Œç¬¬ 63 è¡Œå–æ¶ˆæ³¨é‡Šï¼Œä¸å‡ºæ„å¤–å°±èƒ½çœ‹åˆ°æ¨¡å‹çš„ç€è‰²æ­£ç¡®è·Ÿéšå¤©ç©ºç›’æ—‹è½¬ï¼\n","permalink":"https://congyuxiaoyoudao.github.io/posts/assignments/games202-homework-2/","summary":"\u003cblockquote\u003e\n\u003cp\u003e(âˆ©^o^)âŠƒâ”â˜†ï¾Ÿ.*ï½¥ï½¡\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2 id=\"0x00-to-begin-with\"\u003e0x00 To begin with\u003c/h2\u003e\n\u003cp\u003eè¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e éƒ¨åˆ†è¯¾ç¨‹å†…å®¹å›é¡¾\u003c/li\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e GAMES202 ä½œä¸š 2\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eFor reference\u003c/strong\u003eğŸ‘‡ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eğŸ“ºB ç«™è§†é¢‘ï¼š\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://www.bilibili.com/video/BV1YK4y1T7yY/?spm_id_from=333.337.top_right_bar_window_custom_collection.content.click\u0026amp;vd_source=b6584cebba3a7a1a34d2f60d63bdc868\"\u003eGAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“¦ä»£ç ä»“åº“ï¼š\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://github.com/congyuxiaoyoudao/GAMES202_Homework/tree/working\"\u003econgyuxiaoyoudao/GAMES202_Homework at working\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“ƒ\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://dl.acm.org/doi/10.1145/15886.15902\"\u003eThe rendering equation | ACM SIGGRAPH Computer Graphics\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“ƒ\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://dl.acm.org/doi/10.1145/566654.566612\"\u003ePrecomputed radiance transfer for real-time rendering in dynamic, low-frequency lighting environments | ACM Transactions on Graphics\u003c/a\u003e\n\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003emaster åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2 id=\"0x01-å‰ç½®å‡†å¤‡-warm-up\"\u003e0x01 å‰ç½®å‡†å¤‡ Warm Up\u003c/h2\u003e\n\u003ch3 id=\"æ¸²æŸ“æ–¹ç¨‹-render-equation\"\u003eæ¸²æŸ“æ–¹ç¨‹ Render Equation\u003c/h3\u003e\n\u003cp\u003eJames T. Kajiyaï¼ˆæ²¡é”™å°±æ˜¯é‚£ä¸ªæå‡º Kajiya-Kay å¤´å‘ç€è‰²æ¨¡å‹çš„ Kajiyaï¼‰åœ¨ 1986 å¹´æå‡ºäº†æ¸²æŸ“æ–¹ç¨‹ï¼ˆThe Render Equationï¼‰ï¼ŒåŸè®ºæ–‡é‡Œé•¿è¿™æ ·ï¼š\u003c/p\u003e\n\u003cdiv\u003e$$\nI(x,x')=g(x,x')\\left[ \\epsilon(x,x')+\\int_{S}\\rho(x,x',x'')I(x',x'')dx'' \\right]\n$$\u003c/div\u003e\n\u003cp\u003eå½“ç„¶ç°åœ¨çœ‹å¾—æ›´èˆ’æœçš„å½¢å¼é•¿è¿™æ ·ï¼š\u003c/p\u003e","title":"Assignment 5. GAMES202 Homework 2"},{"content":" ğŸš© 0x00 To begin with è¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\nGAMES202 ä½œä¸š 1 For referenceğŸ‘‡ï¼š\nğŸ“º B ç«™è§†é¢‘ï¼š GAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“ ğŸ“¦ ä»£ç ä»“åº“ï¼š congyuxiaoyoudao/GAMES202_Homework at working master åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…\n0x01 Shadow Map å®Œæˆä¸¤ä¸ªä»»åŠ¡ç‚¹ï¼š\nç¬¬ä¸€ä¸ª Pass ä»¥å…‰æºä½œä¸ºç›¸æœºæ¸²æŸ“ä¸€å¼  ShadowMapï¼Œéœ€è¦ä¸º Shader ä¼ é€’æ­£ç¡®çš„ uLightMVP çŸ©é˜µï¼› ç¬¬äºŒä¸ª Pass è·å–å…‰æºä¼ é€’çš„ç»Ÿä¸€å˜é‡ FBO ï¼ˆShadowMapï¼‰ï¼Œéœ€è¦æ¯”è¾ƒå½“å‰ ShadingPoint çš„æ·±åº¦å€¼ä¸ ShadowMap ä¸Šè®°å½•çš„æ·±åº¦å€¼ï¼Œå¾—å‡ºå¯è§æ€§é¡¹ä¸ Shading ç»“æœç›¸ä¹˜ã€‚ DirectionalLight.js ä¸­ï¼Œå®Œå–„ CalcLightMVP å‡½æ•°ï¼š\n1\t// Model transform 2 mat4.translate(modelMatrix, modelMatrix, translate); 3 mat4.scale(modelMatrix, modelMatrix, scale); 4 5 // View transform 6 mat4.lookAt(viewMatrix, this.lightPos, this.focalPoint, this.lightUp); 7 8 // Projection transform 9 var r = 100; 10 var l = -r; 11 var t = 100; 12 var b = -t; 13 var n = 0.01; 14 // caution! Depth of far plane should be a bit more larger 15 var f = 400; 16 17 mat4.ortho(projectionMatrix, l, r, b, t, n, f); è¿œå¹³é¢éœ€è®¾ç½®å¾—ç¨å¾®å¤§ä¸€ç‚¹ï¼Œé¿å…å…‰æºçš„è§†é”¥èŒƒå›´æ— æ³•è¦†ç›–å…¨éƒ¨åœºæ™¯\nphongFragment.glsl ä¸­ï¼Œç”±äº ShadowMap è®°å½•çš„æ·±åº¦å€¼èŒƒå›´æ˜¯ 0-1ï¼Œæ‰€ä»¥åœ¨æ¯”è¾ƒä¹‹å‰éœ€è¦æŠŠå½“å‰ ShadingPoint åˆ°å…‰æºçš„è·ç¦»è½¬æ¢åˆ°è¯¥åŒºé—´ï¼Œå¯ä»¥é€è§†é™¤æ³•åè½¬æ¢è‡³ NDC åå†æ˜ å°„è‡³è¯¥èŒƒå›´ï¼š\n1Â vec3 shadowCoord = vPositionFromLight.xyz / vPositionFromLight.w; // NDC 2Â shadowCoord.xyz = (shadowCoord.xyz + 1.0) / 2.0; // -1~1 -\u0026gt; 0-1 ç„¶åä½¿ç”¨è¿™ä¸ªåæ ‡ä¼ å…¥ useShadowMap å‡½æ•°è¿›è¡Œæ¯”è¾ƒï¼š\n1float useShadowMap(sampler2D shadowMap, vec4 shadowCoord){ 2 float shadowMapDepth = unpack(texture2D(shadowMap, shadowCoord.xy)); 3 float visibility = shadowCoord.z \u0026gt; (shadowMapDepth + EPS) ? 0.0 : 1.0; 4 return visibility; 5} è¿™é‡Œçš„ EPSï¼ˆEpsilonï¼‰æ˜¯æ¡†æ¶å®šä¹‰çš„ Biasï¼Œä½œä¸ºé˜ˆå€¼åˆ¤æ–­æ˜¯å¦æ˜¾è‘—å¾—å¤§äºè®°å½•çš„æ·±åº¦ï¼Œç”¨äºä¿®æ­£è‡ªé®æŒ¡é—®é¢˜\nç„¶ååœ¨ main å‡½æ•°ä¸­è°ƒç”¨ useShadowMap å’Œ phongColor ç›¸ä¹˜å³å¯ã€‚\n0x02 PCF ç®€å•è¯´ä¸‹ PCF çš„åŸç†ï¼šé’ˆå¯¹å½“å‰ ShadingPointï¼Œä¸ä»…è€ƒå¯Ÿå…¶å¯¹åº”åƒç´ åœ¨ ShadowMap ä¸Šè®°å½•çš„æ·±åº¦ï¼Œè¿˜è¦è€ƒå¯Ÿè¯¥åƒç´ å‘¨å›´ï¼ˆé‚»å±…åƒç´ ï¼‰çš„æ·±åº¦ï¼Œå¹¶é€ä¸€æ¯”è¾ƒå¾—å‡ºå½“å‰ ShadingPoint åœ¨è¿™äº›åƒç´ ä¸Šçš„é®æŒ¡å…³ç³»ï¼Œç„¶åå°†è¿™äº›å€¼æ±‚å¹³å‡ï¼Œå¾—å‡ºä¸€ä¸ªå¹³å‡çš„é®æŒ¡å…³ç³»ï¼ˆä»‹äº 0-1 ä¹‹é—´ï¼‰ã€‚è¦ç‚¹ï¼š\nå¹¶éå¯¹ ShadowMap è¿›è¡Œæ»¤æ³¢ æ›´åƒæ˜¯å¯¹æ·±åº¦æ¯”è¾ƒçš„ç»“æœè¿›è¡Œæ»¤æ³¢ æ¡†æ¶æ¨èåœ¨åœ†ç›˜çŠ¶æ»¤æ³¢æ ¸ä¸­éšæœºé‡‡æ ·ï¼Œå¯ä»¥ç”Ÿæˆæ›´åŠ è‡ªç„¶çš„æ¨¡ç³Šé˜´å½±ï¼Œè¦å®Œæˆçš„ä»»åŠ¡å¦‚ä¸‹ï¼š\nè°ƒç”¨ä»»ä¸€éšæœºé‡‡æ ·å‡½æ•°ï¼Œå¡«å……é‡‡æ ·åç§»æ•°ç»„ï¼ˆpoissonDisk[NUM_SAMPLES]ï¼‰; è€ƒå¯Ÿæ¯ä¸ªåç§»ååƒç´ è®°å½•çš„æ·±åº¦å¹¶ä¸å½“å‰ ShadingsPoint çš„æ·±åº¦è¿›è¡Œæ¯”è¾ƒï¼Œç´¯åŠ å¯è§æ€§é¡¹ï¼› è¿”å›å¹³å‡çš„å¯è§æ€§é¡¹ã€‚ è¿™é‡Œä½¿ç”¨ poissonDiskSamples ç”Ÿæˆéšæœºåç§»ï¼š\nè¿™æ®µä»£ç å°†ä¼šå¡«å……é‡‡æ ·åç§»æ•°ç»„ï¼Œå€¼å½¢å¦‚ï¼š\n$$ \\begin{aligned} possionDisk_{i}=\u0026(\\cos\\theta,\\sin \\theta)\\cdot R \\\\ a_{0}\\leq \\theta\\leq a_{0}\u0026+2\\pi \\cdot rings \\\\ \\frac{1}{samples}^{3/4}\u0026\\leq R\\leq 1 \\end{aligned} $$ åœ¨å¡«å……æ•°ç»„åï¼Œå¾ªç¯é‡‡æ ·æ¯ä¸€ä¸ªåç§»åçš„åƒç´ ï¼Œæ¯”è¾ƒæ·±åº¦ï¼Œç´¯åŠ å¯è§æ€§é¡¹ï¼Œæœ€åæ±‚å…¶å‡å€¼ï¼š\n1// filter size is filter window size in pixels defined by FILTER_RADIUS / resolution 2float PCF(sampler2D shadowMap, vec4 coords, float filterSize) { 3 4 // STEP 1: uniform disk sampling generate a group of random sample points 5 poissonDiskSamples(coords.xy); 6 // Step 2: sample each point and accumulate each visibility component 7 float sum = 0.0; 8 for (int i = 0; i \u0026lt; PCF_NUM_SAMPLES; i++) { 9 vec2 sampleOffset = poissonDisk[i] * filterSize; 10 vec2 uv = coords.xy + sampleOffset; 11 float shadowMapDepth = unpack(texture2D(shadowMap, uv)); 12 float visibility = coords.z \u0026gt; (shadowMapDepth + EPS) ? 0.0 : 1.0; 13 sum += visibility; 14 } 15 // Step 3: return averaged visibility 16 return sum / float(PCF_NUM_SAMPLES); 17} ç”±äºé‡‡æ ·çš„åç§»åœ¨ UV ç©ºé—´ä¸­è¿›è¡Œï¼Œæ‰€ä»¥éœ€è¦é™¤ä»¥è´´å›¾åˆ†è¾¨ç‡ï¼Œæ¡†æ¶ç»™çš„æ˜¯ 2048ï¼Œæ­¤å¤–ï¼Œä¹˜ä¸€ä¸ª FILTER_RADIUS è°ƒæ•´åç§»èŒƒå›´å¤§å°ï¼Œè¯¥å€¼è¶Šå¤§ï¼Œé˜´å½±è¶Šè½¯\nåŒæ ·åœ¨ main å‡½æ•°ä¸­è°ƒç”¨ PCF å’Œ phongColor ç›¸ä¹˜å³å¯ã€‚\n0x03 PCSS è§‚å¯Ÿç°å®çš„é˜´å½±ï¼Œä¼šå‘ç°åœ¨é è¿‘æŠ•å°„é˜´å½±çš„éšœç¢ç‰©æ—¶ï¼Œé˜´å½±ä¼šæ›´åŠ ç¡¬ï¼Œåä¹‹æ›´è½¯ã€‚PCSS åœ¨ PCF çš„åŸºç¡€ä¸Šéœ€è¦æ ¹æ®é®æŒ¡ç‰©çš„è·ç¦»æ”¹å˜æ»¤æ³¢æ ¸çš„å¤§å°ï¼Œä»¥è°ƒèŠ‚é˜´å½±è½¯ç¡¬ï¼Œè¦å®Œæˆçš„ä»»åŠ¡å¦‚ä¸‹ï¼š\nè·å¾—é®æŒ¡ç‰©çš„å¹³å‡æ·±åº¦ï¼Œå®Œå–„ findBlocker å‡½æ•°ï¼› æ ¹æ®ç›¸ä¼¼ä¸‰è§’å½¢åŸç†è®¡ç®—åŠå½±å¤§å°ï¼ˆpenumbra sizeï¼‰ï¼› æ ¹æ®åŠå½±å¤§å°è°ƒæ•´æ»¤æ³¢æ ¸å¤§å°ï¼Œè°ƒç”¨ PCFã€‚ è¯¾ç¨‹è§†é¢‘ç»™å‡ºäº†ä¸€ç§ç¡®å®šå¯èƒ½é®æŒ¡å½“å‰ ShadingPoint çš„èŒƒå›´ï¼Œå³è¿æ¥ ShadingPoint åˆ° Lightï¼Œåœ¨è¿‘å¹³é¢å¤„æ‰€æˆªçš„åŒºåŸŸã€‚\nä¹Ÿæ˜¯ç›¸ä¼¼ä¸‰è§’å½¢ï¼Œç»™å®šå…‰æºå®½åº¦å³å¯è®¡ç®—ï¼š\n$$ blockerSearchRadius=W_{light} \\cdot \\frac{d_{PosToLight}-d_{near}}{d_{PosToLight}} $$ ç„¶åå°†è¿™ä¸ªèŒƒå›´ä¹˜ä¸Šåç§»ï¼Œåœ¨æœ€ç»ˆçš„åç§»èŒƒå›´å†…éšæœºé‡‡æ ·ï¼Œä»…è®°å½•å¹¶ç´¯åŠ ä¸ºé®æŒ¡ç‰©çš„åƒç´ æ·±åº¦ï¼Œæœ€åæ±‚å¾—å¹³å‡é®æŒ¡ç‰©æ·±åº¦ã€‚\n1float findBlocker( sampler2D shadowMap, vec2 uv, float zReceiver ) { 2 float avgBlockerDepth = 0.0; 3 float blockerSum = 0.0; 4 poissonDiskSamples(uv); 5 6 // use proj on near plane to define search radius 7 float blockerSearchRadius = LIGHT_WIDTH_UV * (vPositionFromLight.z - NEAR_PLANE) / vPositionFromLight.z ; 8 9 for (int i = 0; i \u0026lt; BLOCKER_SEARCH_NUM_SAMPLES; i++) { 10 vec2 sampleOffset = poissonDisk[i] * blockerSearchRadius; 11 vec2 uvSample = uv + sampleOffset; 12 float shadowMapDepth = unpack(texture2D(shadowMap, uvSample)); 13 if (shadowMapDepth \u0026lt; zReceiver) { 14 avgBlockerDepth += shadowMapDepth; 15 blockerSum ++; 16 } 17 } 18 19 if(blockerSum == 0.0) return 1.0; // no blocker give a max depth value 20 else return avgBlockerDepth / blockerSum; 21} ä¹‹ååœ¨ PCSS ä¸­è°ƒç”¨ä¹‹ï¼Œå†ä¸€æ¬¡ä½¿ç”¨ç›¸ä¼¼ä¸‰è§’å½¢è·å¾—åŠå½±å¤§å°ï¼Œå°†å…¶ä½œä¸ºæ»¤æ³¢å™¨å¤§å°ä¼ å…¥ PCFã€‚\n1float PCSS(sampler2D shadowMap, vec4 coords){ 2 3 // STEP 1: avgblocker depth 4 float avgBlockerDepth = findBlocker(shadowMap, coords.xy, coords.z); 5 // STEP 2: penumbra size 6 // LIGHT_WIDTH_UV is defined by (LIGHT_WIDTH / resolution) 7 float penumbraSize = (coords.z - avgBlockerDepth) * LIGHT_WIDTH_UV / avgBlockerDepth; 8 // STEP 3: use penumbra size to define filter size 9 float visibility = PCF(shadowMap, coords, penumbraSize); 10 return visibility; 11 12} è¿™é‡Œç›¸ä¼¼ä¸‰è§’å½¢æ±‚è§£æ—¶ç›´æ¥ä½¿ç”¨å±å¹•ç©ºé—´ç¯å®½åº¦ï¼Œå¯ä»¥ç›´æ¥å°†å¾—åˆ°çš„åŠå½±ç›´å¾„ä½œä¸ºæ»¤æ³¢å™¨å¤§å°ä¼ å…¥ PCFï¼Œæ³¨æ„ç»Ÿä¸€çš„é‡çº²\nåŒæ ·åœ¨ main å‡½æ•°ä¸­è°ƒç”¨ PCSS å’Œ phongColor ç›¸ä¹˜å³å¯ã€‚\n0x04 Bonus å¤šå…‰æº è¦å®ç°å¤šå…‰æºï¼Œå°±éœ€è¦ä¸ºæ¯ä¸ªå…‰æºç»˜åˆ¶ä¸€å¼  ShadowMapï¼Œå¸¸è§„çš„æ€è·¯æ˜¯ä¸ºæ¯å¼  ShadowMap ç»‘å®šä¸€ä¸ª uniformï¼Œç„¶å Shader é‡Œä¸€ä¸€æ¯”è¾ƒï¼Œåˆæˆæœ€ç»ˆçš„é˜´å½±ã€‚ä½†æ˜¯è¿™æ ·è¿˜éœ€è¦å‘ Shader ä¼ ä¸åŒçš„å…‰æºçš„ ulightMVP çŸ©é˜µï¼Œéšç€å…‰æºæ•°é‡å¢åŠ ï¼Œå˜é‡ä¼šå¼‚å¸¸åœ°å¤šï¼Œä¸æ˜¯å¾ˆä¼˜é›…ã€‚\nè¿™ç§æ€è·¯è¦å¹²çš„äº‹ï¼š\nä¸ºæ¯ä¸ªå…‰æºæ¸²æŸ“å…¶ç‹¬ç«‹çš„ ShadowMap å°†æ¯ä¸ªå…‰æºçš„ ShadowMap ç»‘åˆ° Material çš„ uniform ä¸­ å°†æ¯ä¸ªå…‰æºçš„ uLightPos å’Œ ulightMVP ä¼ é€’ç»™ Shader åœ¨ Shader ä¸­éå†æ¯å¼  ShadowMapï¼Œç´¯åŠ å¯è§æ€§é¡¹ æœ¬æ¥æ˜¯æƒ³ç”¨è¿™ä¸ªæ€è·¯çš„ï¼Œä½†æ˜¯æ¡†æ¶è¦åŠ¨çš„ä¸œè¥¿å¤ªå¤šäº†ï¼Œé‚æ”¾å¼ƒ\nGPUGems ä¸­ä½¿ç”¨ä¸€å¼  ShadowMap çº¹ç†ï¼š\nChapter 10. Parallel-Split Shadow Maps on Programmable GPUs \u0026hellip;we reuse a single shadow-map texture in each rendering pass\nç”Ÿæˆ ShadowMap åé©¬ä¸Šåˆæˆé˜´å½±ï¼Œä¹‹åçš„å…‰æºå°±å¯ä»¥å¤ç”¨è¿™ä¸ª Textureï¼Œç„¶ååªéœ€å°†æ¯ä¸ªå…‰æºçš„è´¡çŒ®ç´¯åŠ å³å¯ã€‚\né‡‡ç”¨èŠ±æ¡‘æ°çš„åšæ³•ï¼Œæ¯ä¸ªå…‰æºéƒ½èµ°ä¸€æ¬¡ Camera Passï¼Œç„¶åæ··åˆã€‚\nå› ä¸ºä¸€ä¸ª material åªèƒ½å­˜ä¸€å¼  ShadowMapï¼Œæ‰€ä»¥ä¸€ä¸ªæè´¨è¦ä¸ºæ¯ä¸ªå…‰æºéƒ½ build ä¸€éï¼Œä¹Ÿæ˜¯èŠ±æ¡‘æ°çš„åšæ³•ï¼Œç”¨ä¸€ä¸ªç´¢å¼•åŒºåˆ† material å¯¹åº”çš„å…‰æºï¼Œå…ˆä»çˆ¶ç±» Material æ”¹èµ·ï¼ŒMaterial.js ä¸­ï¼š\nç„¶åæ˜¯ PhongMaterial.js ä¸­ï¼Œåœ¨æ„é€ å‡½æ•°å’Œ build å‡½æ•°ä¸­å¢åŠ ç¯å…‰ç´¢å¼•ï¼š\nShadowMaterial.js ä¸­ï¼ŒåŒæ ·ï¼š\nloadOBJ.js ä¸­ï¼Œä¸ºæ¯ä¸ªå…‰æº build ä¸€ä¸ªæè´¨ï¼š\nengine.js ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿ä¸€ç‚¹å°è£…ä¸€ä¸ªåŠ æ–¹å‘å…‰çš„å‡½æ•°ï¼š\n1function AddDirectionalLight(renderer, intensity, color, position, focalPoint, up, hasShadowMap) { 2 const directionLight = new DirectionalLight(intensity, color, position, focalPoint, up, hasShadowMap, renderer.gl); 3 renderer.addLight(directionLight); 4} ç„¶åæ”¹ä¸€ä¸‹ä½ç½®å’Œé¢œè‰²ï¼Œå†æ¬¡å¢åŠ ä¸¤ç›æ–¹å‘å…‰ï¼š\n1AddDirectionalLight(renderer, 5000, [1, 0, 1], lightPos, focalPoint, lightUp, true); 2lightPos = [0, 80, -80]; 3AddDirectionalLight(renderer, 500, [0, 1, 1], lightPos, focalPoint, lightUp, true); 4lightPos = [80, 80, 0]; 5AddDirectionalLight(renderer, 500, [1, 1, 0], lightPos, focalPoint, lightUp, true); æœ€å WebGLRendererä¸­.js ä¸­ï¼Œåªä¸ºå¯¹åº”å…‰æºç´¢å¼•çš„ material è¿›è¡Œç»˜åˆ¶ï¼Œç„¶åæŠŠå…¶ä½™å…‰æºçš„ç»˜åˆ¶ç»“æœå åˆ°ç¬¬ä¸€ä¸ªå…‰æºçš„ç»˜åˆ¶ç»“æœï¼ˆFrameBufferï¼‰ä¸Šï¼š\nè¿™é‡ŒæŒ‰æˆ‘åŸæ¥å†™çš„æŠŠ mesh çš„æ—‹è½¬æ”¾ Camera Pass é‡Œäº†ï¼Œæ‰€ä»¥åŠ äº†å¤šå…‰æºä¼šå‡ºç°å¾ˆä¸¥é‡çš„æŠ–åŠ¨ï¼Œæ‹¿åˆ°å¤–é¢å³å¯\næœ€åå†è®©å…‰æºè½¬èµ·æ¥ï¼š\n1let lightPos = this.lights[l].entity.lightPos; 2lightPos = vec3.rotateY(lightPos, lightPos, this.lights[l].entity.focalPoint, degreeToRadian(10) * deltaTime); 3this.lights[l].entity.lightPos = lightPos; å¤§åŠŸå‘Šæˆï¼Œçœ‹ä¸€ä¸‹ä¸‰ä½“è¿åŠ¨ï¼š\nåŠ¨æ€ç‰©ä½“ ç›®å‰å¯ä»¥çœ‹åˆ°ç‰©ä½“å’Œå…‰æºæ˜¯ä¸æ”¯æŒæ—‹è½¬çš„ï¼Œè¿™é‡ŒåŠ ä¸Šã€‚ä¸åŠ¨è„‘å­ä¸€ç‚¹çš„åŠæ³•æ˜¯å…¨å±€æœç´¢ Transformï¼Œç„¶åä¸€ä¸ªä¸€ä¸ªåŠ ä¸Šæ—‹è½¬å°±è¡Œï¼Œè¿™é‡Œç¬”è€…å°½é‡ç»™å‡ºæœ‰é€»è¾‘çš„ä¿®æ”¹æ–¹å¼ã€‚\næ¡†æ¶ä¸­çš„æ¸²æŸ“å¾ªç¯ä½äº engine.jsï¼Œæœ€åæœ‰ä¸ª setTransform å‡½æ•°ï¼Œåœ¨è¿™é‡ŒåŠ ä¸Šæ—‹è½¬å˜æ¢ï¼š\n1function setTransform(t_x, t_y, t_z, r_x, r_y, r_z, s_x, s_y, s_z) { 2\treturn { 3\tmodelTransX: t_x, 4\tmodelTransY: t_y, 5\tmodelTransZ: t_z, 6\t// Begin TOP changes 7\tmodelRotateX: r_x, 8\tmodelRotateY: r_y, 9\tmodelRotateZ: r_z, 10\t// End TOP changes 11\tmodelScaleX: s_x, 12\tmodelScaleY: s_y, 13\tmodelScaleZ: s_z, 14\t}; 15} ç„¶ååœ¨ä¸Šé¢éƒ¨åˆ†ä»£ç è®¾ç½®æ¨¡å‹å˜æ¢ä¸­åŠ ä¸Šæ—‹è½¬çš„å‚æ•°ï¼Œç›®å‰å…ˆç»™ 0ï¼š\n1let floorTransform = setTransform(0, 0, -30, 0, 0, 0, 4, 4, 4); 2let obj1Transform = setTransform(0, 0, 0, 0, 0, 0, 20, 20, 20); 3let obj2Transform = setTransform(40, 0, -40, 0, 0, 0, 10, 10, 10); è¿™ä¸ªå˜æ¢ä½œä¸º loadOBJ å‡½æ•°çš„å‚æ•°ç”¨äºè®¾ç½®æ¨¡å‹å˜æ¢ï¼Œå…ˆçœ‹çœ‹è¿™ä¸ªå‡½æ•°å¹²äº†ä»€ä¹ˆï¼ˆloadOBJ.jsï¼‰ï¼š\næ¶‰åŠåˆ° transform çš„åœ°æ–¹å°±è¿™äº›ï¼Œä¸€ä¸ªæ˜¯ Mesh çš„ Ctorï¼Œå¦ä¸€ä¸ªæ˜¯ material çš„ build å‡½æ•°ã€‚\nåœ¨ Mesh.js ä¸­ï¼Œæ›´æ”¹å…¶æ„é€ å‡½æ•°ï¼Œå¢åŠ å¯¹æ—‹è½¬çš„æ”¯æŒï¼š\n1// TRSTransform Ctor 2 constructor(translate = [0, 0, 0], rotate = [0, 0, 0], scale = [1, 1, 1]) { 3 this.translate = translate; 4\tthis.rotate = rotate; 5 this.scale = scale; 6 } 7 8// ... 9 10// Mesh Ctor 11\tconst modelTranslation = [transform.modelTransX, transform.modelTransY, transform.modelTransZ]; 12\tconst modelRotation = [transform.modelRotateX, transform.modelRotateY, transform.modelRotateZ]; 13\tconst modelScale = [transform.modelScaleX, transform.modelScaleY, transform.modelScaleZ]; 14\tlet meshTrans = new TRSTransform(modelTranslation, modelRotation, modelScale); å›åˆ° loadOBJ.jsï¼Œä»ä¼ å…¥çš„ transform ä¸­è§£ææ¨¡å‹æ—‹è½¬ï¼Œç„¶åä¼ å…¥ material çš„ build å‡½æ•°ï¼š\n1// object.traverse 2let Translation = [transform.modelTransX, transform.modelTransY, transform.modelTransZ]; 3let Rotation = [transform.modelRotateX, transform.modelRotateY, transform.modelRotateZ]; 4let Scale = [transform.modelScaleX, transform.modelScaleY, transform.modelScaleZ]; 5 6material = buildPhongMaterial(colorMap, mat.specular.toArray(), light, Translation, Rotation, Scale, \u0026#34;./src/shaders/phongShader/phongVertex.glsl\u0026#34;, \u0026#34;./src/shaders/phongShader/phongFragment.glsl\u0026#34;); 7shadowMaterial = buildShadowMaterial(light, Translation, Rotation, Scale, \u0026#34;./src/shaders/shadowShader/shadowVertex.glsl\u0026#34;, \u0026#34;./src/shaders/shadowShader/shadowFragment.glsl\u0026#34;); ç„¶åè‡ªç„¶éœ€è¦å¯¹ material çš„å˜æ¢è¿›è¡Œæ”¯æŒï¼Œä¾æ¬¡åœ¨ PhongMaterial.js å’Œ ShadowMaterial.js ä¸­ä¸ºä¸Šè¿°åˆ›å»ºæè´¨çš„å‡½æ•°æ·»åŠ å¯¹æ—‹è½¬çš„æ”¯æŒï¼š\nPhongMaterial.js ä¸­ï¼š\n1// PhongMaterial Ctor 2 constructor(color, specular, light, translate, rotate, scale, vertexShader, fragmentShader) { 3 let lightMVP = light.CalcLightMVP(translate, rotate, scale); 4 5// material builder function 6async function buildPhongMaterial(color, specular, light, translate, rotate, scale, vertexPath, fragmentPath) { 7 8 let vertexShader = await getShaderString(vertexPath); 9 let fragmentShader = await getShaderString(fragmentPath); 10 return new PhongMaterial(color, specular, light, translate, rotate, scale, vertexShader, fragmentShader); 11} åŒæ ·ï¼ŒShadowMaterial.js ä¸­ï¼š\n1class ShadowMaterial extends Material { 2 constructor(light, translate, rotate, scale, vertexShader, fragmentShader) { 3 let lightMVP = light.CalcLightMVP(translate, rotate, scale); 4 super({ 5 \u0026#39;uLightMVP\u0026#39;: { type: \u0026#39;matrix4fv\u0026#39;, value: lightMVP } 6 }, [], vertexShader, fragmentShader, light.fbo); 7 } 8} 9 10async function buildShadowMaterial(light, translate, rotate, scale, vertexPath, fragmentPath) { 11 let vertexShader = await getShaderString(vertexPath); 12 let fragmentShader = await getShaderString(fragmentPath); 13 return new ShadowMaterial(light, translate,rotate, scale, vertexShader, fragmentShader); 14} æ³¨æ„åˆ°ï¼Œä¸Šé¢ä¼ é€’çš„ lightMVP çŸ©é˜µæ˜¯é€šè¿‡ CalcLightMVP è®¡ç®—çš„ï¼Œæ‰€ä»¥ä¸‹ä¸€æ­¥ä¸ºå…¶å¢åŠ å¯¹æ—‹è½¬çš„æ”¯æŒï¼ŒDirectionalLight.js ä¸­ï¼š\n1 CalcLightMVP(translate, rotate, scale) { 2 let lightMVP = mat4.create(); 3 let modelMatrix = mat4.create(); 4 let viewMatrix = mat4.create(); 5 let projectionMatrix = mat4.create(); 6 7 // Model transform 8 mat4.translate(modelMatrix, modelMatrix, translate); 9 mat4.rotateX(modelMatrix, modelMatrix, rotate[0]); 10 mat4.rotateY(modelMatrix, modelMatrix, rotate[1]); 11 mat4.rotateZ(modelMatrix, modelMatrix, rotate[2]); 12 mat4.scale(modelMatrix, modelMatrix, scale); è®°å¾—æŠŠä¸Šé¢ç¯çš„ Meshï¼ˆcubeï¼‰æ¨¡å‹å˜æ¢çš„æ—‹è½¬å‚æ•°åŠ ä¸Š\n1// DirectionalLight Ctor 2this.mesh = Mesh.cube(setTransform(0, 0, 0, 0, 0, 0, 0.2, 0.2, 0.2, 0)); æœ€åï¼Œæ¸²æŸ“å¾ªç¯æ¯ä¸€å¸§ç»˜åˆ¶æ—¶ä¼šè°ƒç”¨ WebGLRenderer çš„ render å‡½æ•°ï¼Œåè€…åˆä¼šä¸ºæ¯ä¸€ä¸ªå®ä½“è°ƒç”¨å…¶ meshRender çš„ draw å‡½æ•°ï¼Œè¯¥å‡½æ•°éœ€è¦è°ƒç”¨ bindCameraParametersï¼Œè¿™é‡Œå‘ Shader ä¼ é€’äº†ä½œä¸º uniform çš„æ¨¡å‹å˜æ¢çŸ©é˜µï¼Œåœ¨è¿™é‡ŒåŠ ä¸Šæ—‹è½¬ï¼ˆMeshRender.js ä¸­ï¼‰ï¼š\n1mat4.rotateX(modelMatrix, modelMatrix, this.mesh.transform.rotate[0]); 2mat4.rotateY(modelMatrix, modelMatrix, this.mesh.transform.rotate[1]); 3mat4.rotateZ(modelMatrix, modelMatrix, this.mesh.transform.rotate[2]); å¯¹æ—‹è½¬çš„æ”¯æŒåˆ°è¿™é‡Œå°±å·®ä¸å¤šäº†ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦è®©æ¨¡å‹éšç€æ—¶é—´æŒ‰ Y è½´æ—‹è½¬ï¼Œæˆ‘ä»¬å¯ä»¥ä»å¾ªç¯é‡Œæ‹¿åˆ°å½“å‰æ—¶é—´ï¼Œç„¶åä¸ä¿å­˜çš„æ—¶é—´ç›¸å‡å¾—åˆ°å·®å€¼ï¼Œå‘ render å‡½æ•°ä¼ å…¥è¿™ä¸ªå·®å€¼ç„¶åæ¯å¸§ç´¯åŠ ä¸€ä¸ªæ—‹è½¬è§’åº¦å³å¯ã€‚\næœ€åï¼Œåœ¨ WebGLRenderer.jsï¼Œrender å‡½æ•°ä¸­æ¯å¸§éœ€è¦æ›´æ–°å…‰æºå¯¹åº”çš„ FBOï¼ˆå¸§ç¼“å†²åŒºï¼‰ï¼Œå¦åˆ™ ShadowMap çš„å†…å®¹ä¼šæ¯å¸§å åŠ ï¼Œä»¥åŠæ›´æ–°ä¼ å…¥ Shader çš„ uniform å˜é‡ã€‚\nè¿™é‡Œ updateMVP æ˜¯æˆ‘è‡ªå®šä¹‰çš„ä¸€ä¸ªå‡½æ•°ï¼š\n1 updateMVP(mesh, lightEntity){ 2 let translate = mesh.transform.translate; 3 let rotate = mesh.transform.rotate; 4 let scale = mesh.transform.scale; 5 let MVP = lightEntity.CalcLightMVP(translate, rotate, scale); 6 return MVP; 7 } å®Œæˆä¹‹åå°±å¯ä»¥è½¬åœˆåœˆ~\n","permalink":"https://congyuxiaoyoudao.github.io/posts/assignments/games202-homework-1/","summary":"\u003chr\u003e\n\u003ch2 id=\"-0x00-to-begin-with\"\u003eğŸš© 0x00 To begin with\u003c/h2\u003e\n\u003cp\u003eè¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e GAMES202 ä½œä¸š 1\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eFor reference\u003c/strong\u003eğŸ‘‡ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eğŸ“º B ç«™è§†é¢‘ï¼š\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://www.bilibili.com/video/BV1YK4y1T7yY/?spm_id_from=333.337.top_right_bar_window_custom_collection.content.click\u0026amp;vd_source=b6584cebba3a7a1a34d2f60d63bdc868\"\u003eGAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“¦ ä»£ç ä»“åº“ï¼š\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://github.com/congyuxiaoyoudao/GAMES202_Homework/tree/working\"\u003econgyuxiaoyoudao/GAMES202_Homework at working\u003c/a\u003e\n\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003emaster åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2 id=\"0x01-shadow-map\"\u003e0x01 Shadow Map\u003c/h2\u003e\n\u003cp\u003eå®Œæˆä¸¤ä¸ªä»»åŠ¡ç‚¹ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eç¬¬ä¸€ä¸ª Pass ä»¥å…‰æºä½œä¸ºç›¸æœºæ¸²æŸ“ä¸€å¼  ShadowMapï¼Œéœ€è¦ä¸º Shader ä¼ é€’æ­£ç¡®çš„ \u003ccode\u003euLightMVP\u003c/code\u003e çŸ©é˜µï¼›\u003c/li\u003e\n\u003cli\u003eç¬¬äºŒä¸ª Pass è·å–å…‰æºä¼ é€’çš„ç»Ÿä¸€å˜é‡ FBO ï¼ˆShadowMapï¼‰ï¼Œéœ€è¦æ¯”è¾ƒå½“å‰ ShadingPoint çš„æ·±åº¦å€¼ä¸ ShadowMap ä¸Šè®°å½•çš„æ·±åº¦å€¼ï¼Œå¾—å‡ºå¯è§æ€§é¡¹ä¸ Shading ç»“æœç›¸ä¹˜ã€‚\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eDirectionalLight.js ä¸­ï¼Œå®Œå–„ \u003ccode\u003eCalcLightMVP\u003c/code\u003e å‡½æ•°ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%204.GAMES202HW1/202504151505787.png#center\"\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-glsl\" data-lang=\"glsl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 1\u003c/span\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"c1\"\u003e// Model transform\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 2\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003emat4\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etranslate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodelMatrix\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emodelMatrix\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etranslate\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 3\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003emat4\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003escale\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodelMatrix\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emodelMatrix\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003escale\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 4\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 5\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// View transform\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 6\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003emat4\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elookAt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eviewMatrix\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elightPos\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efocalPoint\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elightUp\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 7\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 8\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// Projection transform\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 9\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003er\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e10\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003el\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e11\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e12\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eb\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e13\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.01\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e14\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// caution! Depth of far plane should be a bit more larger\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e15\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e400\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e16\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e17\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003emat4\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eortho\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprojectionMatrix\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003el\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003eè¿œå¹³é¢éœ€è®¾ç½®å¾—ç¨å¾®å¤§ä¸€ç‚¹ï¼Œé¿å…å…‰æºçš„è§†é”¥èŒƒå›´æ— æ³•è¦†ç›–å…¨éƒ¨åœºæ™¯\u003c/p\u003e","title":"Assignment 4. GAMES202 Homework 1"},{"content":" å¼€ä¸ªæ–°å‘ï¼Œä¹‹å‰å›«å›µåæ£åœ°è¿‡äº†ä¸€é 202ï¼Œç°åœ¨å¿˜å¾—å·®ä¸å¤šäº†ï¼Œè¯¥æ¡èµ·æ¥ã€‚æ­£å¥½ç»™æ¯ç‡¥çš„ç”Ÿæ´»å¢æ·»ä¸€ç‚¹è‰²å½©ï¼ˆï¼Ÿï¼‰ï¼Œæœ€è¿‘æ¯”è¾ƒå¿™ä½†è¿˜æ˜¯äº‰å–ä¸€å‘¨åšä¸€ä¸ªä½œä¸š\nğŸš© 0x00 To begin with è¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\nGAMES202 ä½œä¸š 0 ä¸åŒ…å«ä½œä¸šæ¡†æ¶åˆ†æ For referenceğŸ‘‡ï¼š\nğŸ“º B ç«™è§†é¢‘ï¼š GAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“ ğŸ“¦ ä»£ç ä»“åº“ï¼š congyuxiaoyoudao/GAMES202_Homework at working master åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…\nâš™ï¸ 0x01 Configuration ç¯å¢ƒé…ç½® é€‰æ‹©ä½¿ç”¨ VSCode æ’ä»¶æ­å»ºæœ¬åœ°æœåŠ¡å™¨ï¼Œåœ¨æ‰©å±•ä¸­æœç´¢ Live Serverï¼Œå®‰è£…æ­¤æ’ä»¶ã€‚\nåœ¨ç¼–è¾‘ Html ä»£ç çª—å£æŒ‰ F1ï¼ˆæˆ–è€…å³é”®ï¼‰é€‰æ‹© Live Server: Open with Live Serverï¼Œéšåä¼šè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼Œå¯¼èˆªè‡³æœ¬åœ°æœåŠ¡å™¨ç«¯å£ï¼Œä¸€åˆ‡æ­£å¸¸çš„è¯æ˜¯ä¸‹é¢è¿™ä¸ªæ•ˆæœï¼š\nå¯ä»¥ä½¿ç”¨é¼ æ ‡å’Œå³ä¸Šè§’çš„æ§åˆ¶é¢æ¿è¿›è¡Œä¸€äº›ç®€å•çš„äº¤äº’ã€‚\nå¦‚æœé‡åˆ°æ¨¡å‹è´´å›¾åŠ è½½ä¸å‡ºæ¥ï¼ˆåªæœ‰ 202 å­—æ ·ï¼‰ï¼Œå¯ä»¥é€‰æ‹©å¤šåˆ·æ–°å‡ æ¬¡ã€‚æˆ–è€…ç›´æ¥åœ¨åŠ è½½è„šæœ¬å‰é¢„åŠ è½½è´´å›¾ï¼Œå¯ä»¥æ ¹æ²»è¿™ä¸ªé—®é¢˜ã€‚\n1\u0026lt;link rel=\u0026#34;preload\u0026#34; href=\u0026#34;assets/mary/MC003_Kozakura_Mari.png\u0026#34; as=\u0026#34;image\u0026#34; type=\u0026#34;image/png\u0026#34; crossorigin/\u0026gt; ğŸ¤” 0x02 Blinn-Phong Shading Model æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼ŒCV å·¥ç¨‹å¸ˆ\nä½¿ç”¨ GLSL ç¼–å†™ Shader å¦‚æœä½¿ç”¨å­—ç¬¦ä¸²çš„æ–¹å¼å¼•å…¥ Shaderï¼Œå°±åœ¨ InternalShader.js ä¸­åŠ ä¸Šï¼š\n1// Phong Shader 2 3const PhongVertexShader = ` 4// attribute is vertex input data 5attribute vec3 aVertexPosition; 6attribute vec3 aNormalPosition; 7attribute vec2 aTextureCoord; 8 9// uniform is consistent/global data between VS/PS in a drawcall 10uniform mat4 uModelViewMatrix; 11uniform mat4 uProjectionMatrix; 12 13// varying is data need to be interpolated from VS to PS 14varying highp vec2 vTextureCoord; 15varying highp vec3 vFragPos; 16varying highp vec3 vNormal; 17 18void main(void) { 19 20Â vFragPos = aVertexPosition; 21Â vNormal = aNormalPosition; 22 // MVP 23Â gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(aVertexPosition, 1.0); 24 25Â vTextureCoord = aTextureCoord; 26} 27`; 28 29const PhongFragmentShader = ` 30#ifdef GL_ES 31precision mediump float; 32#endif 33uniform sampler2D uSampler; 34//binn 35uniform vec3 uKd; 36uniform vec3 uKs; 37uniform vec3 uLightPos; 38uniform vec3 uCameraPos; 39uniform float uLightIntensity; 40uniform int uTextureSample; 41 42varying highp vec2 vTextureCoord; 43varying highp vec3 vFragPos; 44varying highp vec3 vNormal; 45 46void main(void) { 47Â vec3 color; 48Â if (uTextureSample == 1) { 49\t// Gamma correction 50\tcolor = pow(texture2D(uSampler, vTextureCoord).rgb, vec3(2.2)); 51Â } else { 52Â // default color 53Â color = uKd; 54Â } 55 56Â vec3 ambient = 0.05 * color; 57 58 // lambertian diffuse 59Â vec3 lightDir = normalize(uLightPos- vFragPos); 60Â vec3 normal = normalize(vNormal); 61Â float diff = max(dot(lightDir, normal), 0.0); 62Â float light_atten_coff = uLightIntensity / length(uLightPos- vFragPos); 63Â vec3 diffuse = diff * light_atten_coff * color; 64 65 // Phong specular 66Â vec3 viewDir = normalize(uCameraPos- vFragPos); 67Â float spec = 0.0; 68Â vec3 reflectDir = reflect(-lightDir, normal); 69Â spec = pow (max(dot(viewDir, reflectDir), 0.0), 35.0); 70Â vec3 specular = uKs * light_atten_coff * spec; 71 72 // Compose all components and do gamma reverse 73Â gl_FragColor = vec4(pow((ambient + diffuse + specular), vec3(1.0/2.2)), 1.0); 74 75} 76`; å®ç° PhongMaterial ç±» åœ¨ src/materials/ ä¸‹æ–°å»º PhongMaterial.jsï¼Œå®šä¹‰ç»§æ‰¿è‡ª Material çš„ PhongMaterial ç±»ï¼Œä¼ å‚ï¼Œç»‘å®š Shaderã€‚\nsuper è°ƒç”¨çˆ¶ç±»æ„é€ \n1class PhongMaterial extends Material { 2/** 3Â * Creates an instance of PhongMaterial. 4Â * @param {vec3f} color The material color 5Â * @param {Texture} colorMap The texture object of the material 6Â * @param {vec3f} specular The material specular coefficient 7Â * @param {float} intensity The light intensity 8Â * @memberof PhongMaterial 9Â */ 10Â constructor(color, colorMap, specular, intensity) { 11Â let textureSample = 0; 12 13Â if (colorMap != null) { 14Â textureSample = 1; 15Â super({ 16Â \u0026#39;uTextureSample\u0026#39;: { type: \u0026#39;1i\u0026#39;, value: textureSample }, 17Â \u0026#39;uSampler\u0026#39;: { type: \u0026#39;texture\u0026#39;, value: colorMap }, 18Â \u0026#39;uKd\u0026#39;: { type: \u0026#39;3fv\u0026#39;, value: color }, 19Â \u0026#39;uKs\u0026#39;: { type: \u0026#39;3fv\u0026#39;, value: specular }, 20Â \u0026#39;uLightIntensity\u0026#39;: { type: \u0026#39;1f\u0026#39;, value: intensity } 21Â }, [], PhongVertexShader, PhongFragmentShader); 22Â } else { 23Â //console.log(color); 24Â super({ 25Â \u0026#39;uTextureSample\u0026#39;: { type: \u0026#39;1i\u0026#39;, value: textureSample }, 26 27Â \u0026#39;uKd\u0026#39;: { type: \u0026#39;3fv\u0026#39;, value: color }, 28Â \u0026#39;uKs\u0026#39;: { type: \u0026#39;3fv\u0026#39;, value: specular }, 29Â \u0026#39;uLightIntensity\u0026#39;: { type: \u0026#39;1f\u0026#39;, value: intensity } 30Â }, [], PhongVertexShader, PhongFragmentShader); 31Â } 32 33Â } 34} å¯¼å…¥ PhongMaterial.js åœ¨ index.html ä¸­ï¼Œåœ¨å¯¼å…¥ Material.js ä¹‹åå¯¼å…¥ PhongMaterial.jsã€‚\n1\u0026lt;script src=\u0026#34;src/materials/Material.js\u0026#34; defer\u0026gt;\u0026lt;/script\u0026gt; 2\u0026lt;!-- Load phong material **after** Material --\u0026gt; 3\u0026lt;script src=\u0026#34;src/materials/PhongMaterial.js\u0026#34; defer\u0026gt;\u0026lt;/script\u0026gt; ä½¿ç”¨ PhongMaterial src/loads/loadOBJ.js ä¸­ï¼Œåˆ é™¤åŸæœ¬åˆ›å»ºé»˜è®¤æè´¨çš„éƒ¨åˆ†ï¼Œæ”¹ä¸ºä½¿ç”¨ PhongMaterial åˆ›å»ºå®ä¾‹ã€‚\n1// // MARK: You can change the myMaterial object to your own Material instance 2 3// let textureSample = 0; 4// let myMaterial; 5// if (colorMap != null) { 6// textureSample = 1; 7// myMaterial = new Material({ 8// \u0026#39;uSampler\u0026#39;: { type: \u0026#39;texture\u0026#39;, value: colorMap }, 9// \u0026#39;uTextureSample\u0026#39;: { type: \u0026#39;1i\u0026#39;, value: textureSample }, 10// \u0026#39;uKd\u0026#39;: { type: \u0026#39;3fv\u0026#39;, value: mat.color.toArray() } 11// },[],VertexShader, FragmentShader); 12// }else{ 13// myMaterial = new Material({ 14// \u0026#39;uTextureSample\u0026#39;: { type: \u0026#39;1i\u0026#39;, value: textureSample }, 15// \u0026#39;uKd\u0026#39;: { type: \u0026#39;3fv\u0026#39;, value: mat.color.toArray() } 16// },[],VertexShader, FragmentShader); 17// } 18\t19let myMaterial = new PhongMaterial( mat.color.toArray(), 20\tcolorMap, 21\tmat.specular.toArray(), 22\trenderer.lights[0].entity.mat.intensity) ğŸª Extraï¼šä»æ–‡ä»¶ä¸­åŠ è½½ Shader ä¸ºäº†è®©è¿™ç¯‡æ˜¾å¾—ä¸é‚£ä¹ˆæ°´ï¼Œè¡¥ä¸€ä¸‹å¦ä¸€ä¸ªä»å¤–éƒ¨æ–‡ä»¶åŠ è½½ Shader çš„æ–¹æ³•ï¼Œåœ¨ src/shaders/phongShader ä¸­å·²ç»ç»™å‡ºäº†è¿™ä¸¤ä¸ªç€è‰²å™¨æ–‡ä»¶\næ›´æ”¹ PhongMaterial ç±» å› ä¸ºæ„é€ å‡½æ•°ä¸æ”¯æŒå¼‚æ­¥ï¼Œå°±æŠŠåˆ›å»º Material çš„é€»è¾‘æ”¾åˆ°ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œåœ¨è¿™ä¸ªå‡½æ•°é‡Œè°ƒç”¨ loadShader.js ä¸­å®šä¹‰çš„ loadShaderFile å‡½æ•°åŠ è½½ shader æ–‡ä»¶ï¼Œç­‰å¾…åŠ è½½å®Œåå†è°ƒç”¨æ„é€ å‡½æ•°å¹¶è¿”å›æ–°åˆ›å»ºçš„å®ä¾‹ï¼š\n1// Load the shader files from file 2class PhongMaterial extends Material { 3 constructor(uniforms, vertexShader, fragmentShader) { 4 super(uniforms, [], vertexShader, fragmentShader); 5 } 6 7 /** 8 * Creates an instance of PhongMaterial async. 9 * @param {vec3f} color 10 * @param {Texture} colorMap 11 * @param {vec3f} specular 12 * @param {float} intensity 13 * @returns {Promise\u0026lt;PhongMaterial\u0026gt;} 14 */ 15 static async create(color, colorMap, specular, intensity) { 16 const textureSample = colorMap ? 1 : 0; 17 18 const [vertexShader, fragmentShader] = await Promise.all([ 19 loadShaderFile(\u0026#39;src/shaders/phongShader/vertex.glsl\u0026#39;), 20 loadShaderFile(\u0026#39;src/shaders/phongShader/fragment.glsl\u0026#39;) 21 ]); 22 // console.log(\u0026#39;Vertex Shader:\u0026#39;, vertexShader.slice(0, 100)); 23 // console.log(\u0026#39;Fragment Shader:\u0026#39;, fragmentShader.slice(0, 100)); 24 const uniforms = { 25 \u0026#39;uTextureSample\u0026#39;: { type: \u0026#39;1i\u0026#39;, value: textureSample }, 26 \u0026#39;uKd\u0026#39;: { type: \u0026#39;3fv\u0026#39;, value: color }, 27 \u0026#39;uKs\u0026#39;: { type: \u0026#39;3fv\u0026#39;, value: specular }, 28 \u0026#39;uLightIntensity\u0026#39;: { type: \u0026#39;1f\u0026#39;, value: intensity } 29 }; 30 31 if (colorMap) { 32 uniforms[\u0026#39;uSampler\u0026#39;] = { type: \u0026#39;texture\u0026#39;, value: colorMap }; 33 } 34 35 return new PhongMaterial(uniforms, vertexShader, fragmentShader); 36 } 37} æ›´æ”¹ loadOBJ.js ç”¨ create æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æè´¨å®ä¾‹ï¼Œå®Œæˆåè¿›è¡Œæ¸²æŸ“ã€‚\n1PhongMaterial.create( mat.color.toArray(), 2\tcolorMap, 3\tmat.specular.toArray(), 4\trenderer.lights[0].entity.mat.intensity) 5\t.then((myMaterial) =\u0026gt; { 6\tlet meshRender = new MeshRender(renderer.gl, mesh, myMaterial); 7\trenderer.addMesh(meshRender); 8\t}) ğŸ“ Afterwords ä¸€åˆ‡æ­£å¸¸å°±æ˜¯ä¸‹é¢çš„æ•ˆæœã€‚\n","permalink":"https://congyuxiaoyoudao.github.io/posts/assignments/games202-homework-0/","summary":"\u003cblockquote\u003e\n\u003cp\u003eå¼€ä¸ªæ–°å‘ï¼Œä¹‹å‰å›«å›µåæ£åœ°è¿‡äº†ä¸€é 202ï¼Œç°åœ¨å¿˜å¾—å·®ä¸å¤šäº†ï¼Œè¯¥æ¡èµ·æ¥ã€‚æ­£å¥½ç»™æ¯ç‡¥çš„ç”Ÿæ´»å¢æ·»ä¸€ç‚¹è‰²å½©ï¼ˆï¼Ÿï¼‰ï¼Œæœ€è¿‘æ¯”è¾ƒå¿™ä½†è¿˜æ˜¯äº‰å–ä¸€å‘¨åšä¸€ä¸ªä½œä¸š\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2 id=\"-0x00-to-begin-with\"\u003eğŸš© 0x00 To begin with\u003c/h2\u003e\n\u003cp\u003eè¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e GAMES202 ä½œä¸š 0\u003c/li\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e \u003cstrong\u003eä¸\u003c/strong\u003eåŒ…å«ä½œä¸šæ¡†æ¶åˆ†æ\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eFor reference\u003c/strong\u003eğŸ‘‡ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eğŸ“º B ç«™è§†é¢‘ï¼š\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://www.bilibili.com/video/BV1YK4y1T7yY/?spm_id_from=333.337.top_right_bar_window_custom_collection.content.click\u0026amp;vd_source=b6584cebba3a7a1a34d2f60d63bdc868\"\u003eGAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“¦ ä»£ç ä»“åº“ï¼š\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://github.com/congyuxiaoyoudao/GAMES202_Homework/tree/working\"\u003econgyuxiaoyoudao/GAMES202_Homework at working\u003c/a\u003e\n\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003emaster åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2 id=\"-0x01-configuration-ç¯å¢ƒé…ç½®\"\u003eâš™ï¸ 0x01 Configuration ç¯å¢ƒé…ç½®\u003c/h2\u003e\n\u003cp\u003eé€‰æ‹©ä½¿ç”¨ VSCode æ’ä»¶æ­å»ºæœ¬åœ°æœåŠ¡å™¨ï¼Œåœ¨æ‰©å±•ä¸­æœç´¢ Live Serverï¼Œå®‰è£…æ­¤æ’ä»¶ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%203.GAMES202HW0/202504072204421.png#center\"\u003e\u003c/p\u003e\n\u003cp\u003eåœ¨ç¼–è¾‘ Html ä»£ç çª—å£æŒ‰ F1ï¼ˆæˆ–è€…å³é”®ï¼‰é€‰æ‹© \u003cstrong\u003eLive Server: Open with Live Server\u003c/strong\u003eï¼Œéšåä¼šè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼Œå¯¼èˆªè‡³æœ¬åœ°æœåŠ¡å™¨ç«¯å£ï¼Œä¸€åˆ‡æ­£å¸¸çš„è¯æ˜¯ä¸‹é¢è¿™ä¸ªæ•ˆæœï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%203.GAMES202HW0/202504072210368.png#center\"\u003e\u003c/p\u003e\n\u003cp\u003eå¯ä»¥ä½¿ç”¨é¼ æ ‡å’Œå³ä¸Šè§’çš„æ§åˆ¶é¢æ¿è¿›è¡Œä¸€äº›ç®€å•çš„äº¤äº’ã€‚\u003c/p\u003e\n\u003cp\u003eå¦‚æœé‡åˆ°æ¨¡å‹è´´å›¾åŠ è½½ä¸å‡ºæ¥ï¼ˆåªæœ‰ 202 å­—æ ·ï¼‰ï¼Œå¯ä»¥é€‰æ‹©å¤šåˆ·æ–°å‡ æ¬¡ã€‚æˆ–è€…ç›´æ¥åœ¨åŠ è½½è„šæœ¬å‰é¢„åŠ è½½è´´å›¾ï¼Œå¯ä»¥æ ¹æ²»è¿™ä¸ªé—®é¢˜ã€‚\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e1\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003elink\u003c/span\u003e \u003cspan class=\"na\"\u003erel\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;preload\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003ehref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;assets/mary/MC003_Kozakura_Mari.png\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eas\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;image\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;image/png\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003ecrossorigin\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"-0x02-blinn-phong-shading-model\"\u003eğŸ¤” 0x02 Blinn-Phong Shading Model\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼ŒCV å·¥ç¨‹å¸ˆ\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch3 id=\"ä½¿ç”¨-glsl-ç¼–å†™-shader\"\u003e\u003cstrong\u003eä½¿ç”¨ GLSL ç¼–å†™ Shader\u003c/strong\u003e\u003c/h3\u003e\n\u003cp\u003eå¦‚æœä½¿ç”¨å­—ç¬¦ä¸²çš„æ–¹å¼å¼•å…¥ Shaderï¼Œå°±åœ¨ InternalShader.js ä¸­åŠ ä¸Šï¼š\u003c/p\u003e","title":"Assignment 3. GAMES202 Homework 0"},{"content":" å¶ç„¶ç”¨ shader ä¹±æ“å‡ºçš„ä¸€ä¸ªç±»ä¼¼æ¼«ç”»é£æ ¼çš„æ”¾å°„çº¿æ•ˆæœï¼Œå®é™…ä¸Šè¿˜æœ‰å¾ˆå¤šç¼ºé™·ï¼Œæƒä¸”å½“æ€è·¯åˆ†äº«äº†\nğŸš© 0x00 To begin with è¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\næ¼«ç”»çš„é€Ÿåº¦çº¿æ•ˆæœ åŸºäº blender ç€è‰²å™¨çš„ä¹±ç³Š ğŸ‘€ 0x01 What is Radiating Lines æ¼«ç”»ä¸­ç»å¸¸æœ‰è¿™ç§æ”¾å°„çº¿çš„æ•ˆæœï¼š\né€šå¸¸æ˜¯ç”¨æ¥è¡¨è¾¾è§’è‰²æƒ…ç»ªã€ç‰©ä½“é€Ÿåº¦æ„Ÿæˆ–çªå‡ºç”»é¢é‡ç‚¹ï¼ŒåŠ¨æ¼«ä¸­è¿˜ä¼šåšå‡ºåŠ¨ç”»ä»¥å¢åŠ è¡¨ç°åŠ›ã€‚ä½†æ˜¯å¦‚æœä¸é ç”»ï¼ˆå…¨å‡­ç¨‹åºåŒ–ï¼‰æ€ä¹ˆåšå‘¢ï¼Ÿ\nå¦‚æœä¸é™åˆ¶å·¥å…·çš„è¯æ€è·¯å¾ˆç®€å•ï¼Œåœ¨ PS é‡Œå…ˆç”»ä¸€ä¸ªæ¸å˜ï¼Œå†ç”¨æ³¢æµªæ‰­æˆé—´éš”ä¸ç­‰çš„å°–åˆºçŠ¶ï¼Œæœ€åè½¬æˆæåæ ‡å°±å®Œäº‹äº†ã€‚\nä½†æ˜¯å¦‚æœè¦ç”¨ shader å†™çš„è¯å°±æœ‰ç‚¹å¤´ç–¼äº†ï¼Œä¸»è¦æ˜¯é‚£ç§ä¸è§„åˆ™çš„å°–åˆºæ•ˆæœã€‚æˆ‘ä¸€å¼€å§‹æƒ³çš„æ˜¯è®© V çš„èµ·ç‚¹åœ¨å¾„å‘éšæœºåç§»ï¼Œä½† UV æ¯•ç«Ÿæ˜¯é‡å¤å¹³é“ºçš„ï¼Œæåæ ‡ä¸€æ‰­è¿˜æ˜¯ä¼šçªœåˆ°ä¸­å¿ƒå»ï¼Œç”šè‡³ V æœ‰æ²¡æœ‰éƒ½æ²¡å…³ç³»ã€‚\næ‰€ä»¥åç§» UV çš„æƒ³æ³•æ˜¯ä¸è¡Œäº†ï¼Œæˆ‘çš„åšæ³•æ˜¯ç³Šå‡ºä¸€ä¸ªé®ç½©ï¼ˆä¹Ÿæ˜¯å¾ˆé‚ªé—¨äº†ï¼‰ã€‚\nğŸ•¸ï¸ 0x02 Radiating Lines æ”¾å°„çº¿æ•ˆæœ è¦åšå‡ºæ”¾å°„çš„æ•ˆæœï¼Œé¦–å…ˆå¾—è®© UV ä½äºæ¨¡å‹çš„ä¸­å¿ƒï¼Œä»¥æ­£æ–¹å½¢å¹³é¢ä¸ºä¾‹ï¼Œåœ¨æ˜ å°„ä¸­å°† UV åŒæ—¶å‡å» 0.5ï¼Œè®© UV (0,0) å¤„ä½äºæ¨¡å‹ä¸­å¿ƒã€‚\nç„¶åå°±æ˜¯è®© U ç»•åœ†å‘¨ç¯æ¸¸ä¸€åœˆï¼Œç°åœ¨çš„ UV å¯ä»¥å½“æˆç›´è§’åæ ‡ç³»å¤„ç†ï¼Œå¾ˆå®¹æ˜“ç»™å‡ºä¸€ä¸ªå•ä½åœ†çš„æ–¹ç¨‹ï¼š\n$$ u^2+v^2=1 $$ ç„¶åç®—ä»¥ U è½´æ­£æ–¹å‘ä¸ºèµ·ç‚¹çš„è§’åº¦ï¼š\n$$ \\theta=\\arctan \\frac{v}{u} $$ å¯ä»¥ç”¨è¿ç®—èŠ‚ç‚¹çš„åæ­£åˆ‡ 2 è®¡ç®—è¿™ä¸ª$\\theta$ï¼Œä½†æ˜¯ç»“æœçš„èŒƒå›´æ˜¯$-\\pi \\sim+\\pi$ï¼Œéœ€è¦æ˜ å°„å›$0 \\sim1$ï¼š\nç”¨è¿™ä¸ªä½œä¸º UV é‡‡æ ·æ³¢æµªçº¹ç†å°±å¯ä»¥æœ‰æ”¾å°„çº¿çš„æ•ˆæœï¼š\nä¸ºä»€ä¹ˆå¯ä»¥ç›´æ¥è¿çŸ¢é‡ï¼Œå› ä¸º V æ˜¯å•¥éƒ½æ— æ‰€è°“ï¼Œç”±äºæ³¢æµªçº¹ç†çš„æ€§è´¨å¾„å‘éƒ½æ˜¯åŒä¸€ä¸ªå€¼\nä½†æ˜¯æ¼«ç”»é‡Œé¢çš„æ”¾å°„çº¿ç²—ç»†ã€é—´éš”æ²¡æœ‰é‚£ä¹ˆå‡åŒ€ï¼Œé‚£å°±æ‹¿ä¸€ä¸ªå™ªæ³¢æ‰°åŠ¨ Uï¼š\né…·ï¼å¯ä»¥æ‹¿è¿™ç©æ„äº¤å¹³é¢æ„æˆä½œä¸šäº†ï¼ˆbushiï¼‰ã€‚\nğŸ—¯ï¸ 0x03 Urchin-Shaped Mask æµ·èƒ†çŠ¶é®ç½© ç°åœ¨æœ‰äº†æ”¾å°„çº¿çš„é€ å‹ï¼Œä½†æˆ‘ä»¬åªéœ€è¦å‘¨è¾¹çš„éƒ¨åˆ†ï¼Œä¸ºæ­¤éœ€è¦å¾„å‘å‰”é™¤ä¸­å¿ƒéƒ¨åˆ†çš„æ”¾å°„çº¿ï¼Œé¦–å…ˆéœ€è¦æ‹¿åˆ°å¾„å‘çš„ Vï¼Œç›´æ¥å–åŸå§‹ UV çš„é•¿åº¦å³å¯ã€‚ç„¶åéœ€è¦è®© V å¾„å‘éšæœºåç§»ï¼Œè¿™é‡Œæˆ‘ç›´æ¥æ‹¿æ³¢æµªçº¹ç†çš„è¾“å‡ºä¸ V ç›¸åŠ ï¼Œç³Šå‡ºä¸€ä¸ªæµ·èƒ†çŠ¶é®ç½©ã€‚\næ³¢æµªçº¹ç†ä¹‹åçš„ä¹˜æ•°ç”¨äºæ§åˆ¶åç§»èŒƒå›´\næœ€åæ‹¿è¿™ä¸ªé®ç½©å’ŒåŸæœ¬çš„æ”¾å°„çº¿æ··åˆä¸€ä¸‹ï¼Œé®ç½©ä¸º 0 å¤„å–åŸæœ¬é¢œè‰²ï¼Œå¦åˆ™å– 1ï¼ˆç™½è‰²ï¼‰ã€‚\nç„¶åå°±ç³Šå‡ºæ¥äº†\u0026hellip;\u0026hellip;\nâ­ 0x04 After words åšå‡ºè¿™ä¸ªçš„æ—¶å€™è¿˜ç‰¹æ„ç½‘ä¸Šæœäº†ä¸€åœˆï¼Œæœ‰ AE å’Œ PS çš„æ•™ç¨‹ï¼Œä½†ä¼¼ä¹æ²¡æœ‰ç”¨ shader è¿˜åŸçš„ï¼ˆä¹Ÿå¯èƒ½æ²¡æœåˆ°ï¼‰ï¼Œå½“ç„¶æ¯•ç«Ÿæ˜¯ç³Šå‡ºæ¥çš„ï¼Œè¿˜æœ‰å¾ˆå¤šä¸å¯æ§çš„åœ°æ–¹ï¼š\nå¸¸è§„çš„æ¼«ç”»æ”¾å°„çº¿ä¸ä¸€å®šå‡åŒ€å¾„å‘ï¼Œä¼šæœ‰éšæœºè§’åº¦åç§» æ— æ³•æ–¹ä¾¿åœ°æ§åˆ¶æ¡çº¹å¤§å° æ— æ³•æµç•…ç¨³å®šåœ°åšå‡ºé€Ÿåº¦çº¿åŠ¨ç”» å®é™…å¦‚æœæœ‰é¡¹ç›®è¦ç”¨ä¼°è®¡ä¹Ÿæ˜¯ç›´æ¥ç”»å¥½é®ç½©ç„¶ååšå¸§åŠ¨ç”»çš„ï¼Œä½†è¿˜æ˜¯å¸Œæœ›æˆ‘è¿™ç§é‚ªé—¨çš„åšæ³•æ˜¯æ— ç”¨ä¹‹ç”¨å§ã€‚\n","permalink":"https://congyuxiaoyoudao.github.io/posts/interludes/manga-speed-lines/","summary":"\u003cblockquote\u003e\n\u003cp\u003eå¶ç„¶ç”¨ shader ä¹±æ“å‡ºçš„ä¸€ä¸ªç±»ä¼¼æ¼«ç”»é£æ ¼çš„æ”¾å°„çº¿æ•ˆæœï¼Œå®é™…ä¸Šè¿˜æœ‰å¾ˆå¤šç¼ºé™·ï¼Œæƒä¸”å½“æ€è·¯åˆ†äº«äº†\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2 id=\"-0x00-to-begin-with\"\u003eğŸš© 0x00 To begin with\u003c/h2\u003e\n\u003cp\u003eè¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e æ¼«ç”»çš„é€Ÿåº¦çº¿æ•ˆæœ\u003c/li\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e åŸºäº blender ç€è‰²å™¨çš„ä¹±ç³Š\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"-0x01-what-is-radiating-lines\"\u003eğŸ‘€ 0x01 What is Radiating Lines\u003c/h2\u003e\n\u003cp\u003eæ¼«ç”»ä¸­ç»å¸¸æœ‰è¿™ç§æ”¾å°„çº¿çš„æ•ˆæœï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/TA-interludes/Interlude%202.MangaSpeedLines/202504021841792.jpg#center\"\u003e\u003c/p\u003e\n\u003cp\u003eé€šå¸¸æ˜¯ç”¨æ¥è¡¨è¾¾è§’è‰²æƒ…ç»ªã€ç‰©ä½“é€Ÿåº¦æ„Ÿæˆ–çªå‡ºç”»é¢é‡ç‚¹ï¼ŒåŠ¨æ¼«ä¸­è¿˜ä¼šåšå‡ºåŠ¨ç”»ä»¥å¢åŠ è¡¨ç°åŠ›ã€‚ä½†æ˜¯å¦‚æœä¸é ç”»ï¼ˆå…¨å‡­ç¨‹åºåŒ–ï¼‰æ€ä¹ˆåšå‘¢ï¼Ÿ\u003c/p\u003e\n\u003cp\u003eå¦‚æœä¸é™åˆ¶å·¥å…·çš„è¯æ€è·¯å¾ˆç®€å•ï¼Œåœ¨ PS é‡Œå…ˆç”»ä¸€ä¸ªæ¸å˜ï¼Œå†ç”¨æ³¢æµªæ‰­æˆé—´éš”ä¸ç­‰çš„å°–åˆºçŠ¶ï¼Œæœ€åè½¬æˆæåæ ‡å°±å®Œäº‹äº†ã€‚\u003c/p\u003e\n\u003cp\u003eä½†æ˜¯å¦‚æœè¦ç”¨ shader å†™çš„è¯å°±æœ‰ç‚¹å¤´ç–¼äº†ï¼Œä¸»è¦æ˜¯é‚£ç§ä¸è§„åˆ™çš„å°–åˆºæ•ˆæœã€‚æˆ‘ä¸€å¼€å§‹æƒ³çš„æ˜¯è®© V çš„èµ·ç‚¹åœ¨å¾„å‘éšæœºåç§»ï¼Œä½† UV æ¯•ç«Ÿæ˜¯é‡å¤å¹³é“ºçš„ï¼Œæåæ ‡ä¸€æ‰­è¿˜æ˜¯ä¼šçªœåˆ°ä¸­å¿ƒå»ï¼Œç”šè‡³ V æœ‰æ²¡æœ‰éƒ½æ²¡å…³ç³»ã€‚\u003c/p\u003e\n\u003cp\u003eæ‰€ä»¥åç§» UV çš„æƒ³æ³•æ˜¯ä¸è¡Œäº†ï¼Œæˆ‘çš„åšæ³•æ˜¯ç³Šå‡ºä¸€ä¸ªé®ç½©ï¼ˆä¹Ÿæ˜¯å¾ˆé‚ªé—¨äº†ï¼‰ã€‚\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"-0x02-radiating-lines-æ”¾å°„çº¿æ•ˆæœ\"\u003eğŸ•¸ï¸ 0x02 Radiating Lines æ”¾å°„çº¿æ•ˆæœ\u003c/h2\u003e\n\u003cp\u003eè¦åšå‡ºæ”¾å°„çš„æ•ˆæœï¼Œé¦–å…ˆå¾—è®© UV ä½äºæ¨¡å‹çš„ä¸­å¿ƒï¼Œä»¥æ­£æ–¹å½¢å¹³é¢ä¸ºä¾‹ï¼Œåœ¨æ˜ å°„ä¸­å°† UV åŒæ—¶å‡å» 0.5ï¼Œè®© UV (0,0) å¤„ä½äºæ¨¡å‹ä¸­å¿ƒã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/TA-interludes/Interlude%202.MangaSpeedLines/202503312115356.png#center\"\u003e\u003c/p\u003e\n\u003cp\u003eç„¶åå°±æ˜¯è®© U ç»•åœ†å‘¨ç¯æ¸¸ä¸€åœˆï¼Œç°åœ¨çš„ UV å¯ä»¥å½“æˆç›´è§’åæ ‡ç³»å¤„ç†ï¼Œå¾ˆå®¹æ˜“ç»™å‡ºä¸€ä¸ªå•ä½åœ†çš„æ–¹ç¨‹ï¼š\u003c/p\u003e\n\u003cdiv\u003e$$\nu^2+v^2=1\n$$\u003c/div\u003e\n\u003cp\u003eç„¶åç®—ä»¥ U è½´æ­£æ–¹å‘ä¸ºèµ·ç‚¹çš„è§’åº¦ï¼š\u003c/p\u003e\n\u003cdiv\u003e$$\n\\theta=\\arctan \\frac{v}{u}\n$$\u003c/div\u003e\n\u003cp\u003eå¯ä»¥ç”¨è¿ç®—èŠ‚ç‚¹çš„åæ­£åˆ‡ 2 è®¡ç®—è¿™ä¸ª$\\theta$ï¼Œä½†æ˜¯ç»“æœçš„èŒƒå›´æ˜¯$-\\pi \\sim+\\pi$ï¼Œéœ€è¦æ˜ å°„å›$0 \\sim1$ï¼š\u003c/p\u003e","title":"Interlude 2. Manga Speed Lines"},{"content":" æœ¬ç€è™šå¿ƒäº¤æµä¸æ¥å—æ‰¹è¯„çš„æ€åº¦ï¼ŒæŠŠè¿™ç¯‡ç”¨æ¥â€œåº”ä»˜â€å­¦æ ¡ä½œä¸šçš„ç»¼è¿°å†™ä½œæ”¾ä¸Šæ¥ï¼Œä¸åèµæ•™ï¼\n0x00 To begin with è¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\nè¿‘å¹´æ¥æ°´ä½“æ³¢å½¢æ¨¡æ‹Ÿçš„ä¸»è¦æ–¹æ³•åˆ†ç±»ä»‹ç» ç°æœ‰æ–‡çŒ®çš„ç ”ç©¶è¶‹åŠ¿åˆ†æåŠæœªæ¥æ–¹å‘é¢„æµ‹ For referenceï¼š\nğŸ“– çœŸå®æ„Ÿæ°´ä½“æ¸²æŸ“æŠ€æœ¯æ€»ç»“ ğŸ“– ä¹ã€æµä½“æ¨¡æ‹Ÿç®€è¿° ğŸ“– æ¸¸æˆä¸­çš„å®æ—¶æ°´ä½“æ¨¡æ‹ŸæŠ€æœ¯ 0x01 æ‘˜è¦ çœŸå®æ„Ÿæ°´ä½“æ¨¡æ‹Ÿå› å…¶é«˜åº¦ä»¿çœŸçš„è§†è§‰è¡¨ç°ä¸å¹¿æ³›çš„åº”ç”¨é¢†åŸŸæˆä¸ºè®¡ç®—æœºå›¾å½¢å­¦çš„ç ”ç©¶çƒ­ç‚¹ã€‚æœ¬æ–‡å›é¡¾äº†è¿‘ 50 å¹´ï¼ˆ1978-2025ï¼‰æ¥æ°´ä½“æ¨¡æ‹Ÿçš„æ–¹æ³•ï¼Œå…·ä½“è€Œè¨€ï¼ŒåŒ…æ‹¬æ—©æœŸåŸºäºç»éªŒä¸ç»Ÿè®¡çš„æ–¹æ³•ä¸å‚æ•°åŒ–æ³¢åˆ—åˆæˆçš„æ–¹æ³•ï¼Œä¸­æœŸåŸºäºç‰©ç†çš„æ•°å€¼æ¨¡æ‹Ÿæ–¹æ³•å’Œæ³¢ç²’å­æ–¹æ³•ï¼Œä»¥åŠè¿‘å¹´è½¬å‘æ•°æ®é©±åŠ¨çš„æ·±åº¦å­¦ä¹ æ–¹æ³•ã€‚\nå…³é”®è¯ï¼šæµä½“æ¨¡æ‹Ÿã€æ³¢å½¢æ¨¡æ‹Ÿã€æ·±åº¦å­¦ä¹ ã€ç‰©ç†æ•°å€¼æ–¹æ³•\nRealistic water simulation has emerged as a prominent research focus in computer graphics due to its highly realistic visual effects and broad application domains. This paper reviews the methods of water simulation over the past 50 years (1978â€“2025), specifically including early approaches based on empirical and statistical models, parametric wave synthesis methods, mid-term physics-based numerical simulation techniques and wave particle methods, as well as the recent shift toward data-driven deep learning approaches.\nKeywords: Fluid simulation, Wave simulation, Deep learning, Physics-based numerical methods\n0x02 å¼•è¨€ æµä½“æ¨¡æ‹Ÿä½œä¸ºè®¡ç®—æœºå›¾å½¢å­¦ä¸æµä½“åŠ¨åŠ›å­¦çš„é‡è¦åˆ†æ”¯ï¼Œæ˜¯ä¸€ç§åˆ©ç”¨ç‰©ç†å®šå¾‹å’Œè®¡ç®—æœºç®—æ³•å¯¹æµä½“ï¼ˆå¦‚æ°´æ³¢ã€çƒŸé›¾å’Œç«ç„°ï¼‰çš„è¡Œä¸ºè¿›è¡Œä»¿çœŸé¢„æµ‹çš„æŠ€æœ¯ï¼Œåœ¨è®¡ç®—æœºå›¾å½¢å­¦ã€è™šæ‹Ÿç°å®ã€å½±è§†è¡Œä¸šä»¥åŠæ¸¸æˆå¼€å‘é¢†åŸŸæœ‰ç€å¹¿æ³›åº”ç”¨ã€‚æ•°åå¹´æ¥ï¼Œç ”ç©¶äººå‘˜å·²ç»å¼€å‘äº†ä¸€ç³»åˆ—åŸºäºæµä½“åŠ¨åŠ›å­¦çš„æ•°å€¼æ¨¡å‹ã€‚è™½ç„¶è¿™äº›æ–¹æ³•åœ¨æ¨¡æ‹Ÿæ•ˆæœå’Œç®—æ³•ä¼˜åŒ–ä¸Šå„æœ‰ä¼˜åŠ¿ï¼Œä½†é«˜è´¨é‡çš„æµä½“ä»¿çœŸçš„è®¡ç®—å¼€é”€å¾€å¾€æ— æ³•æ»¡è¶³å®æ—¶æ¸²æŸ“çš„è¦æ±‚ï¼Œç‰¹åˆ«æ˜¯å½“è¿›è¡Œé«˜åˆ†è¾¨ç‡åœºæ™¯ï¼ˆå¦‚æµ·æ´‹ã€æ²³æµå’Œæ¹–æ³Šï¼‰çš„æ¨¡æ‹Ÿæ—¶ï¼Œæ¨¡æ‹Ÿæ—¶é—´å°†å¤§å¹…å¢åŠ ã€‚å¦‚ä½•é«˜æ•ˆã€å®æ—¶åœ°è¿›è¡Œé«˜è´¨é‡ã€çœŸå®çš„æµä½“æ¨¡æ‹Ÿï¼Œæ˜¯å­¦æœ¯ç•Œå’Œå·¥ä¸šç•ŒäºŸå¾…è§£å†³çš„éš¾é¢˜ã€‚\nåœ¨è‡ªç„¶ç•Œçš„ä¼—å¤šæµä½“ä¸­ï¼Œæ°´ä½“å ªç§°ä¸€ä¸ªå…¸å‹çš„æ¨¡æ‹Ÿå¯¹è±¡ï¼Œåœ¨æ¸¸æˆä¸­å¯¹å…¶è¿›è¡Œæ¨¡æ‹Ÿçš„éœ€æ±‚å‡ºç°å¾—å°¤ä¸ºé¢‘ç¹ã€‚çœŸå®æ„Ÿçš„æ°´ä½“æ¨¡æ‹Ÿä¸ä»…éœ€è¦å…¼é¡¾æ³¢å½¢ï¼ˆWave Shapeï¼‰å’Œç€è‰²ï¼ˆShadingï¼‰çš„æ‹ŸçœŸæ€§ï¼Œè¿˜è¦èƒ½å¤Ÿå‡†ç¡®å“åº”æ¥è‡ªå„ç§å®ä½“å’Œç”¨æˆ·çš„äº¤äº’æ“ä½œï¼Œä»¥åŠå…·å¤‡ç”¨äºä¼˜åŒ–çš„å»ºæ¨¡æ–¹æ³•ã€LOD æŠ€æœ¯å’Œé«˜æ•ˆçš„æ›²é¢ç»†åˆ†ç®—æ³•ã€‚å…¶ä¸­ï¼Œæ°´ä½“çš„æ³¢å½¢æ¨¡æ‹Ÿå°¤ä¸ºå…³é”®ï¼Œå› ä¸ºæ°´æ³¢çš„å½¢æ€å’Œè¿åŠ¨å—åˆ°åŒ…å«é£åŠ›ã€æ·±åº¦å’Œè¡¨é¢å¼ åŠ›ç­‰è¯¸å¤šå› ç´ çš„å…±åŒå½±å“ï¼Œåæ˜ äº†æ°´ä½“ä¸ç¯å¢ƒçš„å„ç§äº¤äº’å½¢å¼ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šå½±å“æ¨¡æ‹Ÿçš„çœŸå®æ€§å’Œè§†è§‰æ•ˆæœã€‚\nä¼ ç»Ÿçš„æ³¢å½¢æ¨¡æ‹Ÿæ–¹æ³•å¤§å¤šä¸ºåŸºäºç‰©ç†çš„æ•°å€¼æ¨¡æ‹ŸæŠ€æœ¯ï¼Œæ ¹æ®æµä½“çš„ç‰©ç†æ€§è´¨å»ºç«‹å¯¹åº”çš„æ•°å­¦æ¨¡å‹ï¼Œå†åˆ©ç”¨æ•°å€¼æ–¹æ³•å¯¹å…¶æ±‚è§£ï¼Œä»è€Œè¿˜åŸæµä½“çš„åŠ¨æ€è¡Œä¸ºã€‚è¿‘å¹´æ¥ï¼Œéšç€æ–°ä¸€è½®äººå·¥æ™ºèƒ½æµªæ½®çš„å…´èµ·ï¼Œç ”ç©¶äººå‘˜ä¹Ÿå¼€å§‹å¼•å…¥åŸºäºæ·±åº¦å­¦ä¹ çš„æ–¹æ³•[1]ï¼Œé€šè¿‡è®­ç»ƒä¸€ä¸ªæ•°æ®é©±åŠ¨çš„æ¨¡å‹ä»£ç†ä¼ ç»Ÿæ¨¡æ‹Ÿè¿‡ç¨‹ä¸­è®¡ç®—æœ€å¯†é›†çš„éƒ¨åˆ†ï¼Œå€ŸåŠ©ç¥ç»ç½‘ç»œçš„å¼ºå¤§æ‹Ÿåˆèƒ½åŠ›ä¸ç°ä»£ç¡¬ä»¶çš„åŠ é€Ÿæ”¯æŒï¼Œåœ¨æœ€å¤§ç¨‹åº¦ä¸Šä¿è¯æ¨¡æ‹Ÿç²¾åº¦çš„åŒæ—¶ï¼Œæ˜¾è‘—æå‡äº†æ¨¡æ‹Ÿé€Ÿåº¦ã€‚æœ¬ç¯‡æ–‡ç« å°†ä¸»è¦å…³æ³¨è¿‘å‡ åå¹´ä»¥æ¥å…³äºæ°´ä½“æ³¢å½¢æ¨¡æ‹Ÿçš„ç ”ç©¶è¿›å±•ï¼Œå†…å®¹æ¶µç›–æœ€æ—©çš„åŸºäºç»éªŒå’Œç»Ÿè®¡çš„å‚æ•°æ¨¡å‹æ–¹æ³•ã€ä¼ ç»Ÿçš„åŸºäºç‰©ç†çš„æ•°å€¼æ–¹æ³•å’Œæœ€æ–°çš„åŸºäºæ·±åº¦å­¦ä¹ çš„æ•°æ®é©±åŠ¨æ–¹æ³•ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†æŒ‰ç…§æ—¶é—´é¡ºåºå›é¡¾æ°´ä½“æ³¢å½¢æ¨¡æ‹ŸæŠ€æœ¯çš„å‘å±•å†å²[2-4]ï¼›æ¥ç€æˆ‘ä»¬å°†å·²æœ‰çš„æ–¹æ¡ˆæŒ‰ç…§å®ç°çš„æŠ€æœ¯è·¯å¾„åˆ†ç±»ï¼Œä»‹ç»å„ç±»æ–¹æ³•åœ¨æ‹ŸçœŸæ€§ã€å®æ—¶æ€§ä»¥åŠé€‚ç”¨åœºæ™¯ç­‰æ–¹é¢çš„ç‰¹ç‚¹å’Œä¼˜åŠ¿ï¼›æœ€åï¼Œæˆ‘ä»¬å°†å¯¹æ”¶é›†åˆ°çš„ç›¸å…³æ–‡çŒ®è¿›è¡Œç»Ÿè®¡æ±‡æ€»ï¼Œå¹¶é€šè¿‡å¯è§†åŒ–æ‰‹æ®µè¿›è¡Œè¶‹åŠ¿åˆ†æä¸æœªæ¥ç ”ç©¶æ–¹å‘çš„é¢„æµ‹ã€‚é€šè¿‡ç³»ç»Ÿåœ°æ•´ç†å’Œåˆ†æç°æœ‰æ–‡çŒ®ï¼Œæœ¬ç¯‡æ–‡ç« æ—¨åœ¨ä¸ºç ”ç©¶äººå‘˜æä¾›ä¸€ä¸ªè¾ƒä¸ºå…¨é¢çš„æŠ€æœ¯è·¯çº¿å›¾ï¼ŒåŒæ—¶ä¸ºè¿›ä¸€æ­¥æ¢ç´¢é«˜æ•ˆçš„çœŸå®æ„Ÿæ°´ä½“çš„æ³¢å½¢æ¨¡æ‹Ÿæ–¹æ³•æä¾›ç†è®ºå’Œå®è·µå‚è€ƒã€‚\n0x03 æ°´ä½“æ³¢å½¢æ¨¡æ‹Ÿæ¦‚è¿° çœŸå®æ„Ÿçš„æ°´ä½“æ¨¡æ‹Ÿå› å…¶å“è¶Šçš„è§†è§‰è¡¨ç°ï¼Œä½œä¸ºæå‡æ²‰æµ¸æ„Ÿä¸è§†è§‰çœŸå®åº¦çš„é‡è¦æŠ€æœ¯æ‰‹æ®µï¼Œåœ¨å„ç±»æ¸¸æˆä¸­å¾—åˆ°äº†å¹¿æ³›åº”ç”¨ã€‚\næ¯”å¦‚æ±‚ç”Ÿä¹‹è·¯ 2 ä¸­è¯¡ç§˜çš„æ—é—´æ°´é¢ï¼š\nWater - Valve Developer Community å†åˆ°åœ°å¹³çº¿è¥¿ä¹‹ç»å¢ƒä¸­å¹½æ·±çš„æ²³æ»©ï¼š\næœ€åæ˜¯çº¢è‰²æ²™æ¼ ï¼ˆCrimson Desertï¼Œ2025ï¼‰ä¸­æ½ºæ½ºçš„æºªæ¶§æµæ°´ï¼š\nDev Archives: The Engine Behind Crimson Desert | GDC 2025 è¦æƒ³å®ç°è¿™äº›å¤§ä½œä¸­æå…·è¡¨ç°åŠ›çš„æ°´ä½“æ¸²æŸ“æ•ˆæœï¼Œé¦–è¦éš¾ç‚¹å°±æ˜¯å¯¹æ°´ä½“çš„æ³¢å½¢æ¨¡æ‹Ÿã€‚å¦‚ä½•è¡¨ç°å‡ºæ‹ŸçœŸçš„æ°´é¢æ³¢æµªåŠ¨æ€ï¼Œä¸€ç›´æ˜¯å­¦æœ¯ç•Œå’Œå·¥ä¸šç•Œé•¿æœŸæ”»åšçš„æŠ€æœ¯éš¾é¢˜ã€‚å¤šå¹´æ¥ï¼Œç ”ç©¶äººå‘˜å·²ç»æå‡ºäº†ä¸€ç³»åˆ—å¯¹æ°´ä½“æ³¢å½¢è¿›è¡Œæ¨¡æ‹Ÿçš„æ–¹æ³•ï¼ŒæŒ‰æ—¶é—´é¡ºåºåˆ—å‡ºå¦‚ä¸‹ï¼š\nå‡¹å‡¸è´´å›¾ï¼ˆBump Mappingï¼‰[J. Blinnï¼Œ1978][5] éšæœºæ³¢å½¢ï¼ˆRandom Wavesï¼‰[Schachterï¼Œ1980][6] æ­£å¼¦æ³¢ï¼ˆSinusoids Waveï¼‰[Max N Lï¼Œ1981][7] åˆ†å½¢å™ªå£°ï¼ˆFractal Noiseï¼‰[Perlin Kenï¼Œ1985][8] Gerstner æ³¢ï¼ˆGerstner Waveï¼‰[Fournier å’Œ Reevesï¼Œ1986][9] å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFast Fourier Transformï¼‰[Mastin ç­‰ï¼Œ1987][10] B-æ ·æ¡ï¼ˆBeta-Splinesï¼‰[T\u0026rsquo;so å’Œ Barskyï¼Œ1987][11] æ¬§æ‹‰æ–¹æ³•ï¼ˆEulerian Approachesï¼‰[Kass å’Œ Millerï¼Œ1990][12] æ‹‰æ ¼æœ—æ—¥æ–¹æ³•ï¼ˆLagrangian Approachesï¼‰[Stam å’Œ Fiumeï¼Œ1995][13] æ¬§æ‹‰-æ‹‰æ ¼æœ—æ—¥æ··åˆæ–¹æ³•ï¼ˆHybrid Approachesï¼‰[Brein å’Œ Hodgins,1995][14] ç©ºé—´-é¢‘è°±æ··åˆæ–¹æ³•ï¼ˆSpatial-Spectral Approachesï¼‰[Thon ç­‰ï¼Œ2000][15] æ³¢ç²’å­ï¼ˆWave Particlesï¼‰[Yuksel ç­‰ï¼Œ2007][16] æµå‹å›¾ï¼ˆFlow Mapï¼‰[Vlachosï¼Œ2010] å›å½’æ£®æ—ï¼ˆRegression Forestsï¼‰[LadickÃ½ ç­‰ï¼Œ2015][25] æ°´é¢æ³¢åŒ…æ–¹æ³•ï¼ˆWater Wave Packetsï¼‰[Jeschkeï¼Œ2017][21] å˜å½¢æ„ŸçŸ¥ç¥ç»ç½‘ç»œï¼ˆDeformation-aware Neural Networksï¼‰[Prantl ç­‰ï¼Œ2017][29] å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰[Tompson ç­‰ï¼Œ2017][26] æ°´é¢å°æ³¢æ–¹æ³•ï¼ˆWater Surface Waveletsï¼‰[Jeschkeï¼Œ2018][22] æ½œåœ¨ç©ºé—´ç‰©ç†æ–¹æ³•ï¼ˆLatent Space Physicsï¼‰[Wiewel ç­‰ï¼Œ2019][30] æ·±åº¦ç¥ç»ç½‘ç»œï¼ˆDeep Neural Networkï¼‰[Zhang ç­‰ï¼Œ2020][31] å›¾ç¥ç»ç½‘ç»œï¼ˆGraphic Neural Networkï¼‰[Sanchez-Gonzalez ç­‰ï¼Œ2020][34] æŒ‰ç…§å®ç°æŠ€æœ¯çš„è·¯å¾„åˆ†ç±»ï¼Œå¯å°†ä¸Šæ–‡æ€»ç»“çš„æ–¹æ³•åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼š\næ—©æœŸçš„åŸºäºå‡¹å‡¸è´´å›¾çš„æ–¹æ³• çº¿æ€§æ³¢å½¢å åŠ æ–¹æ³• åŸºäºç»Ÿè®¡é¢‘è°±çš„å‚æ•°åŒ–æ–¹æ³• åŸºäºç‰©ç†çš„æ•°å€¼æ¨¡æ‹Ÿæ–¹æ³• æ³¢ç²’å­æ–¹æ³• åŸºäºæ·±åº¦å­¦ä¹ çš„æ–¹æ³• ä¸‹é¢å¯¹æ¯ç§ç±»åˆ«çš„æ–¹æ³•è¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚\n0x04 åŸºäºå‡¹å‡¸è´´å›¾çš„æ–¹æ³• Blinn åœ¨ 1978[5]å¹´å¼€å‘çš„å‡¹å‡¸è´´å›¾æ˜ å°„ï¼ˆbump mappingï¼‰æŠ€æœ¯æ˜¯å¯¹æ°´ä½“æ³¢å½¢æ¨¡æ‹Ÿçš„é¦–æ¬¡å°è¯•ã€‚è¿™ç§æ–¹æ³•é€šè¿‡æ–½åŠ ä¸€ä¸ªå‡¹å‡¸å‡½æ•°æ‰°åŠ¨è¡¨é¢æ³•çº¿æ–¹å‘æ¨¡æ‹Ÿæ³¢çº¹æ•ˆæœï¼Œå¯ä»¥å¾ˆå¥½åœ°å†ç°æ°´ä½“è¡¨é¢æ³¢æµªåå°„çš„éšæœºæ€§ã€‚\nå¯ä»¥é€‰ç”¨ä¸åŒçš„å‡¹å‡¸æ˜ å°„å‡½æ•°å¯¹è¡¨é¢è¿›è¡Œæ‰°åŠ¨ã€‚ä¾‹å¦‚ï¼ŒSchachterï¼ˆ1980ï¼‰[6] æå‡ºäº†ä¸€ä¸ªéšæœºæ³¢å½¢ï¼ˆRandom Waveï¼‰çš„æ¨¡å‹ï¼Œè¯¥æ¨¡å‹åŒ…å«ä¸€å¼ é¢„è®¡ç®—çš„çª„å¸¦å™ªå£°ï¼ˆnarrow-band noiseï¼‰æ³¢å½¢è¡¨ï¼Œé€šè¿‡å åŠ å¤šä¸ªçª„å¸¦å™ªå£°æ³¢å½¢å‘é‡ç”Ÿæˆæ°´ä½“çº¹ç†ï¼›Perlinï¼ˆ1985ï¼‰[8] ç»“åˆ 20 ä¸ªæ”¾å°„çŠ¶æ‘†çº¿æ³¢å½¢ï¼Œä½¿ç”¨çƒå½¢æ³¢å‰æ›¿ä»£ä¼ ç»Ÿçš„çº¿æ€§æ³¢å‰ï¼Œæ¯ä¸ªæ³¢æºçš„æŒ¯å¹…ä¸é¢‘ç‡æ»¡è¶³ $1/f$ å…³ç³»ï¼Œè¿™ä¸€æ€§è´¨è¡¨è¾¾åˆ†å½¢çš„æ€æƒ³ï¼Œæ‰“ç ´äº†çº¹ç†åˆ†å¸ƒçš„é‡å¤æ€§ã€‚\nå°½ç®¡è¿™äº›åŸºäºå‡¹å‡¸è´´å›¾çš„æ–¹æ³•æ˜“äºä½¿ç”¨ä¸”ä¸éœ€è¦å¤æ‚çš„æ¨¡æ‹Ÿè¿‡ç¨‹ï¼Œä½†é€šå¸¸ä¸è¶³ä»¥æ»¡è¶³æ¨¡æ‹Ÿå’ŒåŠ¨ç”»çš„éœ€æ±‚ã€‚ç”±äºæ²¡æœ‰åœ¨å‡ ä½•å±‚é¢ä¸Šå¯¹ç½‘æ ¼è¿›è¡Œä»»ä½•æ›´æ”¹ï¼Œè§†è§‰ä¸Šè¡¨ç°â€œå‡¸èµ·â€çš„æ³¢æµªç¼ºä¹è¶³å¤Ÿçš„å‡ ä½•ç»†èŠ‚å’ŒåŠ¨æ€æ€§ï¼Œéš¾ä»¥è¡¨ç°çœŸå®çš„æ°´é¢è¿åŠ¨ã€‚\n0x05 çº¿æ€§æ³¢å½¢å åŠ æ–¹æ³• çº¿æ€§æ³¢å½¢å åŠ æ–¹æ³•åŸºäºæ³¢åŠ¨çš„çº¿æ€§å åŠ åŸç†ï¼Œæ¯ä¸ªæ³¢åˆ—ç”±ä¸€ç»„ç‹¬ç«‹çš„å‚æ•°æ§åˆ¶ï¼Œå åŠ åå¯ä»¥ç”Ÿæˆå¤æ‚çš„è¡¨é¢å½¢æ€ã€‚â€‹åœ¨æ°´ä½“æ¨¡æ‹Ÿä¸­ï¼Œå¸¸ç”¨çš„åŸºç¡€æ³¢å½¢ä¸ºæ­£å¼¦æ³¢å’Œ Gerstner æ³¢ã€‚\næ­£å¼¦æ³¢ï¼ˆSinusoids Waveï¼‰ Maxï¼ˆ1981ï¼‰[7] é¦–å…ˆå°†å‚…é‡Œå¶åˆ†æç†è®ºå¼•å…¥è®¡ç®—æœºå›¾å½¢å­¦ï¼Œåœ¨ä»–è‘—åçš„ç”µå½± Carla\u0026rsquo;s Island ä¸­ä½¿ç”¨ä¸€ç³»åˆ—æ­£å¼¦æ³¢çš„å åŠ è¿‘ä¼¼ Stokes æ³¢ï¼Œæ¨¡æ‹Ÿæ°´é¢æ³¢æµªæ•ˆæœã€‚é€šè¿‡ä¸åŒé¢‘ç‡æ­£å¼¦æ³¢çš„çº¿æ€§ç»„åˆæ„å»ºæ°´é¢é«˜åº¦åœºï¼Œç”¨ä¸‰ä¸ªå‚æ•°è®¡ç®—åœ¨æ—¶é—´$t$ä¸Šçš„æµ·é¢é«˜åº¦å›¾ï¼š\n$$ h(x,z,t)=-y_{0}+\\sum_{i=1}^{N_{\\omega}}A_{i}\\cos(k_{i_{x}}x+k_{i_{z}}z-\\omega _{i}t) $$ å…¶ä¸­$N_{\\omega}$æ˜¯æ³¢æ•°ï¼Œ$A_{i}$æ˜¯ç¬¬$i$ä¸ªæ³¢çš„æŒ¯å¹…ï¼Œ$\\vec{k}=(k_{i_{x}},k_{i_{z}})$æ˜¯æ³¢çŸ¢é‡ï¼Œ$\\omega_{i}$æ˜¯å…¶è„‰å†²å€¼ï¼Œ$y_{0}$æ˜¯è‡ªç”±è¡¨é¢çš„é«˜åº¦ã€‚\nPeacheyï¼ˆ1986ï¼‰[17]é€šè¿‡å¼•å…¥æ³¢å‰–é¢å‡½æ•°ï¼ˆwave profileï¼‰ä¸ç›¸ä½å‡½æ•°çš„åˆ†ç¦»è®¾è®¡ï¼Œèƒ½å¤Ÿæ ¹æ®æ·±åº¦æ”¹å˜æ³¢çš„æŒ¯å¹…ï¼Œæ”¹è¿›äº†è¿™ç§æ–¹æ³•ã€‚\nç›®å‰åœ¨æ°´ä½“æ¸²æŸ“é¢†åŸŸå·²ç»å¾ˆå°‘ç›´æ¥ä½¿ç”¨æ­£å¼¦æ³¢è¿›è¡Œæ³¢å½¢æ¨¡æ‹Ÿï¼Œä¸šç•Œå¾€å¾€é’çäºä½¿ç”¨å®ƒçš„è¿›åŒ–ç‰ˆ Gerstner æ³¢ã€‚\nGerstner æ³¢ï¼ˆGerstner Waveï¼‰ Fournier å’Œ Reeves (1986) [9]æå‡ºäº†åŸºäº Gerstner æ¨¡å‹çš„æ°´ä½“æ³¢å½¢å»ºæ¨¡æ–¹æ³•ï¼Œé€šè¿‡å‚æ•°åŒ–è½¨é“è¿åŠ¨å®ç°äº†å¤æ‚æµ·é¢åŠ¨æ€çš„æ¨¡æ‹Ÿã€‚è¿™ç§æ–¹æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯ä½¿ç”¨è‡ªç”±è¡¨é¢ä¸Šçš„æ¯ä¸ªç²’å­æè¿°å…¶é™æ­¢ä½ç½®å‘¨å›´çš„åœ†ï¼Œç²’å­çš„è¿åŠ¨æ–¹ç¨‹ï¼ˆä»…è€ƒè™‘ XZ å¹³é¢ï¼‰å¯ä»¥è¡¨ç¤ºä¸ºï¼š\n$$ \\begin{aligned} x=\u0026x_{0}+r\\times \\sin(\\kappa x_{0}-\\omega t) \\\\ z=\u0026z_{0}-r\\times \\cos(\\kappa x_{0}-\\omega t) \\end{aligned} $$ é€šè¿‡è°ƒèŠ‚è½¨é“åŠå¾„$r$ã€æ³¢æ•°$\\kappa$ã€è§’é¢‘ç‡$\\omega$ç­‰å‚æ•°ï¼Œå¯ä»¥ç”Ÿæˆä¸åŒå½¢æ€çš„æ³¢å½¢ï¼ˆå¦‚æ­£å¼¦æ³¢ã€æ‘†çº¿æ³¢ç­‰ï¼‰ã€‚ä¸ºäº†æ¨¡æ‹ŸçœŸå®æµ·æ´‹è¡¨é¢çš„å˜åŒ–æ€§å’Œéšæœºæ€§ï¼Œä½œè€…å¼•å…¥äº†æ³¢åˆ—ï¼ˆwave trainsï¼‰ï¼Œå³å…·æœ‰ç›¸åŒåŸºæœ¬ç‰¹å¾ï¼ˆé«˜åº¦ï¼Œå‘¨æœŸå’Œæ³¢é•¿ï¼‰å’Œç›¸åŒåˆå§‹ç›¸ä½çš„æ³¢æµªç»„ï¼Œæ¯åˆ—æ³¢æµªéƒ½æœ‰è‡ªå·±çš„ä¸€ç»„å‚æ•°å’Œå¯é€‰çš„éšæœºå…ƒç´ ã€‚\nç›¸è¾ƒäºä¼ ç»Ÿçš„æ­£å¼¦æ³¢æ¨¡å‹ï¼ŒGerstner æ³¢å…·æœ‰æ›´å°–é”çš„æ³¢å³°å’Œæ›´å¹³ç¼“çš„æ³¢è°·ï¼Œèƒ½å¤Ÿæ›´çœŸå®åœ°è¿˜åŸæµ·æ´‹ä¸­æ³¢æµªçš„éå¯¹ç§°ç‰¹å¾ï¼Œé€‚ç”¨äºè¡¨ç°å¤§å°ºåº¦çš„æ°´ä½“åŠ¨æ€ã€‚å¹¶ä¸”ç”±äºè®¡ç®—é‡å¯æ§ï¼Œæ€§ä»·æ¯”é«˜ï¼Œä¸å°‘æ¸¸æˆä»é‡‡ç”¨å…¶ä½œä¸ºæ°´ä½“æ¸²æŸ“çš„åŸºç¡€å®ç°ã€‚\n0x06 åŸºäºç»Ÿè®¡é¢‘è°±çš„å‚æ•°åŒ–æ–¹æ³• åŸºäºç»Ÿè®¡é¢‘è°±çš„å‚æ•°åŒ–æ–¹æ³•åŒºåˆ«äºä»¥å¾€çš„ç©ºé—´åŸŸçš„æ¨¡æ‹Ÿæ–¹æ³•ï¼Œé¦–æ¬¡å¼•å…¥äº†é¢‘åŸŸçš„æ¦‚å¿µã€‚é€šè¿‡ä½¿ç”¨ä»ç†è®ºæˆ–æµ‹é‡æ•°æ®è·å¾—çš„æ³¢çš„é¢‘è°±åˆ†å¸ƒæ¥æè¿°æµ·æ´‹è¡¨é¢ï¼Œç„¶åä»é¢‘åŸŸæå–å¹…åº¦åˆ†é‡å¹¶é€šè¿‡é€†å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆIFFTï¼‰è½¬æ¢å›ç©ºé—´åŸŸï¼Œæ„é€ æ°´ä½“è¡¨é¢é«˜åº¦åœºï¼Œå°†è¡¨é¢çš„å‡ ä½•ç‰¹å¾ä½œä¸ºæ¯ä¸ªç‚¹$X$å¤„çš„é«˜åº¦ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n$$ h(X,t)=\\sum_{i=1}^{N_{s}}\\tilde{h}(\\vec{k},t)e^{\\vec{ik}X} $$ å…¶ä¸­$N_{s}$æ˜¯é¢‘è°±åˆ†é‡æ•°ï¼Œ$\\vec{k}$æ˜¯æ³¢çŸ¢é‡ï¼Œ$\\tilde{h}(\\vec{k},t)$æ˜¯ä»ç†è®ºæˆ–ç»éªŒæ³¢è°±ä¸­è·å¾—çš„å‚…é‡Œå¶åˆ†é‡ã€‚\nå¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFFTï¼‰ Mastin ç­‰ï¼ˆ1987ï¼‰[10]æå‡ºäº†åŸºäºå‚…ç«‹å¶åˆæˆä¸ç»éªŒé£æµ·é¢‘è°±æ¨¡å‹çš„æµ·æ´‹æ³¢å½¢æ¨¡æ‹ŸæŠ€æœ¯ã€‚å…¶é£æµ·é¢‘è°±æ¨¡å‹æ˜¯åŸºäº Pierson å’Œ Moskowitzï¼ˆ1964ï¼‰[18]ç”±æ³¢æµªè®°å½•æ„å»ºçš„ä¸€ä¸ªå®Œå…¨å¼€å‘çš„é£æµ·é¢‘è°±æ¨¡å‹ï¼Œå…¶åŠŸç‡è°±å¯ä»¥è¡¨ç¤ºä¸ºï¼š\n$$ F_{PM}(f)=\\frac{\\alpha g^2}{(2\\pi)^4f^5}e^{-\\frac{5}{4}(\\frac{f_{m}}{f})^4} $$ å…¶ä¸­$\\alpha=0.0081$ä¸º Phillips å¸¸é‡ï¼Œ$g$æ˜¯å¼•åŠ›å¸¸æ•°ã€‚é¢‘ç‡å³°å€¼$f_{m}$å¯ä»¥å¦‚ä¸‹è¡¨ç¤ºï¼š\n$$ f_{m}=\\frac{0.13g}{U_{10}} $$ è¯¥æ¨¡å‹æ­ç¤ºäº†å®Œå…¨å¼€å‘çš„ä¸€ç»´é£æµ·é¢‘è°±çš„å¯ä»¥ä½¿ç”¨é£é€Ÿï¼ˆ$U_{10}$ï¼‰è®¡ç®—å¾—å‡ºï¼ŒHasselmann ç­‰ï¼ˆ1980ï¼‰[19]åœ¨æ­¤åŸºç¡€ä¸Šç»“åˆæ–¹å‘ä¼ æ’­å› å­ï¼ˆ$D(f,\\theta)$ï¼‰æå‡ºäº†ä¸€ä¸ªäºŒç»´é¢‘è°±ï¼š\n$$ \\begin{aligned} F(f,\\theta)=\u0026F_{PM}(f)D(f,\\theta)\\\\ D(f,\\theta)=\u0026N_{p}^{-1}\\cos^{2p}(\\theta/2) \\end{aligned} $$ å…¶ä¸­ï¼š\n$$ \\begin{aligned} p=9.77\\left( \\frac{f}{f_{m}} \\right)^\\mu,\u0026\\quad \\mu=\\begin{cases} 4.06 \\quad \u0026if \\quad ff_{m} \\end{cases} \\\\ N_{p}=\u0026\\frac{2^{1-2p}\\pi \\Gamma(2p+1)}{\\Gamma^2(p+1)} \\end{aligned} $$ Mastin ç­‰åœ¨æ­¤åŸºç¡€ä¸Šï¼Œä½¿ç”¨æ­£å‘ FFTã€ä¸Šè¿°æ»¤æ³¢å™¨å’Œé€† FFTï¼Œä»ç™½å™ªå£°å›¾åƒä¸­ä»¥éå¸¸ç®€å•çš„æ–¹å¼åˆæˆäº†æµ·æ´‹å›¾åƒ ã€‚é€šè¿‡å¯¹ç™½å™ªå£°å›¾åƒè¿›è¡ŒäºŒç»´å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼Œä½¿ç”¨äºŒç»´é£æµ·é¢‘è°±å¯¹ FFT å¹…åº¦é¡¹è¿›è¡Œæ»¤æ³¢ï¼Œèƒ½å¤Ÿç”Ÿæˆä¸é”™çš„æ³¢æµªå¤–è§‚ã€‚\nåæ¥çš„ç ”ç©¶äººå‘˜åœ¨æ­¤åŸºç¡€ä¸Šå°è¯•ä½¿ç”¨å¤šç§é¢‘è°±å¯¹æ°´ä½“è¿›è¡Œæ¨¡æ‹Ÿï¼Œå¦‚ Premoze å’Œ Ashikhminï¼ˆ2000ï¼‰[20]çš„ JONSWAPï¼ŒTessendorfï¼ˆ2001ï¼‰çš„é«˜æ–¯ä¼ªéšæœºå’Œ Phillips ç†è®ºæ³¢è°± ã€‚è¿™äº›æ–¹æ³•åœ¨åˆ¶ä½œé™æ­¢å›¾åƒæ–¹é¢æ•ˆæœå¾ˆå¥½ï¼Œä½†ä¸é€‚åˆåŠ¨ç”»ã€‚å› ä¸ºç”¨äºè¿›è¡Œæ¨¡æ‹Ÿçš„é¢‘è°±æ•°æ®ä¸åŒ…å«åœ¨æ—¶é—´ä¸Šçš„å˜åŒ–ã€‚\nç©ºé—´-é¢‘è°±æ··åˆæ–¹æ³•ï¼ˆSpatial-Spectral Approachesï¼‰ ç”±äºä¼ ç»Ÿ FFT æ–¹æ³•éœ€è¦å°†é¢‘åŸŸæ»¤æ³¢ç»“æœè½¬æ¢ä¸ºæœ‰é™ç©ºé—´åŸŸé«˜åº¦åœºï¼Œå¯¼è‡´ç”Ÿæˆçš„æµ·é¢å°ºå¯¸å—é™ä¸”æ— æ³•å®ç°å¤šç»†èŠ‚å±‚æ¬¡ã€‚Thon ç­‰ï¼ˆ2000ï¼‰[15]æ”¹è‰¯äº†è¿™ç§æ–¹æ³•ï¼Œåœ¨ä¸€ä¸ªå°çŸ©é˜µä¸­å¯¹æµ·æ´‹é¢‘è°±è¿›è¡Œé‡‡æ ·ï¼ˆaï¼‰ï¼Œé€‰å–å…¶ä¸­åœ¨æŒ¯å¹…æ–¹é¢æœ€å…·ä»£è¡¨æ€§çš„åˆ†é‡ï¼ˆbï¼‰ï¼Œå¹¶å°†è¿™äº›åˆ†é‡çš„å€¼ï¼ˆé¢‘ç‡ã€æŒ¯å¹…ã€æ–¹å‘ï¼‰ç”¨äºæ‘†çº¿ï¼ˆtrochoidï¼‰çš„å‚æ•°ã€‚ä¸ä¼ ç»Ÿçš„ FFT æ–¹æ³•ä¸åŒï¼Œè¿™ç§æ–¹æ³•ç»“åˆäº†ç©ºé—´åŸŸçš„æ¨¡æ‹Ÿæ€æƒ³ï¼Œä½¿ç”¨ Gerstner æ³¢ç›´æ¥å åŠ æ‘†çº¿ï¼ˆeï¼‰ï¼Œæ— éœ€ä½¿ç”¨é€† FFTï¼Œä»è€Œä¿ç•™äº†å¤šç§ç»†èŠ‚å±‚æ¬¡ã€‚å¦å¤–ï¼Œè¿™ç§æ–¹æ³•æ˜¯å®Œå…¨ç¨‹åºåŒ–çš„ï¼Œå³åªåœ¨éœ€è¦æ—¶è®¡ç®—è¡¨é¢é«˜åº¦ï¼Œæ— éœ€å­˜å‚¨ç½‘æ ¼æˆ–é«˜åº¦åœºã€‚\nåŒæ—¶ï¼Œä»…é€‰å–å°‘é‡ä»£è¡¨æ€§çš„é¢‘ç‡åˆ†é‡ä¹Ÿå¸¦æ¥äº†ç²¾åº¦ä¸è¶³çš„é—®é¢˜ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒThon ç­‰å¼•å…¥äº† Perlinï¼ˆ1985ï¼‰çš„æ¹æµå‡½æ•°æ›¿æ¢æ‰€æœ‰æ²¡æœ‰è¢«é€‰æ‹©çš„åˆ†é‡ï¼š\n$$ Turbulence(P,m)=\\sum_{i=0}^{n_{o}-1}\\frac{Noise(P\\cdot m^i)}{m^i} $$ å…¶ä¸­ï¼Œ$n_{o}$æ˜¯è¦æ±‚å’Œçš„é¢‘ç‡åˆ†é‡æ€»æ•°ï¼Œ$P$æ˜¯ç©ºé—´ä¸­çš„ä¸€ä¸ªç‚¹ï¼Œ$m$æ˜¯é¢‘ç‡ä¹˜æ•°ã€‚é€šè¿‡åœ¨ç©ºé—´åŸŸä¸­æ·»åŠ è¯¥æ¹æµå‡½æ•°ï¼Œå¼•å…¥äº†çœŸå®æµ·æµªè°±ä¸­ä¸å­˜åœ¨çš„ä½é¢‘åˆ†é‡ï¼ˆfï¼‰ï¼Œè€Œè¿™äº›åˆ†é‡ä¼šåœ¨ Pierson-Moskowitz æ»¤æ³¢åè¢«å‰Šå¼±ç”šè‡³å‰”é™¤ï¼ˆaï¼‰ã€‚\næœ€ç»ˆçš„æµ·é¢æ¨¡å‹è¡¨ç¤ºä¸ºï¼š\n$$ \\begin{aligned} h(x,y,t)=\u0026 \\sum_{i=1}^nA_{i}\\cdot v(k_{i}(x\\cdot \\cos\\theta_{i}+y\\cdot \\sin \\theta_{i})-\\omega_{i}\\cdot t+\\phi_{i}) \\\\ +\u0026A_{t}\\cdot Turblence(x_{t}(t),y_{t}(t),z_{t}(t),m) \\end{aligned} $$ å…¶ä¸­ï¼Œ$A_{t}$æ˜¯æ˜¯æ¹æµçš„æŒ¯å¹…ï¼Œ$m$æ˜¯é¢‘ç‡ä¹˜æ•°ï¼Œ$x_{t}(t),y_{t}(t),z_{t}(t)$ æ˜¯ä½ç§»åˆ°æ¹æµçš„æ—¶é—´å‡½æ•°ã€‚\n0x07 åŸºäºç‰©ç†çš„æ•°å€¼æ–¹æ³• åŸºäºç‰©ç†çš„æ–¹æ³•ä½¿ç”¨ N-Sï¼ˆNavier-Stokesï¼‰æ–¹ç¨‹å¯¹æµä½“å»ºç«‹æ•°å­¦æ¨¡å‹ã€‚N-S æ–¹ç¨‹ä½œä¸ºæµä½“åŠ›å­¦çš„åŸºç¡€ï¼Œæè¿°äº†æµä½“é€Ÿåº¦å’Œè´¨é‡éšæ—¶é—´çš„å˜åŒ–è¿‡ç¨‹ï¼Œå¯ä»¥ç”¨æ¥æ¨¡æ‹Ÿå„ç§æµä½“çš„åŠ¨æ€ï¼ˆå¦‚æ°´ä½“ã€çƒŸé›¾ã€å¤§æ°”ç­‰ï¼‰ã€‚æ¨¡æ‹Ÿçš„æ ¸å¿ƒåœ¨äºå¯¹ N-S æ–¹ç¨‹çš„æ±‚è§£ï¼Œä»ä¸åŒçš„è§†è§’å‡ºå‘ï¼Œå¯ä»¥åˆ†ä¸ºä¸¤ç§æ±‚è§£æ–¹æ³•ï¼šæ¬§æ‹‰æ–¹æ³•ï¼ˆåŸºäºç½‘æ ¼ï¼‰å’Œæ‹‰æ ¼æœ—æ—¥æ–¹æ³•ï¼ˆåŸºäºç²’å­ï¼‰ã€‚\nNavier-Stokes æ–¹ç¨‹ å¯¹äºæµ·æ´‹ç­‰å¤§å‹æµä½“ï¼Œé€šå¸¸è€ƒè™‘ä¸å¯å‹ç¼©æµä½“ï¼Œå…¶å½¢å¼ä¸ºï¼š\n$$ \\begin{aligned} \\nabla \\vec{U}\u0026=0 \\\\ \\frac{\\partial \\vec{U}}{\\partial t}+\\vec{U}\\nabla \\vec{U} + \\frac{\\vec{\\nabla}p}{\\rho}\u0026-\\mu \\frac{ \\nabla^2\\vec{U}}{\\rho}-\\vec{g}=0 \\end{aligned} $$ å…¶ä¸­$\\vec{U}$ä¸ºæµä½“çš„é€Ÿåº¦ï¼Œ$\\mu$ä¸ºç²˜æ»ç³»æ•°ï¼Œ$g$ä¸ºå¼•åŠ›å¸¸æ•°ã€‚ç®—å­$\\nabla \\vec{U}$ä¸º$\\vec{U}$çš„æ¢¯åº¦ï¼Œå¯ä»¥æ ¹æ®ä¸‹å¼è®¡ç®—ï¼š\n$$ \\nabla \\vec{U}=\\left(\\frac{\\partial u}{\\partial t},\\frac{\\partial v}{\\partial t},\\frac{\\partial w}{\\partial t} \\right) $$ ç¬¬ä¸€ä¸ªæ–¹ç¨‹ä¸ºè´¨é‡å®ˆæ’æ–¹ç¨‹ï¼Œå¯¹äºä¸å¯å‹ç¼©æµä½“ï¼Œæ„å‘³ç€æµä½“çš„å¯†åº¦éšæ—¶é—´ä¿æŒä¸å˜ï¼›ç¬¬äºŒä¸ªæ–¹ç¨‹ä¸ºåŠ¨é‡å®ˆæ’æ–¹ç¨‹ï¼Œæµä½“çš„åŠ é€Ÿåº¦$\\frac{\\partial \\vec{U}}{\\partial t}$ç­‰äºæ–½åŠ äºå…¶ä¸Šçš„åŠ›é™¤ä»¥å…¶å¯†åº¦ã€‚\næ¬§æ‹‰æ–¹æ³•ï¼ˆEulerian approachesï¼‰ æ¬§æ‹‰æ–¹æ³•è€ƒå¯Ÿç©ºé—´ä¸­çš„å›ºå®šç‚¹ï¼Œé€šè¿‡ç›‘æµ‹ç¦»æ•£ç½‘æ ¼ä¸Šçš„é€Ÿåº¦åœºã€å‹åŠ›åœºã€å¯†åº¦åœºç­‰ç‰©ç†å‚æ•°çš„å˜åŒ–è§„å¾‹ï¼Œå»ºç«‹å…¨å±€æµåœºæ¼”åŒ–æ¨¡å‹ã€‚è¿™ä¸€æ–¹æ³•çš„ä¼˜åŠ¿åœ¨äºèƒ½å¤Ÿå¾ˆæ–¹ä¾¿åœ°è®¡ç®—è§„åˆ™ç½‘æ ¼ä¸Šçš„æ¢¯åº¦ï¼Œé€‚ç”¨äºå¤§è§„æ¨¡çš„æµä½“æ¨¡æ‹Ÿã€‚\nKass å’Œ Millerï¼ˆ1990ï¼‰[12]é¦–æ¬¡æå‡ºäº†åŸºäºç‰©ç†æ–¹æ³•çš„æ€æƒ³ï¼Œé€šè¿‡ä¸‰ä¸ªå‡è®¾ï¼ˆæ°´é¢ä¸ºé«˜åº¦åœºã€å‚ç›´é€Ÿåº¦å¯å¿½ç•¥ã€æ°´å¹³é€Ÿåº¦æ’å®šï¼‰å°† N-S æ–¹ç¨‹ç®€åŒ–ä¸ºçº¿æ€§æ³¢åŠ¨æ–¹ç¨‹ï¼š\n$$ \\frac{{\\partial^2h}}{\\partial t^2}=gd \\frac{{\\partial ^2h}}{\\partial x^2} $$ å…¶ä¸­æ³¢é€Ÿä¸æ°´æ·±çš„å¹³æ–¹æ ¹æˆæ­£æ¯”$c \\propto \\sqrt{ gd }$ã€‚ä¸ºäº†æ±‚è§£è¿™ä¸ªæ–¹ç¨‹ï¼Œéœ€è¦æ„é€ è¿ç»­åå¾®åˆ†æ–¹ç¨‹çš„ç¦»æ•£å½¢å¼ï¼ŒKass å’Œ Miller ä½¿ç”¨æœ‰é™å·®åˆ†æŠ€æœ¯å°†å…¶ç¦»æ•£è¿‘ä¼¼ä¸ºï¼š\n$$ \\begin{aligned} \\frac{{\\partial^2h_{i}}}{\\partial t^2}=-\u0026g\\left( \\frac{{d_{i-1}+d_{i}}}{2 (\\Delta x)^2}(h_{i}-h_{i-1}) \\right) \\\\ +\u0026g\\left( \\frac{{d_{i}+d_{i+1}}}{2 (\\Delta x)^2}(h_{i+1}-h_{i}) \\right) \\end{aligned} $$ è¿™ç§åœ¨è¿ç»­å‡åŒ€ç½‘æ ¼ä¸Šçš„æœ‰é™å·®åˆ†å°†å°†æ°´ä½“ç¦»æ•£è¡¨ç¤ºä¸ºæ°´é¢é«˜åº¦åœºï¼ˆ$h_{i}$ï¼‰ã€é€Ÿåº¦åœºï¼ˆ$u_{i}$ï¼‰å’Œæ°´åº•ï¼ˆ$b_{i}$ï¼‰ï¼Œä½“ç°äº†æ¬§æ‹‰æ–¹æ³•çš„æ€æƒ³ã€‚\næ‹‰æ ¼æœ—æ—¥æ–¹æ³•ï¼ˆLagrangian approachesï¼‰ æ‹‰æ ¼æœ—æ—¥æ–¹æ³•åŸºäºç»„æˆæµä½“çš„ç²’å­ï¼Œè·Ÿè¸ªå¹¶è€ƒå¯Ÿæ¯ä¸ªç²’å­çš„è¿åŠ¨è½¨è¿¹ã€é€Ÿåº¦ã€å‹å¼ºã€å¯†åº¦ç­‰éšæ—¶é—´çš„å˜åŒ–ã€‚è¿™ä¸€æ–¹æ³•çš„ä¼˜åŠ¿åœ¨äºç²’å­é—´çš„ç‹¬ç«‹æ€§æ›´åˆ©äº GPU å¹¶è¡Œè¿ç®—ï¼Œé€‚ç”¨äºæ¨¡æ‹Ÿæµä½“çš„ç»†èŠ‚ï¼Œä½†å¤„ç†å¤§è§„æ¨¡æµä½“æ—¶æ•ˆç‡è¾ƒä½ã€‚\nStam å’Œ Fiumeï¼ˆ1995ï¼‰[13]é¦–æ¬¡å¼•å…¥å°† SPHï¼ˆSmoothed Particle Hydrodynamicsï¼Œå…‰æ»‘ç²’å­æµä½“åŠ¨åŠ›å­¦ï¼‰å¼•å…¥å›¾å½¢å­¦ï¼Œä»æ‹‰æ ¼æœ—æ—¥è§†è§’æè¿°æµä½“ã€‚SPH çš„æ ¸å¿ƒæ€æƒ³åŒ…æ‹¬å°†æµä½“ç¦»æ•£ä¸ºä¸€ç»„ç²’å­ï¼Œè¿™äº›ç²’å­ä¸ºå¯é€šè¿‡æ ¸å‡½æ•°å½±å“å…¶é‚»å±…çš„æ½œåœ¨éšå¼è¡¨é¢ï¼ˆä¹Ÿç§°ä¸º blobs æˆ– metaballsï¼‰ã€‚åˆ©ç”¨æ ¸å‡½æ•°å¯¹ç‰©ç†é‡è¿›è¡ŒåŠ æƒå¹³å‡ï¼Œä»è€Œè¿‘ä¼¼æ±‚è§£ N-S æ–¹ç¨‹ã€‚\nåœ¨æ‹‰æ ¼æœ—æ—¥è§†è§’ä¸‹ï¼ŒN-S æ–¹ç¨‹å¯ä»¥è¢«ç®€åŒ–ï¼šè€ƒè™‘åˆ°æ¯ä¸ªç²’å­éƒ½æœ‰è‡ªå·±çš„è´¨é‡ï¼Œå®ƒä»¬çš„æ€»å’Œç­‰äºæµä½“çš„æ€»è´¨é‡ï¼Œå¹¶ä¸”éšæ—¶é—´ä¿æŒä¸å˜ï¼Œå¯ä»¥çœç•¥ N-S çš„è´¨é‡å®ˆæ’æ–¹ç¨‹ï¼›åœ¨åŠ¨é‡å®ˆæ’æ–¹ç¨‹ä¸­ï¼Œç”±äºæµä½“ç”±ç²’å­æœ¬èº«ä¼ è¾“ï¼Œå¯ä»¥çœç•¥éçº¿æ€§å¹³æµé¡¹ï¼ˆ$\\vec{U}\\nabla \\vec{U}$ï¼‰ã€‚æœ€åï¼Œåªéœ€è¦ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹æ¥æè¿°æµä½“çš„é€Ÿåº¦ï¼š\n$$ \\frac{{\\partial \\vec{U}}}{\\partial t}=\\frac{1}{\\rho}(-\\nabla p+\\mu \\nabla^2\\vec{U}+\\rho g) $$ å…¶ä¸­ï¼Œ$\\nabla p$ä¸ºå‹åŠ›ï¼Œ$\\mu \\nabla^2\\vec{U}$ä¸ºç²˜æ€§åŠ›ï¼Œ$\\rho g$ä¸ºå¤–éƒ¨å‹åŠ›ã€‚ç›¸å…³ç‰©ç†é‡å¯ä»¥å¦‚ä¸‹è¿‘ä¼¼ï¼š\n$$ S_{i}=\\sum_{j=1}^{N_{p}}m_{j}{\\frac{S_{j}}{\\rho_{j}}}W(r,R) $$ å¯¹å‹å¼ºè®¡ç®—æ¢¯åº¦å¯ä»¥å¾—åˆ°å‹åŠ›ï¼Œå¯¹é€Ÿåº¦åº”ç”¨æ‹‰æ™®æ‹‰æ–¯ç®—å­å¯ä»¥è®¡ç®—ç²˜æ»åŠ›ã€‚\nFeldman å’Œ Bonetï¼ˆ2007ï¼‰[42]å¯¹åŸºäº SPH çš„æ¡†æ¶è¿›è¡Œæ”¹è¿›ï¼Œæå‡ºäº†åŠ¨æ€ç²’å­ç»†åŒ–çš„ä¸€èˆ¬æ–¹æ³•ï¼Œæ ¹æ®å›ºå®šçš„ç»†åŒ–æ¨¡å¼è·å¾—å­ç²’å­çš„æœ€ä½³è´¨é‡åˆ†å¸ƒï¼›Winchenbach å’Œ Kolbï¼ˆ2021ï¼‰[43]å¯¹ç»†åŒ–è¿‡ç¨‹è¿›è¡Œæ”¹è¿›ï¼Œä½¿ç”¨ä¸€ä¸ªç¦»æ•£åŒ–çš„ç›®æ ‡å‡½æ•°è‡ªé€‚åº”ä¼˜åŒ–ç»†åŒ–æ¨¡å¼ï¼Œæ˜¾è‘—é™ä½äº†å› å›ºå®šæ¨¡å¼å¸¦æ¥çš„è¯¯å·®ï¼Œèƒ½å¤Ÿæ¨¡æ‹Ÿé«˜è¾¾ 1:1,000,000 çš„è‡ªé€‚åº”ä½“ç§¯æ¯”çš„ä¸å¯å‹ç¼©ä½ç²˜åº¦æ¹æµã€‚\næ‹‰æ ¼æœ—æ—¥-æ¬§æ‹‰æ··åˆçš„æ–¹æ³•ï¼ˆHybrid approachesï¼‰ ä¸ºäº†ç»“åˆè¿™ä¸¤ç§æ–¹æ³•çš„ä¼˜åŠ¿ï¼Œç ”ç©¶äººå‘˜è¿˜å¼€å‘äº†ç»“åˆè¿™ä¸¤ç§æŠ€æœ¯çš„æ··åˆæ–¹æ³•ï¼Œå³ä½¿ç”¨æ¬§æ‹‰æ–¹æ³•æ¨¡æ‹Ÿæµä½“ä¸»ä½“éƒ¨åˆ†ï¼Œå†ä½¿ç”¨æ‹‰æ ¼æœ—æ—¥æ–¹æ³•æ¨¡æ‹Ÿå°å°ºåº¦ç»†èŠ‚ï¼Œä¾‹å¦‚æ³¡æ²«ï¼Œæ°”æ³¡æˆ–å–·é›¾ï¼Œäº‹å®ä¸Šï¼Œè¿™ç§åˆæˆçš„æ–¹æ³•ä¹Ÿè·å¾—äº†éå¸¸é€¼çœŸçš„ç»“æœã€‚\nBrein å’Œ Hodginsï¼ˆ1995ï¼‰[14]é¦–æ¬¡ç»“åˆäº†è¿™ä¸¤ç§æ–¹æ³•ï¼Œæ¨¡æ‹Ÿæµä½“åœ¨æ’å‡»æ—¶äº§ç”Ÿçš„æ³¢æµªã€é£æº…ç°è±¡ï¼›Takahashi ç­‰ï¼ˆ2003ï¼‰[38]åœ¨æ¬§æ‹‰æ¨¡æ‹Ÿä¸­åµŒå…¥ç²’å­ç³»ç»Ÿï¼Œåˆ›å»ºåŒ…æ‹¬é£æº…å’Œæ³¡æ²«åœ¨å†…çš„å¤æ‚åœºæ™¯ï¼›Greenwood å’Œ Houseï¼ˆ2004ï¼‰[39]ä½¿ç”¨æ°´å¹³é›†æ–¹æ³•åœ¨æµä½“ç©ºè…”ã€æµä½“-ç©ºæ°”è¾¹ç•Œå¤„åˆ›å»ºæ°”æ³¡ï¼Œå®ç°äº†è§†è§‰ä¸Šæ›´ä¸ºçœŸå®çš„æ°´ä½“è¡¨ç°ã€‚\nThÃ¼rey ç­‰ï¼ˆ2006ï¼‰[40]æå‡ºäº†ä¸€ç§å°†äºŒç»´æµ…æ°´æ¨¡æ‹Ÿä¸ä¸‰ç»´è‡ªç”±è¡¨é¢æµä½“æ¨¡æ‹Ÿç›¸ç»“åˆçš„æ–¹æ³•ï¼Œé€šè¿‡ä½¿ç”¨ Lattice Boltzmann æ–¹æ³•æ±‚è§£ Saint-Venant æ–¹ç¨‹ï¼Œå®ç°äº† 2D ä¸ 3D ä»¿çœŸçš„è€¦åˆï¼›ä¹‹åä½œè€…æ‰©å±•äº†è¿™é¡¹å·¥ä½œï¼Œå¼•å…¥ SPH æ–¹æ³•è¡¨ç¤ºç²’å­é—´çš„ç›¸äº’ä½œç”¨ï¼ˆ2007ï¼‰[41]ã€‚\n0x08 æ³¢ç²’å­æ–¹æ³• æ³¢ç²’å­æ–¹æ³•ä½¿ç”¨ç²’å­ä»£è¡¨æ°´æ³¢ï¼Œå…è®¸å…¶å‘ç”Ÿåå°„ä»¥åŠå’Œå…¶å®ƒå¯¹è±¡ç›¸äº’ä½œç”¨ã€‚è¿™ç§æ–¹æ³•ç»“åˆæ³¢ç²’äºŒè±¡æ€§çš„æ€æƒ³ï¼Œå°†ä¸‰ç»´æ°´ä½“æ³¢å½¢æ¨¡æ‹Ÿè½¬åŒ–ä¸ºå¯¹äºŒç»´ç²’å­è¿åŠ¨è¿›è¡Œæ¨¡æ‹Ÿã€‚\næ³¢ç²’å­ï¼ˆWave Particleï¼‰ Yuksel ç­‰ï¼ˆ2007ï¼‰[16]é¦–æ¬¡å¼•å…¥æ³¢ç²’å­ï¼ˆwave particleï¼‰çš„æ¦‚å¿µï¼Œæ¨¡æ‹Ÿæ°´ä½“ä¸å…¶å®ƒç‰©ä½“çš„äº¤äº’ã€‚æ¯ä¸ªæ³¢æµªç²’å­æºå¸¦æŒ¯å¹…ã€æ³¢é•¿ã€ä¼ æ’­æ–¹å‘ç­‰å±æ€§ï¼Œé€šè¿‡å åŠ å±€éƒ¨åå·®å‡½æ•°ç”Ÿæˆæ°´é¢é«˜åº¦åœºã€‚\n$$ D_{i}(x,t)=\\frac{a_{i}}{2}\\left(\\cos{\\frac{\\pi|x-x_{i}(t)|}{2}}+1\\right)\\Pi\\left(\\frac{{|x-x_{i}(t)|}}{2r_{i}}\\right) $$ å…¶ä¸­$a_{i}$æ˜¯æ³¢ç²’å­çš„æŒ¯å¹…ï¼Œ$r_{i}$æ˜¯æ³¢ç²’å­çš„åŠå¾„ï¼Œ$\\Pi(x)$æ˜¯çŸ©å½¢å‡½æ•°ï¼Œä¿è¯æ³¢å½¢åœ¨æœ‰é™èŒƒå›´å†…ä¸å‘ç”Ÿçªå˜ï¼š\n$$ \\begin{equation} \\Pi(x)=\\left\\{ \\begin{aligned} 1 \u0026 , \u0026 |x| \u003c \\frac{1}{2} \\\\ \\frac{1}{2} \u0026, \u0026 |x| = \\frac{1}{2} \\\\ 0 \u0026, \u0026 |x| \\ge \\frac{1}{2} \\end{aligned} \\right. \\end{equation} $$ ä¸ºäº†æ¨¡æ‹ŸçœŸå®æ°´æ³¢çš„æ¨ªçºµæ³¢å¤åˆæ•ˆåº”ï¼ŒYuksel ç­‰æ‰©å±•äº†é«˜åº¦åœºï¼Œå¼•å…¥æ°´å¹³åå·®åˆ†é‡$\\eta_{xy}$ï¼š\n$$ \\begin{aligned} \\eta_{xy}(x,t)=\u0026\\sum_{i}D_{i}^L(x,t) \\\\ D_{i}^L(x,t)=\u0026L_{i}(\\hat{u}_{i}\\cdot(x-x_{i}))D_{i}(x,t) \\\\ L_{i}(u)=\u0026-\\sin\\left( \\frac{2\\pi u}{l_{i}} \\right)\\Pi\\left( \\frac{u}{l_{i}} \\right)\\hat{u}_{i} \\end{aligned} $$ å…¶ä¸­ï¼Œ$D_{i}^L$æ˜¯çºµå‘å±€éƒ¨åå·®å‡½æ•°ï¼Œ$L_{i}$æ˜¯æè¿°çºµå‘æ³¢å½¢çš„å‡½æ•°ï¼Œæ¨¡æ‹Ÿæ³¢ç²’å­çš„åœ†å‘¨è¿åŠ¨ã€‚\næ­¤å¤–ï¼Œå½“æ³¢å‰æ‰©å±•è¶…è¿‡æ³¢ç²’å­åŠå¾„ä¸€åŠä»¥ä¸Šæ—¶ï¼Œå°†æ³¢ç²’å­åˆ†è£‚ä¸ºä¸‰ä¸ªå­æ³¢ç²’å­ï¼ˆæŒ¯å¹…å’Œåˆ†æ•£è§’ä¸ºåŸæ³¢ç²’å­çš„ä¸‰åˆ†ä¹‹ä¸€ï¼Œæ³¢ç²’å­åŠå¾„ä¸å˜ï¼‰ï¼Œè¿™ç§ç»†åˆ†æ–¹æ³•å¯ä»¥ä¿æŒæ³¢å‰çš„è¿ç»­æ€§ï¼Œå…¼é¡¾æ³¢å½¢çš„æ‰©å±•å’Œæ”¶ç¼©ã€‚\næ°´é¢æ³¢åŒ…æ–¹æ³•ï¼ˆWater Wave Packetsï¼‰ Jeschke å’Œ Wojtanï¼ˆ2017ï¼‰[21]åœ¨æ³¢ç²’å­ç†è®ºçš„åŸºç¡€ä¸Šï¼Œæå‡ºäº†æ°´é¢æ³¢åŒ…ï¼ˆwater packetsï¼‰æ–¹æ³•ï¼Œå°†æ°´æ³¢èƒ½é‡å°è£…ä¸ºæ³¢åŒ…å•å…ƒã€‚ä¸ä¼ ç»Ÿæ³¢ç²’å­æ–¹æ³•ä¸åŒï¼Œæ¯ä¸ªæ³¢åŒ…åŒ…å«ä¸€ç»„æ³¢é•¿å’Œæ³¢åˆ—ï¼Œå…¶è¿åŠ¨ç”±ä¸¤ä¸ªé€Ÿåº¦æ§åˆ¶ï¼š\nç¾¤é€Ÿåº¦ï¼šå†³å®šæ³¢åŒ…æ•´ä½“èƒ½é‡ä¼ æ’­æ–¹å‘ ç›¸é€Ÿåº¦ï¼šå†³å®šæ³¢åŒ…å†…éƒ¨æ³¢å³°è¿åŠ¨é€Ÿåº¦ åŸºäº Airy æ³¢ç†è®ºï¼Œæ³¢åŒ…é«˜åº¦åœºé€šè¿‡å¦‚ä¸‹å…¬å¼è¿‘ä¼¼ï¼š\n$$ \\eta(x,t)\\approx \\sum_{j=1}^N a_{j}\\phi(\\hat{x})\\cos(k_{j}\\cdot(\\hat{x}-X_{pg})) $$ å…¶ä¸­ï¼Œ$\\phi(x)$ä¸ºé«˜æ–¯åŒ…ç»œå‡½æ•°ï¼Œ$X_{pg}$ä¸ºç›¸é€Ÿåº¦ä¸ç¾¤é€Ÿåº¦ç´¯è®¡ä½ç§»å·®ï¼Œ$a_{j}$å’Œ$k_{j}$åˆ†åˆ«è¡¨ç¤ºæ³¢åŒ…çš„æŒ¯å¹…å’Œæ³¢æ•°ã€‚ä¸ºäº†ç»´æŒèƒ½é‡å®ˆæ’ï¼Œæ ¹æ®é¢ç§¯å˜åŒ–åŠ¨æ€è°ƒæ•´æ³¢åŒ…æŒ¯å¹…ï¼š\n$$ a_{j}(t_{n+1})=a_{j}(t_{n})\\sqrt{ {\\frac{(\\rho g+\\sigma k_{n}^2)A_{n}}{(\\rho g+\\sigma k_{n+1}^2)A_{n+1}}} } $$ å…¶ä¸­ï¼Œ$A_{n}$ä¸ºæ³¢åŒ…é¢ç§¯ï¼Œ$\\rho,\\sigma$åˆ†åˆ«ä¸ºæ°´å¯†åº¦å’Œå¼ åŠ›ã€‚\næ°´é¢å°æ³¢æ–¹æ³•ï¼ˆWater Surface Waveletsï¼‰ Jeschke ç­‰ï¼ˆ2018ï¼‰[22]æå‡ºçš„æ°´é¢å°æ³¢æ–¹æ³•ï¼ˆwater surface waveletsï¼‰åœ¨æ°´é¢æ³¢åŒ…ç®—æ³•åŸºç¡€ä¸Šè¿›è¡Œäº†æ”¹è¿›ã€‚é€šè¿‡å¼•å…¥å°æ³¢å˜æ¢ï¼Œå°†æ°´é¢é«˜åº¦åœºåˆ†è§£ä¸ºç©ºé—´-é¢‘ç‡æ–¹å‘çš„æŒ¯å¹…å‡½æ•°ï¼š\n$$ \\eta(x,t)=Re\\int_{\\mathbb{R}^2} A(x,k,t)e^{i(k\\cdot x-\\omega(k)t)}dk $$ å…¶ä¸­æŒ¯å¹…å‡½æ•°$A(x,k,t)$åŒ…å«ä½ç½®$x$ï¼Œæ³¢çŸ¢é‡$k$å’Œæ—¶é—´$t$ã€‚è¿™ç§å˜æ¢å°†é«˜é¢‘æ³¢åŠ¨ä¿¡æ¯ç¼–ç åˆ°æŒ¯å¹…å‡½æ•°ä¸­ï¼Œä½¿å…¶ç©ºé—´å˜åŒ–æ›´å¹³æ»‘ï¼Œé™ä½äº†å¯¹ç½‘æ ¼åˆ†è¾¨ç‡çš„è¦æ±‚ã€‚\n0x09 åŸºäºæ·±åº¦å­¦ä¹ çš„æ–¹æ³• è¿‘å¹´æ¥ï¼Œæ·±åº¦å­¦ä¹ æŠ€æœ¯é€æ¸è¢«ç ”ç©¶äººå‘˜å¼•å…¥æ°´ä½“æ¨¡æ‹Ÿé¢†åŸŸï¼Œé€šè¿‡ä½¿ç”¨åŸºäºæ·±åº¦å­¦ä¹ çš„æ–¹æ³•ï¼Œä»¥è¾ƒå°çš„è®¡ç®—æˆæœ¬è¿‘ä¼¼æ±‚è§£æµä½“åŠ¨åŠ›å­¦æ–¹ç¨‹ï¼ˆN-S æ–¹ç¨‹ï¼‰ï¼Œèƒ½å¤Ÿæå‡æ¨¡æ‹Ÿæ•ˆç‡å’Œé€¼çœŸåº¦ã€‚å¯¹åº”æ±‚è§£ N-S çš„ä¸¤ç§ä¸»æµè§†è§’ï¼Œä½¿ç”¨æ·±åº¦å­¦ä¹ çš„åŠ é€Ÿä¹Ÿåˆ†ä¸ºä¸¤å¤§ç±»åˆ«ï¼šå¯¹æ¬§æ‹‰æˆ–æ‹‰æ ¼æœ—æ—¥æ–¹æ³•è¿›è¡ŒåŠ é€Ÿï¼Œä¹Ÿæœ‰ç ”ç©¶äººå‘˜åœ¨è¿™æ–¹é¢åšäº†ä¸€äº›æ€»ç»“[23-24]ã€‚\nå›å½’æ£®æ—ï¼ˆRegression Forestï¼‰ LadickyÌ ç­‰ï¼ˆ2015ï¼‰[25]é’ˆå¯¹ä¼ ç»ŸåŸºäºç²’å­çš„æµä½“æ¨¡æ‹Ÿæ–¹æ³•ï¼ˆå¦‚ SPHï¼ŒPBF ç­‰ï¼‰è®¡ç®—æˆæœ¬é«˜ã€æ­¥é•¿å—é™ç­‰é—®é¢˜ï¼Œé¦–åˆ›æ€§åœ°æå‡ºäº†ä¸€ç§æ•°æ®é©±åŠ¨çš„åŸºäºæœºå™¨å­¦ä¹ çš„æ–¹æ³•ã€‚ä»–ä»¬å°†æ±‚è§£ N-S æ–¹ç¨‹çš„è¿‡ç¨‹è½¬åŒ–ä¸ºå›å½’é—®é¢˜ï¼Œé€šè¿‡è®­ç»ƒå›å½’æ£®æ—æ¨¡å‹å­¦ä¹ å¹¶é¢„æµ‹ç²’å­åŠ é€Ÿåº¦ã€‚ç‰¹å¾å‘é‡ç›´æ¥å¯¹åº” N-S æ–¹ç¨‹ä¸­çš„ç²˜åº¦ã€å¼ åŠ›ã€å‹åŠ›å’Œä¸å¯å‹ç¼©çº¦æŸï¼š\n$$ \\begin{aligned} \u0026\\Phi_{X,R}^{vise}(x_{i})=\\frac{\\mu}{\\rho_{0}}\\left( \\sum_{j\\in X} v_{j}\\Omega_{R}(x_{j}-x_{i})-v_{i}\\sum_{j\\in X} \\Omega_{R}(x_{j}-x_{i}) \\right)\\\\ \u0026\\Phi_{X,R}^{ten}(x_{i})=\\frac{\\sigma}{\\rho_{0}}\\left( \\sum_{j\\in X} x_{j}\\Omega_{R}(x_{j}-x_{i})-x_{i}\\sum_{j\\in X} \\Omega_{R}(x_{j}-x_{i}) \\right)\\\\ \u0026\\Phi_{X,R}^{pres}(x_{i})=\\frac{k}{\\rho_{0}}\\nabla \\sum_{j\\in X} \\Omega_{R}(x_{j}-x_{i})\\\\ \u0026\\Phi_{X,R}^{comp}(x_{i})=\\phi_{X,R}^O(x_{i}) \\end{aligned} $$ è¯¥ç‰¹å¾å‘é‡è®¾è®¡ä½¿å¾—æ¨¡å‹èƒ½å¤Ÿåœ¨ä¿æŒç‰©ç†åˆç†æ€§çš„å‰æä¸‹ï¼Œå®ç°æ¯”ä¼ ç»Ÿ SPH æ–¹æ³•å¿« 10-1000 å€çš„å®æ—¶æ¨¡æ‹Ÿé€Ÿåº¦ã€‚\nå·ç§¯ç¥ç»ç½‘ç»œï¼ˆConvolutional Neural Networkï¼‰ Tompson ç­‰ï¼ˆ2017ï¼‰[26]æå‡ºäº†ä¸€ç§åŸºäºå·ç§¯ç¥ç»ç½‘ç»œåŠ é€Ÿæ¬§æ‹‰æµä½“æ¨¡æ‹Ÿçš„æ–¹æ³•ï¼Œä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œæ›¿ä»£ä¼ ç»Ÿå‹åŠ›æŠ•å½±æ±‚è§£å™¨ï¼Œç»“åˆæ— ç›‘ç£å­¦ä¹ æ¡†æ¶æé«˜è®¡ç®—æ•ˆç‡ã€‚\nè¯¥æ–¹æ³•çš„æ ¸å¿ƒåœ¨äºä½¿ç”¨ CNNï¼ˆå·ç§¯ç¥ç»ç½‘ç»œï¼‰é¢„æµ‹ä¸å¯å‹ç¼©æµä½“çš„å‹åŠ›åœºï¼Œä»£æ›¿ä¼ ç»Ÿæ•°å€¼æ–¹æ³•ä¸­å¯¹ä¸€ä¸ªå¤§å‹ç¨€ç–çº¿æ€§ç³»ç»Ÿè¿›è¡Œæ±‚è§£çš„è¿‡ç¨‹ã€‚å…·ä½“è€Œè¨€ï¼Œç ”ç©¶äººå‘˜è®¾è®¡äº†ä¸€ä¸ªä¸“é—¨çš„ç½‘ç»œç»“æ„ï¼Œç½‘ç»œçš„è¾“å…¥ä¸ºé€Ÿåº¦åœºçš„æ•£åº¦å’Œè¾¹ç•Œæ¡ä»¶ï¼Œè¾“å‡ºä¸ºå¯¹æµä½“å‹åŠ›åœºçš„ä¼°è®¡ã€‚\nå®éªŒç»“æœè¡¨æ˜ï¼Œè¯¥æ–¹æ³•åœ¨äºŒç»´å’Œä¸‰ç»´æ¨¡æ‹Ÿä¸­éƒ½èƒ½å®ç°å®æ—¶æ€§èƒ½ï¼Œå¹¶ä¸”åœ¨ä¿æŒç‰©ç†å‡†ç¡®æ€§çš„åŒæ—¶ï¼Œæ˜¾è‘—æé«˜äº†è®¡ç®—æ•ˆç‡ã€‚â€‹\nXiao ç­‰ï¼ˆ2018ï¼‰[27]åœ¨æ­¤åŸºç¡€ä¸Šæ”¹å˜äº†ç½‘ç»œçš„è¾“å…¥ï¼šæ ¹æ®ç¦»æ•£åŒ–æ¬§æ‹‰ç½‘æ ¼ç»“æ„å’Œä¸­é—´é€Ÿåº¦ä½œä¸ºè¾“å…¥ï¼Œé¢„æµ‹æ³Šæ¾ç³»ç»Ÿçš„è§£ï¼›Zhang ç­‰ï¼ˆ2023ï¼‰[28]é€šè¿‡è®­ç»ƒ CNN æ±‚è§£ ISPHï¼ˆä¸å¯å‹ç¼©å…‰æ»‘ç²’å­æµä½“åŠ¨åŠ›å­¦ï¼‰ä¸­çš„ PPEï¼ˆæ³Šæ¾å‹åŠ›æ–¹ç¨‹ï¼‰ï¼Œé¦–æ¬¡è®­ç»ƒäº†ä¸€ä¸ªæ‹‰æ ¼æœ—æ—¥è§†è§’çš„ CNN æ¨¡å‹ã€‚\nå›¾ç¥ç»ç½‘ç»œï¼ˆGraph Neural Networkï¼‰ Sanchez-Gonzalez ç­‰ï¼ˆ2020ï¼‰[32]é¦–æ¬¡æå‡ºäº†åŸºäºå›¾ç¥ç»ç½‘ç»œçš„æ±‚è§£å™¨ï¼ˆGNSï¼‰ï¼Œå°†å›¾ç¥ç»ç½‘ç»œå¼•å…¥æµä½“æ¨¡æ‹Ÿï¼šç”¨å›¾ä¸­çš„èŠ‚ç‚¹è¡¨ç¤ºç‰©ç†ç³»ç»Ÿçš„ç²’å­ï¼Œå¹¶é€šè¿‡å­¦ä¹ çš„ä¿¡æ¯ä¼ é€’æ¥è®¡ç®—æµä½“åŠ¨åŠ›å­¦ï¼›Li å’Œ Farimaniï¼ˆ2022ï¼‰[34]ä½¿ç”¨ GNN åŠ é€Ÿæ‹‰æ ¼æœ—æ—¥æµä½“æ¨¡æ‹Ÿï¼›Zhang ç­‰ï¼ˆ2024ï¼‰[34]ä½¿ç”¨ GNN ä»£æ›¿ CNN å¯¹ ISPH çš„ PPE è¿›è¡Œæ±‚è§£ï¼Œå¢åŠ äº†å¯¹éç»“æ„åŒ–æ•°æ®çš„å¤„ç†ï¼›Higaki ç­‰ï¼ˆ2025ï¼‰[35]åœ¨ GNS çš„åŸºç¡€ä¸Šæå‡ºäº†é€æ­¥å¢å¼ºçš„ GNSï¼Œè¯æ˜äº†åœ¨å›ºå®šç²’å­/èŠ‚ç‚¹å¤§å°æ—¶ï¼Œæ‹‰æ ¼æœ—æ—¥æ±‚è§£å™¨çš„æ—¶é—´æ­¥é•¿å¯ä»¥æ˜¾è‘—å¢åŠ ã€‚\n0x0a æ€»ç»“ å„ç±»æ¨¡æ‹Ÿæ–¹æ³•æ€»ç»“ æœ¬æ–‡ä¸»è¦ä»‹ç»äº†è¿‘ 50 å¹´ä»¥æ¥è®¡ç®—æœºå›¾å½¢å­¦ä¸­å¯¹æ°´ä½“æ¨¡æ‹Ÿçš„å„é¡¹ç ”ç©¶å·¥ä½œï¼Œç ”ç©¶äººå‘˜æå‡ºäº†å¤§é‡ä¸”å¤šæ ·çš„æ¨¡æ‹Ÿæ–¹æ³•ï¼Œæˆ‘ä»¬å¤§è‡´å¯ä»¥å°†è¿™äº›æ–¹æ³•åˆ†ä¸ºå…­ä¸ªç±»åˆ«ã€‚å…·ä½“è€Œè¨€ï¼ŒåŸºäºå‡¹å‡¸è´´å›¾çš„æ–¹æ³•å’Œçº¿æ€§æ³¢å½¢å åŠ æ–¹æ³•æ˜¯å¯¹æ°´ä½“æ¨¡æ‹Ÿçš„æ—©æœŸå°è¯•ï¼Œè¿™äº›æ–¹æ³•è™½ç„¶èƒ½åœ¨è§†è§‰ä¸Šè·å¾—ä¸é”™çš„æ¨¡æ‹Ÿæ•ˆæœï¼Œä½†ç¼ºä¹ç‰©ç†äº¤äº’æ€§ï¼Œæ— æ³•è¡¨ç°åŠ¨æ€ç»†èŠ‚ï¼›éšç€ç ”ç©¶çš„è¿›å±•ï¼ŒåŸºäºç»Ÿè®¡é¢‘è°±çš„å‚æ•°åŒ–æ–¹æ³•å’ŒåŸºäºç‰©ç†çš„æ•°å€¼æ–¹æ³•é€æ¸æˆä¸ºä¸»æµï¼Œè¿™äº›æ–¹æ³•åœ¨æ»¡è¶³äº†äº¤äº’æ€§çš„åŒæ—¶ï¼Œèƒ½å¤Ÿæä¾›æå…¶æ‹ŸçœŸçš„æ´‹é¢å¤–è§‚ï¼Œä½†å› ä¸ºè®¡ç®—å¤æ‚åº¦è¾ƒé«˜ï¼Œéš¾ä»¥æ»¡è¶³å®æ—¶æ¸²æŸ“çš„è¦æ±‚ï¼›è¿‘å¹´æ¥ï¼Œæ³¢ç²’å­æ–¹æ³•å’ŒåŸºäºæ·±åº¦å­¦ä¹ çš„æŠ€æœ¯ä¹Ÿé™†ç»­æ¶Œç°ï¼Œä¸ºæ°´ä½“æ¨¡æ‹Ÿå¸¦æ¥äº†æ–°çš„å¯èƒ½æ€§ã€‚\næ°´ä½“æ³¢å½¢æ¨¡æ‹Ÿç±»åˆ« ä¸»è¦æ€æƒ³ ä¼˜åŠ¿ åŠ£åŠ¿ é€‚ç”¨åœºæ™¯ åŸºäºå‡¹å‡¸è´´å›¾çš„æ–¹æ³• é€šè¿‡é¢„å®šä¹‰çš„çº¹ç†ï¼ˆæ³•çº¿è´´å›¾/é«˜åº¦è´´å›¾ï¼‰æ¨¡æ‹Ÿæ°´é¢æ³¢çº¹ï¼Œåˆ©ç”¨å…‰å½±å˜åŒ–äº§ç”ŸåŠ¨æ€æ•ˆæœã€‚ è®¡ç®—å¼€é”€æä½ï¼›å®æ—¶æ€§é«˜ï¼›å®ç°ç®€å• æ— ç‰©ç†äº¤äº’æ€§ï¼›ç¼ºä¹åŠ¨æ€ç»†èŠ‚å˜åŒ–ï¼›è¿‘æ™¯æ•ˆæœå·® æ¸¸æˆæˆ–å®æ—¶æ¸²æŸ“ä¸­çš„è¿œè·ç¦»æ°´é¢ã€ä½ç¡¬ä»¶éœ€æ±‚åœºæ™¯ çº¿æ€§æ³¢å½¢å åŠ æ–¹æ³• å åŠ å¤šä¸ªæ³¢å½¢ï¼ˆå¦‚ Gerstner æ³¢ï¼‰ä»¥å½¢æˆå¤æ‚æ³¢å½¢ï¼Œé€šè¿‡è°ƒæ•´å‚æ•°æ¨¡æ‹Ÿä¸åŒæ³¢æµªå½¢æ€ã€‚ æ•ˆæœå¯æ§æ€§é«˜ï¼›è®¡ç®—æ•ˆç‡è¾ƒé«˜ï¼›åŸºæœ¬å®ç°åŠ¨æ€æ•ˆæœ ç¼ºä¹çœŸå®ç‰©ç†äº¤äº’;é«˜é¢‘ç»†èŠ‚ä¸è¶³ï¼›å‚æ•°è°ƒèŠ‚ä¾èµ–ç»éªŒ ç”µå½±ç‰¹æ•ˆä¸­çš„è§„åˆ™æ³¢æµªã€æ¸¸æˆä¸­çš„ä¸­è·ç¦»æµ·é¢ åŸºäºç»Ÿè®¡é¢‘è°±çš„å‚æ•°åŒ–æ–¹æ³• åŸºäºæµ·æ´‹å­¦ç»Ÿè®¡æ¨¡å‹ï¼ˆå¦‚ Phillips é¢‘è°±ï¼‰ï¼Œé€šè¿‡FFTç”Ÿæˆç¬¦åˆçœŸå®æµ·æµªé¢‘è°±åˆ†å¸ƒçš„æ³¢å½¢ã€‚ é«˜çœŸå®åº¦ï¼›è‡ªç„¶æ³¢å½¢ç»†èŠ‚ä¸°å¯Œï¼›æ”¯æŒå¤§èŒƒå›´æµ·é¢æ¨¡æ‹Ÿ è®¡ç®—å¤æ‚åº¦è¾ƒé«˜ ï¼›å‚æ•°è°ƒèŠ‚å¤æ‚ ï¼›å®æ—¶æ€§å—é™ å½±è§†çº§æµ·æ´‹åœºæ™¯ã€èˆªæµ·æ¨¡æ‹Ÿå™¨ã€å¤§è§„æ¨¡å¼€æ”¾æ°´åŸŸ åŸºäºç‰©ç†çš„æ•°å€¼æ–¹æ³• ç›´æ¥æ±‚è§£æµä½“åŠ›å­¦æ–¹ç¨‹ï¼ˆNavier-Stokesï¼‰ï¼Œæ¨¡æ‹Ÿæ°´ä½“ä¸ç¯å¢ƒçš„ç‰©ç†äº¤äº’ã€‚ ç‰©ç†ç²¾ç¡®åº¦é«˜ ï¼›æ”¯æŒå¤æ‚äº¤äº’ ï¼›åŠ¨æ€ç»†èŠ‚æœ€ä¸°å¯Œ è®¡ç®—æˆæœ¬æé«˜;å®æ—¶æ€§å·®ï¼›å®ç°å¤æ‚åº¦é«˜ ç§‘ç ”ä»¿çœŸã€é«˜ç²¾åº¦å½±è§†ç‰¹æ•ˆã€æµä½“åŠ¨åŠ›å­¦ç ”ç©¶ æ³¢ç²’å­æ–¹æ³• å°†æ³¢æµªåˆ†è§£ä¸ºæºå¸¦èƒ½é‡å’Œæ–¹å‘çš„ç²’å­ç³»ç»Ÿï¼Œæ¨¡æ‹Ÿæ³¢çš„ä¼ æ’­ä¸äº¤äº’ã€‚ æ”¯æŒå±€éƒ¨ç»†èŠ‚æ§åˆ¶ï¼›åŠ¨æ€äº¤äº’æ€§å¥½ï¼›é€‚åˆå¤æ‚è¾¹ç•Œ å¤§è§„æ¨¡æ¨¡æ‹Ÿæ•ˆç‡ä½ï¼›ç²’å­é—´è¿è´¯æ€§éš¾ä¿æŒï¼›èƒ½é‡å®ˆæ’å®ç°å¤æ‚ æ¸¸æˆä¸­çš„è¿‘æ™¯æ³¢æµªç‰¹æ•ˆï¼ˆå¦‚èˆ¹åªå°¾è¿¹ï¼‰ã€å°å‹æ°´åŸŸäº¤äº’æ¨¡æ‹Ÿ åŸºäºæ·±åº¦å­¦ä¹ çš„æ–¹æ³• ä½¿ç”¨ç¥ç»ç½‘ç»œå­¦ä¹ è¿‘ä¼¼æ±‚è§£ä¼ ç»Ÿæµä½“åŠ›å­¦æ–¹ç¨‹ï¼Œå¯é€šè¿‡æ•°æ®é©±åŠ¨çš„æ–¹å¼æ¨¡æ‹Ÿå¤æ‚æ°´ä½“è¡Œä¸ºã€‚ å¯ç”Ÿæˆè¶…ç°å®æ•ˆæœï¼›æ•°æ®é©±åŠ¨é€‚é…æ€§å¼ºï¼›æ½œåœ¨çš„é«˜æ•ˆæ¨ç†å¯èƒ½ éœ€è¦å¤§é‡è®­ç»ƒæ•°æ®ï¼›ç‰©ç†ä¸€è‡´æ€§éš¾ä¿è¯ï¼›å®æ—¶æ¨ç†ç¡¬ä»¶è¦æ±‚é«˜ é£æ ¼åŒ–æ°´ä½“æ¸²æŸ“ã€å¿«é€ŸåŸå‹è®¾è®¡ã€ç»“åˆä¼ ç»Ÿæ–¹æ³•çš„æ··åˆç³»ç»Ÿ è¡¥å……è¯´æ˜ï¼š\nå®æ—¶æ€§æ’åºï¼šå‡¹å‡¸è´´å›¾ \u0026gt; æ³¢ç²’å­ â‰ˆ æ³¢å½¢å åŠ  \u0026gt; å‚æ•°åŒ–æ–¹æ³• \u0026gt; æ·±åº¦å­¦ä¹  \u0026gt; ç‰©ç†æ•°å€¼æ–¹æ³• çœŸå®åº¦æ’åºï¼šç‰©ç†æ•°å€¼æ–¹æ³• \u0026gt; å‚æ•°åŒ–æ–¹æ³• \u0026gt; æ·±åº¦å­¦ä¹  â‰ˆ æ³¢å½¢å åŠ  \u0026gt; æ³¢ç²’å­ \u0026gt; å‡¹å‡¸è´´å›¾ è¶‹åŠ¿ï¼šå·¥ä¸šç•Œå¸¸é‡‡ç”¨æ··åˆæ–¹æ¡ˆï¼ˆå¦‚ï¼šå‚æ•°åŒ–æ–¹æ³•+æ³¢ç²’å­ï¼‰ï¼Œå­¦æœ¯ç•Œåˆ™èšç„¦ç‰©ç†æ•°å€¼æ–¹æ³•ä¸æ·±åº¦å­¦ä¹ çš„ç»“åˆã€‚ ç¡¬ä»¶ä¾èµ–æ€§ï¼šæ·±åº¦å­¦ä¹ ä¸ç‰©ç†æ•°å€¼æ–¹æ³•å¯¹ GPU/ç®—åŠ›è¦æ±‚æœ€é«˜ï¼Œå‡¹å‡¸è´´å›¾æ–¹æ³•æœ€è½»é‡ã€‚ å¯è§†åŒ–åˆ†æåŠé¢„æµ‹ ä½¿ç”¨ Zotero å¯¹æ£€ç´¢åˆ°çš„æ–‡çŒ®è¿›è¡Œå¯è§†åŒ–åˆ†æï¼š\nå¯ä»¥åœ¨è¯äº‘å›¾ä¸­çœ‹åˆ°ï¼Œé™¤äº†ä¼ ç»Ÿçš„â€œNavier-Stokesâ€ã€â€œParticle methodsâ€ã€â€œLagrangian ISPHâ€ç­‰åŸºäºç‰©ç†æ–¹æ³•å¤–ï¼Œâ€œArtificial neural networksâ€ã€â€œCNNâ€ã€â€œdeep neural networkâ€ç­‰åŸºäºç¥ç»ç½‘ç»œæ–¹æ³•çš„æœ¯è¯­ä¹Ÿå¼€å§‹æ›´ä¸ºé¢‘ç¹åœ°å‡ºç°ã€‚è¿™æˆ–è®¸æ˜¯ä¸€ä¸ªç§¯æçš„ä¿¡å·ï¼Œè¡¨æ˜åç»­çš„ç ”ç©¶ä¸­ä»¥ AI åŠ©åŠ›çš„æ°´ä½“æ¨¡æ‹Ÿæ–¹æ³•å°†ä¸æ–­æ¶Œç°ã€‚å½“ç„¶ï¼Œæœªæ¥ä¹Ÿæœ‰å¯èƒ½ä¼šå‡ºç°ç”¨äºæ¨¡æ‹Ÿä¸åŒç»†èŠ‚å±‚æ¬¡æ°´ä½“è¡¨ç°ï¼ˆå¦‚æ³¢æµªã€æ¶¡æµã€æ¹æµã€æ³¡æ²«ã€æµ®æ²«ç­‰ï¼‰çš„æ–°æ–¹æ³•ã€‚åŒæ—¶ï¼Œä¸ºäº†ä¼˜åŒ–æ¨¡æ‹Ÿæ•ˆç‡ï¼Œè·å¾—å®æ—¶é€Ÿç‡ï¼Œæœ‰å¿…è¦é’ˆå¯¹ä¸åŒå±‚æ¬¡çš„è¡¨ç°é‡‡å–å·®å¼‚åŒ–çš„æ¨¡æ‹Ÿç­–ç•¥ï¼Œä½¿ç”¨å¯æ‰©å±•ä¸”åŠ¨æ€è‡ªé€‚åº”çš„å»ºæ¨¡ç­–ç•¥ï¼Œåˆç†åˆ†é…è®¡ç®—èµ„æºã€‚\n0x0b Afterwords è™½ç„¶æ˜¯ç”¨äºåº”ä»˜å­¦æ ¡è®ºæ–‡å†™ä½œè¯¾çš„ä½œä¸šï¼ˆå­¦æ ¡ä¹Ÿä¸æŒ‡æœ›ä½ çœŸè¯»æ‡‚ä¸ªä»€ä¹ˆä¸»è¦æ˜¯æŠŠå†™è®ºæ–‡è½¯ä»¶å’Œæ ¼å¼æ‘¸æ¸…ï¼Œæ‰€ä»¥æˆ‘è‡³å°‘ä¼šç”¨ Zotero äº†ï¼‰ï¼Œç²—æµ…åœ°æµè§ˆå„è·¯å¤§ä½¬å’Œ SIGGRAPH çš„æ–‡ç« ï¼Œä¸æ•¢è¯´æœ‰å¤šå¤§æ”¶è·ï¼Œä½†è‡³å°‘å¯¹è¿™äº›å‡ºè‰²çš„å·¥ä½œå¿ƒå‘å¾€ä¹‹ã€‚æœ‰æœºä¼šçš„è¯ä¼šå•ç‹¬å¼€ä¸€ç¯‡ Issue é’ˆå¯¹è¿™ä¸ªé¢†åŸŸåšä¸€äº›ç ”ç©¶ã€‚\næ„Ÿè°¢å‰äººçš„ç»¼è¿°ï¼Œä¸ºæˆ‘çš„ä½œä¸šæä¾›äº†å¾ˆå¤§å¸®åŠ©ã€‚\n0x0c Reference [1] DU T. Deep Learning for Physics Simulation[C/OL]//ACM SIGGRAPH 2023 Courses. New York, NY, USA: Association for Computing Machinery, 2023: 1-25[2025-04-10]. https://dl.acm.org/doi/10.1145/3587423.3595518 . DOI: 10.1145/3587423.3595518 .\n[2] DARLES E, CRESPIN B, GHAZANFARPOUR D, ç­‰. A Survey of Ocean Simulation and Rendering Techniques in Computer Graphics[J/OL]. Computer Graphics Forum, 2011, 30(1): 43-60. DOI: 10.1111/j.1467-8659.2010.01828.x .\n[3] IGLESIAS A. Computer Graphics Techniques for Realistic Modeling, Rendering, and Animation of Water. Part I: 1980-88[C]//Proceedings of the International Conference on Computational Science-Part II. Berlin, Heidelberg: Springer-Verlag, 2002: 181-190.\n[4] IGLESIAS A. Computer Graphics Techniques for Realistic Modeling, Rendering and Animation of Water. Part II: 1989â€“1997[C/OL]//SLOOT P M A, HOEKSTRA A G, TAN C J K, ç­‰. Computational Science â€” ICCS 2002. Berlin, Heidelberg: Springer, 2002: 191-200. DOI: 10.1007/3-540-46080-2_20 .\n[5] BLINN J F. Simulation of wrinkled surfaces[J/OL]. SIGGRAPH Comput. Graph., 1978, 12(3): 286-292. DOI: 10.1145/965139.507101 .\n[6] SCHACHTER B. Long crested wave models[J/OL]. Computer Graphics and Image Processing, 1980, 12(2): 187-201. DOI: 10.1016/0146-664X(80)90011-8 .\n[7] MAX N L. Vectorized procedural models for natural terrain: Waves and islands in the sunset[C/OL]//Proceedings of the 8th annual conference on Computer graphics and interactive techniques. New York, NY, USA: Association for Computing Machinery, 1981: 317-324[2025-04-10]. https://dl.acm.org/doi/10.1145/800224.806820 . DOI: 10.1145/800224.806820 .\n[8] PERLIN K. An image synthesizer[J/OL]. SIGGRAPH Comput. Graph., 1985, 19(3): 287-296. DOI: 10.1145/325165.325247 .\n[9] FOURNIER A, REEVES W T. A simple model of ocean waves[C/OL]//Proceedings of the 13th annual conference on Computer graphics and interactive techniques. New York, NY, USA: Association for Computing Machinery, 1986: 75-84[2025-04-10]. https://dl.acm.org/doi/10.1145/15922.15894 . DOI: 10.1145/15922.15894 .\n[10] MASTIN G A, WATTERBERG P A, MAREDA J F. Fourier Synthesis of Ocean Scenes[J/OL]. IEEE Computer Graphics and Applications, 1987, 7(3): 16-23. DOI: 10.1109/MCG.1987.276961 .\n[11] TSâ€™O P Y, BARSKY B A. Modeling and rendering waves: wave-tracing using beta-splines and reflective and refractive texture mapping.[J/OL]. ACM Trans. Graph., 1987, 6(3): 191-214. DOI: 10.1145/35068.35070 .\n[12] KASS M, MILLER G. Rapid, stable fluid dynamics for computer graphics[J/OL]. SIGGRAPH Comput. Graph., 1990, 24(4): 49-57. DOI: 10.1145/97880.97884 .\n[13] STAM J, FIUME E. Depicting fire and other gaseous phenomena using diffusion processes[C/OL]//Proceedings of the 22nd annual conference on Computer graphics and interactive techniques. New York, NY, USA: Association for Computing Machinery, 1995: 129-136[2025-04-10]. https://dl.acm.org/doi/10.1145/218380.218430 . DOI: 10.1145/218380.218430 .\n[14] Oâ€™BRIEN J F, HODGINS J K. Dynamic Simulation of Splashing Fluids[A/OL]. (2023-02-13)[2025-04-11]. http://arxiv.org/abs/2302.06087 . DOI: 10.1109/CA.1995.393532 .\n[15] THON S, DISCHLER J M, GHAZANFARPOUR D. Ocean waves synthesis using a spectrum-based turbulence function[C/OL]//Proceedings Computer Graphics International 2000. 2000: 65-72[2025-04-11]. https://ieeexplore.ieee.org/document/852321 . DOI: 10.1109/CGI.2000.852321 .\n[16] YUKSEL C, HOUSE D H, KEYSER J. Wave particles[C/OL]//ACM SIGGRAPH 2007 papers. New York, NY, USA: Association for Computing Machinery, 2007: 99-es[2025-04-10]. https://dl.acm.org/doi/10.1145/1275808.1276501 . DOI: 10.1145/1275808.1276501 .\n[17] PEACHEY D R. Modeling waves and surf[C/OL]//Proceedings of the 13th annual conference on Computer graphics and interactive techniques. New York, NY, USA: Association for Computing Machinery, 1986: 65-74[2025-04-12]. https://dl.acm.org/doi/10.1145/15922.15893 . DOI: 10.1145/15922.15893 .\n[18] PIERSON JR. W J, MOSKOWITZ L. A proposed spectral form for fully developed wind seas based on the similarity theory of S. A. Kitaigorodskii[J/OL]. Journal of Geophysical Research (1896-1977), 1964, 69(24): 5181-5190. DOI: 10.1029/JZ069i024p05181 .\n[19] HASSELMANN D E, DUNCKEL M, EWING J A. Directional Wave Spectra Observed during JONSWAP 1973[J/OL]. 1980[2025-04-12]. https://journals.ametsoc.org/view/journals/phoc/10/8/1520-0485_1980_010_1264_dwsodj_2_0_co_2.xml .\n[20] PREMO\u0026quot;E S, ASHIKHMIN M. Rendering Natural Waters[C]//Proceedings of the 8th Pacific Conference on Computer Graphics and Applications. USA: IEEE Computer Society, 2000: 23.\n[21] JESCHKE S, WOJTAN C. Water wave packets[J/OL]. ACM Trans. Graph., 2017, 36(4): 103:1-103:12. DOI: 10.1145/3072959.3073678 .\n[22] JESCHKE S, SKÅ˜IVAN T, MÃœLLER-FISCHER M, ç­‰. Water surface wavelets[J/OL]. ACM Trans. Graph., 2018, 37(4): 94:1-94:13. DOI: 10.1145/3197517.3201336 .\n[23] SHARMA P, CHUNG W T, AKOUSH B, ç­‰. A Review of Physics-Informed Machine Learning in Fluid Mechanics[J/OL]. Energies, 2023, 16(5): 2343. DOI: 10.3390/en16052343 .\n[24] LINO M, FOTIADIS S, BHARATH A A, ç­‰. Current and emerging deep-learning methods for the simulation of fluid dynamics[J/OL]. Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences, 2023, 479(2275): 20230058. DOI: 10.1098/rspa.2023.0058 .\n[25] LADICKÃ L, JEONG S, SOLENTHALER B, ç­‰. Data-driven fluid simulations using regression forests[J/OL]. ACM Trans. Graph., 2015, 34(6): 199:1-199:9. DOI: 10.1145/2816795.2818129 .\n[26] TOMPSON J, SCHLACHTER K, SPRECHMANN P, ç­‰. Accelerating eulerian fluid simulation with convolutional networks[C]//Proceedings of the 34th International Conference on Machine Learning - Volume 70. Sydney, NSW, Australia: JMLR.org, 2017: 3424-3433.\n[27] XIAO X, ZHOU Y, WANG H, ç­‰. A Novel CNN-Based Poisson Solver for Fluid Simulation[J/OL]. IEEE Transactions on Visualization and Computer Graphics, 2020, 26(3): 1454-1465. DOI: 10.1109/TVCG.2018.2873375 .\n[28] ZHANG N, YAN S, MA Q, ç­‰. A CNN-supported Lagrangian ISPH model for free surface flow[J/OL]. Applied Ocean Research, 2023, 136: 103587. DOI: 10.1016/j.apor.2023.103587 .\n[29] PRANTL L, BONEV B, THUEREY N. Generating Liquid Simulations with Deformation-aware Neural Networks[A/OL]. arXiv, 2019[2025-04-11]. http://arxiv.org/abs/1704.07854 . DOI: 10.48550/arXiv.1704.07854 .\n[30] WIEWEL S, BECHER M, THUEREY N. Latent-space Physics: Towards Learning the Temporal Evolution of Fluid Flow[A/OL]. arXiv, 2019[2025-04-11]. http://arxiv.org/abs/1802.10123 . DOI: 10.48550/arXiv.1802.10123 .\n[31] ZHANG Y, BAN X, DU F, ç­‰. FluidsNet: End-to-end learning for Lagrangian fluid simulation[J/OL]. Expert Systems with Applications, 2020, 152: 113410. DOI: 10.1016/j.eswa.2020.113410 .\n[32] SANCHEZ-GONZALEZ A, GODWIN J, PFAFF T, ç­‰. Learning to Simulate Complex Physics with Graph Networks[C/OL]//Proceedings of the 37th International Conference on Machine Learning. PMLR, 2020: 8459-8468[2025-04-13]. https://proceedings.mlr.press/v119/sanchez-gonzalez20a.html .\n[33] LI Z, FARIMANI A B. Graph neural network-accelerated Lagrangian fluid simulation[J/OL]. Computers \u0026amp; Graphics, 2022, 103: 201-211. DOI: 10.1016/j.cag.2022.02.004 .\n[34]ZHANG N, YAN S, MA Q, ç­‰. A hybrid method combining ISPH with graph neural network for simulating free-surface flows[J/OL]. Computer Physics Communications, 2024, 301: 109220. DOI: 10.1016/j.cpc.2024.109220 .\n[35] HIGAKI T, TANABE Y, HASHIMOTO H, ç­‰. Step-by-step enhancement of a graph neural network-based surrogate model for Lagrangian fluid simulations with flexible time step sizes[J/OL]. Applied Ocean Research, 2025, 154: 104424. DOI: 10.1016/j.apor.2025.104424 .\n[36] SHU D, LI Z, BARATI FARIMANI A. A physics-informed diffusion model for high-fidelity flow field reconstruction[J/OL]. Journal of Computational Physics, 2023, 478: 111972. DOI: 10.1016/j.jcp.2023.111972 .\n[37] TAKAHASHI T, FUJII H, KUNIMATSU A, ç­‰. Realistic Animation of Fluid with Splash and Foam[J/OL]. [2025][2025-04-13]. https://onlinelibrary.wiley.com/doi/10.1111/1467-8659.00686 .\n[38] GREENWOOD S T, HOUSE D H. Better with bubbles: enhancing the visual realism of simulated fluid[C/OL]//Proceedings of the 2004 ACM SIGGRAPH/Eurographics symposium on Computer animationÂ - SCA â€™04. Grenoble, France: ACM Press, 2004: 287[2025-04-13]. http://portal.acm.org/citation.cfm?doid=1028523.1028562 . DOI: 10.1145/1028523.1028562 .\n[39] THÃœREY N, RÃœDE U, STAMMINGER M. Animation of Open Water Phenomena with coupled Shallow Water and Free Surface Simulations[J].\n[40] THÃœREY N, SADLO F, SCHIRM S, ç­‰. Real-time Simulations of Bubbles and Foam within a Shallow Water Framework[J].\n[41] LUO M, KHAYYER A, LIN P. Particle methods in ocean and coastal engineering[J/OL]. Applied Ocean Research, 2021, 114: 102734. DOI: 10.1016/j.apor.2021.102734 .\n[42] FELDMAN J, BONET J. Dynamic refinement and boundary contact forces in SPH with applications in fluid flow problems[J/OL]. International Journal for Numerical Methods in Engineering, 2007, 72(3): 295-324. DOI: 10.1002/nme.2010 .\n[43] WINCHENBACH R, KOLB A. Optimized Refinement for Spatially Adaptive SPH[J/OL]. ACM Trans. Graph., 2021, 40(1): 8:1-8:15. DOI: 10.1145/3363555 .\n","permalink":"https://congyuxiaoyoudao.github.io/posts/assignments/a-review-of-realistic-water-waveform-simulation/","summary":"\u003cblockquote\u003e\n\u003cp\u003eæœ¬ç€è™šå¿ƒäº¤æµä¸æ¥å—æ‰¹è¯„çš„æ€åº¦ï¼ŒæŠŠè¿™ç¯‡ç”¨æ¥â€œåº”ä»˜â€å­¦æ ¡ä½œä¸šçš„ç»¼è¿°å†™ä½œæ”¾ä¸Šæ¥ï¼Œä¸åèµæ•™ï¼\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2 id=\"0x00-to-begin-with\"\u003e0x00 To begin with\u003c/h2\u003e\n\u003cp\u003eè¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e è¿‘å¹´æ¥æ°´ä½“æ³¢å½¢æ¨¡æ‹Ÿçš„ä¸»è¦æ–¹æ³•åˆ†ç±»ä»‹ç»\u003c/li\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e ç°æœ‰æ–‡çŒ®çš„ç ”ç©¶è¶‹åŠ¿åˆ†æåŠæœªæ¥æ–¹å‘é¢„æµ‹\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eFor reference\u003c/strong\u003eï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eğŸ“– \n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://zhuanlan.zhihu.com/p/95917609\"\u003eçœŸå®æ„Ÿæ°´ä½“æ¸²æŸ“æŠ€æœ¯æ€»ç»“\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“– \n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://zhuanlan.zhihu.com/p/672738842\"\u003eä¹ã€æµä½“æ¨¡æ‹Ÿç®€è¿°\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003eğŸ“– \n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://zhuanlan.zhihu.com/p/21573239\"\u003eæ¸¸æˆä¸­çš„å®æ—¶æ°´ä½“æ¨¡æ‹ŸæŠ€æœ¯\u003c/a\u003e\n\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"0x01-æ‘˜è¦\"\u003e0x01 æ‘˜è¦\u003c/h2\u003e\n\u003cp\u003eçœŸå®æ„Ÿæ°´ä½“æ¨¡æ‹Ÿå› å…¶é«˜åº¦ä»¿çœŸçš„è§†è§‰è¡¨ç°ä¸å¹¿æ³›çš„åº”ç”¨é¢†åŸŸæˆä¸ºè®¡ç®—æœºå›¾å½¢å­¦çš„ç ”ç©¶çƒ­ç‚¹ã€‚æœ¬æ–‡å›é¡¾äº†è¿‘ 50 å¹´ï¼ˆ1978-2025ï¼‰æ¥æ°´ä½“æ¨¡æ‹Ÿçš„æ–¹æ³•ï¼Œå…·ä½“è€Œè¨€ï¼ŒåŒ…æ‹¬æ—©æœŸåŸºäºç»éªŒä¸ç»Ÿè®¡çš„æ–¹æ³•ä¸å‚æ•°åŒ–æ³¢åˆ—åˆæˆçš„æ–¹æ³•ï¼Œä¸­æœŸåŸºäºç‰©ç†çš„æ•°å€¼æ¨¡æ‹Ÿæ–¹æ³•å’Œæ³¢ç²’å­æ–¹æ³•ï¼Œä»¥åŠè¿‘å¹´è½¬å‘æ•°æ®é©±åŠ¨çš„æ·±åº¦å­¦ä¹ æ–¹æ³•ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eå…³é”®è¯\u003c/strong\u003eï¼šæµä½“æ¨¡æ‹Ÿã€æ³¢å½¢æ¨¡æ‹Ÿã€æ·±åº¦å­¦ä¹ ã€ç‰©ç†æ•°å€¼æ–¹æ³•\u003c/p\u003e\n\u003cp\u003eRealistic water simulation has emerged as a prominent research focus in computer graphics due to its highly realistic visual effects and broad application domains. This paper reviews the methods of water simulation over the past 50 years (1978â€“2025), specifically including early approaches based on empirical and statistical models, parametric wave synthesis methods, mid-term physics-based numerical simulation techniques and wave particle methods, as well as the recent shift toward data-driven deep learning approaches.\u003c/p\u003e","title":"Assignment 2. A Review of Realistic Water Waveform Simulation"},{"content":" ç”±äºåµŒå…¥å¼æ¨¡å‹çš„ä¸é€æ˜ã€é«˜ç»´åº¦ä»¥åŠå¤§è§„æ¨¡ç°ä»£æ•°æ®é›†çš„é™åˆ¶ï¼Œå¯¹å…¶è¿›è¡Œè§£é‡Šå’Œä½¿ç”¨æå…·æŒ‘æˆ˜æ€§ã€‚Zijie J. Wang ç­‰å¼€å‘äº† WizMapï¼Œä¸€ä¸ªäº¤äº’å¼å¯è§†åŒ–å·¥å…·ï¼Œå…è®¸ç”¨æˆ·è½»æ¾æ¢ç´¢å’Œè§£é‡ŠåµŒå…¥å¼å¤§æ¨¡å‹\nğŸš© 0x00 To begin with åº”å¯è§†åŒ–è¯¾ç¨‹è¦æ±‚ï¼Œæœ¬ç¯‡æ—¨åœ¨å¯¹åŸè®ºæ–‡é¡¹ç›®è¿›è¡Œç²—æµ…çš„ç¿»è¯‘\u0026amp;ä»‹ç»\u0026amp;åˆ†æï¼Œä»…ä½œå­¦ä¹ ä¹‹ç”¨ è®ºæ–‡åï¼šWizMap: Scalable Interactive Visualization for Exploring Large Machine Learning Embeddings ä½œè€…ï¼šZijie J. Wang,Â Fred Hohman,Â Duen Horng Chau\nè¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\nEmbedding Model åŠå…¶å±€é™ å‰äººçš„äº¤äº’å¯è§†åŒ–å·¥å…· æ•£ç‚¹å›¾ ç­‰é«˜çº¿å›¾ WizMap çš„ç›®çš„åŠæ„ä¹‰ WizMap çš„å®ç°åˆ†æ ç¬”è€…çš„çœ‹æ³• For referenceğŸ‘‡ï¼š\nğŸ“– åŸè®ºæ–‡åœ°å€ï¼š [2306.09328] WizMap: Scalable Interactive Visualization for Exploring Large Machine Learning Embeddings ğŸ“º åŸæ¼”ç¤ºè§†é¢‘ï¼š Demo Video \u0026ldquo;WizMAP: Scalable Interactive Visualization for Exploring Large ML Embeddings\u0026rdquo; ğŸ”§ æ¼”ç¤ºåœ°å€ï¼š WizMap ğŸ“– æ²¡æœ‰æ€è€ƒè¿‡ Embeddingï¼Œä¸è¶³ä»¥è°ˆ AI ğŸ“º Machine Learning Crash Course: Embeddings ğŸ“º 14 Embedding Projector ğŸ¤” 0x01 What is LLM Embedding ä¸ºäº†è®©æ²¡æœ‰æ¥è§¦è¿‡æœºå™¨å­¦ä¹ çš„è¯»è€…æ›´å®¹æ˜“ç†è§£åŸè®ºæ–‡çš„å·¥ä½œï¼Œç¬”è€…åŠ ä¸Šäº†æ­¤èŠ‚\nConcept of Embedding åµŒå…¥çš„æ¦‚å¿µ åœ¨æ•°å­¦ä¸Šï¼ŒEmbedding ä»£è¡¨ä¸€ä¸ªæ˜ å°„å…³ç³»ï¼š$f:X\\to Y$ï¼Œè¯¥å…³ç³»æ˜¯åŒæ„çš„ï¼Œå³åœ¨å•å°„æ¡ä»¶ä¸‹ä¿æŒæ•°å­¦ç»“æ„ï¼ˆåŠ æ€§ã€ä¹˜æ³•ç­‰ï¼‰ï¼›åœ¨æœºå™¨å­¦ä¹ é¢†åŸŸï¼Œç”¨äºå°†æ•°æ®æºæ˜ å°„åˆ°å¦å¤–ä¸€ä¸ªç©ºé—´ï¼Œæ•°æ®æºå¯ä»¥æ¥è‡ªäºæ–‡æœ¬ã€å›¾åƒç”šè‡³è§†é¢‘ï¼Œè¿™é‡Œä»¥æ–‡æœ¬ä¸ºä¾‹\nå¯¹äºäººè€Œè¨€ï¼Œè¯­è¨€æœ‰ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ã€è¯­æ³•è§„åˆ™ã€å¤šä¹‰æ€§ã€æ–‡åŒ–èƒŒæ™¯ç­‰ç‰¹æ€§ã€‚è€Œå¯¹äºæœºå™¨è€Œè¨€ï¼Œè¯­è¨€åªä¸è¿‡æ˜¯ 0 å’Œ 1 ã€‚å¦‚æœæƒ³è®©æœºå™¨èƒ½å¤Ÿâ€œç†è§£â€è‡ªç„¶è¯­è¨€ï¼Œå°±éœ€è¦å¯¹æ–‡æœ¬ä¿¡æ¯è¿›è¡ŒæŠ½è±¡ç¼–ç ã€‚\nEmbeddingï¼ˆåµŒå…¥ï¼‰å°±æä¾›äº†å¯¹è‡ªç„¶è¯­è¨€çš„ä¸€å±‚æŠ½è±¡ï¼Œå°†ç¦»æ•£çš„æ–‡æœ¬è¾“å…¥è½¬æ¢ä¸ºè¿ç»­çš„å‘é‡è¡¨ç¤ºã€‚è¿™ç§å‘é‡è¡¨ç¤ºèƒ½å¤Ÿæ•æ‰æ–‡æœ¬çš„è¯­ä¹‰ï¼ˆä¸Šä¸‹æ–‡ï¼‰ä¿¡æ¯ï¼Œä½¿å…¶å¯ä»¥è¢« LLM å¤„ç†ã€å­˜å‚¨å’Œè®¡ç®—ã€‚\nSemantic Baseed Encoding åŸºäºè¯ä¹‰çš„ç¼–ç  Embedding å¯¹è‡ªç„¶è¯­è¨€åˆ°å¤šç»´å‘é‡ç©ºé—´çš„æ˜ å°„å¿…é¡»æ˜¯ä¸€ä¸€æ˜ å°„ï¼Œä¹Ÿå³æ¯ä¸ªè¯è¯­æ˜ å°„åˆ°ä¸€ä¸ªå”¯ä¸€å‘é‡ï¼Œä¸åŒè¯è¯­æ˜ å°„çš„å‘é‡ä¸åŒã€‚è¿™ç§æ“ä½œæœ‰æ•ˆé™ä½äº†å› ä¸ºè‡ªç„¶è¯­è¨€ä¸­å¯èƒ½å­˜åœ¨çš„â€œå¤šè¯ä¸€ä¹‰â€ã€â€œä¸€è¯å¤šä¹‰â€è€Œå¯¼è‡´çš„å¤æ‚æ€§ï¼Œä¹Ÿæ˜¯ç¼–ç éœ€è¦éµå¾ªçš„æ¡ä»¶ä¹‹ä¸€ã€‚\næ˜ å°„åˆ°å¤šç»´å‘é‡ç©ºé—´ä¸»è¦æœ‰ä¸¤ä¸ªç†ç”±ï¼š\n1.å¯ä»¥å¯¹åº”å•è¯å¤šç»´åº¦ç‰¹å¾ï¼Œä¹Ÿå³å•è¯ä¸åŒå±‚é¢çš„å±æ€§ã€‚ç›¸è¾ƒäºæ ‡é‡ï¼Œå‘é‡èƒ½å¤Ÿæ‰¿è½½æ›´å¤šçš„ä¿¡æ¯ï¼ŒEmbedding å°±åƒæŠŠè¿™äº›å±æ€§â€œåµŒå…¥â€åˆ°å‘é‡å„ç»´åº¦çš„å€¼çš„è¿‡ç¨‹ã€‚æ¯”å¦‚è¯´ apple å¯ä»¥è¡¨ç¤ºä¸ºè¿™æ ·ï¼š\nWord Animal Big Red Expensive \u0026hellip; apple -0.5 0.1 0.7 0.3 \u0026hellip; å±æ€§åªæ˜¯ä¸¾ä¸ªä¾‹å­ï¼Œä¸å¤ªæ°å½“æ•¬è¯·è°…è§£\nç„¶è€Œå¦‚ä½•ç¡®å®šèƒ½æè¿°å…¨éƒ¨è‡ªç„¶è¯­è¨€è¯è¯­çš„æ‰€æœ‰ç»´åº¦æ˜¯å›°éš¾çš„ã€‚å³ä½¿æ˜¯åŒä¸€è¯è¯­ï¼Œåœ¨ä¸åŒä¸Šä¸‹æ–‡çš„æ„ä¹‰ä¹Ÿå¯èƒ½ä¸åŒï¼Œä¸å…¶å¤§è´¹å‘¨ç« æ‰¾åˆ°ä¸€å¥—å›ºå®šçš„ç»´åº¦ï¼Œä¸å¦‚å°†è¯è¯­å®šä¹‰åœ¨å…¶å¤„äºçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œç”¨è¯ä¸è¯ä¹‹é—´çš„å…³ç³»å®šä¹‰è¯ã€‚\nApple pie is my favorite dessert during the holidays. Discover the innovative world of Apple and shop everything iPhone\u0026hellip; åœ¨ç¬¬ä¸€å¥ä¸­ï¼ŒApple çš„å«ä¹‰ä¸ Pear æ¥è¿‘ï¼Œä½†åœ¨ç¬¬äºŒå¥ä¸­å´ä¸ Huawei æ¥è¿‘ã€‚\n2.å¯ä»¥å¯¹å‘é‡ï¼ˆå‡†ç¡®è€Œè¨€æ˜¯å‘é‡ä¹‹é—´çš„å…³ç³»ï¼‰è¿›è¡Œåº¦é‡ã€‚è¿™é‡Œå°±ç”¨åˆ°ä¸€äº›åŸºæœ¬çš„çº¿æ€§ä»£æ•°æ€§è´¨ï¼šåœ¨å®šä¹‰äº†åº¦é‡å‡½æ•°çš„å‘é‡ç©ºé—´ä¸­ï¼Œå¯ä»¥ç”¨è·ç¦»ä»£è¡¨ä¸¤ä¸ªå‘é‡é—´çš„ç›¸ä¼¼åº¦ã€‚ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ä¸¤ä¸ª Embedding Vector é—´çš„è·ç¦»ä»£è¡¨å…¶æ˜ å°„çš„è¯è¯­çš„ç›¸ä¼¼åº¦ã€‚\n$$ Similarity(A,B)=D_{Euclidean}(A,B)=\\sqrt{ \\Sigma_{i=1}^n{(a_{i}-b_{i})^2} } \\\\ $$ ä»…éµå¾ªå•å°„æ¡ä»¶åªæ˜¯å®Œæˆäº†è¯è¯­å±‚é¢çš„æŠ½è±¡ï¼Œæœºå™¨ä»ç„¶æ— æ³•ç†è§£å…¶èƒŒåçš„è¯­ä¹‰ã€‚ä¸ºäº†èƒ½å¤Ÿç”¨å†…ç§¯æè¿°è‡ªç„¶è¯­è¨€çš„ç›¸ä¼¼åº¦ï¼ŒEmbeddingå¿…é¡»è®©è¯­ä¹‰ç›¸ä¼¼çš„å•è¯åœ¨å‘é‡ç©ºé—´ä¸­æ¥è¿‘ï¼ˆç›¸å¯¹äºè¯­ä¹‰å·®è·å¤§çš„ï¼‰ã€‚æ¯”å¦‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œâ€œSailâ€å’Œâ€œShipâ€åœ¨å‘é‡ç©ºé—´ä¸­æ˜¯æ¥è¿‘çš„ï¼Œä½†ä¸â€œHowâ€è·ç¦»è¾ƒè¿œã€‚\nEmbedding in Neural Network ç¥ç»ç½‘ç»œä¸­çš„åµŒå…¥å±‚ è®¸å¤šç¥ç»ç½‘ç»œå¤„ç†çš„ä»»åŠ¡ä¸­ï¼Œè¾“å…¥å±‚å¾€å¾€æ˜¯ One hot ç¼–ç çš„ç¦»æ•£æ•°æ®ã€‚åœ¨å…¶ç»„æˆçš„çŸ©é˜µè¿‡äºç¨€ç–æ—¶ï¼Œä¿¡æ¯é‡ä½ï¼Œè®¡ç®—æˆæœ¬é«˜ã€‚åµŒå…¥å±‚é€šè¿‡å°†è¿™ä¸€è¾“å…¥æ˜ å°„è‡³ç»´æ•°è¾ƒä½çš„å‘é‡ï¼Œä¼˜åŒ–äº†è®¡ç®—è¿‡ç¨‹ï¼Œæé«˜äº†è®¡ç®—æ•ˆç‡ã€‚\nåµŒå…¥å±‚æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¯å­¦ä¹ çš„æƒé‡çŸ©é˜µï¼Œè¡Œæ•°ç­‰äºè¯æ±‡è¡¨é•¿åº¦ï¼Œåˆ—æ•°ç­‰äºé¢„è®¾çš„åµŒå…¥ç»´åº¦ã€‚é€šè¿‡æŸå¤±å‡½æ•°å’Œåå‘ä¼ æ’­æœºåˆ¶ï¼Œä¸æ–­è°ƒæ•´åµŒå…¥çŸ©é˜µä¸­çš„æ•°å€¼ï¼Œä½¿å¾—è¯­ä¹‰ç›¸è¿‘çš„å•è¯åœ¨å‘é‡ç©ºé—´ä¸­æ›´æ¥è¿‘ã€‚\nåµŒå…¥çš„ç»´åº¦å¯ä»¥è°ƒæ•´ï¼Œå…·ä½“å–å†³äºè¦å‡ç»´è¿˜æ˜¯é™ç»´ã€‚ç»´æ•°ä¸å¤Ÿå°±åŠ ç»´åº¦ï¼\nåœ¨æœ€åè¾“å‡ºä¹‹å‰ï¼Œäº§ç”Ÿçš„å‘é‡é€šå¸¸ä¸ä¼šç­‰äºä»»ä½•ä¸€ä¸ªå·²çŸ¥å¯¹åº”å•è¯çš„åµŒå…¥å‘é‡ï¼Œè¿™ä¸ªæ—¶å€™å¯¹å…¶åšä¸€æ¬¡æ¨¡ç³ŠåŒ¹é…ï¼Œè½¬æ¢ä¸ºå„ç±»åˆ«çš„æ¦‚ç‡åˆ†å¸ƒï¼Œå³æ¯ä¸ªå•è¯åŒ¹é…è¯¥å‘é‡çš„æ¦‚ç‡ã€‚æœ€åè¾“å‡ºæ¦‚ç‡æœ€é«˜çš„å•è¯ã€‚\nInterpret and Use è§£é‡Šä¸ä½¿ç”¨ ç¥ç»ç½‘ç»œå¯ä»¥ç±»æ¯”ä¸ºé»‘ç®±ï¼Œå¯è§çš„åªæœ‰è¾“å…¥è¾“å‡ºï¼Œè€Œå…¶å­¦ä¹ ã€æ¨ç†çš„è¿‡ç¨‹æ˜¯ä¸é€æ˜çš„ã€‚å°±åµŒå…¥å‘é‡è€Œè¨€ï¼Œä¸€ä¸ªå•è¯çš„åµŒå…¥å¾€å¾€æ˜¯å‡ ç™¾ç»´çš„æµ®ç‚¹å€¼ï¼Œæˆ‘ä»¬éš¾ä»¥è§£é‡Šå®ƒçš„å…·ä½“æ„ä¹‰ï¼›å¦ä¸€æ–¹é¢ï¼ŒåµŒå…¥å‘é‡ä¹‹é—´çš„è·ç¦»ä¹Ÿæ˜¯é€šè¿‡ä¸é€æ˜çš„å­¦ä¹ è¿‡ç¨‹å†³å®šçš„ï¼Œæˆ‘ä»¬åªèƒ½çŒœæµ‹é çš„è¿‘çš„ä¸¤ä¸ªå‘é‡å…·æœ‰è¯­ä¹‰ä¸Šçš„ç›¸ä¼¼æ€§ï¼Œè€Œæ— æ³•è¯´æ˜ä¸ºä»€ä¹ˆæŸä¸€å¯¹å‘é‡çš„è·ç¦»æ¯”å¦ä¸€å¯¹è¿‘ã€‚è¿™å¸¦æ¥äº†è§£é‡Šä¸Šçš„å›°éš¾ã€‚\nç°ä»£ LLM é€šå¸¸åœ¨ TB çº§åˆ«çš„æ•°æ®ä¸Šè¿›è¡Œè®­ç»ƒï¼Œæ•°æ®é›†è§„æ¨¡ä¹‹åºå¤§ï¼Œå¯¼è‡´åµŒå…¥è¯çš„è§„æ¨¡å’ŒåµŒå…¥å‘é‡çš„ç»´æ•°å·¨å¤§ï¼Œå¸¦æ¥äº†æ›´ä¸ºæ˜‚è´µçš„å­˜å‚¨ã€æ£€ç´¢å’Œè®¡ç®—å¼€é”€ã€‚æ•°åƒç»´çš„ç©ºé—´ä¸‹ï¼Œæ•°æ®å¯è§†åŒ–æä¸ºå›°éš¾ï¼Œæ— æ³•é€šè¿‡å¸¸è§„ç»˜å›¾æ‰‹æ®µï¼ˆäºŒç»´/ä¸‰ç»´åæ ‡ç³»ï¼‰ç›´è§‚åœ°å±•ç¤ºæ•°æ®ã€‚è¿™å¸¦æ¥äº†å¯è§†åŒ–çš„å›°éš¾ã€‚\nå¦‚æœä¸ºäº†ä¼˜åŒ–æ¨¡å‹æˆ–æå‡åµŒå…¥è´¨é‡ï¼Œéœ€è¦ç ”ç©¶äººå‘˜å¯¹åµŒå…¥å‘é‡è¿›è¡Œäººä¸ºå¹²é¢„ã€è°ƒæ•´ï¼Œè¿™ä¸ªè¿‡ç¨‹æ— ç–‘æ˜¯æä¸ºç¾éš¾çš„ã€‚ä¸ºäº†åº”å¯¹è¿™äº›å›°éš¾ï¼Œè®¸å¤šå­¦è€…æå‡ºäº†å„å¼å„æ ·çš„äº¤äº’å¼å¯è§†åŒ–å·¥å…·ç”¨æ¥å¸®åŠ©ç”¨æˆ·æ¢ç´¢åµŒå…¥ç©ºé—´ï¼Œæ¯”å¦‚æœ¬ç¯‡ä»‹ç»çš„ WizMapã€‚\nğŸ“ƒ 0x02 Previous Work å‰äººçš„å·¥ä½œ Scatter Plot æ•£ç‚¹å›¾ ä¸€ä¸ªæ¢ç´¢åµŒå…¥ç©ºé—´çš„æ–¹æ³•æ˜¯å°†åµŒå…¥é™ç»´åå¯è§†åŒ–åœ¨ä½ç»´æ•£ç‚¹å›¾ä¸­ã€‚Smilkov ç­‰äººåœ¨2016å¹´æå‡ºäº† Embedding Projectorï¼Œå…è®¸ç”¨æˆ·ä½¿ç”¨ PCAï¼ˆä¸»æˆåˆ†åˆ†æï¼‰å’Œ t-SNEï¼ˆt-åˆ†å¸ƒéšæœºé‚»åŸŸåµŒå…¥ï¼‰æ–¹æ³•å°†é«˜ç»´åµŒå…¥æŠ•å½±åˆ° 2D æˆ– 3D ç©ºé—´ä¸­ï¼Œä»è€Œç›´è§‚åœ°è§‚å¯Ÿæ•°æ®åˆ†å¸ƒã€‚\nè¿™ç§åŸºäºæ•£ç‚¹å›¾çš„æ–¹æ³•å¯ä»¥è¾ƒå¥½åœ°ç†è§£åµŒå…¥çš„å±€éƒ¨ç»“æ„ï¼Œä½†é¢å¯¹å¤§å‹æ•°æ®é›†æ—¶ï¼Œé€ä¸ªæ£€æŸ¥åµŒå…¥æ•°æ®ç‚¹ä»¥ç†è§£åµŒå…¥ç©ºé—´çš„å…¨å±€ç»“æ„æ—¢è´¹æ—¶åˆéš¾ä»¥å®ç°ã€‚\nContour Plot ç­‰é«˜çº¿å›¾ è¿‘å¹´æ¥ä¹Ÿæœ‰å­¦è€…æå‡ºåŸºäºç­‰é«˜çº¿çš„å¯è§†åŒ–äº¤äº’æ–¹æ³•ï¼ŒRobertson ç­‰äººåœ¨2023å¹´æå‡ºçš„ Angler ç³»ç»Ÿä¸­å°†é«˜ç»´æ•°æ®æŠ•å½±åˆ°äºŒç»´å¹³é¢ï¼Œå¹¶ä»¥ç­‰é«˜çº¿çš„å½¢å¼è¡¨ç¤ºæ•°æ®å¯†åº¦æˆ–ç›¸ä¼¼åº¦ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿè·å¾—åµŒå…¥ç©ºé—´çš„æ•´ä½“æ¦‚è§ˆï¼Œå¹¶é€šè¿‡å åŠ æ¯”è¾ƒå¤šä¸ªåµŒå…¥ç»“æœã€‚\nè¿™ç§åŸºäºç­‰é«˜çº¿çš„æ–¹æ³•å¯ä»¥å¿«é€Ÿè·å¾—å¯¹åµŒå…¥ç©ºé—´çš„å…¨å±€æ¦‚è§ˆï¼Œä½†é™åˆ¶äº†ç”¨æˆ·å¯¹åµŒå…¥å±€éƒ¨ç»“æ„çš„æ¢ç´¢ï¼Œä¸”ç¼ºä¹è¶³å¤Ÿçš„è§†è§‰ç¯å¢ƒï¼ˆVisual Contextï¼‰ã€‚\nConclusion ç»“è®º åŸºäºæ•£ç‚¹å›¾çš„æ–¹æ³•éš¾ä»¥è·å–åµŒå…¥çš„å…¨å±€æ¦‚è§ˆï¼Œè€ŒåŸºäºç­‰é«˜çº¿å›¾çš„æ–¹æ³•è™½èƒ½å±•ç°æ•°æ®å¯†åº¦ï¼Œä½†ç¼ºä¹å¯¹å±€éƒ¨ç»†èŠ‚çš„åˆ»ç”»ã€‚ä¸¤ç§æ–¹æ³•å„æœ‰å±€é™ã€‚\nWizMap æ—¨åœ¨æ•´åˆæ•£ç‚¹å›¾ä¸ç­‰é«˜çº¿å›¾å„è‡ªçš„ä¼˜åŠ¿ï¼Œä½¿ç”¨åœ°å›¾å¼äº¤äº’è®¾è®¡ä¸ºç”¨æˆ·æä¾›å…¨é¢çš„è§†è§’ï¼Œå…è®¸ç”¨æˆ·ä»¥ä¸åŒç²’åº¦æ¢ç´¢åµŒå…¥ç©ºé—´ï¼Œâ€œé™ä½äº†è§£é‡Šå’Œä½¿ç”¨åµŒå…¥çš„é—¨æ§›â€ï¼ˆlowers the barrier to interpreting and using embeddingsï¼‰ã€‚\nğŸ”¥0x03 Related Work ç›¸å…³å·¥ä½œ Dimensionality Reduction é™ç»´ å¦‚å‰æ–‡æ‰€è¿°ï¼ŒåµŒå…¥å‘é‡çš„é«˜ç»´æ€§ä¸ºå¯è§†åŒ–å¸¦æ¥äº†å›°éš¾ï¼Œè€Œé«˜ç»´æ•°æ®çš„å¯è§†åŒ–é€šå¸¸æ˜¯åº”ç”¨é™ç»´æŠ€æœ¯å°†å…¶æŠ•å½±è‡³äºŒç»´æˆ–ä¸‰ç»´ç©ºé—´ï¼Œå†ä½¿ç”¨å¸¸è§„çš„å¯è§†åŒ–æ–¹å¼è¿›è¡Œå¤„ç†ã€‚\nä¸€äº›æµè¡Œçš„é™ç»´æŠ€æœ¯åŒ…æ‹¬ UMAPï¼ˆå‡åŒ€æµå½¢è¿‘ä¼¼ä¸æŠ•å½±ï¼‰ã€t-SNEï¼ˆt-åˆ†å¸ƒéšæœºé‚»åŸŸåµŒå…¥ï¼‰å’Œ PCAï¼ˆä¸»æˆåˆ†åˆ†æï¼‰ã€‚è¿™äº›æŠ€æœ¯åœ¨ç»´æŠ¤åµŒå…¥çš„ç»“æ„ã€éšæœºæ€§ã€å‚æ•°æ•æ„Ÿæ€§ã€è®¡ç®—æ•ˆç‡ä¸å¤æ‚åº¦æ–¹é¢å„æœ‰åˆ©å¼Šã€‚é’ˆå¯¹ä¸åŒç»“æ„ã€å±æ€§çš„æ•°æ®æƒè¡¡ä¸åŒçš„é™ç»´æ–¹æ³•ï¼Œèƒ½å¤Ÿå¾—åˆ°æ›´ä¼˜çš„é™ç»´æ•ˆæœã€‚\nå°½ç®¡å„è‡ªé™ç»´æŠ€æœ¯å­˜åœ¨è¯¸å¤šä¸åŒï¼Œä½†å…¶è¾“å‡ºå‡ä¸ºä½ç»´åµŒå…¥è¡¨ç¤ºï¼Œæ˜¯å½¢å¦‚(n_samples, n_components)çš„çŸ©é˜µã€‚åœ¨ WizMap ä¸­ï¼Œç”¨æˆ·å¯ä»¥è‡ªç”±é€‰æ‹©é™ç»´æ–¹å¼ï¼Œä»¥å¯è§†åŒ–æŠ•å½±åçš„åµŒå…¥ã€‚\nInteractive Embedding Visualization äº¤äº’å¼åµŒå…¥å¯è§†åŒ– å¯è§†åŒ–å·¥å…·çš„ä¸€äº›å¸¸è§äº¤äº’å·¥å…·\u0026amp;æ–¹å¼åŒ…æ‹¬ï¼š\nç¼©æ”¾ã€æ—‹è½¬å’Œå¹³ç§» 2D æˆ– 3D æŠ•å½±åµŒå…¥ä»¥æ¢ç´¢å’Œæ£€æŸ¥æ•°æ®ç‚¹ç‰¹å¾ï¼Œå¦‚ Embedding Projector ä¸“é—¨ç”¨äºå¤§è§„æ¨¡ï¼ˆæ•°ç™¾ä¸‡çº§ï¼‰æ•£ç‚¹å›¾çš„ç»˜åˆ¶ï¼Œå¦‚ regl-scatterplot æ½œåœ¨ç©ºé—´åˆ¶å›¾ï¼Œå¸®åŠ©ç”¨æˆ·ç†è§£ä¸åŒåŒºåŸŸçš„æ•°æ®åˆ†å¸ƒåŠå…¶è¯­ä¹‰ç‰¹å¾ï¼Œå¦‚ Latent Space Cartography æ­¤å¤–ï¼Œç ”ç©¶äººå‘˜è¿˜è®¾è®¡äº†ä¸€äº›ç”¨äºæ¯”è¾ƒä¸åŒé™ç»´æ–¹æ³•äº§ç”Ÿçš„åµŒå…¥ç©ºé—´çš„å¯è§†åŒ–å·¥å…·ï¼š\næœªç»™å‡ºé“¾æ¥çš„å·¥å…·æˆªè‡³ç›®å‰ï¼ˆ2025/3/30ï¼‰æ²¡æœ‰å¼€æºå®ç°\nå¯è§†åŒ–ä¸¤ä¸ªåµŒå…¥ä¹‹é—´çš„å±€éƒ¨å’Œå…¨å±€ç›¸ä¼¼æ€§ï¼Œå¦‚ embCompï¼ˆHeimerl ç­‰ï¼Œ2022ï¼‰ è¿½è¸ªæ•°æ®ç‚¹åœ¨ä¸¤ä¸ªåµŒå…¥ä¸­çš„ä½ç½®å˜åŒ–ï¼ˆä½¿ç”¨æ˜Ÿè½¨ Star Rail å¯è§†åŒ–ï¼‰ï¼Œå¦‚ Emblazeï¼ˆSivaraman ç­‰ï¼Œ2022ï¼‰ çªå‡ºæ˜¾ç¤ºåœ¨åµŒå…¥ä¸­å˜åŒ–æœ€å¤§çš„ç‚¹å‘¨å›´çš„é‚»åŸŸï¼Œå¦‚ embedding-comparator ï¼ˆBoggust ç­‰ï¼Œ2022ï¼‰ è¿™äº›å·¥å…·å¯ä»¥é€šè¿‡æ¯”è¾ƒä¸åŒæ¨¡å‹ã€ä¸åŒç®—æ³•ç”Ÿæˆçš„åµŒå…¥ï¼Œæ¯”è¾ƒåµŒå…¥è¡¨ç¤ºä¹‹é—´çš„å·®å¼‚ï¼Œå¹¶â€‹åˆ†æåµŒå…¥çš„å…¨å±€å’Œå±€éƒ¨ç»“æ„ï¼Œä»¥è¯„ä¼°æ¨¡å‹çš„è¡¨ç¤ºå­¦ä¹ èƒ½åŠ›ã€‚\nä¸æ­¤ç›¸åï¼ŒWizMap é€šè¿‡æä¾›ä¸åŒç²’åº¦ï¼ˆå…¨å±€-å±€éƒ¨ï¼‰çš„è§†è§‰ä¸Šä¸‹æ–‡ï¼Œå¸®åŠ©ç”¨æˆ·å¯¼èˆªå’Œè§£é‡Šå¤§å‹åµŒå…¥ç©ºé—´çš„å…¨å±€å’Œå±€éƒ¨ç»“æ„ã€‚\nğŸ“„0x04 Multi-scale Embedding Summarization å¤šå°ºåº¦åµŒå…¥æ‘˜è¦ Embedding Summarizationï¼ˆåµŒå…¥æ‘˜è¦ï¼‰æ—¨åœ¨ä»å¤§å‹åµŒå…¥ç©ºé—´ä¸­æå–æ ¸å¿ƒä¿¡æ¯ï¼Œä»¥å¸®åŠ©ç”¨æˆ·ç†è§£å’Œæ¢ç´¢æ•°æ®çš„ç»“æ„ã€åˆ†å¸ƒåŠå…¶é‡è¦ç‰¹å¾\nç”ŸæˆåµŒå…¥æ‘˜è¦ä¸»è¦å…·æœ‰ä¸¤ä¸ªæŒ‘æˆ˜ï¼š\nå¦‚ä½•åœ¨å¤§å‹æ•°æ®é›†ä¸­æœ‰æ•ˆåœ°æ€»ç»“æ•°ç™¾ä¸‡çº§çš„æ•°æ®ç‚¹ å¦‚ä½•é€‰æ‹©è¦æ€»ç»“çš„åµŒå…¥åŒºåŸŸï¼ˆç”¨æˆ·å¯¹ä¸åŒå¤§å°å’Œç²’åº¦çš„åŒºåŸŸæœ‰ä¸åŒçš„å…´è¶£ï¼‰ WizMap çš„å¼€å‘è€…æå‡ºäº†ä¸€ç§æ–°é¢–çš„æ–¹æ³•ï¼Œä»¥è‡ªåŠ¨ç”Ÿæˆå¤§è§„æ¨¡æ•°æ®çš„å¤šå°ºåº¦åµŒå…¥æ‘˜è¦ã€‚\nMulti-resolution Quadtree Aggregation å¤šåˆ†è¾¨ç‡å››å‰æ ‘èšåˆ é¦–å…ˆåº”ç”¨é™ç»´æŠ€æœ¯ï¼Œå°†é«˜ç»´åµŒå…¥å‘é‡æŠ•å½±åˆ°äºŒç»´å¹³é¢ä¸Šçš„ç‚¹ã€‚ä»è¿™äº›ç‚¹å‡ºå‘ï¼Œæ„å»ºä¸€é¢—å››å‰æ ‘ã€‚\nè¿™é¢—å››å‰æ ‘çš„æ¯ä¸€æ¬¡åˆ’åˆ†å°†äºŒç»´ç©ºé—´åˆ†ä¸ºå››ä¸ªç›¸ç­‰çš„æ­£æ–¹å½¢åŒºåŸŸï¼ˆå¶èŠ‚ç‚¹ï¼‰ï¼Œæ¯ä¸ªåŒºåŸŸä»…å­˜åœ¨ä¸€ä¸ªæ•°æ®ç‚¹ã€‚ä¸ºäº†å¾—åˆ°ä¸åŒç²’åº¦çº§åˆ«çš„åµŒå…¥æ±‡æ€»ï¼Œè‡ªåº•å‘ä¸Šéå†æ ‘ã€‚åœ¨æ¯æ¬¡è¿­ä»£ä¸­æå–æ¯ä¸ªå¶èŠ‚ç‚¹ä¸­åµŒå…¥çš„æ‘˜è¦ï¼Œç„¶åå°†æœ€ä½çº§åˆ«çš„å¶èŠ‚ç‚¹ä¸å…¶çˆ¶èŠ‚ç‚¹åˆå¹¶ã€‚è¿™ä¸ªè¿‡ç¨‹é€’å½’åœ°è¿›è¡Œï¼Œå½¢æˆçº§åˆ«è¶Šæ¥è¶Šé«˜ï¼ˆå›¾ä¸­è‡ªä¸‹è€Œä¸Šï¼‰çš„å¶èŠ‚ç‚¹ï¼Œç›´åˆ°æ•´ä¸ªæ ‘æœ€ç»ˆåˆå¹¶ä¸ºä¸€ä¸ªæ ¹èŠ‚ç‚¹ã€‚\næœ‰ç‚¹ 2048 çš„æ€æƒ³åœ¨ï¼Œäº†è§£å›¾å½¢å­¦å…«å‰æ ‘çš„åŒå­¦åº”è¯¥ç†è§£èµ·æ¥æ²¡å‹åŠ›\næ•´ä¸ªè¿‡ç¨‹æ˜¯é¢„è®¡ç®—çš„ï¼Œå½“ç”¨æˆ·åœ¨ WIZMAP ä¸­ç¼©æ”¾æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°†ç¼©æ”¾æ˜ å°„åˆ°åˆé€‚çš„åµŒå…¥æ‘˜è¦çº§åˆ«ï¼Œå®ç°å¤šç²’åº¦æ‘˜è¦çš„åŠ¨æ€åˆ‡æ¢ã€‚\nå¯ä»¥è”æƒ³è°·æ­Œåœ°å›¾è‡ªé€‚åº”ç¼©æ”¾çš„åšæ³•\nScalable Leaf-level Summarization å¯æ‰©å±•å¶çº§åˆ«æ‘˜è¦ å½¢æˆå››å‰æ ‘èšåˆæ—¶ï¼Œç ”ç©¶äººå‘˜å¯ä»¥é€‰æ‹©ä»»ä½•åˆé€‚çš„æ–¹æ³•æ¥ä»å¶èŠ‚ç‚¹æ€»ç»“åµŒå…¥ã€‚å¯¹äºæ–‡æœ¬åµŒå…¥ï¼Œå¼€å‘è€…æå‡ºäº†åŸºäºå—çš„ TF-IDFï¼ˆt-TF-IDFï¼‰ï¼Œå®ƒå°† TF-IDFï¼ˆTerm Frequency-Inverse Document Frequencyï¼‰åº”ç”¨äºä»å¶èŠ‚ç‚¹æå–å…³é”®è¯ï¼ˆSparck Jonesï¼Œ1972ï¼‰ã€‚\nt-TF-IDF é€šè¿‡å°†æ–‡æ¡£åˆ’åˆ†ä¸ºå¤šä¸ªâ€œå—â€æ¥è®¡ç®—è¯é¢‘ï¼ˆTFï¼‰å°†é•¿æ–‡æ¡£ $d$ åˆ’åˆ†ä¸ºå¤šä¸ªè¾ƒå°çš„å— $B_{i}$ï¼Œå¯¹æ¯ä¸ªå—è®¡ç®—å—çº§ TF ï¼š $t\\text{-} TF(t,B)=\\frac{è¯ t åœ¨å— B ä¸­çš„å‡ºç°æ¬¡æ•°}{å— B çš„æ€»è¯æ•°}$\nç±»ä¼¼äºåŸºäºç±»çš„ TF-IDFï¼ˆc-TF-IDFï¼‰ï¼Œåœ¨è®¡ç®— TF-IDF åˆ†æ•°ä¹‹å‰å°†èšç±»ä¸­çš„æ–‡æ¡£åˆå¹¶ä¸ºä¸€ä¸ªå…ƒæ–‡æ¡£ï¼ˆGrootendorstï¼Œ2022ï¼‰ã€‚å°†æ¯ä¸ªå¶èŠ‚ç‚¹ä¸­çš„æ‰€æœ‰æ–‡æ¡£ï¼ˆå³å››å‰æ ‘åˆ†åŒºä¸­çš„ä¸€ä¸ªå—ï¼‰åˆå¹¶ä¸ºä¸€ä¸ªå…ƒæ–‡æ¡£ï¼Œå¹¶åœ¨æ‰€æœ‰å¶èŠ‚ç‚¹ä¸Šè®¡ç®— TF-IDF åˆ†æ•°ã€‚æœ€åï¼Œæå–å…·æœ‰æœ€é«˜ t-TF-IDF åˆ†æ•°çš„å…³é”®è¯æ¥æ€»ç»“å¶èŠ‚ç‚¹ä¸­çš„åµŒå…¥ã€‚\n$t\\text{-}TF\\text{-}IDF(t,d)=\\max\\limits_{B\\in d}(t\\text{-}TF(t,B)\\times IDF(t))$ï¼Œé€‰å–è¯¥è¯åœ¨æ‰€æœ‰å—ä¸­æƒé‡æœ€é«˜çš„å€¼ï¼Œä¿ç•™å±€éƒ¨ç‰¹å¾\nè¿™ç§æ–¹æ³•æ˜¯å¯æ‰©å±•çš„ï¼Œå¹¶ä¸”ä¸å››å‰æ ‘èšåˆç›¸è¾…ç›¸æˆã€‚ç”±äºæ–‡æ¡£åˆå¹¶æ˜¯åˆ†å±‚çš„ï¼Œåªéœ€æ„å»ºä¸€æ¬¡ n-gram è®¡æ•°çŸ©é˜µï¼Œå¹¶åœ¨æ¯æ¬¡èšåˆè¿­ä»£ä¸­ä»…é€šè¿‡ä¸€æ¬¡çŸ©é˜µä¹˜æ³•è¿›è¡Œæ›´æ–°ã€‚\nåœ¨ MacBook Pro ä¸Šï¼Œæ€»ç»“è·¨è¶Šä¸‰ä¸ªç²’åº¦çº§åˆ«çš„ 180 ä¸‡ä¸ªæ–‡æœ¬åµŒå…¥ï¼Œåªéœ€å¤§çº¦ 55 ç§’ã€‚ å¤„ç†éæ–‡æœ¬æ•°æ®çš„åµŒå…¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ‰¾åˆ°å¶èŠ‚ç‚¹ä¸­ä¸åµŒå…¥ä¸­å¿ƒç‚¹æœ€è¿‘çš„ç‚¹æ¥æ€»ç»“åµŒå…¥ã€‚\nğŸ–¥ï¸User Interface ç”¨æˆ·ç•Œé¢ ç»“åˆ livedemo å’Œæ¼”ç¤ºè§†é¢‘è¿›è¡Œè§£é‡Š\nWizMap çš„ UI å¤§è‡´å¯ä»¥åˆ†ä¸ºå¦‚ä¸‹ 3 ä¸ªéƒ¨åˆ†ï¼š\nMap View åœ°å›¾è§†å›¾ åœ°å›¾è§†å›¾æ˜¯ WIZMAP çš„ä¸»è¦è§†å›¾ã€‚å®ƒæä¾›äº†ä¸€ä¸ªç†Ÿæ‚‰çš„åœ°å›¾ç•Œé¢ï¼Œå…è®¸ç”¨æˆ·å¹³ç§»å’Œç¼©æ”¾ä»¥æ¢ç´¢ä¸åŒå¤§å°çš„åµŒå…¥åŒºåŸŸã€‚ä¸ºäº†å¸®åŠ©ç”¨æˆ·è½»æ¾åœ°è°ƒæŸ¥åµŒå…¥çš„å…¨å±€å’Œå±€éƒ¨ç»“æ„ï¼Œåœ°å›¾è§†å›¾é›†æˆäº†ä¸‰å±‚å¯è§†åŒ–ï¼š\nContourï¼šç­‰é«˜çº¿è½®å»“å±•ç¤ºåµŒå…¥åˆ†å¸ƒï¼Œå¯è§†åŒ–åµŒå…¥å…¨å±€ç»“æ„ Labelï¼šæ ‡ç­¾å±•ç¤ºåµŒå…¥æ‘˜è¦ï¼Œå¯è§†åŒ–åµŒå…¥æ‘˜è¦ Scatterï¼šæ•£ç‚¹å±•ç¤ºåµŒå…¥ç‚¹ä¿¡æ¯ï¼Œå¯è§†åŒ–åµŒå…¥å±€éƒ¨ç»“æ„ åˆ†å¸ƒè½®å»“ï¼ˆDistribution Contourï¼‰ã€‚ä½¿ç”¨æ ¸å¯†åº¦ä¼°è®¡ï¼ˆKDEï¼‰ï¼ˆRosenblattï¼Œ1956ï¼‰æ¥ä¼°è®¡äºŒç»´åµŒå…¥ç‚¹çš„åˆ†å¸ƒã€‚ä»¥æ ‡å‡†çš„å¤šå˜é‡é«˜æ–¯æ ¸å’Œ Silverman å¸¦å®½ä½œä¸º KDE æ¨¡å‹ï¼ˆSilvermanï¼Œ2018ï¼‰ã€‚\næ ¸å¯†åº¦ä¼°è®¡æ˜¯ä¸€ç§éå‚æ•°æ–¹æ³•ï¼Œé€šè¿‡å¯¹æ¯ä¸ªæ•°æ®ç‚¹æ–½åŠ æ ¸å‡½æ•°ï¼ˆ$K$ï¼Œå¸¦å®½ $h$ å†³å®šå…¶å¹³æ»‘ç¨‹åº¦ï¼‰ï¼Œå¹¶æ±‡æ€»æ‰€æœ‰æ ¸å‡½æ•°çš„è´¡çŒ®ï¼Œä¼°è®¡æ€»ä½“çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ã€‚â€‹å…¶æ•°å­¦è¡¨è¾¾å¼ä¸ºï¼š$\\hat{f}(x)=\\frac{1}{nh}\\Sigma_{i=1}^nK\\left( \\frac{x-x_{i}}{h} \\right)$\nåœ¨ä¸€ä¸ª 200Ã—200 çš„äºŒç»´ç½‘æ ¼ä¸Šè®¡ç®—åˆ†å¸ƒä¼¼ç„¶ï¼Œè¯¥ç½‘æ ¼çš„å¤§å°ç”±æ‰€æœ‰åµŒå…¥ç‚¹çš„èŒƒå›´å†³å®šã€‚æœ€åï¼Œå°†ç½‘æ ¼ä¸Šçš„ä¼¼ç„¶æ€§å¯è§†åŒ–ä¸ºä¸€ä¸ªç­‰é«˜çº¿å›¾ï¼Œçªå‡ºæ˜¾ç¤ºåµŒå…¥çš„å¯†åº¦åˆ†å¸ƒã€‚ç ”ç©¶äººå‘˜å¯ä»¥è°ƒæ•´ç½‘æ ¼å¯†åº¦ï¼Œé€šè¿‡å¹³è¡¡è®¡ç®—æ—¶é—´å’Œç­‰é«˜çº¿åˆ†è¾¨ç‡æ¥è°ƒæ•´å®ƒã€‚\nå¤šåˆ†è¾¨ç‡æ ‡ç­¾ï¼ˆMuti-resolution Labelsï¼‰ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è¿™äº›é¢„è®¡ç®—çš„ä¸Šä¸‹æ–‡æ ‡ç­¾ï¼Œåœ¨å„ä¸ªç²’åº¦çº§åˆ«ä¸ŠåŠ¨æ€åœ°è§£é‡ŠåµŒå…¥ã€‚å½“ç”¨æˆ·æ‚¬åœåœ¨æŸä¸ªç½‘æ ¼ä¸Šæ—¶ï¼Œå°†è¿™éƒ¨åˆ†é€šè¿‡å››å‰æ ‘èšåˆç”Ÿæˆçš„æ‘˜è¦æ ‡ç­¾å åŠ åˆ°ç­‰é«˜çº¿å›¾å’Œæ•£ç‚¹å›¾ä¸Šã€‚å¹¶èƒ½æ ¹æ®ç”¨æˆ·çš„å½“å‰ç¼©æ”¾çº§åˆ«è°ƒæ•´æ ‡ç­¾çš„ç“¦ç‰‡ï¼ˆTileï¼‰å¤§å°ã€‚\næ­¤å¤–ï¼Œæ­¤è§†å›¾è¿˜èƒ½å¤Ÿè‡ªåŠ¨æ ‡è®°é«˜å¯†åº¦åµŒå…¥ç‚¹åŒºåŸŸï¼Œé€šè¿‡æ˜¾ç¤ºé è¿‘é«˜æ¦‚ç‡è½®å»“å¤šè¾¹å½¢ï¼ˆhigh-probability contour polygonsï¼‰å‡ ä½•ä¸­å¿ƒå››å‰æ ‘ç“¦ç‰‡çš„æ‘˜è¦å®ç°ã€‚\næ•£ç‚¹å›¾ï¼ˆScatter Plotï¼‰ï¼Œ\nç”¨äºŒç»´æ•£ç‚¹å›¾å¯è§†åŒ–æ‰€æœ‰åµŒå…¥ç‚¹åŠå…¶ä½ç½®ã€‚ç”¨æˆ·å¯ä»¥æŒ‡å®šæ¯ä¸ªåµŒå…¥ç‚¹çš„é¢œè‰²æ¥ç¼–ç é¢å¤–çš„ç‰¹å¾ï¼Œä¾‹å¦‚åµŒå…¥ç±»çš„é¢œè‰²ã€‚æ­¤å¤–ï¼Œç”¨æˆ·å¯ä»¥å°†é¼ æ ‡æ‚¬åœåœ¨æ•£ç‚¹ä¸Šä»¥æ˜¾ç¤ºå…¶åŸå§‹æ•°æ®ã€‚\nControl Panel æ§åˆ¶é¢æ¿ åœ°å›¾è§†å›¾é»˜è®¤æ˜¾ç¤ºæ‰€æœ‰ä¸‰ä¸ªå¯è§†åŒ–å±‚ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ§åˆ¶é¢æ¿ä¸­çš„æŒ‰é’®è‡ªå®šä¹‰è§†å›¾æ˜¾ç¤ºã€‚æ­¤å¤–ï¼ŒWizMap å…è®¸ç”¨æˆ·é€šè¿‡åœ¨åœ°å›¾è§†å›¾ä¸­å åŠ å®ƒä»¬æ¥æ¯”è¾ƒåŒä¸€åµŒå…¥ç©ºé—´ä¸­çš„å¤šä¸ªåµŒå…¥ç»„ï¼ˆGleicherï¼Œ2018ï¼‰ã€‚å¯¹äºåŒ…å«æ—¶é—´çš„åµŒå…¥ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨æ§åˆ¶é¢æ¿å³ä¾§çš„æ»‘å—æ¥è§‚å¯ŸåµŒå…¥éšæ—¶é—´çš„å˜åŒ–ã€‚\nSearch Panel æœç´¢é¢æ¿ æœç´¢å’Œç­›é€‰å¯ä»¥å¸®åŠ©ç”¨æˆ·å‘ç°æœ‰è¶£çš„åµŒå…¥æ¨¡å¼å¹¶æµ‹è¯•ä»–ä»¬å¯¹åµŒå…¥ç»“æ„çš„å‡è®¾ï¼ˆCarter ç­‰äººï¼Œ2019 å¹´ï¼‰ã€‚åœ¨ WizMap ä¸­ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨æœç´¢é¢æ¿æœç´¢åŒ…å«æŒ‡å®šå•è¯çš„æ–‡æœ¬åµŒå…¥ã€‚é¢æ¿æ˜¾ç¤ºæœç´¢ç»“æœåˆ—è¡¨ï¼Œåœ°å›¾è§†å›¾é«˜äº®æ˜¾ç¤ºç›¸åº”çš„åµŒå…¥ç‚¹ã€‚\nScalable \u0026amp; Open-source Implementation å¯æ‰©å±•ä¸”å¼€æºçš„å®ç° WizMap å¯æ‰©å±•è‡³æ•°ç™¾ä¸‡ä¸ªåµŒå…¥ç‚¹ï¼Œæ— éœ€åç«¯æœåŠ¡å™¨ã€‚åˆ©ç”¨ç°ä»£ç½‘ç»œæŠ€æœ¯ï¼Œç‰¹åˆ«æ˜¯ WebGL é€šè¿‡ regl APIï¼ˆLysenkoï¼Œ2016 å¹´ï¼‰æ¸²æŸ“åµŒå…¥ç‚¹ã€‚è¿˜ä½¿ç”¨ Web Workers å’Œ Streams API æ¥å®ç°å¤§åµŒå…¥ç‚¹çš„æµå¼ä¼ è¾“ã€‚å°†åµŒå…¥ä¸æ¸²æŸ“å¹¶è¡Œå¤„ç†ã€‚\nä¸ºäº†å®ç°å¿«é€Ÿå…¨æ–‡æœç´¢ï¼Œåº”ç”¨äº† FlexSearchï¼ˆWilkerlingï¼Œ2019ï¼‰çš„ä¸Šä¸‹æ–‡ç´¢å¼•è¯„åˆ†ç®—æ³•ã€‚ä½¿ç”¨ D3ï¼ˆBostock ç­‰ï¼Œ2011ï¼‰è¿›è¡Œå…¶ä»–å¯è§†åŒ–ï¼Œå¹¶ä½¿ç”¨ scikit-learnï¼ˆPedregosa ç­‰ï¼Œ2011ï¼‰è¿›è¡Œæ ¸å¯†åº¦ä¼°è®¡ï¼ˆKDEï¼‰ã€‚ä¸ºäº† WizMap å¯ä»¥è½»æ¾é›†æˆåˆ°ç”¨æˆ·å½“å‰çš„æµç¨‹ä¸­ï¼ˆWang ç­‰ï¼Œ2023ï¼‰ï¼Œåº”ç”¨ NOVAï¼ˆWang ç­‰ï¼Œ2022bï¼‰ä½¿ WIZMAP åœ¨ç¬”è®°æœ¬ä¸­å¯ç”¨ã€‚ç”¨æˆ·è¿˜å¯ä»¥é€šè¿‡å”¯ä¸€çš„ URL ä¸åä½œè€…å…±äº«ä»–ä»¬çš„åµŒå…¥å›¾ã€‚\nWizMap çš„å¼€å‘è€…æä¾›è¯¦ç»†çš„æ•™ç¨‹ï¼Œå¸®åŠ©ç”¨æˆ·å¤„ç†åµŒå…¥ï¼Œå¹¶ä¸”å°† WizMap å¼€æºï¼Œä»¥æ”¯æŒåµŒå…¥æ¢ç´¢å·¥å…·çš„æœªæ¥ç ”ç©¶å’Œå¼€å‘ã€‚\nğŸ”§Usage Scenarios ä½¿ç”¨åœºæ™¯ Exploring ACL Research Topic Trends æ¢ç´¢ ACL ç ”ç©¶è¶‹åŠ¿ æµ·ä¼¦ï¼ˆHelenï¼‰æ˜¯ä¸€ä½ç§‘å­¦å†å²å­¦å®¶ï¼Œå¥¹åˆ©ç”¨ ACL Anthology æ•°æ®é›†ç ”ç©¶ NLP é¢†åŸŸçš„æ¼”å˜ã€‚å¥¹æå–äº† 63k ç¯‡è®ºæ–‡çš„æ ‡é¢˜å’Œæ‘˜è¦ï¼Œå¹¶ä½¿ç”¨ MPNet ç”Ÿæˆ 768 ç»´åµŒå…¥å‘é‡ã€‚ç„¶åï¼Œå¥¹é€šè¿‡ UMAP é™ç»´ï¼Œå¹¶è°ƒæ•´å‚æ•°ä»¥ä¼˜åŒ–æŠ•å½±åˆ†å¸ƒã€‚å¥¹åˆ©ç”¨ WizMap ç”ŸæˆåµŒå…¥æ‘˜è¦ã€KDE åˆ†å¸ƒå’Œæµå¼æ•°æ®çš„ JSON æ–‡ä»¶ï¼Œå¹¶åŸºäºå¹´ä»½ç‰¹å¾åˆ†æ NLP ç ”ç©¶ä¸»é¢˜çš„æ—¶é—´æ¼”å˜ã€‚\nåœ¨å¯è§†åŒ–åˆ†æä¸­ï¼Œæµ·ä¼¦é€šè¿‡ç¼©æ”¾å’Œå¹³ç§»æ¢ç´¢åµŒå…¥ç»“æ„ï¼Œå¹¶ä½¿ç”¨æœç´¢åŠŸèƒ½æŸ¥æ‰¾ç‰¹å®šå…³é”®è¯çš„è®ºæ–‡ã€‚å¥¹å‘ç°ä¸åŒçš„ç ”ç©¶æ–¹å‘å½¢æˆäº†ç‹¬ç«‹ç°‡ï¼Œä¾‹å¦‚ç¿»è¯‘ã€æ‘˜è¦å’ŒåŒ»ç–— NLPã€‚åœ¨æ’­æ”¾åµŒå…¥æ¼”å˜åŠ¨ç”»æ—¶ï¼Œå¥¹è§‚å¯Ÿåˆ° NLP ç ”ç©¶ä¸»é¢˜çš„å˜åŒ–ï¼Œå¦‚è¯­æ³•ç ”ç©¶çƒ­åº¦ä¸‹é™ï¼Œè€Œé—®ç­”ã€è®½åˆºã€å¹½é»˜å’Œä»‡æ¨è¨€è®ºç­‰æ–°ä¸»é¢˜é€æ¸å…´èµ·ã€‚æœ€ç»ˆï¼Œå¥¹å†³å®šæ’°å†™ä¸€ç¯‡è®ºæ–‡ï¼Œæ¢è®¨ NLP ç ”ç©¶è¶‹åŠ¿çš„æ¼”å˜ã€‚\nInvestigating Text-to-Image Model Usage æ¢ç©¶æ–‡ç”Ÿå›¾æ¨¡å‹çš„ä½¿ç”¨ Bob æ˜¯ä¸€åæœºå™¨å­¦ä¹ ç ”ç©¶å‘˜ï¼Œè‡´åŠ›äºæ”¹è¿›æ–‡ç”Ÿå›¾çš„æ¨¡å‹ã€‚ä»–ä½¿ç”¨ DiffusionDB æ•°æ®é›†ï¼Œåˆ†æç”¨æˆ·çš„æ–‡æœ¬æç¤ºï¼ˆpromptï¼‰ä¸ç”Ÿæˆå›¾åƒçš„å…³ç³»ã€‚ä¸ºæ­¤ï¼Œä»–é‡‡ç”¨ CLIP å°†æ–‡æœ¬å’Œå›¾åƒç¼–ç ä¸º 768 ç»´åµŒå…¥ï¼Œå¹¶åˆ©ç”¨ UMAP é™ç»´åˆ° 2D ç©ºé—´ã€‚éšåï¼Œä»–ä½¿ç”¨ WizMap è¿›è¡Œå¯è§†åŒ–ï¼Œæ¢ç´¢ 360 ä¸‡ä¸ªåµŒå…¥çš„ç»“æ„ã€‚\nåœ¨åµŒå…¥æ¢ç´¢è¿‡ç¨‹ä¸­ï¼ŒBob å‘ç°æç¤ºä¸»è¦åˆ†ä¸ºè‰ºæœ¯å’Œæ‘„å½±ä¸¤ä¸ªç±»åˆ«ï¼Œå¹¶è¿›ä¸€æ­¥è¯†åˆ«å‡ºæ‘„å½±ç±»åˆ«ä¸­çš„ä¸¤ä¸ªå°ç°‡ï¼šéäººç±»ç‰©ä½“å’Œåäººã€‚éšåï¼Œä»–é€šè¿‡æ¯”è¾ƒæ–‡æœ¬åµŒå…¥ä¸å›¾åƒåµŒå…¥çš„åˆ†å¸ƒï¼Œå‘ç°â€œç”µå½±â€ç›¸å…³çš„æ–‡æœ¬åµŒå…¥å¯†åº¦è¾ƒä½ï¼Œè€Œâ€œè‰ºæœ¯è‚–åƒâ€åœ¨å›¾åƒåµŒå…¥ä¸­å¯†åº¦è¾ƒé«˜ï¼Œè¿™å¯èƒ½è¡¨æ˜ Stable Diffusion åœ¨ç”Ÿæˆé€¼çœŸçš„äººè„¸å›¾åƒæ–¹é¢å­˜åœ¨ä¸€å®šçš„å±€é™æ€§ã€‚Bob å¯¹è¿™ä¸ªå‘ç°æ„Ÿåˆ°æ»¡æ„ï¼Œå¹¶å°†å…¶ç”¨äºæ”¹è¿›è®­ç»ƒæ•°æ®ã€‚\nğŸ›¤ï¸ Future Work and Conclusion æœªæ¥å·¥ä½œä¸ç»“è®º WizMap é›†æˆåŸºäºå››å‰æ ‘çš„åµŒå…¥æ‘˜è¦æŠ€æœ¯ï¼Œæ–¹ä¾¿ç”¨æˆ·è§£é‡Šå¤šç§ç²’åº¦çº§åˆ«çš„åµŒå…¥ï¼Œå±•ç°å‡ºä¸ºæœºå™¨å­¦ä¹ é¢†åŸŸæä¾›å¯è§†åŒ–åµŒå…¥çš„æ½œåŠ›ã€‚å¼€å‘è€…åŒæ—¶ä¹Ÿåæ€å¼€å‘è¿‡ç¨‹ä¸­çš„ä¸è¶³ï¼Œå¹¶æç‚¼å‡ºäº†æœªæ¥çš„ç ”ç©¶æ–¹å‘ï¼š\nç”¨æˆ·ç ”ç©¶ï¼Œæ¢ç©¶ç”¨æˆ·çœ¼ä¸­è‡ªé€‚åº”çš„è§†å›¾ç²’åº¦å˜æ¢çš„æœ‰æ•ˆæ€§ è‡ªåŠ¨æ´å¯Ÿï¼ŒåŸºäºå››å‰æ ‘çš„æ–¹æ³•å¯¹ç“¦ç‰‡å¤§å°æ•æ„Ÿï¼Œéœ€è¦æ›´ç¨³å¥çš„åµŒå…¥æ‘˜è¦æ–¹æ³• å¢å¼ºæ¯”è¾ƒï¼Œå åŠ ç­‰é«˜çº¿çš„æ–¹æ³•åœ¨å±€éƒ¨æ¯”è¾ƒä¸ŠåŠ£äºå…¶å®ƒæŠ€æœ¯ï¼Œå¦‚å¹¶åˆ—ï¼ˆJuxtapositionï¼‰å’Œæ˜¾å¼ç¼–ç ï¼ˆExplicit Encodingï¼‰ ğŸ“‰ Broader Impact æ›´å¹¿æ³›çš„å½±å“ ä¸è‰¯åˆ†å­å¯èƒ½ä¼šæ¶æ„åˆ©ç”¨ä» WizMap ä¸­è·å¾—çš„è§è§£ã€‚ä¾‹å¦‚ï¼Œç ”ç©¶è¡¨æ˜æœºå™¨å­¦ä¹ åµŒå…¥åŒ…å«ç¤¾ä¼šåè§ï¼ˆBolukbasi ç­‰äººï¼Œ2016 å¹´ï¼‰ã€‚å› æ­¤ï¼Œä¸è‰¯åˆ†å­å¯ä»¥é€šè¿‡æ³¨å…¥å·²çŸ¥ä¸æ€§åˆ«å’Œç§æ—åè§ç›¸å…³çš„åµŒå…¥æ¥æ“çºµå’Œç ´åæœºå™¨å­¦ä¹ é¢„æµ‹ã€‚\nğŸ“ After words ä¸ªäººæ‹™è§ï¼Œä¸»è¦æè¿°é™¤æŠ•å½±ç®—æ³•å’Œå¼€å‘è€…å·²åæ€çš„ä¸è¶³ä¹‹å¤–çš„ä¸ªäººçœ‹æ³•ã€‚å¯èƒ½æ˜¯ä¸€äº›ç»†ææœ«èŠ‚çš„è§’åº¦ï¼Œå¦‚æœ‰ä¸å½“ï¼Œè¿˜æœ›æµ·æ¶µ\næœç´¢åŠŸèƒ½å…è®¸æœç´¢å…³é”®è¯å¹¶é«˜äº®ç›¸å…³åµŒå…¥ï¼Œä½†æ²¡æœ‰æä¾›æ›´é«˜çº§çš„æŸ¥è¯¢åŠŸèƒ½ï¼Œå¦‚æŒ‰ç±»åˆ«ç­›é€‰ã€æ¨¡ç³ŠåŒ¹é…æˆ–å¤æ‚é€»è¾‘æŸ¥è¯¢ï¼Œå¹¶æ ¹æ®ç»“æœç›¸å…³åº¦åˆ†ä¸åŒçº§åˆ«é«˜äº®åµŒå…¥ã€‚\nè§‚å¯ŸåµŒå…¥åœ¨çš„æ—¶é—´ä¸Šçš„æ¼”å˜æ—¶ï¼Œæ— æ³•é€‰å–æ’­æ”¾åŒºåŸŸå’Œæ§åˆ¶åŠ¨ç”»æ’­æ”¾é€Ÿåº¦ï¼Œéœ€è¦åœ¨æ—¶é—´ä¸Šç»†è‡´åˆ†ææ—¶å¯èƒ½æ˜¾å¾—ä¸å¤Ÿçµæ´»ã€‚\nåŸæ–‡ä¸­æåˆ°ç”¨æˆ·å¯ä»¥æŒ‡å®šæ¯ä¸ªåµŒå…¥ç‚¹çš„é¢œè‰²æ¥ç¼–ç é¢å¤–çš„ç‰¹å¾ï¼Œæ¯”å¦‚åµŒå…¥ç±»ï¼ˆUsers can specify the color of each embedding point to encode additional features, such as the class of embeddings.ï¼‰ã€‚ä½†åœ¨ live demo ä¸­å¹¶æ²¡æœ‰ä¸ºåµŒå…¥æä¾›æ‰‹åŠ¨æ ‡è®°å’Œåˆ†ç±»çš„æ“ä½œï¼Œè¿™ä¸€æ­¥éª¤æ˜¯å¦å‘ç”Ÿåœ¨å¯è§†åŒ–ä¹‹å‰ï¼Ÿ\næ€»ä½“ä¸Šä»ç„¶æ˜¯æä¸ºä¼˜ç§€çš„å¯è§†åŒ–å·¥å…·ï¼Œæ„Ÿè°¢å¼€å‘è€…ä»¬çš„å·¥ä½œã€‚\n","permalink":"https://congyuxiaoyoudao.github.io/posts/assignments/analysis-of-wizmap-scalable-interactive-visualization/","summary":"æœ¬æ–‡å°±åŸè®ºæ–‡åˆ†æäº†äº¤äº’å¼å¯è§†åŒ–å·¥å…· WizMapï¼Œæ¢è®¨å…¶å¦‚ä½•é€šè¿‡åˆ›æ–°çš„å¤šå°ºåº¦æ‘˜è¦æŠ€æœ¯è§£å†³å¤§è§„æ¨¡æœºå™¨å­¦ä¹ åµŒå…¥çš„å¯è§†åŒ–å’Œè§£é‡Šéš¾é¢˜ï¼Œå¹¶ä»‹ç»äº†å…¶ç”¨æˆ·ç•Œé¢ã€åº”ç”¨åœºæ™¯åŠæœªæ¥å‘å±•ã€‚","title":"Assignment 1. Analysis of WizMap Scalable Interactive Visualization"},{"content":" ä¹‹å‰çš„å‡ ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†Toonæ¨¡å‹ä¸€äº›åŸºæœ¬çš„Featureã€‚åœ¨æ·±å…¥å®šåˆ¶ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»å†·é™ä¸‹æ¥æ€è€ƒä¸€ä¸‹æˆ‘ä»¬éœ€è¦ä»€ä¹ˆ\nğŸš© 0x00 To begin with è¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\né›†æˆå¡æ¸²ç€è‰²æ¨¡å‹ For referenceğŸ‘‡ï¼š\nğŸ“– ã€UE5ã€‘é€šè¿‡æ·±åº¦åç§»è®¡ç®—åˆ˜æµ·æŠ•å½± ğŸ‘€ 0x02 ToonIntergrateBxDF ç›®å‰æˆ‘ä»¬çš„å…‰ç…§æ¨¡å‹åªæ˜¯å·²ç»å…·å¤‡äº†åŸºæœ¬çš„æ˜æš—å¤„ç†ï¼Œä»ç„¶æœ‰æ•°é‡ä¼—å¤šçš„Featureéœ€è¦å»å®ç°ï¼ˆRampã€SDFã€Anisotropic hairã€Matcapã€çœ¼é€ç­‰ç­‰ï¼‰ã€‚è™½ç„¶æœ‰ä¸€å°éƒ¨åˆ†å¯ä»¥ç”¨ä¸€äº›trické™„åŠ åœ¨åŸºç¡€è‰²æˆ–å…¶å®ƒæè´¨æ§½ä¸Šï¼Œä½†å…¶ä½™çš„å°±æ— å¯å¥ˆä½•äº†ã€‚è€Œä¸”ä¸åŒäºUnlitï¼Œåœ¨åº•å±‚é€»è¾‘å†™æ­»çš„æƒ…å†µä¸‹ï¼Œèƒ½åœ¨æè´¨ç¼–è¾‘å™¨ä¸­åšçš„å·¥ä½œå°±æ¯”è¾ƒæœ‰é™äº†ã€‚\nä¸€ä¸ªæ¯”è¾ƒå®¹æ˜“æƒ³åˆ°çš„æ–¹æ³•å°±æ˜¯ä¸ºéœ€è¦ç‰¹æ®Šå¤„ç†çš„æè´¨å•ç‹¬æ–°å»ºä¸€ä¸ªç€è‰²æ¨¡å‹ï¼Œæ¯”å¦‚è¯´å¤´å‘ä¸€ä¸ªã€çš®è‚¤ä¸€ä¸ªï¼Œç„¶åé‡Œé¢å„è‡ªå¤„ç†éœ€è¦çš„Featureã€‚ä½†ç€è‰²æ¨¡å‹æ•°é‡æ˜¯æœ‰é™çš„ï¼Œåœ¨ä¸æ‰©å±•FMaterialShadingModelFieldè‡³uint32çš„æƒ…å†µä¸‹æœ€å¤šåªå…è®¸16ä¸ªç€è‰²æ¨¡å‹ã€‚\nè€Œä¸”è¿™ä¹ˆå¤šæ¨¡å‹é€ä¸€æ·»åŠ ä¹Ÿæ¯”è¾ƒç¹çï¼Œæˆ‘è®¤ä¸ºä¸å¤ªä¼˜é›…ï¼Œæ‰€ä»¥æƒ³åˆ°å¦ä¸€ä¸ªæ–¹æ³•ã€‚æ—¢ç„¶æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ªToonBxDFï¼Œä½•ä¸ä»¿ç…§IntegrateBxDFçš„å†™æ³•ï¼Œåœ¨é‡Œé¢å†™ä¸ªå¤§åˆ†æ”¯ï¼Œåˆ†å‘ä¸åŒToonæè´¨çš„æƒ…å†µå‘¢ï¼Ÿ\næ€è·¯æœ‰äº†ï¼Œé‚£ä¸‹ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œæ ¹æ®ä»€ä¹ˆåˆ†å‘å‘¢ï¼ŸIntegrateBxDFæ˜¯æ ¹æ®ShadingModelIDï¼Œæˆ‘ä»¬åº”è¯¥ä¹Ÿéœ€è¦ä¸€ä¸ªToonShadingModelIDã€‚è¿™ä¸ªæ—¶å€™æˆ‘æƒ³èµ·äº†ä¹‹å‰å¼€è¾Ÿä½†æ²¡ä½¿ç”¨è¿‡çš„ToonCustomå¼•è„šã€‚ç°åœ¨å®ƒè¢«å­˜å‚¨åœ¨GBufferçš„CustomDataçš„Alphaé€šé“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœæ­¢æ”¾ç½®Playï¼Œå¥½å¥½ä½¿ç”¨å®ƒäº†ã€‚\nFGBufferDataä¸­çš„CustomDataåœ¨BasePassä¸­ç»è¿‡ç¼–ç æ¥åˆ°GBufferDï¼Œæœ€åè¾“å‡ºåˆ°MRT[4]æˆ–MRT[5]ã€‚\nç±»å‹æ˜¯floatï¼Œï¼ˆæ²¡é”™ï¼Œhalf4ç«Ÿç„¶æ˜¯ä¸ªå®ï¼‰ã€‚\nä½†æ˜¯èŒƒå›´åªæœ‰0~1ï¼Œç”±äºGBufferTextureçš„æ€§è´¨ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªå¼•è„šè¾“å…¥çš„ä»»ä½•æ•°å€¼éƒ½ä¼šè¢«ç¡¬ä»¶é’³åˆ¶åˆ°è¿™ä¸ªèŒƒå›´ã€‚æ²¡åŠæ³•ï¼Œå†™ä¸ªå‡½æ•°è½¬ä¸€ä¸‹å§ã€‚\n1uint DecodeFloatToToonShadingModelID(float SrcFloat) 2{ 3 return SrcFloat * 255; 4} UEé‡Œé¢ä¹Ÿæ–°å†™ä¸€ä¸ªæè´¨å‡½æ•°ï¼ŒæŠŠæ­£å¸¸çš„IDæ˜ å°„è¿‡å»ï¼Œ\næœ€ååœ¨ToonIntergrateBxDFé‡Œéšä¾¿å†™ç‚¹ä¸œè¥¿æµ‹è¯•ä¸€ä¸‹ï¼Œåªæœ‰å½“ToonShadingModelIDä¸º0æ—¶æ‰æœ‰å…‰ç…§è®¡ç®—ã€‚\nå•ç‹¬æŠŠèº«ä½“çš„IDè®¾æˆ2çœ‹çœ‹æ•ˆæœã€‚\n","permalink":"https://congyuxiaoyoudao.github.io/posts/interludes/toon-intergrated-bxdf/","summary":"\u003cblockquote\u003e\n\u003cp\u003eä¹‹å‰çš„å‡ ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†Toonæ¨¡å‹ä¸€äº›åŸºæœ¬çš„Featureã€‚åœ¨æ·±å…¥å®šåˆ¶ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»å†·é™ä¸‹æ¥æ€è€ƒä¸€ä¸‹æˆ‘ä»¬éœ€è¦ä»€ä¹ˆ\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2 id=\"-0x00-to-begin-with\"\u003eğŸš© 0x00 To begin with\u003c/h2\u003e\n\u003cp\u003eè¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e é›†æˆå¡æ¸²ç€è‰²æ¨¡å‹\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eFor reference\u003c/strong\u003eğŸ‘‡ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eğŸ“–\n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://zhuanlan.zhihu.com/p/690066418\"\u003eã€UE5ã€‘é€šè¿‡æ·±åº¦åç§»è®¡ç®—åˆ˜æµ·æŠ•å½±\u003c/a\u003e\n\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"-0x02--toonintergratebxdf\"\u003eğŸ‘€ 0x02  ToonIntergrateBxDF\u003c/h2\u003e\n\u003cp\u003eç›®å‰æˆ‘ä»¬çš„å…‰ç…§æ¨¡å‹åªæ˜¯å·²ç»å…·å¤‡äº†åŸºæœ¬çš„æ˜æš—å¤„ç†ï¼Œä»ç„¶æœ‰æ•°é‡ä¼—å¤šçš„Featureéœ€è¦å»å®ç°ï¼ˆRampã€SDFã€Anisotropic hairã€Matcapã€çœ¼é€ç­‰ç­‰ï¼‰ã€‚è™½ç„¶æœ‰ä¸€å°éƒ¨åˆ†å¯ä»¥ç”¨ä¸€äº›trické™„åŠ åœ¨åŸºç¡€è‰²æˆ–å…¶å®ƒæè´¨æ§½ä¸Šï¼Œä½†å…¶ä½™çš„å°±æ— å¯å¥ˆä½•äº†ã€‚è€Œä¸”ä¸åŒäºUnlitï¼Œåœ¨åº•å±‚é€»è¾‘å†™æ­»çš„æƒ…å†µä¸‹ï¼Œèƒ½åœ¨æè´¨ç¼–è¾‘å™¨ä¸­åšçš„å·¥ä½œå°±æ¯”è¾ƒæœ‰é™äº†ã€‚\u003c/p\u003e\n\u003cp\u003eä¸€ä¸ªæ¯”è¾ƒå®¹æ˜“æƒ³åˆ°çš„æ–¹æ³•å°±æ˜¯ä¸ºéœ€è¦ç‰¹æ®Šå¤„ç†çš„æè´¨å•ç‹¬æ–°å»ºä¸€ä¸ªç€è‰²æ¨¡å‹ï¼Œæ¯”å¦‚è¯´å¤´å‘ä¸€ä¸ªã€çš®è‚¤ä¸€ä¸ªï¼Œç„¶åé‡Œé¢å„è‡ªå¤„ç†éœ€è¦çš„Featureã€‚ä½†ç€è‰²æ¨¡å‹æ•°é‡æ˜¯æœ‰é™çš„ï¼Œåœ¨ä¸æ‰©å±•\u003ccode\u003eFMaterialShadingModelField\u003c/code\u003eè‡³\u003ccode\u003euint32\u003c/code\u003eçš„æƒ…å†µä¸‹æœ€å¤šåªå…è®¸16ä¸ªç€è‰²æ¨¡å‹ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"ShadingModelFieldåªæœ‰16ä½\" loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/TA-interludes/Interlude%201.ToonIntegrateBxDF/202503111821380.png#center\"\u003e\u003c/p\u003e\n\u003cp\u003eè€Œä¸”è¿™ä¹ˆå¤šæ¨¡å‹é€ä¸€æ·»åŠ ä¹Ÿæ¯”è¾ƒç¹çï¼Œæˆ‘è®¤ä¸ºä¸å¤ªä¼˜é›…ï¼Œæ‰€ä»¥æƒ³åˆ°å¦ä¸€ä¸ªæ–¹æ³•ã€‚æ—¢ç„¶æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ª\u003ccode\u003eToonBxDF\u003c/code\u003eï¼Œä½•ä¸ä»¿ç…§\u003ccode\u003eIntegrateBxDF\u003c/code\u003eçš„å†™æ³•ï¼Œåœ¨é‡Œé¢å†™ä¸ªå¤§åˆ†æ”¯ï¼Œåˆ†å‘ä¸åŒToonæè´¨çš„æƒ…å†µå‘¢ï¼Ÿ\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/TA-interludes/Interlude%201.ToonIntegrateBxDF/202503111821796.png#center\"\u003e\u003c/p\u003e\n\u003cp\u003eæ€è·¯æœ‰äº†ï¼Œé‚£ä¸‹ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œæ ¹æ®ä»€ä¹ˆåˆ†å‘å‘¢ï¼Ÿ\u003ccode\u003eIntegrateBxDF\u003c/code\u003eæ˜¯æ ¹æ®\u003ccode\u003eShadingModelID\u003c/code\u003eï¼Œæˆ‘ä»¬åº”è¯¥ä¹Ÿéœ€è¦ä¸€ä¸ª\u003ccode\u003eToonShadingModelID\u003c/code\u003eã€‚è¿™ä¸ªæ—¶å€™æˆ‘æƒ³èµ·äº†ä¹‹å‰å¼€è¾Ÿä½†æ²¡ä½¿ç”¨è¿‡çš„ToonCustomå¼•è„šã€‚ç°åœ¨å®ƒè¢«å­˜å‚¨åœ¨GBufferçš„\u003ccode\u003eCustomData\u003c/code\u003eçš„Alphaé€šé“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœæ­¢æ”¾ç½®Playï¼Œå¥½å¥½ä½¿ç”¨å®ƒäº†ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"CustomDataçš„å­˜å‚¨\" loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/TA-interludes/Interlude%201.ToonIntegrateBxDF/202503111821429.png#center\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eFGBufferData\u003c/code\u003eä¸­çš„\u003ccode\u003eCustomData\u003c/code\u003eåœ¨BasePassä¸­ç»è¿‡ç¼–ç æ¥åˆ°GBufferDï¼Œæœ€åè¾“å‡ºåˆ°MRT[4]æˆ–MRT[5]ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/TA-interludes/Interlude%201.ToonIntegrateBxDF/202503111928061.png#center\"\u003e\u003c/p\u003e\n\u003cp\u003eç±»å‹æ˜¯\u003ccode\u003efloat\u003c/code\u003eï¼Œï¼ˆæ²¡é”™ï¼Œ\u003ccode\u003ehalf4\u003c/code\u003eç«Ÿç„¶æ˜¯ä¸ªå®ï¼‰ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/TA-interludes/Interlude%201.ToonIntegrateBxDF/202503111822563.png#center\"\u003e\u003c/p\u003e\n\u003cp\u003eä½†æ˜¯èŒƒå›´åªæœ‰0~1ï¼Œç”±äºGBufferTextureçš„æ€§è´¨ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªå¼•è„šè¾“å…¥çš„ä»»ä½•æ•°å€¼éƒ½ä¼šè¢«ç¡¬ä»¶é’³åˆ¶åˆ°è¿™ä¸ªèŒƒå›´ã€‚æ²¡åŠæ³•ï¼Œå†™ä¸ªå‡½æ•°è½¬ä¸€ä¸‹å§ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"å°†æµ®ç‚¹è½¬ä¸ºToonShadingModelID\" loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/TA-interludes/Interlude%201.ToonIntegrateBxDF/202503112000369.png#center\"\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-hlsl\" data-lang=\"hlsl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e1\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003eDecodeFloatToToonShadingModelID\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003eSrcFloat\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e  \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e2\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e  \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e3\u003c/span\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eSrcFloat\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e255\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e4\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eUEé‡Œé¢ä¹Ÿæ–°å†™ä¸€ä¸ªæè´¨å‡½æ•°ï¼ŒæŠŠæ­£å¸¸çš„IDæ˜ å°„è¿‡å»ï¼Œ\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"MF_EncodeToonShadingModelIDToFloat\" loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/TA-interludes/Interlude%201.ToonIntegrateBxDF/202503112007292.png#center\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"ç¼–ç åæ¥å…¥è‡ªå®šä¹‰å¼•è„š\" loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/TA-interludes/Interlude%201.ToonIntegrateBxDF/202503112010055.png#center\"\u003e\u003c/p\u003e\n\u003cp\u003eæœ€ååœ¨ToonIntergrateBxDFé‡Œéšä¾¿å†™ç‚¹ä¸œè¥¿æµ‹è¯•ä¸€ä¸‹ï¼Œåªæœ‰å½“\u003ccode\u003eToonShadingModelID\u003c/code\u003eä¸º0æ—¶æ‰æœ‰å…‰ç…§è®¡ç®—ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/TA-interludes/Interlude%201.ToonIntegrateBxDF/202503112012801.png#center\"\u003e\u003c/p\u003e\n\u003cp\u003eå•ç‹¬æŠŠèº«ä½“çš„IDè®¾æˆ2çœ‹çœ‹æ•ˆæœã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/TA-interludes/Interlude%201.ToonIntegrateBxDF/202503112017053.png#center\"\u003e\u003c/p\u003e","title":"Interlude 1. ToonIntergratedBxDF"},{"content":"\næˆ‘å–œæ¬¢ä»°æœ›æœˆäº®ã€‚\næ¯æ¯æ²æµ´é‚£å®›è‹¥æ¥è‡ªç¥æ˜çš„æ¸…è¾‰ï¼ŒæµåŠ¨çš„é™è°§ï¼Œæ¾„æ¾ˆçš„æ¶¤è¡ï¼Œä¾¿èƒ½å¤Ÿå®½èµ¦ç§ç§æµ®èºã€ä¸å®‰ä¸æ„¤æ‡‘ã€‚\nâ€”â€”éšå¿ä¹‹å¿ƒã€‚å«è“„å…¸é›…ã€‚é—²å¯‚å¹½é™ã€‚\nå¹³æ—¥çš„ç”Ÿæ´»å€’ä¹Ÿç®—ç§°æ„ï¼Œè¾°æ—¶è€Œä½œï¼Œå­æ—¶è€Œæ¯ï¼Œå¿™ç¢Œäºè¯¾ä¸šçš„é—²æš‡ä¹Ÿæœ‰æ—¶é—´é’»ç ”è‡ªå·±çš„å…´è¶£ã€‚è¿™èˆ¬æ—¥å­ç¡®ä¹ä¸æƒŠæ³¢æ¾œï¼Œæˆ‘ä¹Ÿé»˜è®¸ã€‚\nç„¶è€Œå¿ƒåº•æ€»æ½œè—ç€å¯¹è¿‘æœˆä¹‹ä»ªçš„å‘å¾€ï¼Œæ¸´æœ›æ§èµ·å…¶çŸœæŒä¹‹ä¸‹ä¸ºäººæ‰€æ¼ è§†çš„â€”â€”æ— å£°çš„å†·ç„°ã€‚\n","permalink":"https://congyuxiaoyoudao.github.io/about/","summary":"\u003cp\u003e\u003cimg alt=\"Sakurakouji Luna\" loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Wives/202505260010872.jpg\"\u003e\u003c/p\u003e\n\u003cbr\u003e\n\u003cp\u003eæˆ‘å–œæ¬¢ä»°æœ›æœˆäº®ã€‚\u003c/p\u003e\n\u003cbr\u003e\n\u003cp\u003eæ¯æ¯æ²æµ´é‚£å®›è‹¥æ¥è‡ªç¥æ˜çš„æ¸…è¾‰ï¼ŒæµåŠ¨çš„é™è°§ï¼Œæ¾„æ¾ˆçš„æ¶¤è¡ï¼Œä¾¿èƒ½å¤Ÿå®½èµ¦ç§ç§æµ®èºã€ä¸å®‰ä¸æ„¤æ‡‘ã€‚\u003c/p\u003e\n\u003cbr\u003e\n\u003cp\u003eâ€”â€”éšå¿ä¹‹å¿ƒã€‚å«è“„å…¸é›…ã€‚é—²å¯‚å¹½é™ã€‚\u003c/p\u003e\n\u003cbr\u003e\n\u003cp\u003eå¹³æ—¥çš„ç”Ÿæ´»å€’ä¹Ÿç®—ç§°æ„ï¼Œè¾°æ—¶è€Œä½œï¼Œå­æ—¶è€Œæ¯ï¼Œå¿™ç¢Œäºè¯¾ä¸šçš„é—²æš‡ä¹Ÿæœ‰æ—¶é—´é’»ç ”è‡ªå·±çš„å…´è¶£ã€‚è¿™èˆ¬æ—¥å­ç¡®ä¹ä¸æƒŠæ³¢æ¾œï¼Œæˆ‘ä¹Ÿé»˜è®¸ã€‚\u003c/p\u003e\n\u003cbr\u003e\n\u003cp\u003eç„¶è€Œå¿ƒåº•æ€»æ½œè—ç€å¯¹è¿‘æœˆä¹‹ä»ªçš„å‘å¾€ï¼Œæ¸´æœ›æ§èµ·å…¶çŸœæŒä¹‹ä¸‹ä¸ºäººæ‰€æ¼ è§†çš„â€”â€”æ— å£°çš„å†·ç„°ã€‚\u003c/p\u003e","title":"About"},{"content":"","permalink":"https://congyuxiaoyoudao.github.io/nebula/","summary":"","title":"Nebula"}]