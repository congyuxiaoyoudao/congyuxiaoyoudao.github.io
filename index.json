[{"content":" 本着虚心交流与接受批评的态度，把这篇用来“应付”学校作业的综述写作放上来，不吝赐教！\n0x00 To begin with 这篇文章将会包含以下内容：\n近年来水体波形模拟的主要方法分类介绍 现有文献的研究趋势分析及未来方向预测 For reference：\n📖 真实感水体渲染技术总结 📖 九、流体模拟简述 📖 游戏中的实时水体模拟技术 0x01 摘要 真实感水体模拟因其高度仿真的视觉表现与广泛的应用领域成为计算机图形学的研究热点。本文回顾了近 50 年（1978-2025）来水体模拟的方法，具体而言，包括早期基于经验与统计的方法与参数化波列合成的方法，中期基于物理的数值模拟方法和波粒子方法，以及近年转向数据驱动的深度学习方法。\n关键词：流体模拟、波形模拟、深度学习、物理数值方法\nRealistic water simulation has emerged as a prominent research focus in computer graphics due to its highly realistic visual effects and broad application domains. This paper reviews the methods of water simulation over the past 50 years (1978–2025), specifically including early approaches based on empirical and statistical models, parametric wave synthesis methods, mid-term physics-based numerical simulation techniques and wave particle methods, as well as the recent shift toward data-driven deep learning approaches.\nKeywords: Fluid simulation, Wave simulation, Deep learning, Physics-based numerical methods\n0x02 引言 流体模拟作为计算机图形学与流体动力学的重要分支，是一种利用物理定律和计算机算法对流体（如水波、烟雾和火焰）的行为进行仿真预测的技术，在计算机图形学、虚拟现实、影视行业以及游戏开发领域有着广泛应用。数十年来，研究人员已经开发了一系列基于流体动力学的数值模型。虽然这些方法在模拟效果和算法优化上各有优势，但高质量的流体仿真的计算开销往往无法满足实时渲染的要求，特别是当进行高分辨率场景（如海洋、河流和湖泊）的模拟时，模拟时间将大幅增加。如何高效、实时地进行高质量、真实的流体模拟，是学术界和工业界亟待解决的难题。\n在自然界的众多流体中，水体堪称一个典型的模拟对象，在游戏中对其进行模拟的需求出现得尤为频繁。真实感的水体模拟不仅需要兼顾波形（Wave Shape）和着色（Shading）的拟真性，还要能够准确响应来自各种实体和用户的交互操作，以及具备用于优化的建模方法、LOD 技术和高效的曲面细分算法。其中，水体的波形模拟尤为关键，因为水波的形态和运动受到包含风力、深度和表面张力等诸多因素的共同影响，反映了水体与环境的各种交互形式，很大程度上影响模拟的真实性和视觉效果。\n传统的波形模拟方法大多为基于物理的数值模拟技术，根据流体的物理性质建立对应的数学模型，再利用数值方法对其求解，从而还原流体的动态行为。近年来，随着新一轮人工智能浪潮的兴起，研究人员也开始引入基于深度学习的方法[1]，通过训练一个数据驱动的模型代理传统模拟过程中计算最密集的部分，借助神经网络的强大拟合能力与现代硬件的加速支持，在最大程度上保证模拟精度的同时，显著提升了模拟速度。本篇文章将主要关注近几十年以来关于水体波形模拟的研究进展，内容涵盖最早的基于经验和统计的参数模型方法、传统的基于物理的数值方法和最新的基于深度学习的数据驱动方法。首先，我们将按照时间顺序回顾水体波形模拟技术的发展历史[2-4]；接着我们将已有的方案按照实现的技术路径分类，介绍各类方法在拟真性、实时性以及适用场景等方面的特点和优势；最后，我们将对收集到的相关文献进行统计汇总，并通过可视化手段进行趋势分析与未来研究方向的预测。通过系统地整理和分析现有文献，本篇文章旨在为研究人员提供一个较为全面的技术路线图，同时为进一步探索高效的真实感水体的波形模拟方法提供理论和实践参考。\n0x03 水体波形模拟概述 真实感的水体模拟因其卓越的视觉表现，作为提升沉浸感与视觉真实度的重要技术手段，在各类游戏中得到了广泛应用。\n比如求生之路 2 中诡秘的林间水面：\nWater - Valve Developer Community 再到地平线西之绝境中幽深的河滩：\n最后是红色沙漠（Crimson Desert，2025）中潺潺的溪涧流水：\nDev Archives: The Engine Behind Crimson Desert | GDC 2025 要想实现这些大作中极具表现力的水体渲染效果，首要难点就是对水体的波形模拟。如何表现出拟真的水面波浪动态，一直是学术界和工业界长期攻坚的技术难题。多年来，研究人员已经提出了一系列对水体波形进行模拟的方法，按时间顺序列出如下：\n凹凸贴图（Bump Mapping）[J. Blinn，1978][5] 随机波形（Random Waves）[Schachter，1980][6] 正弦波（Sinusoids Wave）[Max N L，1981][7] 分形噪声（Fractal Noise）[Perlin Ken，1985][8] Gerstner 波（Gerstner Wave）[Fournier 和 Reeves，1986][9] 快速傅里叶变换（Fast Fourier Transform）[Mastin 等，1987][10] B-样条（Beta-Splines）[T\u0026rsquo;so 和 Barsky，1987][11] 欧拉方法（Eulerian Approaches）[Kass 和 Miller，1990][12] 拉格朗日方法（Lagrangian Approaches）[Stam 和 Fiume，1995][13] 欧拉-拉格朗日混合方法（Hybrid Approaches）[Brein 和 Hodgins,1995][14] 空间-频谱混合方法（Spatial-Spectral Approaches）[Thon 等，2000][15] 波粒子（Wave Particles）[Yuksel 等，2007][16] 流型图（Flow Map）[Vlachos，2010] 回归森林（Regression Forests）[Ladický 等，2015][25] 水面波包方法（Water Wave Packets）[Jeschke，2017][21] 变形感知神经网络（Deformation-aware Neural Networks）[Prantl 等，2017][29] 卷积神经网络（CNN）[Tompson 等，2017][26] 水面小波方法（Water Surface Wavelets）[Jeschke，2018][22] 潜在空间物理方法（Latent Space Physics）[Wiewel 等，2019][30] 深度神经网络（Deep Neural Network）[Zhang 等，2020][31] 图神经网络（Graphic Neural Network）[Sanchez-Gonzalez 等，2020][34] 按照实现技术的路径分类，可将上文总结的方法分为如下几类：\n早期的基于凹凸贴图的方法 线性波形叠加方法 基于统计频谱的参数化方法 基于物理的数值模拟方法 波粒子方法 基于深度学习的方法 下面对每种类别的方法进行详细介绍。\n0x04 基于凹凸贴图的方法 Blinn 在 1978[5]年开发的凹凸贴图映射（bump mapping）技术是对水体波形模拟的首次尝试。这种方法通过施加一个凹凸函数扰动表面法线方向模拟波纹效果，可以很好地再现水体表面波浪反射的随机性。\n可以选用不同的凹凸映射函数对表面进行扰动。例如，Schachter（1980）[6] 提出了一个随机波形（Random Wave）的模型，该模型包含一张预计算的窄带噪声（narrow-band noise）波形表，通过叠加多个窄带噪声波形向量生成水体纹理；Perlin（1985）[8] 结合 20 个放射状摆线波形，使用球形波前替代传统的线性波前，每个波源的振幅与频率满足 $1/f$ 关系，这一性质表达分形的思想，打破了纹理分布的重复性。\n尽管这些基于凹凸贴图的方法易于使用且不需要复杂的模拟过程，但通常不足以满足模拟和动画的需求。由于没有在几何层面上对网格进行任何更改，视觉上表现“凸起”的波浪缺乏足够的几何细节和动态性，难以表现真实的水面运动。\n0x05 线性波形叠加方法 线性波形叠加方法基于波动的线性叠加原理，每个波列由一组独立的参数控制，叠加后可以生成复杂的表面形态。​在水体模拟中，常用的基础波形为正弦波和 Gerstner 波。\n正弦波（Sinusoids Wave） Max（1981）[7] 首先将傅里叶分析理论引入计算机图形学，在他著名的电影 Carla\u0026rsquo;s Island 中使用一系列正弦波的叠加近似 Stokes 波，模拟水面波浪效果。通过不同频率正弦波的线性组合构建水面高度场，用三个参数计算在时间$t$上的海面高度图：\n$$ h(x,z,t)=-y_{0}+\\sum_{i=1}^{N_{\\omega}}A_{i}\\cos(k_{i_{x}}x+k_{i_{z}}z-\\omega _{i}t) $$ 其中$N_{\\omega}$是波数，$A_{i}$是第$i$个波的振幅，$\\vec{k}=(k_{i_{x}},k_{i_{z}})$是波矢量，$\\omega_{i}$是其脉冲值，$y_{0}$是自由表面的高度。\nPeachey（1986）[17]通过引入波剖面函数（wave profile）与相位函数的分离设计，能够根据深度改变波的振幅，改进了这种方法。\n目前在水体渲染领域已经很少直接使用正弦波进行波形模拟，业界往往青睐于使用它的进化版 Gerstner 波。\nGerstner 波（Gerstner Wave） Fournier 和 Reeves (1986) [9]提出了基于 Gerstner 模型的水体波形建模方法，通过参数化轨道运动实现了复杂海面动态的模拟。这种方法的基本思想是使用自由表面上的每个粒子描述其静止位置周围的圆，粒子的运动方程（仅考虑 XZ 平面）可以表示为：\n$$ \\begin{aligned} x=\u0026x_{0}+r\\times \\sin(\\kappa x_{0}-\\omega t) \\\\ z=\u0026z_{0}-r\\times \\cos(\\kappa x_{0}-\\omega t) \\end{aligned} $$ 通过调节轨道半径$r$、波数$\\kappa$、角频率$\\omega$等参数，可以生成不同形态的波形（如正弦波、摆线波等）。为了模拟真实海洋表面的变化性和随机性，作者引入了波列（wave trains），即具有相同基本特征（高度，周期和波长）和相同初始相位的波浪组，每列波浪都有自己的一组参数和可选的随机元素。\n相较于传统的正弦波模型，Gerstner 波具有更尖锐的波峰和更平缓的波谷，能够更真实地还原海洋中波浪的非对称特征，适用于表现大尺度的水体动态。并且由于计算量可控，性价比高，不少游戏仍采用其作为水体渲染的基础实现。\n0x06 基于统计频谱的参数化方法 基于统计频谱的参数化方法区别于以往的空间域的模拟方法，首次引入了频域的概念。通过使用从理论或测量数据获得的波的频谱分布来描述海洋表面，然后从频域提取幅度分量并通过逆快速傅里叶变换（IFFT）转换回空间域，构造水体表面高度场，将表面的几何特征作为每个点$X$处的高度，如下所示：\n$$ h(X,t)=\\sum_{i=1}^{N_{s}}\\tilde{h}(\\vec{k},t)e^{\\vec{ik}X} $$ 其中$N_{s}$是频谱分量数，$\\vec{k}$是波矢量，$\\tilde{h}(\\vec{k},t)$是从理论或经验波谱中获得的傅里叶分量。\n快速傅里叶变换（FFT） Mastin 等（1987）[10]提出了基于傅立叶合成与经验风海频谱模型的海洋波形模拟技术。其风海频谱模型是基于 Pierson 和 Moskowitz（1964）[18]由波浪记录构建的一个完全开发的风海频谱模型，其功率谱可以表示为：\n$$ F_{PM}(f)=\\frac{\\alpha g^2}{(2\\pi)^4f^5}e^{-\\frac{5}{4}(\\frac{f_{m}}{f})^4} $$ 其中$\\alpha=0.0081$为 Phillips 常量，$g$是引力常数。频率峰值$f_{m}$可以如下表示：\n$$ f_{m}=\\frac{0.13g}{U_{10}} $$ 该模型揭示了完全开发的一维风海频谱的可以使用风速（$U_{10}$）计算得出，Hasselmann 等（1980）[19]在此基础上结合方向传播因子（$D(f,\\theta)$）提出了一个二维频谱：\n$$ \\begin{aligned} F(f,\\theta)=\u0026F_{PM}(f)D(f,\\theta)\\\\ D(f,\\theta)=\u0026N_{p}^{-1}\\cos^{2p}(\\theta/2) \\end{aligned} $$ 其中：\n$$ \\begin{aligned} p=9.77\\left( \\frac{f}{f_{m}} \\right)^\\mu,\u0026\\quad \\mu=\\begin{cases} 4.06 \\quad \u0026if \\quad ff_{m} \\end{cases} \\\\ N_{p}=\u0026\\frac{2^{1-2p}\\pi \\Gamma(2p+1)}{\\Gamma^2(p+1)} \\end{aligned} $$ Mastin 等在此基础上，使用正向 FFT、上述滤波器和逆 FFT，从白噪声图像中以非常简单的方式合成了海洋图像 。通过对白噪声图像进行二维快速傅里叶变换，使用二维风海频谱对 FFT 幅度项进行滤波，能够生成不错的波浪外观。\n后来的研究人员在此基础上尝试使用多种频谱对水体进行模拟，如 Premoze 和 Ashikhmin（2000）[20]的 JONSWAP，Tessendorf（2001）的高斯伪随机和 Phillips 理论波谱 。这些方法在制作静止图像方面效果很好，但不适合动画。因为用于进行模拟的频谱数据不包含在时间上的变化。\n空间-频谱混合方法（Spatial-Spectral Approaches） 由于传统 FFT 方法需要将频域滤波结果转换为有限空间域高度场，导致生成的海面尺寸受限且无法实现多细节层次。Thon 等（2000）[15]改良了这种方法，在一个小矩阵中对海洋频谱进行采样（a），选取其中在振幅方面最具代表性的分量（b），并将这些分量的值（频率、振幅、方向）用于摆线（trochoid）的参数。与传统的 FFT 方法不同，这种方法结合了空间域的模拟思想，使用 Gerstner 波直接叠加摆线（e），无需使用逆 FFT，从而保留了多种细节层次。另外，这种方法是完全程序化的，只在需要时计算表面高度，无需存储网格或高度场。\n同时，仅选取少量代表性的频率分量也带来了精度不足的问题，为了解决这个问题，Thon 等引入了 Perlin（1985）的湍流函数替换所有没有被选择的分量：\n$$ Turbulence(P,m)=\\sum_{i=0}^{n_{o}-1}\\frac{Noise(P\\cdot m^i)}{m^i} $$ 其中，$n_{o}$是要求和的频率分量总数，$P$是空间中的一个点，$m$是频率乘数。通过在空间域中添加该湍流函数，引入了真实海浪谱中不存在的低频分量（f），而这些分量会在 Pierson-Moskowitz 滤波后被削弱甚至剔除（a）。\n最终的海面模型表示为：\n$$ \\begin{aligned} h(x,y,t)=\u0026 \\sum_{i=1}^nA_{i}\\cdot v(k_{i}(x\\cdot \\cos\\theta_{i}+y\\cdot \\sin \\theta_{i})-\\omega_{i}\\cdot t+\\phi_{i}) \\\\ +\u0026A_{t}\\cdot Turblence(x_{t}(t),y_{t}(t),z_{t}(t),m) \\end{aligned} $$ 其中，$A_{t}$是是湍流的振幅，$m$是频率乘数，$x_{t}(t),y_{t}(t),z_{t}(t)$ 是位移到湍流的时间函数。\n0x07 基于物理的数值方法 基于物理的方法使用 N-S（Navier-Stokes）方程对流体建立数学模型。N-S 方程作为流体力学的基础，描述了流体速度和质量随时间的变化过程，可以用来模拟各种流体的动态（如水体、烟雾、大气等）。模拟的核心在于对 N-S 方程的求解，从不同的视角出发，可以分为两种求解方法：欧拉方法（基于网格）和拉格朗日方法（基于粒子）。\nNavier-Stokes 方程 对于海洋等大型流体，通常考虑不可压缩流体，其形式为：\n$$ \\begin{aligned} \\nabla \\vec{U}\u0026=0 \\\\ \\frac{\\partial \\vec{U}}{\\partial t}+\\vec{U}\\nabla \\vec{U} + \\frac{\\vec{\\nabla}p}{\\rho}\u0026-\\mu \\frac{ \\nabla^2\\vec{U}}{\\rho}-\\vec{g}=0 \\end{aligned} $$ 其中$\\vec{U}$为流体的速度，$\\mu$为粘滞系数，$g$为引力常数。算子$\\nabla \\vec{U}$为$\\vec{U}$的梯度，可以根据下式计算：\n$$ \\nabla \\vec{U}=\\left(\\frac{\\partial u}{\\partial t},\\frac{\\partial v}{\\partial t},\\frac{\\partial w}{\\partial t} \\right) $$ 第一个方程为质量守恒方程，对于不可压缩流体，意味着流体的密度随时间保持不变；第二个方程为动量守恒方程，流体的加速度$\\frac{\\partial \\vec{U}}{\\partial t}$等于施加于其上的力除以其密度。\n欧拉方法（Eulerian approaches） 欧拉方法考察空间中的固定点，通过监测离散网格上的速度场、压力场、密度场等物理参数的变化规律，建立全局流场演化模型。这一方法的优势在于能够很方便地计算规则网格上的梯度，适用于大规模的流体模拟。\nKass 和 Miller（1990）[12]首次提出了基于物理方法的思想，通过三个假设（水面为高度场、垂直速度可忽略、水平速度恒定）将 N-S 方程简化为线性波动方程：\n$$ \\frac{{\\partial^2h}}{\\partial t^2}=gd \\frac{{\\partial ^2h}}{\\partial x^2} $$ 其中波速与水深的平方根成正比$c \\propto \\sqrt{ gd }$。为了求解这个方程，需要构造连续偏微分方程的离散形式，Kass 和 Miller 使用有限差分技术将其离散近似为：\n$$ \\begin{aligned} \\frac{{\\partial^2h_{i}}}{\\partial t^2}=-\u0026g\\left( \\frac{{d_{i-1}+d_{i}}}{2 (\\Delta x)^2}(h_{i}-h_{i-1}) \\right) \\\\ +\u0026g\\left( \\frac{{d_{i}+d_{i+1}}}{2 (\\Delta x)^2}(h_{i+1}-h_{i}) \\right) \\end{aligned} $$ 这种在连续均匀网格上的有限差分将将水体离散表示为水面高度场（$h_{i}$）、速度场（$u_{i}$）和水底（$b_{i}$），体现了欧拉方法的思想。\n拉格朗日方法（Lagrangian approaches） 拉格朗日方法基于组成流体的粒子，跟踪并考察每个粒子的运动轨迹、速度、压强、密度等随时间的变化。这一方法的优势在于粒子间的独立性更利于 GPU 并行运算，适用于模拟流体的细节，但处理大规模流体时效率较低。\nStam 和 Fiume（1995）[13]首次引入将 SPH（Smoothed Particle Hydrodynamics，光滑粒子流体动力学）引入图形学，从拉格朗日视角描述流体。SPH 的核心思想包括将流体离散为一组粒子，这些粒子为可通过核函数影响其邻居的潜在隐式表面（也称为 blobs 或 metaballs）。利用核函数对物理量进行加权平均，从而近似求解 N-S 方程。\n在拉格朗日视角下，N-S 方程可以被简化：考虑到每个粒子都有自己的质量，它们的总和等于流体的总质量，并且随时间保持不变，可以省略 N-S 的质量守恒方程；在动量守恒方程中，由于流体由粒子本身传输，可以省略非线性平流项（$\\vec{U}\\nabla \\vec{U}$）。最后，只需要一个线性方程来描述流体的速度：\n$$ \\frac{{\\partial \\vec{U}}}{\\partial t}=\\frac{1}{\\rho}(-\\nabla p+\\mu \\nabla^2\\vec{U}+\\rho g) $$ 其中，$\\nabla p$为压力，$\\mu \\nabla^2\\vec{U}$为粘性力，$\\rho g$为外部压力。相关物理量可以如下近似：\n$$ S_{i}=\\sum_{j=1}^{N_{p}}m_{j}{\\frac{S_{j}}{\\rho_{j}}}W(r,R) $$ 对压强计算梯度可以得到压力，对速度应用拉普拉斯算子可以计算粘滞力。\nFeldman 和 Bonet（2007）[42]对基于 SPH 的框架进行改进，提出了动态粒子细化的一般方法，根据固定的细化模式获得子粒子的最佳质量分布；Winchenbach 和 Kolb（2021）[43]对细化过程进行改进，使用一个离散化的目标函数自适应优化细化模式，显著降低了因固定模式带来的误差，能够模拟高达 1:1,000,000 的自适应体积比的不可压缩低粘度湍流。\n拉格朗日-欧拉混合的方法（Hybrid approaches） 为了结合这两种方法的优势，研究人员还开发了结合这两种技术的混合方法，即使用欧拉方法模拟流体主体部分，再使用拉格朗日方法模拟小尺度细节，例如泡沫，气泡或喷雾，事实上，这种合成的方法也获得了非常逼真的结果。\nBrein 和 Hodgins（1995）[14]首次结合了这两种方法，模拟流体在撞击时产生的波浪、飞溅现象；Takahashi 等（2003）[38]在欧拉模拟中嵌入粒子系统，创建包括飞溅和泡沫在内的复杂场景；Greenwood 和 House（2004）[39]使用水平集方法在流体空腔、流体-空气边界处创建气泡，实现了视觉上更为真实的水体表现。\nThürey 等（2006）[40]提出了一种将二维浅水模拟与三维自由表面流体模拟相结合的方法，通过使用 Lattice Boltzmann 方法求解 Saint-Venant 方程，实现了 2D 与 3D 仿真的耦合；之后作者扩展了这项工作，引入 SPH 方法表示粒子间的相互作用（2007）[41]。\n0x08 波粒子方法 波粒子方法使用粒子代表水波，允许其发生反射以及和其它对象相互作用。这种方法结合波粒二象性的思想，将三维水体波形模拟转化为对二维粒子运动进行模拟。\n波粒子（Wave Particle） Yuksel 等（2007）[16]首次引入波粒子（wave particle）的概念，模拟水体与其它物体的交互。每个波浪粒子携带振幅、波长、传播方向等属性，通过叠加局部偏差函数生成水面高度场。\n$$ D_{i}(x,t)=\\frac{a_{i}}{2}\\left(\\cos{\\frac{\\pi|x-x_{i}(t)|}{2}}+1\\right)\\Pi\\left(\\frac{{|x-x_{i}(t)|}}{2r_{i}}\\right) $$ 其中$a_{i}$是波粒子的振幅，$r_{i}$是波粒子的半径，$\\Pi(x)$是矩形函数，保证波形在有限范围内不发生突变：\n$$ \\begin{equation} \\Pi(x)=\\left\\{ \\begin{aligned} 1 \u0026 , \u0026 |x| \u003c \\frac{1}{2} \\\\ \\frac{1}{2} \u0026, \u0026 |x| = \\frac{1}{2} \\\\ 0 \u0026, \u0026 |x| \\ge \\frac{1}{2} \\end{aligned} \\right. \\end{equation} $$ 为了模拟真实水波的横纵波复合效应，Yuksel 等扩展了高度场，引入水平偏差分量$\\eta_{xy}$：\n$$ \\begin{aligned} \\eta_{xy}(x,t)=\u0026\\sum_{i}D_{i}^L(x,t) \\\\ D_{i}^L(x,t)=\u0026L_{i}(\\hat{u}_{i}\\cdot(x-x_{i}))D_{i}(x,t) \\\\ L_{i}(u)=\u0026-\\sin\\left( \\frac{2\\pi u}{l_{i}} \\right)\\Pi\\left( \\frac{u}{l_{i}} \\right)\\hat{u}_{i} \\end{aligned} $$ 其中，$D_{i}^L$是纵向局部偏差函数，$L_{i}$是描述纵向波形的函数，模拟波粒子的圆周运动。\n此外，当波前扩展超过波粒子半径一半以上时，将波粒子分裂为三个子波粒子（振幅和分散角为原波粒子的三分之一，波粒子半径不变），这种细分方法可以保持波前的连续性，兼顾波形的扩展和收缩。\n水面波包方法（Water Wave Packets） Jeschke 和 Wojtan（2017）[21]在波粒子理论的基础上，提出了水面波包（water packets）方法，将水波能量封装为波包单元。与传统波粒子方法不同，每个波包包含一组波长和波列，其运动由两个速度控制：\n群速度：决定波包整体能量传播方向 相速度：决定波包内部波峰运动速度 基于 Airy 波理论，波包高度场通过如下公式近似：\n$$ \\eta(x,t)\\approx \\sum_{j=1}^N a_{j}\\phi(\\hat{x})\\cos(k_{j}\\cdot(\\hat{x}-X_{pg})) $$ 其中，$\\phi(x)$为高斯包络函数，$X_{pg}$为相速度与群速度累计位移差，$a_{j}$和$k_{j}$分别表示波包的振幅和波数。为了维持能量守恒，根据面积变化动态调整波包振幅：\n$$ a_{j}(t_{n+1})=a_{j}(t_{n})\\sqrt{ {\\frac{(\\rho g+\\sigma k_{n}^2)A_{n}}{(\\rho g+\\sigma k_{n+1}^2)A_{n+1}}} } $$ 其中，$A_{n}$为波包面积，$\\rho,\\sigma$分别为水密度和张力。\n水面小波方法（Water Surface Wavelets） Jeschke 等（2018）[22]提出的水面小波方法（water surface wavelets）在水面波包算法基础上进行了改进。通过引入小波变换，将水面高度场分解为空间-频率方向的振幅函数：\n$$ \\eta(x,t)=Re\\int_{\\mathbb{R}^2} A(x,k,t)e^{i(k\\cdot x-\\omega(k)t)}dk $$ 其中振幅函数$A(x,k,t)$包含位置$x$，波矢量$k$和时间$t$。这种变换将高频波动信息编码到振幅函数中，使其空间变化更平滑，降低了对网格分辨率的要求。\n0x09 基于深度学习的方法 近年来，深度学习技术逐渐被研究人员引入水体模拟领域，通过使用基于深度学习的方法，以较小的计算成本近似求解流体动力学方程（N-S 方程），能够提升模拟效率和逼真度。对应求解 N-S 的两种主流视角，使用深度学习的加速也分为两大类别：对欧拉或拉格朗日方法进行加速，也有研究人员在这方面做了一些总结[23-24]。\n回归森林（Regression Forest） Ladický 等（2015）[25]针对传统基于粒子的流体模拟方法（如 SPH，PBF 等）计算成本高、步长受限等问题，首创性地提出了一种数据驱动的基于机器学习的方法。他们将求解 N-S 方程的过程转化为回归问题，通过训练回归森林模型学习并预测粒子加速度。特征向量直接对应 N-S 方程中的粘度、张力、压力和不可压缩约束：\n$$ \\begin{aligned} \u0026\\Phi_{X,R}^{vise}(x_{i})=\\frac{\\mu}{\\rho_{0}}\\left( \\sum_{j\\in X} v_{j}\\Omega_{R}(x_{j}-x_{i})-v_{i}\\sum_{j\\in X} \\Omega_{R}(x_{j}-x_{i}) \\right)\\\\ \u0026\\Phi_{X,R}^{ten}(x_{i})=\\frac{\\sigma}{\\rho_{0}}\\left( \\sum_{j\\in X} x_{j}\\Omega_{R}(x_{j}-x_{i})-x_{i}\\sum_{j\\in X} \\Omega_{R}(x_{j}-x_{i}) \\right)\\\\ \u0026\\Phi_{X,R}^{pres}(x_{i})=\\frac{k}{\\rho_{0}}\\nabla \\sum_{j\\in X} \\Omega_{R}(x_{j}-x_{i})\\\\ \u0026\\Phi_{X,R}^{comp}(x_{i})=\\phi_{X,R}^O(x_{i}) \\end{aligned} $$ 该特征向量设计使得模型能够在保持物理合理性的前提下，实现比传统 SPH 方法快 10-1000 倍的实时模拟速度。\n卷积神经网络（Convolutional Neural Network） Tompson 等（2017）[26]提出了一种基于卷积神经网络加速欧拉流体模拟的方法，使用卷积神经网络替代传统压力投影求解器，结合无监督学习框架提高计算效率。\n该方法的核心在于使用 CNN（卷积神经网络）预测不可压缩流体的压力场，代替传统数值方法中对一个大型稀疏线性系统进行求解的过程。具体而言，研究人员设计了一个专门的网络结构，网络的输入为速度场的散度和边界条件，输出为对流体压力场的估计。\n实验结果表明，该方法在二维和三维模拟中都能实现实时性能，并且在保持物理准确性的同时，显著提高了计算效率。​\nXiao 等（2018）[27]在此基础上改变了网络的输入：根据离散化欧拉网格结构和中间速度作为输入，预测泊松系统的解；Zhang 等（2023）[28]通过训练 CNN 求解 ISPH（不可压缩光滑粒子流体动力学）中的 PPE（泊松压力方程），首次训练了一个拉格朗日视角的 CNN 模型。\n图神经网络（Graph Neural Network） Sanchez-Gonzalez 等（2020）[32]首次提出了基于图神经网络的求解器（GNS），将图神经网络引入流体模拟：用图中的节点表示物理系统的粒子，并通过学习的信息传递来计算流体动力学；Li 和 Farimani（2022）[34]使用 GNN 加速拉格朗日流体模拟；Zhang 等（2024）[34]使用 GNN 代替 CNN 对 ISPH 的 PPE 进行求解，增加了对非结构化数据的处理；Higaki 等（2025）[35]在 GNS 的基础上提出了逐步增强的 GNS，证明了在固定粒子/节点大小时，拉格朗日求解器的时间步长可以显著增加。\n0x0a 总结 各类模拟方法总结 本文主要介绍了近 50 年以来计算机图形学中对水体模拟的各项研究工作，研究人员提出了大量且多样的模拟方法，我们大致可以将这些方法分为六个类别。具体而言，基于凹凸贴图的方法和线性波形叠加方法是对水体模拟的早期尝试，这些方法虽然能在视觉上获得不错的模拟效果，但缺乏物理交互性，无法表现动态细节；随着研究的进展，基于统计频谱的参数化方法和基于物理的数值方法逐渐成为主流，这些方法在满足了交互性的同时，能够提供极其拟真的洋面外观，但因为计算复杂度较高，难以满足实时渲染的要求；近年来，波粒子方法和基于深度学习的技术也陆续涌现，为水体模拟带来了新的可能性。\n水体波形模拟类别 主要思想 优势 劣势 适用场景 基于凹凸贴图的方法 通过预定义的纹理（法线贴图/高度贴图）模拟水面波纹，利用光影变化产生动态效果。 计算开销极低；实时性高；实现简单 无物理交互性；缺乏动态细节变化；近景效果差 游戏或实时渲染中的远距离水面、低硬件需求场景 线性波形叠加方法 叠加多个波形（如 Gerstner 波）以形成复杂波形，通过调整参数模拟不同波浪形态。 效果可控性高；计算效率较高；基本实现动态效果 缺乏真实物理交互;高频细节不足；参数调节依赖经验 电影特效中的规则波浪、游戏中的中距离海面 基于统计频谱的参数化方法 基于海洋学统计模型（如 Phillips 频谱），通过FFT生成符合真实海浪频谱分布的波形。 高真实度；自然波形细节丰富；支持大范围海面模拟 计算复杂度较高 ；参数调节复杂 ；实时性受限 影视级海洋场景、航海模拟器、大规模开放水域 基于物理的数值方法 直接求解流体力学方程（Navier-Stokes），模拟水体与环境的物理交互。 物理精确度高 ；支持复杂交互 ；动态细节最丰富 计算成本极高;实时性差；实现复杂度高 科研仿真、高精度影视特效、流体动力学研究 波粒子方法 将波浪分解为携带能量和方向的粒子系统，模拟波的传播与交互。 支持局部细节控制；动态交互性好；适合复杂边界 大规模模拟效率低；粒子间连贯性难保持；能量守恒实现复杂 游戏中的近景波浪特效（如船只尾迹）、小型水域交互模拟 基于深度学习的方法 使用神经网络学习近似求解传统流体力学方程，可通过数据驱动的方式模拟复杂水体行为。 可生成超现实效果；数据驱动适配性强；潜在的高效推理可能 需要大量训练数据；物理一致性难保证；实时推理硬件要求高 风格化水体渲染、快速原型设计、结合传统方法的混合系统 补充说明：\n实时性排序：凹凸贴图 \u0026gt; 波粒子 ≈ 波形叠加 \u0026gt; 参数化方法 \u0026gt; 深度学习 \u0026gt; 物理数值方法 真实度排序：物理数值方法 \u0026gt; 参数化方法 \u0026gt; 深度学习 ≈ 波形叠加 \u0026gt; 波粒子 \u0026gt; 凹凸贴图 趋势：工业界常采用混合方案（如：参数化方法+波粒子），学术界则聚焦物理数值方法与深度学习的结合。 硬件依赖性：深度学习与物理数值方法对 GPU/算力要求最高，凹凸贴图方法最轻量。 可视化分析及预测 使用 Zotero 对检索到的文献进行可视化分析：\n可以在词云图中看到，除了传统的“Navier-Stokes”、“Particle methods”、“Lagrangian ISPH”等基于物理方法外，“Artificial neural networks”、“CNN”、“deep neural network”等基于神经网络方法的术语也开始更为频繁地出现。这或许是一个积极的信号，表明后续的研究中以 AI 助力的水体模拟方法将不断涌现。当然，未来也有可能会出现用于模拟不同细节层次水体表现（如波浪、涡流、湍流、泡沫、浮沫等）的新方法。同时，为了优化模拟效率，获得实时速率，有必要针对不同层次的表现采取差异化的模拟策略，使用可扩展且动态自适应的建模策略，合理分配计算资源。\n0x0b Afterwords 虽然是用于应付学校论文写作课的作业（学校也不指望你真读懂个什么主要是把写论文软件和格式摸清，所以我至少会用 Zotero 了），粗浅地浏览各路大佬和 SIGGRAPH 的文章，不敢说有多大收获，但至少对这些出色的工作心向往之。有机会的话会单独开一篇 Issue 针对这个领域做一些研究。\n感谢前人的综述，为我的作业提供了很大帮助。\n0x0c Reference [1] DU T. Deep Learning for Physics Simulation[C/OL]//ACM SIGGRAPH 2023 Courses. New York, NY, USA: Association for Computing Machinery, 2023: 1-25[2025-04-10]. https://dl.acm.org/doi/10.1145/3587423.3595518 . DOI: 10.1145/3587423.3595518 .\n[2] DARLES E, CRESPIN B, GHAZANFARPOUR D, 等. A Survey of Ocean Simulation and Rendering Techniques in Computer Graphics[J/OL]. Computer Graphics Forum, 2011, 30(1): 43-60. DOI: 10.1111/j.1467-8659.2010.01828.x .\n[3] IGLESIAS A. Computer Graphics Techniques for Realistic Modeling, Rendering, and Animation of Water. Part I: 1980-88[C]//Proceedings of the International Conference on Computational Science-Part II. Berlin, Heidelberg: Springer-Verlag, 2002: 181-190.\n[4] IGLESIAS A. Computer Graphics Techniques for Realistic Modeling, Rendering and Animation of Water. Part II: 1989–1997[C/OL]//SLOOT P M A, HOEKSTRA A G, TAN C J K, 等. Computational Science — ICCS 2002. Berlin, Heidelberg: Springer, 2002: 191-200. DOI: 10.1007/3-540-46080-2_20 .\n[5] BLINN J F. Simulation of wrinkled surfaces[J/OL]. SIGGRAPH Comput. Graph., 1978, 12(3): 286-292. DOI: 10.1145/965139.507101 .\n[6] SCHACHTER B. Long crested wave models[J/OL]. Computer Graphics and Image Processing, 1980, 12(2): 187-201. DOI: 10.1016/0146-664X(80)90011-8 .\n[7] MAX N L. Vectorized procedural models for natural terrain: Waves and islands in the sunset[C/OL]//Proceedings of the 8th annual conference on Computer graphics and interactive techniques. New York, NY, USA: Association for Computing Machinery, 1981: 317-324[2025-04-10]. https://dl.acm.org/doi/10.1145/800224.806820 . DOI: 10.1145/800224.806820 .\n[8] PERLIN K. An image synthesizer[J/OL]. SIGGRAPH Comput. Graph., 1985, 19(3): 287-296. DOI: 10.1145/325165.325247 .\n[9] FOURNIER A, REEVES W T. A simple model of ocean waves[C/OL]//Proceedings of the 13th annual conference on Computer graphics and interactive techniques. New York, NY, USA: Association for Computing Machinery, 1986: 75-84[2025-04-10]. https://dl.acm.org/doi/10.1145/15922.15894 . DOI: 10.1145/15922.15894 .\n[10] MASTIN G A, WATTERBERG P A, MAREDA J F. Fourier Synthesis of Ocean Scenes[J/OL]. IEEE Computer Graphics and Applications, 1987, 7(3): 16-23. DOI: 10.1109/MCG.1987.276961 .\n[11] TS’O P Y, BARSKY B A. Modeling and rendering waves: wave-tracing using beta-splines and reflective and refractive texture mapping.[J/OL]. ACM Trans. Graph., 1987, 6(3): 191-214. DOI: 10.1145/35068.35070 .\n[12] KASS M, MILLER G. Rapid, stable fluid dynamics for computer graphics[J/OL]. SIGGRAPH Comput. Graph., 1990, 24(4): 49-57. DOI: 10.1145/97880.97884 .\n[13] STAM J, FIUME E. Depicting fire and other gaseous phenomena using diffusion processes[C/OL]//Proceedings of the 22nd annual conference on Computer graphics and interactive techniques. New York, NY, USA: Association for Computing Machinery, 1995: 129-136[2025-04-10]. https://dl.acm.org/doi/10.1145/218380.218430 . DOI: 10.1145/218380.218430 .\n[14] O’BRIEN J F, HODGINS J K. Dynamic Simulation of Splashing Fluids[A/OL]. (2023-02-13)[2025-04-11]. http://arxiv.org/abs/2302.06087 . DOI: 10.1109/CA.1995.393532 .\n[15] THON S, DISCHLER J M, GHAZANFARPOUR D. Ocean waves synthesis using a spectrum-based turbulence function[C/OL]//Proceedings Computer Graphics International 2000. 2000: 65-72[2025-04-11]. https://ieeexplore.ieee.org/document/852321 . DOI: 10.1109/CGI.2000.852321 .\n[16] YUKSEL C, HOUSE D H, KEYSER J. Wave particles[C/OL]//ACM SIGGRAPH 2007 papers. New York, NY, USA: Association for Computing Machinery, 2007: 99-es[2025-04-10]. https://dl.acm.org/doi/10.1145/1275808.1276501 . DOI: 10.1145/1275808.1276501 .\n[17] PEACHEY D R. Modeling waves and surf[C/OL]//Proceedings of the 13th annual conference on Computer graphics and interactive techniques. New York, NY, USA: Association for Computing Machinery, 1986: 65-74[2025-04-12]. https://dl.acm.org/doi/10.1145/15922.15893 . DOI: 10.1145/15922.15893 .\n[18] PIERSON JR. W J, MOSKOWITZ L. A proposed spectral form for fully developed wind seas based on the similarity theory of S. A. Kitaigorodskii[J/OL]. Journal of Geophysical Research (1896-1977), 1964, 69(24): 5181-5190. DOI: 10.1029/JZ069i024p05181 .\n[19] HASSELMANN D E, DUNCKEL M, EWING J A. Directional Wave Spectra Observed during JONSWAP 1973[J/OL]. 1980[2025-04-12]. https://journals.ametsoc.org/view/journals/phoc/10/8/1520-0485_1980_010_1264_dwsodj_2_0_co_2.xml .\n[20] PREMO\u0026quot;E S, ASHIKHMIN M. Rendering Natural Waters[C]//Proceedings of the 8th Pacific Conference on Computer Graphics and Applications. USA: IEEE Computer Society, 2000: 23.\n[21] JESCHKE S, WOJTAN C. Water wave packets[J/OL]. ACM Trans. Graph., 2017, 36(4): 103:1-103:12. DOI: 10.1145/3072959.3073678 .\n[22] JESCHKE S, SKŘIVAN T, MÜLLER-FISCHER M, 等. Water surface wavelets[J/OL]. ACM Trans. Graph., 2018, 37(4): 94:1-94:13. DOI: 10.1145/3197517.3201336 .\n[23] SHARMA P, CHUNG W T, AKOUSH B, 等. A Review of Physics-Informed Machine Learning in Fluid Mechanics[J/OL]. Energies, 2023, 16(5): 2343. DOI: 10.3390/en16052343 .\n[24] LINO M, FOTIADIS S, BHARATH A A, 等. Current and emerging deep-learning methods for the simulation of fluid dynamics[J/OL]. Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences, 2023, 479(2275): 20230058. DOI: 10.1098/rspa.2023.0058 .\n[25] LADICKÝ L, JEONG S, SOLENTHALER B, 等. Data-driven fluid simulations using regression forests[J/OL]. ACM Trans. Graph., 2015, 34(6): 199:1-199:9. DOI: 10.1145/2816795.2818129 .\n[26] TOMPSON J, SCHLACHTER K, SPRECHMANN P, 等. Accelerating eulerian fluid simulation with convolutional networks[C]//Proceedings of the 34th International Conference on Machine Learning - Volume 70. Sydney, NSW, Australia: JMLR.org, 2017: 3424-3433.\n[27] XIAO X, ZHOU Y, WANG H, 等. A Novel CNN-Based Poisson Solver for Fluid Simulation[J/OL]. IEEE Transactions on Visualization and Computer Graphics, 2020, 26(3): 1454-1465. DOI: 10.1109/TVCG.2018.2873375 .\n[28] ZHANG N, YAN S, MA Q, 等. A CNN-supported Lagrangian ISPH model for free surface flow[J/OL]. Applied Ocean Research, 2023, 136: 103587. DOI: 10.1016/j.apor.2023.103587 .\n[29] PRANTL L, BONEV B, THUEREY N. Generating Liquid Simulations with Deformation-aware Neural Networks[A/OL]. arXiv, 2019[2025-04-11]. http://arxiv.org/abs/1704.07854 . DOI: 10.48550/arXiv.1704.07854 .\n[30] WIEWEL S, BECHER M, THUEREY N. Latent-space Physics: Towards Learning the Temporal Evolution of Fluid Flow[A/OL]. arXiv, 2019[2025-04-11]. http://arxiv.org/abs/1802.10123 . DOI: 10.48550/arXiv.1802.10123 .\n[31] ZHANG Y, BAN X, DU F, 等. FluidsNet: End-to-end learning for Lagrangian fluid simulation[J/OL]. Expert Systems with Applications, 2020, 152: 113410. DOI: 10.1016/j.eswa.2020.113410 .\n[32] SANCHEZ-GONZALEZ A, GODWIN J, PFAFF T, 等. Learning to Simulate Complex Physics with Graph Networks[C/OL]//Proceedings of the 37th International Conference on Machine Learning. PMLR, 2020: 8459-8468[2025-04-13]. https://proceedings.mlr.press/v119/sanchez-gonzalez20a.html .\n[33] LI Z, FARIMANI A B. Graph neural network-accelerated Lagrangian fluid simulation[J/OL]. Computers \u0026amp; Graphics, 2022, 103: 201-211. DOI: 10.1016/j.cag.2022.02.004 .\n[34]ZHANG N, YAN S, MA Q, 等. A hybrid method combining ISPH with graph neural network for simulating free-surface flows[J/OL]. Computer Physics Communications, 2024, 301: 109220. DOI: 10.1016/j.cpc.2024.109220 .\n[35] HIGAKI T, TANABE Y, HASHIMOTO H, 等. Step-by-step enhancement of a graph neural network-based surrogate model for Lagrangian fluid simulations with flexible time step sizes[J/OL]. Applied Ocean Research, 2025, 154: 104424. DOI: 10.1016/j.apor.2025.104424 .\n[36] SHU D, LI Z, BARATI FARIMANI A. A physics-informed diffusion model for high-fidelity flow field reconstruction[J/OL]. Journal of Computational Physics, 2023, 478: 111972. DOI: 10.1016/j.jcp.2023.111972 .\n[37] TAKAHASHI T, FUJII H, KUNIMATSU A, 等. Realistic Animation of Fluid with Splash and Foam[J/OL]. [2025][2025-04-13]. https://onlinelibrary.wiley.com/doi/10.1111/1467-8659.00686 .\n[38] GREENWOOD S T, HOUSE D H. Better with bubbles: enhancing the visual realism of simulated fluid[C/OL]//Proceedings of the 2004 ACM SIGGRAPH/Eurographics symposium on Computer animation - SCA ’04. Grenoble, France: ACM Press, 2004: 287[2025-04-13]. http://portal.acm.org/citation.cfm?doid=1028523.1028562 . DOI: 10.1145/1028523.1028562 .\n[39] THÜREY N, RÜDE U, STAMMINGER M. Animation of Open Water Phenomena with coupled Shallow Water and Free Surface Simulations[J].\n[40] THÜREY N, SADLO F, SCHIRM S, 等. Real-time Simulations of Bubbles and Foam within a Shallow Water Framework[J].\n[41] LUO M, KHAYYER A, LIN P. Particle methods in ocean and coastal engineering[J/OL]. Applied Ocean Research, 2021, 114: 102734. DOI: 10.1016/j.apor.2021.102734 .\n[42] FELDMAN J, BONET J. Dynamic refinement and boundary contact forces in SPH with applications in fluid flow problems[J/OL]. International Journal for Numerical Methods in Engineering, 2007, 72(3): 295-324. DOI: 10.1002/nme.2010 .\n[43] WINCHENBACH R, KOLB A. Optimized Refinement for Spatially Adaptive SPH[J/OL]. ACM Trans. Graph., 2021, 40(1): 8:1-8:15. DOI: 10.1145/3363555 .\n","permalink":"https://congyuxiaoyoudao.github.io/posts/assignments/a-review-of-realistic-water-waveform-simulation/","summary":"\u003cblockquote\u003e\n\u003cp\u003e本着虚心交流与接受批评的态度，把这篇用来“应付”学校作业的综述写作放上来，不吝赐教！\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2 id=\"0x00-to-begin-with\"\u003e0x00 To begin with\u003c/h2\u003e\n\u003cp\u003e这篇文章将会包含以下内容：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e 近年来水体波形模拟的主要方法分类介绍\u003c/li\u003e\n\u003cli\u003e\u003cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003e 现有文献的研究趋势分析及未来方向预测\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eFor reference\u003c/strong\u003e：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e📖 \n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://zhuanlan.zhihu.com/p/95917609\"\u003e真实感水体渲染技术总结\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003e📖 \n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://zhuanlan.zhihu.com/p/672738842\"\u003e九、流体模拟简述\u003c/a\u003e\n\n\u003c/li\u003e\n\u003cli\u003e📖 \n\n\n\n\n\n\n\n  \n  \u003ca href=\"https://zhuanlan.zhihu.com/p/21573239\"\u003e游戏中的实时水体模拟技术\u003c/a\u003e\n\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"0x01-摘要\"\u003e0x01 摘要\u003c/h2\u003e\n\u003cp\u003e真实感水体模拟因其高度仿真的视觉表现与广泛的应用领域成为计算机图形学的研究热点。本文回顾了近 50 年（1978-2025）来水体模拟的方法，具体而言，包括早期基于经验与统计的方法与参数化波列合成的方法，中期基于物理的数值模拟方法和波粒子方法，以及近年转向数据驱动的深度学习方法。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e关键词\u003c/strong\u003e：流体模拟、波形模拟、深度学习、物理数值方法\u003c/p\u003e\n\u003cp\u003eRealistic water simulation has emerged as a prominent research focus in computer graphics due to its highly realistic visual effects and broad application domains. This paper reviews the methods of water simulation over the past 50 years (1978–2025), specifically including early approaches based on empirical and statistical models, parametric wave synthesis methods, mid-term physics-based numerical simulation techniques and wave particle methods, as well as the recent shift toward data-driven deep learning approaches.\u003c/p\u003e","title":"Assignment 2. A Review of Realistic Water Waveform Simulation"},{"content":" 由于嵌入式模型的不透明、高维度以及大规模现代数据集的限制，对其进行解释和使用极具挑战性。Zijie J. Wang 等开发了 WizMap，一个交互式可视化工具，允许用户轻松探索和解释嵌入式大模型\n🚩 0x00 To begin with 应可视化课程要求，本篇旨在对原论文项目进行粗浅的翻译\u0026amp;介绍\u0026amp;分析，仅作学习之用 论文名：WizMap: Scalable Interactive Visualization for Exploring Large Machine Learning Embeddings 作者：Zijie J. Wang, Fred Hohman, Duen Horng Chau\n这篇文章将会包含以下内容：\nEmbedding Model 及其局限 前人的交互可视化工具 散点图 等高线图 WizMap 的目的及意义 WizMap 的实现分析 笔者的看法 For reference👇：\n📖 原论文地址： [2306.09328] WizMap: Scalable Interactive Visualization for Exploring Large Machine Learning Embeddings 📺 原演示视频： Demo Video \u0026ldquo;WizMAP: Scalable Interactive Visualization for Exploring Large ML Embeddings\u0026rdquo; 🔧 演示地址： WizMap 📖 没有思考过 Embedding，不足以谈 AI 📺 Machine Learning Crash Course: Embeddings 📺 14 Embedding Projector 🤔 0x01 What is LLM Embedding 为了让没有接触过机器学习的读者更容易理解原论文的工作，笔者加上了此节\nConcept of Embedding 嵌入的概念 在数学上，Embedding 代表一个映射关系：$f:X\\to Y$，该关系是同构的，即在单射条件下保持数学结构（加性、乘法等）；在机器学习领域，用于将数据源映射到另外一个空间，数据源可以来自于文本、图像甚至视频，这里以文本为例\n对于人而言，语言有丰富的上下文、语法规则、多义性、文化背景等特性。而对于机器而言，语言只不过是 0 和 1 。如果想让机器能够“理解”自然语言，就需要对文本信息进行抽象编码。\nEmbedding（嵌入）就提供了对自然语言的一层抽象，将离散的文本输入转换为连续的向量表示。这种向量表示能够捕捉文本的语义（上下文）信息，使其可以被 LLM 处理、存储和计算。\nSemantic Baseed Encoding 基于词义的编码 Embedding 对自然语言到多维向量空间的映射必须是一一映射，也即每个词语映射到一个唯一向量，不同词语映射的向量不同。这种操作有效降低了因为自然语言中可能存在的“多词一义”、“一词多义”而导致的复杂性，也是编码需要遵循的条件之一。\n映射到多维向量空间主要有两个理由：\n1.可以对应单词多维度特征，也即单词不同层面的属性。相较于标量，向量能够承载更多的信息，Embedding 就像把这些属性“嵌入”到向量各维度的值的过程。比如说 apple 可以表示为这样：\nWord Animal Big Red Expensive \u0026hellip; apple -0.5 0.1 0.7 0.3 \u0026hellip; 属性只是举个例子，不太恰当敬请谅解\n然而如何确定能描述全部自然语言词语的所有维度是困难的。即使是同一词语，在不同上下文的意义也可能不同，与其大费周章找到一套固定的维度，不如将词语定义在其处于的上下文中，用词与词之间的关系定义词。\nApple pie is my favorite dessert during the holidays. Discover the innovative world of Apple and shop everything iPhone\u0026hellip; 在第一句中，Apple 的含义与 Pear 接近，但在第二句中却与 Huawei 接近。\n2.可以对向量（准确而言是向量之间的关系）进行度量。这里就用到一些基本的线性代数性质：在定义了度量函数的向量空间中，可以用距离代表两个向量间的相似度。类似的，我们也可以用两个 Embedding Vector 间的距离代表其映射的词语的相似度。\n$$ Similarity(A,B)=D_{Euclidean}(A,B)=\\sqrt{ \\Sigma_{i=1}^n{(a_{i}-b_{i})^2} } \\\\ $$ 仅遵循单射条件只是完成了词语层面的抽象，机器仍然无法理解其背后的语义。为了能够用内积描述自然语言的相似度，Embedding必须让语义相似的单词在向量空间中接近（相对于语义差距大的）。比如在下面的例子中，“Sail”和“Ship”在向量空间中是接近的，但与“How”距离较远。\nEmbedding in Neural Network 神经网络中的嵌入层 许多神经网络处理的任务中，输入层往往是 One hot 编码的离散数据。在其组成的矩阵过于稀疏时，信息量低，计算成本高。嵌入层通过将这一输入映射至维数较低的向量，优化了计算过程，提高了计算效率。\n嵌入层本质上是一个可学习的权重矩阵，行数等于词汇表长度，列数等于预设的嵌入维度。通过损失函数和反向传播机制，不断调整嵌入矩阵中的数值，使得语义相近的单词在向量空间中更接近。\n嵌入的维度可以调整，具体取决于要升维还是降维。维数不够就加维度！\n在最后输出之前，产生的向量通常不会等于任何一个已知对应单词的嵌入向量，这个时候对其做一次模糊匹配，转换为各类别的概率分布，即每个单词匹配该向量的概率。最后输出概率最高的单词。\nInterpret and Use 解释与使用 神经网络可以类比为黑箱，可见的只有输入输出，而其学习、推理的过程是不透明的。就嵌入向量而言，一个单词的嵌入往往是几百维的浮点值，我们难以解释它的具体意义；另一方面，嵌入向量之间的距离也是通过不透明的学习过程决定的，我们只能猜测靠的近的两个向量具有语义上的相似性，而无法说明为什么某一对向量的距离比另一对近。这带来了解释上的困难。\n现代 LLM 通常在 TB 级别的数据上进行训练，数据集规模之庞大，导致嵌入词的规模和嵌入向量的维数巨大，带来了更为昂贵的存储、检索和计算开销。数千维的空间下，数据可视化极为困难，无法通过常规绘图手段（二维/三维坐标系）直观地展示数据。这带来了可视化的困难。\n如果为了优化模型或提升嵌入质量，需要研究人员对嵌入向量进行人为干预、调整，这个过程无疑是极为灾难的。为了应对这些困难，许多学者提出了各式各样的交互式可视化工具用来帮助用户探索嵌入空间，比如本篇介绍的 WizMap。\n📃 0x02 Previous Work 前人的工作 Scatter Plot 散点图 一个探索嵌入空间的方法是将嵌入降维后可视化在低维散点图中。Smilkov 等人在2016年提出了 Embedding Projector，允许用户使用 PCA（主成分分析）和 t-SNE（t-分布随机邻域嵌入）方法将高维嵌入投影到 2D 或 3D 空间中，从而直观地观察数据分布。\n这种基于散点图的方法可以较好地理解嵌入的局部结构，但面对大型数据集时，逐个检查嵌入数据点以理解嵌入空间的全局结构既费时又难以实现。\nContour Plot 等高线图 近年来也有学者提出基于等高线的可视化交互方法，Robertson 等人在2023年提出的 Angler 系统中将高维数据投影到二维平面，并以等高线的形式表示数据密度或相似度，使用户能够获得嵌入空间的整体概览，并通过叠加比较多个嵌入结果。\n这种基于等高线的方法可以快速获得对嵌入空间的全局概览，但限制了用户对嵌入局部结构的探索，且缺乏足够的视觉环境（Visual Context）。\nConclusion 结论 基于散点图的方法难以获取嵌入的全局概览，而基于等高线图的方法虽能展现数据密度，但缺乏对局部细节的刻画。两种方法各有局限。\nWizMap 旨在整合散点图与等高线图各自的优势，使用地图式交互设计为用户提供全面的视角，允许用户以不同粒度探索嵌入空间，“降低了解释和使用嵌入的门槛”（lowers the barrier to interpreting and using embeddings）。\n🔥0x03 Related Work 相关工作 Dimensionality Reduction 降维 如前文所述，嵌入向量的高维性为可视化带来了困难，而高维数据的可视化通常是应用降维技术将其投影至二维或三维空间，再使用常规的可视化方式进行处理。\n一些流行的降维技术包括 UMAP（均匀流形近似与投影）、t-SNE（t-分布随机邻域嵌入）和 PCA（主成分分析）。这些技术在维护嵌入的结构、随机性、参数敏感性、计算效率与复杂度方面各有利弊。针对不同结构、属性的数据权衡不同的降维方法，能够得到更优的降维效果。\n尽管各自降维技术存在诸多不同，但其输出均为低维嵌入表示，是形如(n_samples, n_components)的矩阵。在 WizMap 中，用户可以自由选择降维方式，以可视化投影后的嵌入。\nInteractive Embedding Visualization 交互式嵌入可视化 可视化工具的一些常见交互工具\u0026amp;方式包括：\n缩放、旋转和平移 2D 或 3D 投影嵌入以探索和检查数据点特征，如 Embedding Projector 专门用于大规模（数百万级）散点图的绘制，如 regl-scatterplot 潜在空间制图，帮助用户理解不同区域的数据分布及其语义特征，如 Latent Space Cartography 此外，研究人员还设计了一些用于比较不同降维方法产生的嵌入空间的可视化工具：\n未给出链接的工具截至目前（2025/3/30）没有开源实现\n可视化两个嵌入之间的局部和全局相似性，如 embComp（Heimerl 等，2022） 追踪数据点在两个嵌入中的位置变化（使用星轨 Star Rail 可视化），如 Emblaze（Sivaraman 等，2022） 突出显示在嵌入中变化最大的点周围的邻域，如 embedding-comparator （Boggust 等，2022） 这些工具可以通过比较不同模型、不同算法生成的嵌入，比较嵌入表示之间的差异，并​分析嵌入的全局和局部结构，以评估模型的表示学习能力。\n与此相反，WizMap 通过提供不同粒度（全局-局部）的视觉上下文，帮助用户导航和解释大型嵌入空间的全局和局部结构。\n📄0x04 Multi-scale Embedding Summarization 多尺度嵌入摘要 Embedding Summarization（嵌入摘要）旨在从大型嵌入空间中提取核心信息，以帮助用户理解和探索数据的结构、分布及其重要特征\n生成嵌入摘要主要具有两个挑战：\n如何在大型数据集中有效地总结数百万级的数据点 如何选择要总结的嵌入区域（用户对不同大小和粒度的区域有不同的兴趣） WizMap 的开发者提出了一种新颖的方法，以自动生成大规模数据的多尺度嵌入摘要。\nMulti-resolution Quadtree Aggregation 多分辨率四叉树聚合 首先应用降维技术，将高维嵌入向量投影到二维平面上的点。从这些点出发，构建一颗四叉树。\n这颗四叉树的每一次划分将二维空间分为四个相等的正方形区域（叶节点），每个区域仅存在一个数据点。为了得到不同粒度级别的嵌入汇总，自底向上遍历树。在每次迭代中提取每个叶节点中嵌入的摘要，然后将最低级别的叶节点与其父节点合并。这个过程递归地进行，形成级别越来越高（图中自下而上）的叶节点，直到整个树最终合并为一个根节点。\n有点 2048 的思想在，了解图形学八叉树的同学应该理解起来没压力\n整个过程是预计算的，当用户在 WIZMAP 中缩放时，系统会自动将缩放映射到合适的嵌入摘要级别，实现多粒度摘要的动态切换。\n可以联想谷歌地图自适应缩放的做法\nScalable Leaf-level Summarization 可扩展叶级别摘要 形成四叉树聚合时，研究人员可以选择任何合适的方法来从叶节点总结嵌入。对于文本嵌入，开发者提出了基于块的 TF-IDF（t-TF-IDF），它将 TF-IDF（Term Frequency-Inverse Document Frequency）应用于从叶节点提取关键词（Sparck Jones，1972）。\nt-TF-IDF 通过将文档划分为多个“块”来计算词频（TF）将长文档 $d$ 划分为多个较小的块 $B_{i}$，对每个块计算块级 TF ： $t\\text{-} TF(t,B)=\\frac{词 t 在块 B 中的出现次数}{块 B 的总词数}$\n类似于基于类的 TF-IDF（c-TF-IDF），在计算 TF-IDF 分数之前将聚类中的文档合并为一个元文档（Grootendorst，2022）。将每个叶节点中的所有文档（即四叉树分区中的一个块）合并为一个元文档，并在所有叶节点上计算 TF-IDF 分数。最后，提取具有最高 t-TF-IDF 分数的关键词来总结叶节点中的嵌入。\n$t\\text{-}TF\\text{-}IDF(t,d)=\\max\\limits_{B\\in d}(t\\text{-}TF(t,B)\\times IDF(t))$，选取该词在所有块中权重最高的值，保留局部特征\n这种方法是可扩展的，并且与四叉树聚合相辅相成。由于文档合并是分层的，只需构建一次 n-gram 计数矩阵，并在每次聚合迭代中仅通过一次矩阵乘法进行更新。\n在 MacBook Pro 上，总结跨越三个粒度级别的 180 万个文本嵌入，只需大约 55 秒。 处理非文本数据的嵌入时，可以通过找到叶节点中与嵌入中心点最近的点来总结嵌入。\n🖥️User Interface 用户界面 结合 livedemo 和演示视频进行解释\nWizMap 的 UI 大致可以分为如下 3 个部分：\nMap View 地图视图 地图视图是 WIZMAP 的主要视图。它提供了一个熟悉的地图界面，允许用户平移和缩放以探索不同大小的嵌入区域。为了帮助用户轻松地调查嵌入的全局和局部结构，地图视图集成了三层可视化：\nContour：等高线轮廓展示嵌入分布，可视化嵌入全局结构 Label：标签展示嵌入摘要，可视化嵌入摘要 Scatter：散点展示嵌入点信息，可视化嵌入局部结构 分布轮廓（Distribution Contour）。使用核密度估计（KDE）（Rosenblatt，1956）来估计二维嵌入点的分布。以标准的多变量高斯核和 Silverman 带宽作为 KDE 模型（Silverman，2018）。\n核密度估计是一种非参数方法，通过对每个数据点施加核函数（$K$，带宽 $h$ 决定其平滑程度），并汇总所有核函数的贡献，估计总体的概率密度函数。​其数学表达式为：$\\hat{f}(x)=\\frac{1}{nh}\\Sigma_{i=1}^nK\\left( \\frac{x-x_{i}}{h} \\right)$\n在一个 200×200 的二维网格上计算分布似然，该网格的大小由所有嵌入点的范围决定。最后，将网格上的似然性可视化为一个等高线图，突出显示嵌入的密度分布。研究人员可以调整网格密度，通过平衡计算时间和等高线分辨率来调整它。\n多分辨率标签（Muti-resolution Labels），用户可以通过这些预计算的上下文标签，在各个粒度级别上动态地解释嵌入。当用户悬停在某个网格上时，将这部分通过四叉树聚合生成的摘要标签叠加到等高线图和散点图上。并能根据用户的当前缩放级别调整标签的瓦片（Tile）大小。\n此外，此视图还能够自动标记高密度嵌入点区域，通过显示靠近高概率轮廓多边形（high-probability contour polygons）几何中心四叉树瓦片的摘要实现。\n散点图（Scatter Plot），\n用二维散点图可视化所有嵌入点及其位置。用户可以指定每个嵌入点的颜色来编码额外的特征，例如嵌入类的颜色。此外，用户可以将鼠标悬停在散点上以显示其原始数据。\nControl Panel 控制面板 地图视图默认显示所有三个可视化层，用户可以通过控制面板中的按钮自定义视图显示。此外，WizMap 允许用户通过在地图视图中叠加它们来比较同一嵌入空间中的多个嵌入组（Gleicher，2018）。对于包含时间的嵌入，用户可以使用控制面板右侧的滑块来观察嵌入随时间的变化。\nSearch Panel 搜索面板 搜索和筛选可以帮助用户发现有趣的嵌入模式并测试他们对嵌入结构的假设（Carter 等人，2019 年）。在 WizMap 中，用户可以使用搜索面板搜索包含指定单词的文本嵌入。面板显示搜索结果列表，地图视图高亮显示相应的嵌入点。\nScalable \u0026amp; Open-source Implementation 可扩展且开源的实现 WizMap 可扩展至数百万个嵌入点，无需后端服务器。利用现代网络技术，特别是 WebGL 通过 regl API（Lysenko，2016 年）渲染嵌入点。还使用 Web Workers 和 Streams API 来实现大嵌入点的流式传输。将嵌入与渲染并行处理。\n为了实现快速全文搜索，应用了 FlexSearch（Wilkerling，2019）的上下文索引评分算法。使用 D3（Bostock 等，2011）进行其他可视化，并使用 scikit-learn（Pedregosa 等，2011）进行核密度估计（KDE）。为了 WizMap 可以轻松集成到用户当前的流程中（Wang 等，2023），应用 NOVA（Wang 等，2022b）使 WIZMAP 在笔记本中可用。用户还可以通过唯一的 URL 与协作者共享他们的嵌入图。\nWizMap 的开发者提供详细的教程，帮助用户处理嵌入，并且将 WizMap 开源，以支持嵌入探索工具的未来研究和开发。\n🔧Usage Scenarios 使用场景 Exploring ACL Research Topic Trends 探索 ACL 研究趋势 海伦（Helen）是一位科学历史学家，她利用 ACL Anthology 数据集研究 NLP 领域的演变。她提取了 63k 篇论文的标题和摘要，并使用 MPNet 生成 768 维嵌入向量。然后，她通过 UMAP 降维，并调整参数以优化投影分布。她利用 WizMap 生成嵌入摘要、KDE 分布和流式数据的 JSON 文件，并基于年份特征分析 NLP 研究主题的时间演变。\n在可视化分析中，海伦通过缩放和平移探索嵌入结构，并使用搜索功能查找特定关键词的论文。她发现不同的研究方向形成了独立簇，例如翻译、摘要和医疗 NLP。在播放嵌入演变动画时，她观察到 NLP 研究主题的变化，如语法研究热度下降，而问答、讽刺、幽默和仇恨言论等新主题逐渐兴起。最终，她决定撰写一篇论文，探讨 NLP 研究趋势的演变。\nInvestigating Text-to-Image Model Usage 探究文生图模型的使用 Bob 是一名机器学习研究员，致力于改进文生图的模型。他使用 DiffusionDB 数据集，分析用户的文本提示（prompt）与生成图像的关系。为此，他采用 CLIP 将文本和图像编码为 768 维嵌入，并利用 UMAP 降维到 2D 空间。随后，他使用 WizMap 进行可视化，探索 360 万个嵌入的结构。\n在嵌入探索过程中，Bob 发现提示主要分为艺术和摄影两个类别，并进一步识别出摄影类别中的两个小簇：非人类物体和名人。随后，他通过比较文本嵌入与图像嵌入的分布，发现“电影”相关的文本嵌入密度较低，而“艺术肖像”在图像嵌入中密度较高，这可能表明 Stable Diffusion 在生成逼真的人脸图像方面存在一定的局限性。Bob 对这个发现感到满意，并将其用于改进训练数据。\n🛤️ Future Work and Conclusion 未来工作与结论 WizMap 集成基于四叉树的嵌入摘要技术，方便用户解释多种粒度级别的嵌入，展现出为机器学习领域提供可视化嵌入的潜力。开发者同时也反思开发过程中的不足，并提炼出了未来的研究方向：\n用户研究，探究用户眼中自适应的视图粒度变换的有效性 自动洞察，基于四叉树的方法对瓦片大小敏感，需要更稳健的嵌入摘要方法 增强比较，叠加等高线的方法在局部比较上劣于其它技术，如并列（Juxtaposition）和显式编码（Explicit Encoding） 📉 Broader Impact 更广泛的影响 不良分子可能会恶意利用从 WizMap 中获得的见解。例如，研究表明机器学习嵌入包含社会偏见（Bolukbasi 等人，2016 年）。因此，不良分子可以通过注入已知与性别和种族偏见相关的嵌入来操纵和破坏机器学习预测。\n📝 After words 个人拙见，主要描述除投影算法和开发者已反思的不足之外的个人看法。可能是一些细枝末节的角度，如有不当，还望海涵\n搜索功能允许搜索关键词并高亮相关嵌入，但没有提供更高级的查询功能，如按类别筛选、模糊匹配或复杂逻辑查询，并根据结果相关度分不同级别高亮嵌入。\n观察嵌入在的时间上的演变时，无法选取播放区域和控制动画播放速度，需要在时间上细致分析时可能显得不够灵活。\n原文中提到用户可以指定每个嵌入点的颜色来编码额外的特征，比如嵌入类（Users can specify the color of each embedding point to encode additional features, such as the class of embeddings.）。但在 live demo 中并没有为嵌入提供手动标记和分类的操作，这一步骤是否发生在可视化之前？\n总体上仍然是极为优秀的可视化工具，感谢开发者们的工作。\n","permalink":"https://congyuxiaoyoudao.github.io/posts/assignments/analysis-of-wizmap-scalable-interactive-visualization/","summary":"本文就原论文分析了交互式可视化工具 WizMap，探讨其如何通过创新的多尺度摘要技术解决大规模机器学习嵌入的可视化和解释难题，并介绍了其用户界面、应用场景及未来发展。","title":"Assignment 1. Analysis of WizMap Scalable Interactive Visualization"},{"content":"\n我喜欢仰望月亮。\n每每沐浴那宛若来自神明的清辉，流动的静谧，澄澈的涤荡，便能够宽赦种种浮躁、不安与愤懑。\n——隐忍之心。含蓄典雅。闲寂幽静。\n平日的生活倒也算称意，辰时而作，子时而息，忙碌于课业的闲暇也有时间钻研自己的兴趣。这般日子确乎不惊波澜，我也默许。\n然而心底总潜藏着对近月之仪的向往，渴望捧起其矜持之下为人所漠视的——无声的冷焰。\n","permalink":"https://congyuxiaoyoudao.github.io/about/","summary":"\u003cp\u003e\u003cimg alt=\"Sakurakouji Luna\" loading=\"lazy\" src=\"https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Wives/202505260010872.jpg\"\u003e\u003c/p\u003e\n\u003cbr\u003e\n\u003cp\u003e我喜欢仰望月亮。\u003c/p\u003e\n\u003cbr\u003e\n\u003cp\u003e每每沐浴那宛若来自神明的清辉，流动的静谧，澄澈的涤荡，便能够宽赦种种浮躁、不安与愤懑。\u003c/p\u003e\n\u003cbr\u003e\n\u003cp\u003e——隐忍之心。含蓄典雅。闲寂幽静。\u003c/p\u003e\n\u003cbr\u003e\n\u003cp\u003e平日的生活倒也算称意，辰时而作，子时而息，忙碌于课业的闲暇也有时间钻研自己的兴趣。这般日子确乎不惊波澜，我也默许。\u003c/p\u003e\n\u003cbr\u003e\n\u003cp\u003e然而心底总潜藏着对近月之仪的向往，渴望捧起其矜持之下为人所漠视的——无声的冷焰。\u003c/p\u003e","title":"About"},{"content":"","permalink":"https://congyuxiaoyoudao.github.io/nebula/","summary":"","title":"Nebula"}]