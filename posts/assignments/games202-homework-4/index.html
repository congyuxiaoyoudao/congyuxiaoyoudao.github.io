<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Assignment 7. GAMES202 Homework 4 | The Only Problem's Blog</title><meta name=keywords content="GAMES202,BRDF"><meta name=description content="
å¥½ä¹…ä¸è§ï¼æœ€è¿‘åœ¨å¿™åˆ«çš„å·¥ä½œï¼Œè¿™å‡ å¤©éš¾å¾—æœ‰æ—¶é—´ï¼Œèµ¶ç´§æŠŠ 202 ç³»åˆ—ä½œä¸šåšä¸ªæ”¶å°¾ÎµÙ©(à¹‘> â‚ƒ <)Û¶Ğ·ï¼

0x00 To begin with
è¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š

 éƒ¨åˆ†è¯¾ç¨‹å†…å®¹å›é¡¾
 GAMES202 ä½œä¸š 4

For referenceğŸ‘‡ï¼š

ğŸ“ºB ç«™è§†é¢‘ï¼š







  
  GAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“


ğŸ“¦ä»£ç ä»“åº“ï¼š







  
  congyuxiaoyoudao/GAMES202_Homework at working


ğŸ“ƒ 







  
  Revisiting Physically Based Shading at Imageworks




master åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…

0x01 è¯¾ç¨‹å›é¡¾ Recap
èƒ½é‡å®ˆæ’çš„ BSDF Energy-Preserving BSDFs
Cook-Torrance æå‡ºçš„å¾®è¡¨é¢ BRDF åªè€ƒè™‘å…‰çº¿åœ¨è¡¨é¢ç»è¿‡ä¸€æ¬¡å¼¹å°„åå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡ï¼Œç„¶è€Œå¿½ç•¥äº†å¤šæ¬¡å¼¹å°„æœ€ç»ˆå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡ï¼Œè¿™å°±é€ æˆäº†èƒ½é‡æŸå¤±ã€‚å°¤å…¶æ˜¯å½“æè´¨çš„ roughness è¾ƒé«˜æ—¶ï¼ŒG é¡¹å‡å°ï¼Œå¤šæ¬¡å¼¹å°„çš„æ¯”ä¾‹å¢åŠ ï¼Œèƒ½é‡æŸå¤±è¶Šä¸¥é‡ã€‚

2017 å¹´ Kulla å’Œ Conty å—åˆ° Disney Principle BRDF çš„å¯å‘ï¼Œæå‡ºäº†ä¸€ç§æ”¹è¿›çš„æ–¹æ³•ï¼Œå³é€šè¿‡å¼•å…¥ä¸€ä¸ªèƒ½é‡è¡¥å¿é¡¹ï¼Œå°†å¤šæ¬¡å¼¹å°„å‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡è¡¥å……å›æ¥ï¼Œå°±èƒ½è¿‘ä¼¼åœ°ä¿æŒèƒ½é‡å®ˆæ’ã€‚"><meta name=author content="The Only Problem"><link rel=canonical href=https://congyuxiaoyoudao.github.io/posts/assignments/games202-homework-4/><link crossorigin=anonymous href=/assets/css/stylesheet.452758010f0b7fc9ad7fa528ffdfdd8eb9e830816fb8c8119f16f39583297db8.css integrity="sha256-RSdYAQ8Lf8mtf6Uo/9/djrnoMIFvuMgRnxbzlYMpfbg=" rel="preload stylesheet" as=style><link rel=icon href=https://congyuxiaoyoudao.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://congyuxiaoyoudao.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://congyuxiaoyoudao.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://congyuxiaoyoudao.github.io/apple-touch-icon.png><link rel=mask-icon href=https://congyuxiaoyoudao.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://congyuxiaoyoudao.github.io/posts/assignments/games202-homework-4/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css integrity=sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js integrity=sha384-hIoBPJpTUs74ddyc4bFZSM1TVlQDA60VBbJS0oA934VSz82sBx1X7kSx2ATBDIyd crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js integrity=sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk crossorigin=anonymous onload='window.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\$$",right:"\\\\$$",display:!1},{left:"\\$$",right:"\\\\$$",display:!0}]})})'></script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdn.bootcdn.net/ajax/libs/lxgw-wenkai-screen-webfont/1.7.0/style.min.css><meta property="og:url" content="https://congyuxiaoyoudao.github.io/posts/assignments/games202-homework-4/"><meta property="og:site_name" content="The Only Problem's Blog"><meta property="og:title" content="Assignment 7. GAMES202 Homework 4"><meta property="og:description" content=" å¥½ä¹…ä¸è§ï¼æœ€è¿‘åœ¨å¿™åˆ«çš„å·¥ä½œï¼Œè¿™å‡ å¤©éš¾å¾—æœ‰æ—¶é—´ï¼Œèµ¶ç´§æŠŠ 202 ç³»åˆ—ä½œä¸šåšä¸ªæ”¶å°¾ÎµÙ©(à¹‘> â‚ƒ <)Û¶Ğ·ï¼
0x00 To begin with è¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š
éƒ¨åˆ†è¯¾ç¨‹å†…å®¹å›é¡¾ GAMES202 ä½œä¸š 4 For referenceğŸ‘‡ï¼š
ğŸ“ºB ç«™è§†é¢‘ï¼š GAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“ ğŸ“¦ä»£ç ä»“åº“ï¼š congyuxiaoyoudao/GAMES202_Homework at working ğŸ“ƒ Revisiting Physically Based Shading at Imageworks master åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…
0x01 è¯¾ç¨‹å›é¡¾ Recap èƒ½é‡å®ˆæ’çš„ BSDF Energy-Preserving BSDFs Cook-Torrance æå‡ºçš„å¾®è¡¨é¢ BRDF åªè€ƒè™‘å…‰çº¿åœ¨è¡¨é¢ç»è¿‡ä¸€æ¬¡å¼¹å°„åå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡ï¼Œç„¶è€Œå¿½ç•¥äº†å¤šæ¬¡å¼¹å°„æœ€ç»ˆå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡ï¼Œè¿™å°±é€ æˆäº†èƒ½é‡æŸå¤±ã€‚å°¤å…¶æ˜¯å½“æè´¨çš„ roughness è¾ƒé«˜æ—¶ï¼ŒG é¡¹å‡å°ï¼Œå¤šæ¬¡å¼¹å°„çš„æ¯”ä¾‹å¢åŠ ï¼Œèƒ½é‡æŸå¤±è¶Šä¸¥é‡ã€‚
2017 å¹´ Kulla å’Œ Conty å—åˆ° Disney Principle BRDF çš„å¯å‘ï¼Œæå‡ºäº†ä¸€ç§æ”¹è¿›çš„æ–¹æ³•ï¼Œå³é€šè¿‡å¼•å…¥ä¸€ä¸ªèƒ½é‡è¡¥å¿é¡¹ï¼Œå°†å¤šæ¬¡å¼¹å°„å‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡è¡¥å……å›æ¥ï¼Œå°±èƒ½è¿‘ä¼¼åœ°ä¿æŒèƒ½é‡å®ˆæ’ã€‚"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-14T00:00:00+00:00"><meta property="article:modified_time" content="2025-06-14T00:00:00+00:00"><meta property="article:tag" content="GAMES202"><meta property="article:tag" content="BRDF"><meta name=twitter:card content="summary"><meta name=twitter:title content="Assignment 7. GAMES202 Homework 4"><meta name=twitter:description content="
å¥½ä¹…ä¸è§ï¼æœ€è¿‘åœ¨å¿™åˆ«çš„å·¥ä½œï¼Œè¿™å‡ å¤©éš¾å¾—æœ‰æ—¶é—´ï¼Œèµ¶ç´§æŠŠ 202 ç³»åˆ—ä½œä¸šåšä¸ªæ”¶å°¾ÎµÙ©(à¹‘> â‚ƒ <)Û¶Ğ·ï¼

0x00 To begin with
è¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š

 éƒ¨åˆ†è¯¾ç¨‹å†…å®¹å›é¡¾
 GAMES202 ä½œä¸š 4

For referenceğŸ‘‡ï¼š

ğŸ“ºB ç«™è§†é¢‘ï¼š







  
  GAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“


ğŸ“¦ä»£ç ä»“åº“ï¼š







  
  congyuxiaoyoudao/GAMES202_Homework at working


ğŸ“ƒ 







  
  Revisiting Physically Based Shading at Imageworks




master åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…

0x01 è¯¾ç¨‹å›é¡¾ Recap
èƒ½é‡å®ˆæ’çš„ BSDF Energy-Preserving BSDFs
Cook-Torrance æå‡ºçš„å¾®è¡¨é¢ BRDF åªè€ƒè™‘å…‰çº¿åœ¨è¡¨é¢ç»è¿‡ä¸€æ¬¡å¼¹å°„åå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡ï¼Œç„¶è€Œå¿½ç•¥äº†å¤šæ¬¡å¼¹å°„æœ€ç»ˆå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡ï¼Œè¿™å°±é€ æˆäº†èƒ½é‡æŸå¤±ã€‚å°¤å…¶æ˜¯å½“æè´¨çš„ roughness è¾ƒé«˜æ—¶ï¼ŒG é¡¹å‡å°ï¼Œå¤šæ¬¡å¼¹å°„çš„æ¯”ä¾‹å¢åŠ ï¼Œèƒ½é‡æŸå¤±è¶Šä¸¥é‡ã€‚

2017 å¹´ Kulla å’Œ Conty å—åˆ° Disney Principle BRDF çš„å¯å‘ï¼Œæå‡ºäº†ä¸€ç§æ”¹è¿›çš„æ–¹æ³•ï¼Œå³é€šè¿‡å¼•å…¥ä¸€ä¸ªèƒ½é‡è¡¥å¿é¡¹ï¼Œå°†å¤šæ¬¡å¼¹å°„å‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡è¡¥å……å›æ¥ï¼Œå°±èƒ½è¿‘ä¼¼åœ°ä¿æŒèƒ½é‡å®ˆæ’ã€‚"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://congyuxiaoyoudao.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Assignments","item":"https://congyuxiaoyoudao.github.io/posts/assignments/"},{"@type":"ListItem","position":3,"name":"Assignment 7. GAMES202 Homework 4","item":"https://congyuxiaoyoudao.github.io/posts/assignments/games202-homework-4/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Assignment 7. GAMES202 Homework 4","name":"Assignment 7. GAMES202 Homework 4","description":" å¥½ä¹…ä¸è§ï¼æœ€è¿‘åœ¨å¿™åˆ«çš„å·¥ä½œï¼Œè¿™å‡ å¤©éš¾å¾—æœ‰æ—¶é—´ï¼Œèµ¶ç´§æŠŠ 202 ç³»åˆ—ä½œä¸šåšä¸ªæ”¶å°¾ÎµÙ©(à¹‘\u0026gt; â‚ƒ \u0026lt;)Û¶Ğ·ï¼\n0x00 To begin with è¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\néƒ¨åˆ†è¯¾ç¨‹å†…å®¹å›é¡¾ GAMES202 ä½œä¸š 4 For referenceğŸ‘‡ï¼š\nğŸ“ºB ç«™è§†é¢‘ï¼š GAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“ ğŸ“¦ä»£ç ä»“åº“ï¼š congyuxiaoyoudao/GAMES202_Homework at working ğŸ“ƒ Revisiting Physically Based Shading at Imageworks master åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…\n0x01 è¯¾ç¨‹å›é¡¾ Recap èƒ½é‡å®ˆæ’çš„ BSDF Energy-Preserving BSDFs Cook-Torrance æå‡ºçš„å¾®è¡¨é¢ BRDF åªè€ƒè™‘å…‰çº¿åœ¨è¡¨é¢ç»è¿‡ä¸€æ¬¡å¼¹å°„åå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡ï¼Œç„¶è€Œå¿½ç•¥äº†å¤šæ¬¡å¼¹å°„æœ€ç»ˆå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡ï¼Œè¿™å°±é€ æˆäº†èƒ½é‡æŸå¤±ã€‚å°¤å…¶æ˜¯å½“æè´¨çš„ roughness è¾ƒé«˜æ—¶ï¼ŒG é¡¹å‡å°ï¼Œå¤šæ¬¡å¼¹å°„çš„æ¯”ä¾‹å¢åŠ ï¼Œèƒ½é‡æŸå¤±è¶Šä¸¥é‡ã€‚\n2017 å¹´ Kulla å’Œ Conty å—åˆ° Disney Principle BRDF çš„å¯å‘ï¼Œæå‡ºäº†ä¸€ç§æ”¹è¿›çš„æ–¹æ³•ï¼Œå³é€šè¿‡å¼•å…¥ä¸€ä¸ªèƒ½é‡è¡¥å¿é¡¹ï¼Œå°†å¤šæ¬¡å¼¹å°„å‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡è¡¥å……å›æ¥ï¼Œå°±èƒ½è¿‘ä¼¼åœ°ä¿æŒèƒ½é‡å®ˆæ’ã€‚\n","keywords":["GAMES202","BRDF"],"articleBody":" å¥½ä¹…ä¸è§ï¼æœ€è¿‘åœ¨å¿™åˆ«çš„å·¥ä½œï¼Œè¿™å‡ å¤©éš¾å¾—æœ‰æ—¶é—´ï¼Œèµ¶ç´§æŠŠ 202 ç³»åˆ—ä½œä¸šåšä¸ªæ”¶å°¾ÎµÙ©(à¹‘\u003e â‚ƒ \u003c)Û¶Ğ·ï¼\n0x00 To begin with è¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\néƒ¨åˆ†è¯¾ç¨‹å†…å®¹å›é¡¾ GAMES202 ä½œä¸š 4 For referenceğŸ‘‡ï¼š\nğŸ“ºB ç«™è§†é¢‘ï¼š GAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“ ğŸ“¦ä»£ç ä»“åº“ï¼š congyuxiaoyoudao/GAMES202_Homework at working ğŸ“ƒ Revisiting Physically Based Shading at Imageworks master åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…\n0x01 è¯¾ç¨‹å›é¡¾ Recap èƒ½é‡å®ˆæ’çš„ BSDF Energy-Preserving BSDFs Cook-Torrance æå‡ºçš„å¾®è¡¨é¢ BRDF åªè€ƒè™‘å…‰çº¿åœ¨è¡¨é¢ç»è¿‡ä¸€æ¬¡å¼¹å°„åå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡ï¼Œç„¶è€Œå¿½ç•¥äº†å¤šæ¬¡å¼¹å°„æœ€ç»ˆå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡ï¼Œè¿™å°±é€ æˆäº†èƒ½é‡æŸå¤±ã€‚å°¤å…¶æ˜¯å½“æè´¨çš„ roughness è¾ƒé«˜æ—¶ï¼ŒG é¡¹å‡å°ï¼Œå¤šæ¬¡å¼¹å°„çš„æ¯”ä¾‹å¢åŠ ï¼Œèƒ½é‡æŸå¤±è¶Šä¸¥é‡ã€‚\n2017 å¹´ Kulla å’Œ Conty å—åˆ° Disney Principle BRDF çš„å¯å‘ï¼Œæå‡ºäº†ä¸€ç§æ”¹è¿›çš„æ–¹æ³•ï¼Œå³é€šè¿‡å¼•å…¥ä¸€ä¸ªèƒ½é‡è¡¥å¿é¡¹ï¼Œå°†å¤šæ¬¡å¼¹å°„å‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡è¡¥å……å›æ¥ï¼Œå°±èƒ½è¿‘ä¼¼åœ°ä¿æŒèƒ½é‡å®ˆæ’ã€‚\næœ‰äº†æ¸²æŸ“æ–¹ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°æ±‚å¾—å¾®è¡¨é¢ BRDF åœ¨è§‚å¯Ÿæ–¹å‘ $\\mu_{o}$ ä¸Šå‡ºå°„çš„æ€»èƒ½é‡ï¼š\n$$ E(\\mu_{o})=\\int_{0}^{2\\pi}\\int_{0}^{1}f(\\mu_{o},\\mu_{i},\\phi)\\mu_{i}d\\mu_{i}d\\phi $$ è¿™é‡Œè®° $\\mu_{i}=\\sin \\theta,\\theta=n\\cdot \\mu_{i}$ï¼Œä¹‹åå°±å¯ä»¥å°† $f_{r}\\cos \\theta \\sin \\theta d\\theta d\\phi$ å†™ä¸º $f_{r}\\mu_{i} d\\mu_{i}d\\phi$ã€‚ç„¶è€ŒåŸ PPT é‡Œæåˆ°çš„æ˜¯è®°ä¸º $\\cos \\theta$ï¼Œä¸è¿‡å°±ç§¯åˆ†ç»“æœæ¥è¯´éƒ½ä¸€æ ·\n$E(\\mu_{o})$ çš„èŒƒå›´ä¸º 0-1ï¼Œå¯¹äºä¸åŒçš„ $\\mu_{o}$ï¼Œ$E(\\mu_{o})$ çš„å€¼ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚å¾®è¡¨é¢ BRDF çš„ $E(\\mu_{o})$ ä¼šéšç€ roughness çš„å¢åŠ è€Œè¡°å‡ã€‚ä¸ºäº†å¼¥è¡¥è¿™éƒ¨åˆ†èƒ½é‡ï¼ŒKulla å’Œ Conty è®¾è®¡äº†ä¸€ä¸ªæ–°çš„ BRDF lobeï¼š\n$$ f_{ms}=\\frac{(1-E(\\mu_{o}))(1-E(\\mu_{i}))}{\\pi(1-E_{avg})},E_{avg}=2\\int_{0}^1E(\\mu)\\mu d\\mu $$ å…¶ä¸­ $f_{ms}$ ä¸ºå¼¥è¡¥æŸå¤±çš„ BRDFï¼Œ$E_{avg}$ ä¸ºåœ¨æ‰€æœ‰è§‚å¯Ÿæ–¹å‘ä¸‹å‡ºå°„èƒ½é‡çš„å¹³å‡å€¼ã€‚åŒæ ·è®¡ç®—è¿™ä¸ª BRDF åœ¨è§‚å¯Ÿæ–¹å‘ $\\mu_{o}$ ä¸Šçš„ç§¯åˆ†ï¼š\n$$ \\begin{aligned} E_{ms}(\\mu_{o})\u0026=\\int_{0}^{2\\pi}\\int_{0}^{1}f_{ms}(\\mu_{o},\\mu_{i},\\phi)\\mu_{i}d\\mu_{i}d\\phi \\\\ \u0026=2 \\int_{0}^1 \\frac{(1-E(\\mu_{o}))(1-E(\\mu_{i}))}{\\pi(1-E_{avg})}\\mu_{i}d\\mu_{i}\\\\ \u0026=2 \\frac{1-E(\\mu_{o})}{1-E_{avg}}\\int_{0}^1(1-E(\\mu_{i}))\\mu_{i}d\\mu_{i}\\\\ \u0026= \\frac{1-E(\\mu_{o})}{1-E_{avg}}(1-E_{avg})\\\\ \u0026= 1-E(\\mu_{o}) \\end{aligned} $$ å°†å…¶åŠ åˆ°åŸæ¥çš„å¾®è¡¨é¢ BRDF ä¸Šå³å¯å¼¥è¡¥æŸå¤±ï¼š\n$$ E(\\mu_{o})+E_{ms}(\\mu_{o})\\equiv 1 $$ è®¡ç®— $E(\\mu)$ å’Œ $E_{avg}$ éƒ½éœ€è¦ç§¯åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¦»çº¿ç«¯é¢„å…ˆè®¡ç®—å¥½è¿™ä¸¤é¡¹ï¼Œå°†å…¶æŒ‰éœ€è¦çš„å˜é‡æ‰“è¡¨ï¼Œå­˜å‚¨åœ¨çº¹ç†ä¸Šï¼Œç„¶åæ¸²æŸ“æ—¶å¯¹åº”æŸ¥è¯¢å³å¯ã€‚PPT ä¸­æŒ‡å‡º 32Ã—32 çš„å¤§å°çš„çº¹ç†å°±è¶³å¤Ÿäº†ï¼Œä½œä¸šä¸­åˆ™ä½¿ç”¨äº†æ›´å¤§çš„ 128Ã—128ã€‚\né¢œè‰²è¡¨é¢ Colored Surfaces åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œè¡¨é¢å°†æ‰€æœ‰å…¥å°„çš„å…‰å…¨éƒ¨åå°„ï¼Œå³å…‰çº¿ä¸å­˜åœ¨è¢«å¸æ”¶æˆ–è€…é€å°„çš„æƒ…å†µã€‚ç„¶è€Œï¼Œç»å¤§å¤šæ•°è¡¨é¢æ˜¯å¸¦æœ‰é¢œè‰²çš„ï¼Œå³å…¶ä¼šå¸æ”¶æŸç§æˆåˆ†çš„å…‰ï¼Œè¿™ç§æƒ…å†µä¸‹çš„èƒ½é‡æŸå¤±æ˜¯ç¬¦åˆç‰©ç†çš„ï¼Œå³ $E(\\mu)\u003c1$ã€‚\nKulla å’Œ Conty å—åˆ° Jakob ç­‰äººçš„å¯å‘ï¼Œå¤šæ¬¡å¼¹å°„ä¸‹èƒ½é‡æ˜¯ diffuse çš„ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ä½™å¼¦åŠ æƒçš„ Fresnel é¡¹ä»£è¡¨å¹³å‡è¢«åå°„çš„èƒ½é‡ï¼š\n$$ F_{avg}=2\\int_{0}^1F(\\mu)\\mu d\\mu $$ æˆ‘ä»¬å·²ç»çŸ¥é“æ‰€æœ‰åå°„å‡ºå°„çš„èƒ½é‡æ¯”ä¾‹ä¸º $E_{avg}$ï¼Œé‚£ä¹ˆå› ä¸ºå¾®è¡¨é¢çš„é®æŒ¡è€Œæ²¡æœ‰å‡ºå°„çš„èƒ½é‡æ¯”ä¾‹åˆ™ä¸º $1-E_{avg}$ï¼Œè¿™éƒ¨åˆ†èƒ½é‡ï¼ˆå³å‘ç”Ÿäº†äºŒæ¬¡ bounceï¼‰ä¸­åˆæœ‰ $F_{avg}$ çš„æ¯”ä¾‹èƒ½å¤Ÿè¢«åå°„ï¼Œæ‰€ä»¥ç»è¿‡ $n$ æ¬¡åå°„å‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡å¯ä»¥å½’çº³ä¸ºï¼š\n$$ \\begin{aligned} E_{0}\u0026=F_{avg}E_{avg}\\\\ E_{1}\u0026=F_{avg}(1-E_{avg})F_{avg}E_{avg}\\\\ \\dots\\\\ E_{n}\u0026=F_{avg}^n (1-E_{avg})^n F_{avg}E_{avg} \\end{aligned} $$ å¾ˆæ˜¾ç„¶è¿™æ˜¯ä¸€ä¸ªç­‰æ¯”æ•°åˆ—ï¼Œå°†å…¶æ±‚å’Œåå³å¯å¾—åˆ°æ‰€æœ‰ç»è¿‡å¤šæ¬¡å¼¹å°„æœ€ç»ˆå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„æ€»èƒ½é‡ï¼š\n$$ E=F_{avg}E_{avg}\\sum_{k=0}^{\\infty}F_{avg}^k(1-E_{avg})^k=\\frac{F_{avg}E_{avg}}{1-F_{avg}(1-E_{avg})} $$ $E_{avg}$ å¯ä»¥é€šè¿‡é¢„è®¡ç®—å¾—åˆ°ï¼Œä½†æ˜¯ $F_{avg}$ æ— æ³•è¿™ä¹ˆåšã€‚æ‰€ä»¥ Kulla å’Œ Conty åˆ†åˆ«å¯¹ä»‹ç”µè´¨å’Œå¯¼ä½“åˆ—å‡ºäº†ä¸¤ç§å‰äººç”¨åˆ°çš„æ•°å€¼è¿‘ä¼¼æ–¹æ³•ï¼š\nå¦‚æ­¤ï¼Œåœ¨æ¸²æŸ“æ—¶å³å¯é‡‡æ · $E_{avg}$ å’Œæ ¹æ®è¡¨é¢æ€§è´¨è¿‘ä¼¼ $F_{avg}$ è®¡ç®—å‡ºé¢œè‰²è¡¨é¢çš„å‡ºå°„èƒ½é‡æ¯”ä¾‹ï¼Œç„¶åå†å°†å…¶ä¸ä¸ŠèŠ‚ä¸­æ²¡æœ‰èƒ½é‡å¸æ”¶çš„ $f_{ms}$ ç›¸ä¹˜å³å¯ã€‚\n0x02 é—®é¢˜ä¿®å¤ TroubleShooting åšä½œä¸šæ—¶é‡åˆ°ä¸€äº›å‡ºç°é—®é¢˜çš„åœ°æ–¹ï¼Œè¿™é‡Œä¸€å¹¶æä¸€ä¸‹ï¼š\næ‰¾ä¸åˆ° vec.h æœªå®šä¹‰æ ‡è¯†ç¬¦â€œM_PIâ€ uniform å˜é‡ uEavgFLut å‘½åé”™è¯¯ ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯é…ç½®é—®é¢˜ï¼Œç”¨ vscode åœ¨ task.json çš„ args å­—æ®µåŠ ä¸Šï¼š\n1 \"-I\", 2\"${workspaceFolder}/assignment4/lut-gen/ext\", ç¬¬äºŒä¸ªé—®é¢˜æŠŠæ‰€æœ‰ M_PI æ”¹æˆ PIã€‚\nç¬¬ä¸‰ä¸ªé—®é¢˜åœ¨ KullaContyMaterial.js ä¸­ï¼Œè°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°æ—¶ä¼ å…¥äº†å‘½åå’Œ Shader ä¸­ä¸å¯¹åº”çš„ uniform å˜é‡ï¼ŒæŠŠ uEavgFLut æ”¹æˆ uEavgLut å³å¯ã€‚\n0x03 é¢„ç§¯åˆ† $E(\\mu)$ è’™ç‰¹å¡æ´›æ±‚è§£ Monte Carlo åœ¨ Emu_MC.cpp çš„ IntegrateBRDF ä¸­å®Œæˆå¯¹ $E(\\mu)$ çš„ç§¯åˆ†ï¼Œä½¿ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•åœ¨åŠçƒä¸Šå‡åŒ€é‡‡æ ·å…¥å°„å…‰æ–¹å‘ï¼Œæ±‚è§£è¿™ä¸ªç§¯åˆ†ã€‚ç§¯åˆ†å†…éƒ¨ä¸º BRDF ä»¥åŠ cos é¡¹ï¼š\n$$ f_{r}(i,o)=\\frac{F(i,h)G(i,o,h)D(h)}{4(n\\cdot i)(n\\cdot o)},\\cos \\theta=n\\cdot i $$ Fï¼ŒGï¼ŒD çš„å®ç°æ¡†æ¶ä¸­å‡å·²ç»™å‡ºï¼ŒæŒ‰éœ€è°ƒç”¨å³å¯ã€‚\n1Vec3f IntegrateBRDF(Vec3f V, float roughness, float NdotV) { 2 float A = 0.0; 3 float B = 0.0; 4 float C = 0.0; 5 const int sample_count = 1024; 6 Vec3f N = Vec3f(0.0, 0.0, 1.0); 7 8 samplePoints sampleList = squareToCosineHemisphere(sample_count); 9 for (int i = 0; i \u003c sample_count; i++) { 10 // calculate (fr * ni) / p_o here 11 Vec3f L = sampleList.directions[i]; 12 float pdf = sampleList.PDFs[i]; 13 14 float NdotL = dot(N,L); 15 Vec3f H = normalize(V+L); 16 17 // here we assume all lights are reflected, no absorption! 18 // deal with color later 19 float F = 1.0; 20 float NDF = DistributionGGX(N, H, roughness); 21 float G = GeometrySmith(roughness, NdotV, NdotL); 22 23 float nom = F * NDF * G; 24 float denom = std::max(4.0 * NdotL * NdotV,0.001); 25 float fr = nom / denom; 26 27 // accumulate each component 28 A = B = C +=fr*NdotL/pdf; 29 30 } 31 32 return {A / sample_count, B / sample_count, C / sample_count}; 33} è¿è¡Œç¨‹åºå³å¯å¾—åˆ°è¿™æ ·ä¸€å¼  LUTï¼š\nå¯ä»¥çœ‹åˆ°éšç€ç²—ç³™åº¦é™ä½ï¼ˆè‡ªä¸Šè€Œä¸‹ï¼‰ï¼Œå™ªå£°è¶Šæ¥è¶Šæ˜æ˜¾ã€‚è¿™æ˜¯å› ä¸ºä½ç²—ç³™åº¦çš„å¾®è¡¨é¢æ³•çº¿ $m$ é›†ä¸­åœ¨å®è§‚æ³•çº¿ $n$ é™„è¿‘ï¼Œä½†é€šè¿‡éšæœºé‡‡æ ·å…¥å°„å…‰æ–¹å‘ $i$ è®¡ç®—å¾—åˆ°çš„åŠç¨‹å‘é‡ $h$ åˆ™ä¸ç„¶ï¼Œå› æ­¤å¯¼è‡´ä½ç²—ç³™åº¦ä¸‹ç§¯åˆ†å€¼çš„æ–¹å·®æ˜¾è‘—å¢åŠ ã€‚ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹å¾®è¡¨é¢æ³•çº¿ $m$ è¿›è¡Œé‡è¦æ€§é‡‡æ ·æ¥æ”¹å–„è¿™ä¸ªé—®é¢˜ï¼Œå³ä½¿å¾—é‡‡æ ·çš„ $m$ æ›´å¤šåœ°ä½äº $n$ é™„è¿‘ã€‚\né‡è¦æ€§é‡‡æ ·æ±‚è§£ Importance Sampling æœ€ç»ˆçš„ä»»åŠ¡ä»ç„¶æ˜¯é‡‡æ · $i$ å’Œè®¡ç®— $\\frac{f_{r}(i,o,h)(i,n)}{pdf_{i}(i)}$ï¼Œä½†ç°åœ¨ $i$ å¹¶ä¸ç”±ç›´æ¥é‡‡æ ·å¾—åˆ°ï¼Œè€Œæ˜¯æ ¹æ®æŸä¸ªå¾®è¡¨é¢æ³•çº¿åˆ†å¸ƒæ¨¡å‹é‡è¦æ€§é‡‡æ ·å¾—åˆ°çš„å¾®è¡¨é¢æ³•å‘ $m$ é—´æ¥æ±‚è§£ã€‚\næ¡†æ¶ä¸­ä½¿ç”¨çš„ NDF ä¸º GGX åˆ†å¸ƒï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®è¯¥åˆ†å¸ƒç”Ÿæˆé‡‡æ ·çš„å¾®è¡¨é¢æ³•å‘ $m$ï¼Œå†ç”± $m$ å’Œ $o$ åæ±‚å…¥å°„æ–¹å‘ $i$ã€‚\nç”±å¾®è¡¨é¢æ³•çº¿åˆ†å¸ƒæ¨¡å‹çš„æ€§è´¨ï¼Œå¯ä»¥è®¡ç®—å‡ºé‡‡æ · $m$ çš„æ¦‚ç‡å¯†åº¦ï¼š\n$$ pdf_{m}(m)=D(m)(m\\cdot n) $$ é€šè¿‡è¯¥æ¦‚ç‡å¯†åº¦ï¼Œå¯ä»¥è®¡ç®—å‡ºè¯¥åˆ†å¸ƒä¸‹å¯¹åº”çš„é‡‡æ ·ç‚¹ï¼š\n$$ \\begin{aligned} \\theta_{m}\u0026=\\arctan\\left( \\frac{\\alpha \\sqrt{ \\xi_{1} }}{\\sqrt{ 1-\\xi_{1} }} \\right)\\\\ \\phi_{h}\u0026=2\\pi \\xi_{2} \\end{aligned} $$ å…¶ä¸­ï¼Œ$\\alpha=roughness^{2},\\xi_{1},\\xi_{2}\\in[0,1)$ã€‚\nåœ¨ Emu_IS.cpp çš„ ImportanceSampleGGX å‡½æ•°ä¸­ï¼Œå®Œæˆé‡è¦æ€§é‡‡æ ·çš„é€»è¾‘ï¼Œå¹¶è¿”å›åˆ‡çº¿ç©ºé—´çš„å¾®è¡¨é¢æ³•çº¿ $h$ã€‚\n1Vec3f ImportanceSampleGGX(Vec2f Xi, Vec3f N, float roughness) { 2 float a = roughness * roughness; 3 4 // in spherical space - Bonus 1 5 float Xi1 = Xi.x; 6 float Xi2 = Xi.y; 7 float theta = atan(a*sqrt(Xi1)/sqrt(1-Xi1)); 8 float phi = 2.0 * PI * Xi2; 9 10 // from spherical space to cartesian space - Bonus 1 11 float x = cos(phi)*sin(theta); 12 float y = sin(phi)*sin(theta); 13 float z = cos(theta); 14 15 // tangent coordinates - Bonus 1 16 Vec3f up = abs(N.z) \u003c 0.999 ? Vec3f(0.0, 0.0, 1.0) : Vec3f(1.0, 0.0, 0.0); // N is fixed 001 so not select 001 17 Vec3f tangent = normalize(cross(up,N)); 18 Vec3f bitangent = cross(N,tangent); 19 20 // transform H to tangent space - Bonus 1 21 Vec3f H = normalize(tangent*x + bitangent*y + N*z); 22 return H; 23} æ¥ä¸‹æ¥è®¡ç®— $\\frac{f_{r}(i,o,h)(i,n)}{pdf_{i}(i)}$ çš„å€¼ï¼Œéœ€è¦å…ˆå°†é‡‡æ · $m$ çš„æ¦‚ç‡å¯†åº¦è½¬åŒ–ä¸ºé‡‡æ · $i$ çš„æ¦‚ç‡å¯†åº¦ï¼š\n$$ pdf_{i}(i)=pdf_{m}(m)\\left\\lvert \\left\\lvert \\frac{\\partial\\omega_{m}}{\\partial \\omega_{i}} \\right\\rvert \\right\\rvert =\\frac{D(m)(m\\cdot n)}{4(i\\cdot m)} $$ æ‰€ä»¥æœ€ç»ˆéœ€è¦ç´¯åŠ çš„æƒé‡ä¸ºï¼š\n$$ \\begin{aligned} weight(i)\u0026=\\frac{f_{r}(i,o,h)(i,n)}{pdf_{i}(i)} \\\\ \u0026=\\frac{F(i,m)G(i,o,m)D(m)}{4(n\\cdot i)(n\\cdot o)}\\cdot(n\\cdot i)\\cdot \\frac{4(i\\cdot m)}{D(m)(n\\cdot m)} \\\\ \u0026=\\frac{(o\\cdot m)G(i,o,h)}{(o\\cdot n)(m\\cdot n)} \\end{aligned} $$ è¿™é‡Œæš‚ä¸”è€ƒè™‘æ‰€æœ‰èƒ½é‡éƒ½è¢«åå°„ï¼Œå³ F ä¸º 1ï¼›æœ€åç•™åœ¨åˆ†å­ä¸Šçš„å®é™…ä¸Šæ˜¯ $i\\cdot m$ï¼Œä½†æ˜¯ $i\\cdot m=o\\cdot m$ï¼Œæ‰€ä»¥å¯ä»¥æ›¿æ¢\nåœ¨ Emu_IS.cpp çš„ IntegrateBRDF å‡½æ•°ä¸­æ¯æ¬¡é‡‡æ ·ç´¯åŠ è¯¥æƒé‡å³å¯ï¼š\n1Vec3f IntegrateBRDF(Vec3f V, float roughness) { 2 3 const int sample_count = 1024; 4 Vec3f N = Vec3f(0.0, 0.0, 1.0); 5 Vec3f Emu = Vec3f(0.0f); 6 for (int i = 0; i \u003c sample_count; i++) { 7 Vec2f Xi = Hammersley(i, sample_count); 8 Vec3f H = ImportanceSampleGGX(Xi, N, roughness); 9 Vec3f L = normalize(H * 2.0f * dot(V, H) - V); 10 11 float NoL = std::max(L.z, 0.0f); 12 float NoH = std::max(H.z, 0.0f); 13 float VoH = std::max(dot(V, H), 0.0f); 14 float NoV = std::max(dot(N, V), 0.0f); 15 16 // calculate (fr * ni) / p_o here - Bonus 1 17 float w = VoH * GeometrySmith(roughness,NoV,NoL)/(NoV*NoH); 18 Emu += Vec3f(w); 19 // Split Sum - Bonus 2 20 } 21 22 return Emu / sample_count; 23} å®Œæˆé‡è¦æ€§é‡‡æ ·ä¹‹åå¾—åˆ°çš„ $E(\\mu)$ å°±æ²¡æœ‰å™ªç‚¹äº†ï¼š\n0x04 é¢„ç§¯åˆ† $E_{avg}$ é¢„ç§¯åˆ† $E_{avg}$ çš„è¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œç”šè‡³å› ä¸º $E(\\mu),\\mu$ éƒ½æ˜¯å®šå€¼ç›´æ¥è¿”å› $2E(\\mu)\\mu$ å³å¯ã€‚\n1Vec3f IntegrateEmu(Vec3f V, float roughness, float NdotV, Vec3f Ei) { 2 return Ei * NdotV * 2.0f; 3 Vec3f Eavg = Vec3f(0.0f); 4 const int sample_count = 1024; 5 Vec3f N = Vec3f(0.0, 0.0, 1.0); 6 7 for (int i = 0; i \u003c sample_count; i++) 8 { 9 Vec2f Xi = Hammersley(i, sample_count); 10 Vec3f H = ImportanceSampleGGX(Xi, N, roughness); 11 Vec3f L = normalize(H * 2.0f * dot(V, H) - V); 12 13 float NoL = std::max(L.z, 0.0f); 14 float NoH = std::max(H.z, 0.0f); 15 float VoH = std::max(dot(V, H), 0.0f); 16 float NoV = std::max(dot(N, V), 0.0f); 17 18 // calculate Eavg here - Bonus 1 19 Eavg += Ei * NoV * 2.0f; 20 } 21 22 return Eavg / sample_count; 23} æ±‚è§£ $E_{avg}$ çš„è¿‡ç¨‹ä»…ä¾èµ–äºé‡‡æ ·åˆ°çš„ $E(\\mu)$ ï¼Œæ‰€ä»¥ Eavg_IS.cpp å’Œ E_avg_MC.cpp çš„å®ç°æ˜¯ä¸€æ ·çš„ã€‚\nè¿è¡Œç¨‹åºå¯ä»¥å¾—åˆ°è¿™æ ·ä¸€å¼  LUTï¼š\nå¦‚æœæ­£ç¡®å®ç°äº† $E(\\mu)$ çš„é‡è¦æ€§é‡‡æ ·ï¼Œä¸Šå›¾å°±ä¼šå˜å¾— Smooth ä¸€ç‚¹ï¼š\n0x05 å®æ—¶æ¸²æŸ“ Realtime Rendering PBR æè´¨çš„å®ç°å°±ä¸è´´äº†ï¼Œå…¬å¼å·²ç»ç»™å‡ºäº†ï¼Œå¯ä»¥ç›´æ¥æ¬ç¦»çº¿ç«¯çš„å®ç°\nåœ¨å®æ—¶ç«¯éœ€è¦é‡‡æ ·é¢„ç§¯åˆ†çš„ $E(\\mu)$ å’Œ $E_{avg}$ çš„ LUTï¼Œç„¶åä»ç„¶æ˜¯å¥—å…¬å¼è®¡ç®—èƒ½é‡å®ˆæ’çš„ BRDFï¼š\n$$ f_{r}=f_{micro}+f_{add}*f_{ms} $$ åœ¨ MultiScatterBRDF å‡½æ•°ä¸­ï¼Œéœ€è¦å®Œæˆå¯¹ $f_{add},f_{ms}$ çš„è®¡ç®—ï¼š\n$$ \\begin{aligned} f_{add}\u0026=\\frac{F_{avg}E_{avg}}{1-F_{avg}(1-E_{avg})}\\\\ f_{ms}(\\mu_{o},\\mu_{i})\u0026=\\frac{(1-E(\\mu_{o}))(1-E(\\mu_{i}))}{\\pi(1-E_{avg})} \\end{aligned} $$ 1vec3 MultiScatterBRDF(float NdotL, float NdotV) 2{ 3 vec3 albedo = pow(texture2D(uAlbedoMap, vTextureCoord).rgb, vec3(2.2)); 4 5 vec3 E_o = texture2D(uBRDFLut, vec2(NdotL, uRoughness)).xxx; 6 vec3 E_i = texture2D(uBRDFLut, vec2(NdotV, uRoughness)).xxx; 7 8 vec3 E_avg = texture2D(uEavgLut, vec2(0, uRoughness)).xxx; 9 // copper 10 vec3 edgetint = vec3(0.827, 0.792, 0.678); 11 vec3 F_avg = AverageFresnel(albedo, edgetint); 12 13 // calculate fms and missing energy here 14 vec3 f_add = F_avg * E_avg / (1.0 - F_avg * (1.0 - E_avg)); 15 vec3 f_ms = (1.0 - E_o) * (1.0 - E_i) / (PI * (1.0 - E_avg)); 16 return f_add*f_ms; 17 18} å®Œæˆåå³å¯è¾¾åˆ°å¦‚å›¾æ‰€ç¤ºçš„æ•ˆæœï¼š\n0x06 Split Sum ä»ç„¶æ˜¯è®¡ç®— $E(\\mu)$ï¼Œç»“æœä¿å­˜åˆ°ä¸€å¼ ä¸ roughness å’Œæ›²ç‡ç›¸å…³çš„ LUT ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ F é¡¹ä» BRDF ä¸­åˆ†ç¦»å‡ºæ¥ï¼ˆè¿™ä¸ªæ€è·¯åœ¨ Lecture5 Real-time Environment Mapping 1h 15min å·¦å³æœ‰æåŠï¼‰ï¼š\n$$ \\begin{aligned} E\u0026=\\int_{\\Omega^+}f_{r}(n\\cdot i) d\\omega_{i} \\\\ \u0026=\\int_{\\Omega^+} \\frac{f_{r}}{F}(n\\cdot i) Fd\\omega_{i}\\\\ \u0026=\\int_{\\Omega^+} \\frac{f_{r}}{F}(n\\cdot i) (F_{0}+(1-F_{0})(1-\\cos \\theta)^5)d\\omega_{i}\\\\ \u0026=\\int_{\\Omega^+} \\frac{f_{r}}{F}(n\\cdot i) (F_{0}+(1-F_{0})\\alpha)d\\omega_{i}\\\\ \u0026=\\int_{\\Omega^+} \\frac{f_{r}}{F}(n\\cdot i) (F_{0}(1-\\alpha)+\\alpha)d\\omega_{i}\\\\ \u0026=F_{0}\\int_{\\Omega^+} \\frac{f_{r}}{F}(n\\cdot i) (1-\\alpha)d\\omega_{i}+\\int_{\\Omega^+} \\frac{f_{r}}{F}(n\\cdot i) \\alpha d\\omega_{i} \\end{aligned} $$ è®° $\\alpha=(1-\\cos \\theta)^5$\næ›´æ”¹ä¸€ä¸‹ IntegrateBRDFï¼Œå°†è¿™ä¸¤ä¸ª Split çš„ç»“æœåˆ†åˆ«å­˜å…¥ LUT çš„ GB é€šé“ï¼ŒR é€šé“ä»ç„¶å­˜åŸæ¥çš„ $E(\\mu)$ï¼š\nç„¶ååœ¨å®æ—¶ç«¯é‡è½½ä¸€ä¸ª MultiScatterBRDFï¼Œå¢åŠ ä¸€ä¸ª F0 ä½œä¸ºå‚æ•°ï¼Œç”¨ä¸¤ä¸ª Split çš„ç§¯åˆ†è¿˜åŸ $E(\\mu),E_{avg}$ï¼š\nè°ƒç”¨è¿™ä¸ªæ–°çš„å‡½æ•°å¹¶ä¼ å…¥ F0 å³å¯çœ‹åˆ°ä½¿ç”¨ Split Sum è®¡ç®—å‡ºæ¥çš„ç»“æœï¼š\n","wordCount":"1187","inLanguage":"zh","datePublished":"2025-06-14T00:00:00Z","dateModified":"2025-06-14T00:00:00Z","author":{"@type":"Person","name":"The Only Problem"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://congyuxiaoyoudao.github.io/posts/assignments/games202-homework-4/"},"publisher":{"@type":"Organization","name":"The Only Problem's Blog","logo":{"@type":"ImageObject","url":"https://congyuxiaoyoudao.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://congyuxiaoyoudao.github.io/ accesskey=h title="The Only Problem's Blog (Alt + H)">The Only Problem's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://congyuxiaoyoudao.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://congyuxiaoyoudao.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://congyuxiaoyoudao.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://congyuxiaoyoudao.github.io/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://congyuxiaoyoudao.github.io/>ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href=https://congyuxiaoyoudao.github.io/posts/>Posts</a>&nbsp;Â»&nbsp;<a href=https://congyuxiaoyoudao.github.io/posts/assignments/>Assignments</a></div><h1 class="post-title entry-hint-parent">Assignment 7. GAMES202 Homework 4</h1><div class=post-meta><span title='2025-06-14 00:00:00 +0000 UTC'>å…­æœˆ 14, 2025</span>&nbsp;Â·&nbsp;6 åˆ†é’Ÿ&nbsp;Â·&nbsp;The Only Problem</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>ç›®å½•</span></summary><div class=inner><ul><li><a href=#0x00-to-begin-with aria-label="0x00 To begin with">0x00 To begin with</a></li><li><a href=#0x01-%e8%af%be%e7%a8%8b%e5%9b%9e%e9%a1%be-recap aria-label="0x01 è¯¾ç¨‹å›é¡¾ Recap">0x01 è¯¾ç¨‹å›é¡¾ Recap</a><ul><li><a href=#%e8%83%bd%e9%87%8f%e5%ae%88%e6%81%92%e7%9a%84-bsdf-energy-preserving-bsdfs aria-label="èƒ½é‡å®ˆæ’çš„ BSDF Energy-Preserving BSDFs">èƒ½é‡å®ˆæ’çš„ BSDF Energy-Preserving BSDFs</a></li><li><a href=#%e9%a2%9c%e8%89%b2%e8%a1%a8%e9%9d%a2-colored-surfaces aria-label="é¢œè‰²è¡¨é¢ Colored Surfaces">é¢œè‰²è¡¨é¢ Colored Surfaces</a></li></ul></li><li><a href=#0x02-%e9%97%ae%e9%a2%98%e4%bf%ae%e5%a4%8d-troubleshooting aria-label="0x02 é—®é¢˜ä¿®å¤ TroubleShooting">0x02 é—®é¢˜ä¿®å¤ TroubleShooting</a></li><li><a href=#0x03-%e9%a2%84%e7%a7%af%e5%88%86-emu aria-label="0x03 é¢„ç§¯åˆ† $E(\mu)$">0x03 é¢„ç§¯åˆ† $E(\mu)$</a><ul><li><a href=#%e8%92%99%e7%89%b9%e5%8d%a1%e6%b4%9b%e6%b1%82%e8%a7%a3-monte-carlo aria-label="è’™ç‰¹å¡æ´›æ±‚è§£ Monte Carlo">è’™ç‰¹å¡æ´›æ±‚è§£ Monte Carlo</a></li><li><a href=#%e9%87%8d%e8%a6%81%e6%80%a7%e9%87%87%e6%a0%b7%e6%b1%82%e8%a7%a3-importance-sampling aria-label="é‡è¦æ€§é‡‡æ ·æ±‚è§£ Importance Sampling">é‡è¦æ€§é‡‡æ ·æ±‚è§£ Importance Sampling</a></li></ul></li><li><a href=#0x04-%e9%a2%84%e7%a7%af%e5%88%86-e_avg aria-label="0x04 é¢„ç§¯åˆ† $E_{avg}$">0x04 é¢„ç§¯åˆ† $E_{avg}$</a></li><li><a href=#0x05-%e5%ae%9e%e6%97%b6%e6%b8%b2%e6%9f%93-realtime-rendering aria-label="0x05 å®æ—¶æ¸²æŸ“ Realtime Rendering">0x05 å®æ—¶æ¸²æŸ“ Realtime Rendering</a></li><li><a href=#0x06-split-sum aria-label="0x06 Split Sum">0x06 Split Sum</a></li></ul></div></details></div><div class=post-content><blockquote><p>å¥½ä¹…ä¸è§ï¼æœ€è¿‘åœ¨å¿™åˆ«çš„å·¥ä½œï¼Œè¿™å‡ å¤©éš¾å¾—æœ‰æ—¶é—´ï¼Œèµ¶ç´§æŠŠ 202 ç³»åˆ—ä½œä¸šåšä¸ªæ”¶å°¾ÎµÙ©(à¹‘> â‚ƒ &lt;)Û¶Ğ·ï¼</p></blockquote><hr><h2 id=0x00-to-begin-with>0x00 To begin with<a hidden class=anchor aria-hidden=true href=#0x00-to-begin-with>#</a></h2><p>è¿™ç¯‡æ–‡ç« å°†ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š</p><ul><li><input checked disabled type=checkbox> éƒ¨åˆ†è¯¾ç¨‹å†…å®¹å›é¡¾</li><li><input checked disabled type=checkbox> GAMES202 ä½œä¸š 4</li></ul><p><strong>For reference</strong>ğŸ‘‡ï¼š</p><ul><li>ğŸ“ºB ç«™è§†é¢‘ï¼š
<a href="https://www.bilibili.com/video/BV1YK4y1T7yY/?spm_id_from=333.337.top_right_bar_window_custom_collection.content.click&amp;vd_source=b6584cebba3a7a1a34d2f60d63bdc868">GAMES202-é«˜è´¨é‡å®æ—¶æ¸²æŸ“</a></li><li>ğŸ“¦ä»£ç ä»“åº“ï¼š
<a href=https://github.com/congyuxiaoyoudao/GAMES202_Homework/tree/working>congyuxiaoyoudao/GAMES202_Homework at working</a></li><li>ğŸ“ƒ
<a href=https://blog.selfshadow.com/publications/s2017-shading-course/imageworks/s2017_pbs_imageworks_slides_v2.pdf>Revisiting Physically Based Shading at Imageworks</a></li></ul><blockquote><p>master åˆ†æ”¯ä¸Šæ˜¯ 202 å…¨éƒ¨ä½œä¸šæ±‡æ€»ï¼Œworking åˆ†æ”¯ç”¨äºæäº¤ä»£ç ã€‚éœ€è¦åŸå§‹ä½œä¸šå¯ä¸‹è½½ master åˆ†æ”¯çš„åŒ…</p></blockquote><hr><h2 id=0x01-è¯¾ç¨‹å›é¡¾-recap>0x01 è¯¾ç¨‹å›é¡¾ Recap<a hidden class=anchor aria-hidden=true href=#0x01-è¯¾ç¨‹å›é¡¾-recap>#</a></h2><h3 id=èƒ½é‡å®ˆæ’çš„-bsdf-energy-preserving-bsdfs>èƒ½é‡å®ˆæ’çš„ BSDF Energy-Preserving BSDFs<a hidden class=anchor aria-hidden=true href=#èƒ½é‡å®ˆæ’çš„-bsdf-energy-preserving-bsdfs>#</a></h3><p>Cook-Torrance æå‡ºçš„å¾®è¡¨é¢ BRDF åªè€ƒè™‘å…‰çº¿åœ¨è¡¨é¢ç»è¿‡ä¸€æ¬¡å¼¹å°„åå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡ï¼Œç„¶è€Œå¿½ç•¥äº†å¤šæ¬¡å¼¹å°„æœ€ç»ˆå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡ï¼Œè¿™å°±é€ æˆäº†èƒ½é‡æŸå¤±ã€‚å°¤å…¶æ˜¯å½“æè´¨çš„ roughness è¾ƒé«˜æ—¶ï¼ŒG é¡¹å‡å°ï¼Œå¤šæ¬¡å¼¹å°„çš„æ¯”ä¾‹å¢åŠ ï¼Œèƒ½é‡æŸå¤±è¶Šä¸¥é‡ã€‚</p><p><img alt="Missing Energy of Microfacet BRDF, Revisiting Physically Based Shading at Imageworks, SIGGRAPH 2017" loading=lazy src=https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506151740381.png#center></p><p>2017 å¹´ Kulla å’Œ Conty å—åˆ° Disney Principle BRDF çš„å¯å‘ï¼Œæå‡ºäº†ä¸€ç§æ”¹è¿›çš„æ–¹æ³•ï¼Œå³é€šè¿‡å¼•å…¥ä¸€ä¸ªèƒ½é‡è¡¥å¿é¡¹ï¼Œå°†å¤šæ¬¡å¼¹å°„å‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡è¡¥å……å›æ¥ï¼Œå°±èƒ½è¿‘ä¼¼åœ°ä¿æŒèƒ½é‡å®ˆæ’ã€‚</p><p>æœ‰äº†æ¸²æŸ“æ–¹ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°æ±‚å¾—å¾®è¡¨é¢ BRDF åœ¨è§‚å¯Ÿæ–¹å‘ $\mu_{o}$ ä¸Šå‡ºå°„çš„æ€»èƒ½é‡ï¼š</p><div>$$
E(\mu_{o})=\int_{0}^{2\pi}\int_{0}^{1}f(\mu_{o},\mu_{i},\phi)\mu_{i}d\mu_{i}d\phi
$$</div><blockquote><p>è¿™é‡Œè®° $\mu_{i}=\sin \theta,\theta=n\cdot \mu_{i}$ï¼Œä¹‹åå°±å¯ä»¥å°† $f_{r}\cos \theta \sin \theta d\theta d\phi$ å†™ä¸º $f_{r}\mu_{i} d\mu_{i}d\phi$ã€‚ç„¶è€ŒåŸ PPT é‡Œæåˆ°çš„æ˜¯è®°ä¸º $\cos \theta$ï¼Œä¸è¿‡å°±ç§¯åˆ†ç»“æœæ¥è¯´éƒ½ä¸€æ ·</p></blockquote><p>$E(\mu_{o})$ çš„èŒƒå›´ä¸º 0-1ï¼Œå¯¹äºä¸åŒçš„ $\mu_{o}$ï¼Œ$E(\mu_{o})$ çš„å€¼ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚å¾®è¡¨é¢ BRDF çš„ $E(\mu_{o})$ ä¼šéšç€ roughness çš„å¢åŠ è€Œè¡°å‡ã€‚ä¸ºäº†å¼¥è¡¥è¿™éƒ¨åˆ†èƒ½é‡ï¼ŒKulla å’Œ Conty è®¾è®¡äº†ä¸€ä¸ªæ–°çš„ BRDF lobeï¼š</p><div>$$
f_{ms}=\frac{(1-E(\mu_{o}))(1-E(\mu_{i}))}{\pi(1-E_{avg})},E_{avg}=2\int_{0}^1E(\mu)\mu d\mu
$$</div><p>å…¶ä¸­ $f_{ms}$ ä¸ºå¼¥è¡¥æŸå¤±çš„ BRDFï¼Œ$E_{avg}$ ä¸ºåœ¨æ‰€æœ‰è§‚å¯Ÿæ–¹å‘ä¸‹å‡ºå°„èƒ½é‡çš„å¹³å‡å€¼ã€‚åŒæ ·è®¡ç®—è¿™ä¸ª BRDF åœ¨è§‚å¯Ÿæ–¹å‘ $\mu_{o}$ ä¸Šçš„ç§¯åˆ†ï¼š</p><div>$$
\begin{aligned}
E_{ms}(\mu_{o})&=\int_{0}^{2\pi}\int_{0}^{1}f_{ms}(\mu_{o},\mu_{i},\phi)\mu_{i}d\mu_{i}d\phi \\
&=2 \int_{0}^1 \frac{(1-E(\mu_{o}))(1-E(\mu_{i}))}{\pi(1-E_{avg})}\mu_{i}d\mu_{i}\\
&=2 \frac{1-E(\mu_{o})}{1-E_{avg}}\int_{0}^1(1-E(\mu_{i}))\mu_{i}d\mu_{i}\\
&= \frac{1-E(\mu_{o})}{1-E_{avg}}(1-E_{avg})\\
&= 1-E(\mu_{o})
\end{aligned}
$$</div><p>å°†å…¶åŠ åˆ°åŸæ¥çš„å¾®è¡¨é¢ BRDF ä¸Šå³å¯å¼¥è¡¥æŸå¤±ï¼š</p><div>$$
E(\mu_{o})+E_{ms}(\mu_{o})\equiv 1
$$</div><p><img alt="Micro Energy Compensation, Revisiting Physically Based Shading at Imageworks, SIGGRAPH 2017" loading=lazy src=https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506151914803.png#center></p><p>è®¡ç®— $E(\mu)$ å’Œ $E_{avg}$ éƒ½éœ€è¦ç§¯åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¦»çº¿ç«¯é¢„å…ˆè®¡ç®—å¥½è¿™ä¸¤é¡¹ï¼Œå°†å…¶æŒ‰éœ€è¦çš„å˜é‡æ‰“è¡¨ï¼Œå­˜å‚¨åœ¨çº¹ç†ä¸Šï¼Œç„¶åæ¸²æŸ“æ—¶å¯¹åº”æŸ¥è¯¢å³å¯ã€‚PPT ä¸­æŒ‡å‡º 32Ã—32 çš„å¤§å°çš„çº¹ç†å°±è¶³å¤Ÿäº†ï¼Œä½œä¸šä¸­åˆ™ä½¿ç”¨äº†æ›´å¤§çš„ 128Ã—128ã€‚</p><h3 id=é¢œè‰²è¡¨é¢-colored-surfaces>é¢œè‰²è¡¨é¢ Colored Surfaces<a hidden class=anchor aria-hidden=true href=#é¢œè‰²è¡¨é¢-colored-surfaces>#</a></h3><p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œè¡¨é¢å°†æ‰€æœ‰å…¥å°„çš„å…‰å…¨éƒ¨åå°„ï¼Œå³å…‰çº¿ä¸å­˜åœ¨è¢«å¸æ”¶æˆ–è€…é€å°„çš„æƒ…å†µã€‚ç„¶è€Œï¼Œç»å¤§å¤šæ•°è¡¨é¢æ˜¯å¸¦æœ‰é¢œè‰²çš„ï¼Œå³å…¶ä¼šå¸æ”¶æŸç§æˆåˆ†çš„å…‰ï¼Œè¿™ç§æƒ…å†µä¸‹çš„èƒ½é‡æŸå¤±æ˜¯ç¬¦åˆç‰©ç†çš„ï¼Œå³ $E(\mu)&lt;1$ã€‚</p><p>Kulla å’Œ Conty å—åˆ° Jakob ç­‰äººçš„å¯å‘ï¼Œå¤šæ¬¡å¼¹å°„ä¸‹èƒ½é‡æ˜¯ diffuse çš„ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ä½™å¼¦åŠ æƒçš„ Fresnel é¡¹ä»£è¡¨å¹³å‡è¢«åå°„çš„èƒ½é‡ï¼š</p><div>$$
F_{avg}=2\int_{0}^1F(\mu)\mu d\mu
$$</div><p>æˆ‘ä»¬å·²ç»çŸ¥é“æ‰€æœ‰åå°„å‡ºå°„çš„èƒ½é‡æ¯”ä¾‹ä¸º $E_{avg}$ï¼Œé‚£ä¹ˆå› ä¸ºå¾®è¡¨é¢çš„é®æŒ¡è€Œæ²¡æœ‰å‡ºå°„çš„èƒ½é‡æ¯”ä¾‹åˆ™ä¸º $1-E_{avg}$ï¼Œè¿™éƒ¨åˆ†èƒ½é‡ï¼ˆå³å‘ç”Ÿäº†äºŒæ¬¡ bounceï¼‰ä¸­åˆæœ‰ $F_{avg}$ çš„æ¯”ä¾‹èƒ½å¤Ÿè¢«åå°„ï¼Œæ‰€ä»¥ç»è¿‡ $n$ æ¬¡åå°„å‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„èƒ½é‡å¯ä»¥å½’çº³ä¸ºï¼š</p><div>$$
\begin{aligned}
E_{0}&=F_{avg}E_{avg}\\
E_{1}&=F_{avg}(1-E_{avg})F_{avg}E_{avg}\\
\dots\\
E_{n}&=F_{avg}^n (1-E_{avg})^n F_{avg}E_{avg}
\end{aligned}
$$</div><p>å¾ˆæ˜¾ç„¶è¿™æ˜¯ä¸€ä¸ªç­‰æ¯”æ•°åˆ—ï¼Œå°†å…¶æ±‚å’Œåå³å¯å¾—åˆ°æ‰€æœ‰ç»è¿‡å¤šæ¬¡å¼¹å°„æœ€ç»ˆå‡ºå°„åˆ°è§‚å¯Ÿæ–¹å‘çš„æ€»èƒ½é‡ï¼š</p><div>$$
E=F_{avg}E_{avg}\sum_{k=0}^{\infty}F_{avg}^k(1-E_{avg})^k=\frac{F_{avg}E_{avg}}{1-F_{avg}(1-E_{avg})}
$$</div><p>$E_{avg}$ å¯ä»¥é€šè¿‡é¢„è®¡ç®—å¾—åˆ°ï¼Œä½†æ˜¯ $F_{avg}$ æ— æ³•è¿™ä¹ˆåšã€‚æ‰€ä»¥ Kulla å’Œ Conty åˆ†åˆ«å¯¹ä»‹ç”µè´¨å’Œå¯¼ä½“åˆ—å‡ºäº†ä¸¤ç§å‰äººç”¨åˆ°çš„æ•°å€¼è¿‘ä¼¼æ–¹æ³•ï¼š</p><p><img alt="Dielectric Fresnel, Revisiting Physically Based Shading at Imageworks, SIGGRAPH 2017" loading=lazy src=https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506152010539.png#center></p><p><img alt="Conductor Fresnel, Revisiting Physically Based Shading at Imageworks, SIGGRAPH 2017" loading=lazy src=https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506152011189.png#center></p><p>å¦‚æ­¤ï¼Œåœ¨æ¸²æŸ“æ—¶å³å¯é‡‡æ · $E_{avg}$ å’Œæ ¹æ®è¡¨é¢æ€§è´¨è¿‘ä¼¼ $F_{avg}$ è®¡ç®—å‡ºé¢œè‰²è¡¨é¢çš„å‡ºå°„èƒ½é‡æ¯”ä¾‹ï¼Œç„¶åå†å°†å…¶ä¸ä¸ŠèŠ‚ä¸­æ²¡æœ‰èƒ½é‡å¸æ”¶çš„ $f_{ms}$ ç›¸ä¹˜å³å¯ã€‚</p><hr><h2 id=0x02-é—®é¢˜ä¿®å¤-troubleshooting>0x02 é—®é¢˜ä¿®å¤ TroubleShooting<a hidden class=anchor aria-hidden=true href=#0x02-é—®é¢˜ä¿®å¤-troubleshooting>#</a></h2><p>åšä½œä¸šæ—¶é‡åˆ°ä¸€äº›å‡ºç°é—®é¢˜çš„åœ°æ–¹ï¼Œè¿™é‡Œä¸€å¹¶æä¸€ä¸‹ï¼š</p><ol><li>æ‰¾ä¸åˆ° vec.h</li><li>æœªå®šä¹‰æ ‡è¯†ç¬¦â€œ<code>M_PI</code>â€</li><li>uniform å˜é‡ <code>uEavgFLut</code> å‘½åé”™è¯¯</li></ol><p>ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯é…ç½®é—®é¢˜ï¼Œç”¨ vscode åœ¨ task.json çš„ args å­—æ®µåŠ ä¸Šï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=ln>1</span><span class=cl> <span class=s2>&#34;-I&#34;</span><span class=err>,</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=s2>&#34;${workspaceFolder}/assignment4/lut-gen/ext&#34;</span><span class=err>,</span>
</span></span></code></pre></div><p>ç¬¬äºŒä¸ªé—®é¢˜æŠŠæ‰€æœ‰ <code>M_PI</code> æ”¹æˆ <code>PI</code>ã€‚</p><p>ç¬¬ä¸‰ä¸ªé—®é¢˜åœ¨ KullaContyMaterial.js ä¸­ï¼Œè°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°æ—¶ä¼ å…¥äº†å‘½åå’Œ Shader ä¸­ä¸å¯¹åº”çš„ uniform å˜é‡ï¼ŒæŠŠ <code>uEavgFLut</code> æ”¹æˆ <code>uEavgLut</code> å³å¯ã€‚</p><hr><h2 id=0x03-é¢„ç§¯åˆ†-emu>0x03 é¢„ç§¯åˆ† $E(\mu)$<a hidden class=anchor aria-hidden=true href=#0x03-é¢„ç§¯åˆ†-emu>#</a></h2><h3 id=è’™ç‰¹å¡æ´›æ±‚è§£-monte-carlo>è’™ç‰¹å¡æ´›æ±‚è§£ Monte Carlo<a hidden class=anchor aria-hidden=true href=#è’™ç‰¹å¡æ´›æ±‚è§£-monte-carlo>#</a></h3><p>åœ¨ Emu_MC.cpp çš„ <code>IntegrateBRDF</code> ä¸­å®Œæˆå¯¹ $E(\mu)$ çš„ç§¯åˆ†ï¼Œä½¿ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•åœ¨åŠçƒä¸Šå‡åŒ€é‡‡æ ·å…¥å°„å…‰æ–¹å‘ï¼Œæ±‚è§£è¿™ä¸ªç§¯åˆ†ã€‚ç§¯åˆ†å†…éƒ¨ä¸º BRDF ä»¥åŠ cos é¡¹ï¼š</p><div>$$
f_{r}(i,o)=\frac{F(i,h)G(i,o,h)D(h)}{4(n\cdot i)(n\cdot o)},\cos \theta=n\cdot i
$$</div><p>Fï¼ŒGï¼ŒD çš„å®ç°æ¡†æ¶ä¸­å‡å·²ç»™å‡ºï¼ŒæŒ‰éœ€è°ƒç”¨å³å¯ã€‚</p><p><img loading=lazy src=https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506152027150.png#center></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln> 1</span><span class=cl><span class=n>Vec3f</span> <span class=nf>IntegrateBRDF</span><span class=p>(</span><span class=n>Vec3f</span> <span class=n>V</span><span class=p>,</span> <span class=kt>float</span> <span class=n>roughness</span><span class=p>,</span> <span class=kt>float</span> <span class=n>NdotV</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>    <span class=kt>float</span> <span class=n>A</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>    <span class=kt>float</span> <span class=n>B</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>    <span class=kt>float</span> <span class=n>C</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>    <span class=k>const</span> <span class=kt>int</span> <span class=n>sample_count</span> <span class=o>=</span> <span class=mi>1024</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>    <span class=n>Vec3f</span> <span class=n>N</span> <span class=o>=</span> <span class=n>Vec3f</span><span class=p>(</span><span class=mf>0.0</span><span class=p>,</span> <span class=mf>0.0</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>    
</span></span><span class=line><span class=ln> 8</span><span class=cl>    <span class=n>samplePoints</span> <span class=n>sampleList</span> <span class=o>=</span> <span class=n>squareToCosineHemisphere</span><span class=p>(</span><span class=n>sample_count</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>sample_count</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>      <span class=c1>// calculate (fr * ni) / p_o here
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=c1></span>      <span class=n>Vec3f</span> <span class=n>L</span> <span class=o>=</span> <span class=n>sampleList</span><span class=p>.</span><span class=n>directions</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>      <span class=kt>float</span> <span class=n>pdf</span> <span class=o>=</span> <span class=n>sampleList</span><span class=p>.</span><span class=n>PDFs</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>
</span></span><span class=line><span class=ln>14</span><span class=cl>      <span class=kt>float</span> <span class=n>NdotL</span> <span class=o>=</span> <span class=n>dot</span><span class=p>(</span><span class=n>N</span><span class=p>,</span><span class=n>L</span><span class=p>);</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>      <span class=n>Vec3f</span> <span class=n>H</span> <span class=o>=</span> <span class=n>normalize</span><span class=p>(</span><span class=n>V</span><span class=o>+</span><span class=n>L</span><span class=p>);</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>
</span></span><span class=line><span class=ln>17</span><span class=cl>      <span class=c1>// here we assume all lights are reflected, no absorption!
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=c1></span>      <span class=c1>// deal with color later
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=c1></span>      <span class=kt>float</span> <span class=n>F</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>;</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>      <span class=kt>float</span> <span class=n>NDF</span> <span class=o>=</span> <span class=n>DistributionGGX</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=n>H</span><span class=p>,</span> <span class=n>roughness</span><span class=p>);</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>      <span class=kt>float</span> <span class=n>G</span> <span class=o>=</span> <span class=n>GeometrySmith</span><span class=p>(</span><span class=n>roughness</span><span class=p>,</span> <span class=n>NdotV</span><span class=p>,</span> <span class=n>NdotL</span><span class=p>);</span>
</span></span><span class=line><span class=ln>22</span><span class=cl>
</span></span><span class=line><span class=ln>23</span><span class=cl>      <span class=kt>float</span> <span class=n>nom</span> <span class=o>=</span> <span class=n>F</span> <span class=o>*</span> <span class=n>NDF</span> <span class=o>*</span> <span class=n>G</span><span class=p>;</span>
</span></span><span class=line><span class=ln>24</span><span class=cl>      <span class=kt>float</span> <span class=n>denom</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>(</span><span class=mf>4.0</span> <span class=o>*</span> <span class=n>NdotL</span> <span class=o>*</span> <span class=n>NdotV</span><span class=p>,</span><span class=mf>0.001</span><span class=p>);</span>
</span></span><span class=line><span class=ln>25</span><span class=cl>      <span class=kt>float</span> <span class=n>fr</span> <span class=o>=</span> <span class=n>nom</span> <span class=o>/</span> <span class=n>denom</span><span class=p>;</span>
</span></span><span class=line><span class=ln>26</span><span class=cl>
</span></span><span class=line><span class=ln>27</span><span class=cl>      <span class=c1>// accumulate each component
</span></span></span><span class=line><span class=ln>28</span><span class=cl><span class=c1></span>      <span class=n>A</span> <span class=o>=</span> <span class=n>B</span> <span class=o>=</span> <span class=n>C</span> <span class=o>+=</span><span class=n>fr</span><span class=o>*</span><span class=n>NdotL</span><span class=o>/</span><span class=n>pdf</span><span class=p>;</span>
</span></span><span class=line><span class=ln>29</span><span class=cl>
</span></span><span class=line><span class=ln>30</span><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=ln>31</span><span class=cl>
</span></span><span class=line><span class=ln>32</span><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=n>A</span> <span class=o>/</span> <span class=n>sample_count</span><span class=p>,</span> <span class=n>B</span> <span class=o>/</span> <span class=n>sample_count</span><span class=p>,</span> <span class=n>C</span> <span class=o>/</span> <span class=n>sample_count</span><span class=p>};</span>
</span></span><span class=line><span class=ln>33</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>è¿è¡Œç¨‹åºå³å¯å¾—åˆ°è¿™æ ·ä¸€å¼  LUTï¼š</p><p><img loading=lazy src=https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506152042227.png#center></p><p>å¯ä»¥çœ‹åˆ°éšç€ç²—ç³™åº¦é™ä½ï¼ˆè‡ªä¸Šè€Œä¸‹ï¼‰ï¼Œå™ªå£°è¶Šæ¥è¶Šæ˜æ˜¾ã€‚è¿™æ˜¯å› ä¸ºä½ç²—ç³™åº¦çš„å¾®è¡¨é¢æ³•çº¿ $m$ é›†ä¸­åœ¨å®è§‚æ³•çº¿ $n$ é™„è¿‘ï¼Œä½†é€šè¿‡éšæœºé‡‡æ ·å…¥å°„å…‰æ–¹å‘ $i$ è®¡ç®—å¾—åˆ°çš„åŠç¨‹å‘é‡ $h$ åˆ™ä¸ç„¶ï¼Œå› æ­¤å¯¼è‡´ä½ç²—ç³™åº¦ä¸‹ç§¯åˆ†å€¼çš„æ–¹å·®æ˜¾è‘—å¢åŠ ã€‚ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹å¾®è¡¨é¢æ³•çº¿ $m$ è¿›è¡Œé‡è¦æ€§é‡‡æ ·æ¥æ”¹å–„è¿™ä¸ªé—®é¢˜ï¼Œå³ä½¿å¾—é‡‡æ ·çš„ $m$ æ›´å¤šåœ°ä½äº $n$ é™„è¿‘ã€‚</p><h3 id=é‡è¦æ€§é‡‡æ ·æ±‚è§£-importance-sampling>é‡è¦æ€§é‡‡æ ·æ±‚è§£ Importance Sampling<a hidden class=anchor aria-hidden=true href=#é‡è¦æ€§é‡‡æ ·æ±‚è§£-importance-sampling>#</a></h3><p>æœ€ç»ˆçš„ä»»åŠ¡ä»ç„¶æ˜¯é‡‡æ · $i$ å’Œè®¡ç®— $\frac{f_{r}(i,o,h)(i,n)}{pdf_{i}(i)}$ï¼Œä½†ç°åœ¨ $i$ å¹¶ä¸ç”±ç›´æ¥é‡‡æ ·å¾—åˆ°ï¼Œè€Œæ˜¯æ ¹æ®æŸä¸ªå¾®è¡¨é¢æ³•çº¿åˆ†å¸ƒæ¨¡å‹é‡è¦æ€§é‡‡æ ·å¾—åˆ°çš„å¾®è¡¨é¢æ³•å‘ $m$ é—´æ¥æ±‚è§£ã€‚</p><p>æ¡†æ¶ä¸­ä½¿ç”¨çš„ NDF ä¸º GGX åˆ†å¸ƒï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®è¯¥åˆ†å¸ƒç”Ÿæˆé‡‡æ ·çš„å¾®è¡¨é¢æ³•å‘ $m$ï¼Œå†ç”± $m$ å’Œ $o$ åæ±‚å…¥å°„æ–¹å‘ $i$ã€‚</p><p>ç”±å¾®è¡¨é¢æ³•çº¿åˆ†å¸ƒæ¨¡å‹çš„æ€§è´¨ï¼Œå¯ä»¥è®¡ç®—å‡ºé‡‡æ · $m$ çš„æ¦‚ç‡å¯†åº¦ï¼š</p><div>$$
pdf_{m}(m)=D(m)(m\cdot n)
$$</div><p>é€šè¿‡è¯¥æ¦‚ç‡å¯†åº¦ï¼Œå¯ä»¥è®¡ç®—å‡ºè¯¥åˆ†å¸ƒä¸‹å¯¹åº”çš„é‡‡æ ·ç‚¹ï¼š</p><div>$$
\begin{aligned}
\theta_{m}&=\arctan\left( \frac{\alpha \sqrt{ \xi_{1} }}{\sqrt{ 1-\xi_{1} }} \right)\\
\phi_{h}&=2\pi \xi_{2}
\end{aligned}
$$</div><p>å…¶ä¸­ï¼Œ$\alpha=roughness^{2},\xi_{1},\xi_{2}\in[0,1)$ã€‚</p><p>åœ¨ Emu_IS.cpp çš„ <code>ImportanceSampleGGX</code> å‡½æ•°ä¸­ï¼Œå®Œæˆé‡è¦æ€§é‡‡æ ·çš„é€»è¾‘ï¼Œå¹¶è¿”å›åˆ‡çº¿ç©ºé—´çš„å¾®è¡¨é¢æ³•çº¿ $h$ã€‚</p><p><img loading=lazy src=https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506152111744.png#center></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln> 1</span><span class=cl><span class=n>Vec3f</span> <span class=nf>ImportanceSampleGGX</span><span class=p>(</span><span class=n>Vec2f</span> <span class=n>Xi</span><span class=p>,</span> <span class=n>Vec3f</span> <span class=n>N</span><span class=p>,</span> <span class=kt>float</span> <span class=n>roughness</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>    <span class=kt>float</span> <span class=n>a</span> <span class=o>=</span> <span class=n>roughness</span> <span class=o>*</span> <span class=n>roughness</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>
</span></span><span class=line><span class=ln> 4</span><span class=cl>    <span class=c1>// in spherical space - Bonus 1
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=c1></span>    <span class=kt>float</span> <span class=n>Xi1</span> <span class=o>=</span> <span class=n>Xi</span><span class=p>.</span><span class=n>x</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>    <span class=kt>float</span> <span class=n>Xi2</span> <span class=o>=</span> <span class=n>Xi</span><span class=p>.</span><span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>    <span class=kt>float</span> <span class=n>theta</span> <span class=o>=</span> <span class=n>atan</span><span class=p>(</span><span class=n>a</span><span class=o>*</span><span class=n>sqrt</span><span class=p>(</span><span class=n>Xi1</span><span class=p>)</span><span class=o>/</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=n>Xi1</span><span class=p>));</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>    <span class=kt>float</span> <span class=n>phi</span> <span class=o>=</span> <span class=mf>2.0</span> <span class=o>*</span> <span class=n>PI</span> <span class=o>*</span> <span class=n>Xi2</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>
</span></span><span class=line><span class=ln>10</span><span class=cl>    <span class=c1>// from spherical space to cartesian space - Bonus 1
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=c1></span>    <span class=kt>float</span> <span class=n>x</span> <span class=o>=</span> <span class=n>cos</span><span class=p>(</span><span class=n>phi</span><span class=p>)</span><span class=o>*</span><span class=n>sin</span><span class=p>(</span><span class=n>theta</span><span class=p>);</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>    <span class=kt>float</span> <span class=n>y</span> <span class=o>=</span> <span class=n>sin</span><span class=p>(</span><span class=n>phi</span><span class=p>)</span><span class=o>*</span><span class=n>sin</span><span class=p>(</span><span class=n>theta</span><span class=p>);</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>    <span class=kt>float</span> <span class=n>z</span> <span class=o>=</span> <span class=n>cos</span><span class=p>(</span><span class=n>theta</span><span class=p>);</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>
</span></span><span class=line><span class=ln>15</span><span class=cl>    <span class=c1>// tangent coordinates - Bonus 1
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=c1></span>    <span class=n>Vec3f</span> <span class=n>up</span> <span class=o>=</span> <span class=n>abs</span><span class=p>(</span><span class=n>N</span><span class=p>.</span><span class=n>z</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mf>0.999</span> <span class=o>?</span> <span class=n>Vec3f</span><span class=p>(</span><span class=mf>0.0</span><span class=p>,</span> <span class=mf>0.0</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>)</span> <span class=o>:</span> <span class=n>Vec3f</span><span class=p>(</span><span class=mf>1.0</span><span class=p>,</span> <span class=mf>0.0</span><span class=p>,</span> <span class=mf>0.0</span><span class=p>);</span> <span class=c1>// N is fixed 001 so not select 001
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=c1></span>    <span class=n>Vec3f</span> <span class=n>tangent</span> <span class=o>=</span> <span class=n>normalize</span><span class=p>(</span><span class=n>cross</span><span class=p>(</span><span class=n>up</span><span class=p>,</span><span class=n>N</span><span class=p>));</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>    <span class=n>Vec3f</span> <span class=n>bitangent</span> <span class=o>=</span> <span class=n>cross</span><span class=p>(</span><span class=n>N</span><span class=p>,</span><span class=n>tangent</span><span class=p>);</span>
</span></span><span class=line><span class=ln>19</span><span class=cl>
</span></span><span class=line><span class=ln>20</span><span class=cl>    <span class=c1>// transform H to tangent space - Bonus 1
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=c1></span>    <span class=n>Vec3f</span> <span class=n>H</span> <span class=o>=</span> <span class=n>normalize</span><span class=p>(</span><span class=n>tangent</span><span class=o>*</span><span class=n>x</span> <span class=o>+</span> <span class=n>bitangent</span><span class=o>*</span><span class=n>y</span> <span class=o>+</span> <span class=n>N</span><span class=o>*</span><span class=n>z</span><span class=p>);</span>
</span></span><span class=line><span class=ln>22</span><span class=cl>    <span class=k>return</span> <span class=n>H</span><span class=p>;</span>
</span></span><span class=line><span class=ln>23</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>æ¥ä¸‹æ¥è®¡ç®— $\frac{f_{r}(i,o,h)(i,n)}{pdf_{i}(i)}$ çš„å€¼ï¼Œéœ€è¦å…ˆå°†é‡‡æ · $m$ çš„æ¦‚ç‡å¯†åº¦è½¬åŒ–ä¸ºé‡‡æ · $i$ çš„æ¦‚ç‡å¯†åº¦ï¼š</p><div>$$
pdf_{i}(i)=pdf_{m}(m)\left\lvert \left\lvert \frac{\partial\omega_{m}}{\partial \omega_{i}} \right\rvert \right\rvert =\frac{D(m)(m\cdot n)}{4(i\cdot m)}
$$</div><p>æ‰€ä»¥æœ€ç»ˆéœ€è¦ç´¯åŠ çš„æƒé‡ä¸ºï¼š</p><div>$$
\begin{aligned}
weight(i)&=\frac{f_{r}(i,o,h)(i,n)}{pdf_{i}(i)} \\
&=\frac{F(i,m)G(i,o,m)D(m)}{4(n\cdot i)(n\cdot o)}\cdot(n\cdot i)\cdot \frac{4(i\cdot m)}{D(m)(n\cdot m)} \\
&=\frac{(o\cdot m)G(i,o,h)}{(o\cdot n)(m\cdot n)}
\end{aligned}
$$</div><blockquote><p>è¿™é‡Œæš‚ä¸”è€ƒè™‘æ‰€æœ‰èƒ½é‡éƒ½è¢«åå°„ï¼Œå³ F ä¸º 1ï¼›æœ€åç•™åœ¨åˆ†å­ä¸Šçš„å®é™…ä¸Šæ˜¯ $i\cdot m$ï¼Œä½†æ˜¯ $i\cdot m=o\cdot m$ï¼Œæ‰€ä»¥å¯ä»¥æ›¿æ¢</p></blockquote><p>åœ¨ Emu_IS.cpp çš„ <code>IntegrateBRDF</code> å‡½æ•°ä¸­æ¯æ¬¡é‡‡æ ·ç´¯åŠ è¯¥æƒé‡å³å¯ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln> 1</span><span class=cl><span class=n>Vec3f</span> <span class=nf>IntegrateBRDF</span><span class=p>(</span><span class=n>Vec3f</span> <span class=n>V</span><span class=p>,</span> <span class=kt>float</span> <span class=n>roughness</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>
</span></span><span class=line><span class=ln> 3</span><span class=cl>    <span class=k>const</span> <span class=kt>int</span> <span class=n>sample_count</span> <span class=o>=</span> <span class=mi>1024</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>    <span class=n>Vec3f</span> <span class=n>N</span> <span class=o>=</span> <span class=n>Vec3f</span><span class=p>(</span><span class=mf>0.0</span><span class=p>,</span> <span class=mf>0.0</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>    <span class=n>Vec3f</span> <span class=n>Emu</span> <span class=o>=</span> <span class=n>Vec3f</span><span class=p>(</span><span class=mf>0.0f</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>sample_count</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>        <span class=n>Vec2f</span> <span class=n>Xi</span> <span class=o>=</span> <span class=n>Hammersley</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>sample_count</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>        <span class=n>Vec3f</span> <span class=n>H</span> <span class=o>=</span> <span class=n>ImportanceSampleGGX</span><span class=p>(</span><span class=n>Xi</span><span class=p>,</span> <span class=n>N</span><span class=p>,</span> <span class=n>roughness</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>        <span class=n>Vec3f</span> <span class=n>L</span> <span class=o>=</span> <span class=n>normalize</span><span class=p>(</span><span class=n>H</span> <span class=o>*</span> <span class=mf>2.0f</span> <span class=o>*</span> <span class=n>dot</span><span class=p>(</span><span class=n>V</span><span class=p>,</span> <span class=n>H</span><span class=p>)</span> <span class=o>-</span> <span class=n>V</span><span class=p>);</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>
</span></span><span class=line><span class=ln>11</span><span class=cl>        <span class=kt>float</span> <span class=n>NoL</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>(</span><span class=n>L</span><span class=p>.</span><span class=n>z</span><span class=p>,</span> <span class=mf>0.0f</span><span class=p>);</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>        <span class=kt>float</span> <span class=n>NoH</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>(</span><span class=n>H</span><span class=p>.</span><span class=n>z</span><span class=p>,</span> <span class=mf>0.0f</span><span class=p>);</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>        <span class=kt>float</span> <span class=n>VoH</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>(</span><span class=n>dot</span><span class=p>(</span><span class=n>V</span><span class=p>,</span> <span class=n>H</span><span class=p>),</span> <span class=mf>0.0f</span><span class=p>);</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>        <span class=kt>float</span> <span class=n>NoV</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>(</span><span class=n>dot</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=n>V</span><span class=p>),</span> <span class=mf>0.0f</span><span class=p>);</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>        
</span></span><span class=line><span class=ln>16</span><span class=cl>        <span class=c1>// calculate (fr * ni) / p_o here - Bonus 1
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=c1></span>        <span class=kt>float</span> <span class=n>w</span> <span class=o>=</span> <span class=n>VoH</span> <span class=o>*</span> <span class=n>GeometrySmith</span><span class=p>(</span><span class=n>roughness</span><span class=p>,</span><span class=n>NoV</span><span class=p>,</span><span class=n>NoL</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=n>NoV</span><span class=o>*</span><span class=n>NoH</span><span class=p>);</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>        <span class=n>Emu</span> <span class=o>+=</span> <span class=n>Vec3f</span><span class=p>(</span><span class=n>w</span><span class=p>);</span>
</span></span><span class=line><span class=ln>19</span><span class=cl>        <span class=c1>// Split Sum - Bonus 2
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>
</span></span><span class=line><span class=ln>22</span><span class=cl>    <span class=k>return</span> <span class=n>Emu</span> <span class=o>/</span> <span class=n>sample_count</span><span class=p>;</span>
</span></span><span class=line><span class=ln>23</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>å®Œæˆé‡è¦æ€§é‡‡æ ·ä¹‹åå¾—åˆ°çš„ $E(\mu)$ å°±æ²¡æœ‰å™ªç‚¹äº†ï¼š</p><p><img loading=lazy src=https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506152305671.png#center></p><hr><h2 id=0x04-é¢„ç§¯åˆ†-e_avg>0x04 é¢„ç§¯åˆ† $E_{avg}$<a hidden class=anchor aria-hidden=true href=#0x04-é¢„ç§¯åˆ†-e_avg>#</a></h2><p>é¢„ç§¯åˆ† $E_{avg}$ çš„è¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œç”šè‡³å› ä¸º $E(\mu),\mu$ éƒ½æ˜¯å®šå€¼ç›´æ¥è¿”å› $2E(\mu)\mu$ å³å¯ã€‚</p><p><img loading=lazy src=https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506152251191.png#center></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln> 1</span><span class=cl><span class=n>Vec3f</span> <span class=nf>IntegrateEmu</span><span class=p>(</span><span class=n>Vec3f</span> <span class=n>V</span><span class=p>,</span> <span class=kt>float</span> <span class=n>roughness</span><span class=p>,</span> <span class=kt>float</span> <span class=n>NdotV</span><span class=p>,</span> <span class=n>Vec3f</span> <span class=n>Ei</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>    <span class=k>return</span> <span class=n>Ei</span> <span class=o>*</span> <span class=n>NdotV</span> <span class=o>*</span> <span class=mf>2.0f</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>    <span class=n>Vec3f</span> <span class=n>Eavg</span> <span class=o>=</span> <span class=n>Vec3f</span><span class=p>(</span><span class=mf>0.0f</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>    <span class=k>const</span> <span class=kt>int</span> <span class=n>sample_count</span> <span class=o>=</span> <span class=mi>1024</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>    <span class=n>Vec3f</span> <span class=n>N</span> <span class=o>=</span> <span class=n>Vec3f</span><span class=p>(</span><span class=mf>0.0</span><span class=p>,</span> <span class=mf>0.0</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>
</span></span><span class=line><span class=ln> 7</span><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>sample_count</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> 
</span></span><span class=line><span class=ln> 8</span><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>        <span class=n>Vec2f</span> <span class=n>Xi</span> <span class=o>=</span> <span class=n>Hammersley</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>sample_count</span><span class=p>);</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>        <span class=n>Vec3f</span> <span class=n>H</span> <span class=o>=</span> <span class=n>ImportanceSampleGGX</span><span class=p>(</span><span class=n>Xi</span><span class=p>,</span> <span class=n>N</span><span class=p>,</span> <span class=n>roughness</span><span class=p>);</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>        <span class=n>Vec3f</span> <span class=n>L</span> <span class=o>=</span> <span class=n>normalize</span><span class=p>(</span><span class=n>H</span> <span class=o>*</span> <span class=mf>2.0f</span> <span class=o>*</span> <span class=n>dot</span><span class=p>(</span><span class=n>V</span><span class=p>,</span> <span class=n>H</span><span class=p>)</span> <span class=o>-</span> <span class=n>V</span><span class=p>);</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>
</span></span><span class=line><span class=ln>13</span><span class=cl>        <span class=kt>float</span> <span class=n>NoL</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>(</span><span class=n>L</span><span class=p>.</span><span class=n>z</span><span class=p>,</span> <span class=mf>0.0f</span><span class=p>);</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>        <span class=kt>float</span> <span class=n>NoH</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>(</span><span class=n>H</span><span class=p>.</span><span class=n>z</span><span class=p>,</span> <span class=mf>0.0f</span><span class=p>);</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>        <span class=kt>float</span> <span class=n>VoH</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>(</span><span class=n>dot</span><span class=p>(</span><span class=n>V</span><span class=p>,</span> <span class=n>H</span><span class=p>),</span> <span class=mf>0.0f</span><span class=p>);</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>        <span class=kt>float</span> <span class=n>NoV</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>(</span><span class=n>dot</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=n>V</span><span class=p>),</span> <span class=mf>0.0f</span><span class=p>);</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>
</span></span><span class=line><span class=ln>18</span><span class=cl>        <span class=c1>// calculate Eavg here - Bonus 1
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=c1></span>        <span class=n>Eavg</span> <span class=o>+=</span> <span class=n>Ei</span> <span class=o>*</span> <span class=n>NoV</span> <span class=o>*</span> <span class=mf>2.0f</span><span class=p>;</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>
</span></span><span class=line><span class=ln>22</span><span class=cl>    <span class=k>return</span> <span class=n>Eavg</span> <span class=o>/</span> <span class=n>sample_count</span><span class=p>;</span>
</span></span><span class=line><span class=ln>23</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>æ±‚è§£ $E_{avg}$ çš„è¿‡ç¨‹ä»…ä¾èµ–äºé‡‡æ ·åˆ°çš„ $E(\mu)$ ï¼Œæ‰€ä»¥ Eavg_IS.cpp å’Œ E_avg_MC.cpp çš„å®ç°æ˜¯ä¸€æ ·çš„ã€‚</p><p>è¿è¡Œç¨‹åºå¯ä»¥å¾—åˆ°è¿™æ ·ä¸€å¼  LUTï¼š</p><p><img loading=lazy src=https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506152300734.png#center></p><p>å¦‚æœæ­£ç¡®å®ç°äº† $E(\mu)$ çš„é‡è¦æ€§é‡‡æ ·ï¼Œä¸Šå›¾å°±ä¼šå˜å¾— Smooth ä¸€ç‚¹ï¼š</p><p><img loading=lazy src=https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506152305677.png#center></p><hr><h2 id=0x05-å®æ—¶æ¸²æŸ“-realtime-rendering>0x05 å®æ—¶æ¸²æŸ“ Realtime Rendering<a hidden class=anchor aria-hidden=true href=#0x05-å®æ—¶æ¸²æŸ“-realtime-rendering>#</a></h2><blockquote><p>PBR æè´¨çš„å®ç°å°±ä¸è´´äº†ï¼Œå…¬å¼å·²ç»ç»™å‡ºäº†ï¼Œå¯ä»¥ç›´æ¥æ¬ç¦»çº¿ç«¯çš„å®ç°</p></blockquote><p>åœ¨å®æ—¶ç«¯éœ€è¦é‡‡æ ·é¢„ç§¯åˆ†çš„ $E(\mu)$ å’Œ $E_{avg}$ çš„ LUTï¼Œç„¶åä»ç„¶æ˜¯å¥—å…¬å¼è®¡ç®—èƒ½é‡å®ˆæ’çš„ BRDFï¼š</p><div>$$
f_{r}=f_{micro}+f_{add}*f_{ms}
$$</div><p>åœ¨ <code>MultiScatterBRDF</code> å‡½æ•°ä¸­ï¼Œéœ€è¦å®Œæˆå¯¹ $f_{add},f_{ms}$ çš„è®¡ç®—ï¼š</p><div>$$
\begin{aligned}
f_{add}&=\frac{F_{avg}E_{avg}}{1-F_{avg}(1-E_{avg})}\\
f_{ms}(\mu_{o},\mu_{i})&=\frac{(1-E(\mu_{o}))(1-E(\mu_{i}))}{\pi(1-E_{avg})}
\end{aligned}
$$</div><p><img loading=lazy src=https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506152327799.png#center></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-glsl data-lang=glsl><span class=line><span class=ln> 1</span><span class=cl><span class=k>vec3</span> <span class=n>MultiScatterBRDF</span><span class=p>(</span><span class=k>float</span> <span class=n>NdotL</span><span class=p>,</span> <span class=k>float</span> <span class=n>NdotV</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>  <span class=k>vec3</span> <span class=n>albedo</span> <span class=o>=</span> <span class=n>pow</span><span class=p>(</span><span class=n>texture2D</span><span class=p>(</span><span class=n>uAlbedoMap</span><span class=p>,</span> <span class=n>vTextureCoord</span><span class=p>).</span><span class=n>rgb</span><span class=p>,</span> <span class=k>vec3</span><span class=p>(</span><span class=mf>2.2</span><span class=p>));</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>
</span></span><span class=line><span class=ln> 5</span><span class=cl>  <span class=k>vec3</span> <span class=n>E_o</span> <span class=o>=</span> <span class=n>texture2D</span><span class=p>(</span><span class=n>uBRDFLut</span><span class=p>,</span> <span class=k>vec2</span><span class=p>(</span><span class=n>NdotL</span><span class=p>,</span> <span class=n>uRoughness</span><span class=p>)).</span><span class=n>xxx</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>  <span class=k>vec3</span> <span class=n>E_i</span> <span class=o>=</span> <span class=n>texture2D</span><span class=p>(</span><span class=n>uBRDFLut</span><span class=p>,</span> <span class=k>vec2</span><span class=p>(</span><span class=n>NdotV</span><span class=p>,</span> <span class=n>uRoughness</span><span class=p>)).</span><span class=n>xxx</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>
</span></span><span class=line><span class=ln> 8</span><span class=cl>  <span class=k>vec3</span> <span class=n>E_avg</span> <span class=o>=</span> <span class=n>texture2D</span><span class=p>(</span><span class=n>uEavgLut</span><span class=p>,</span> <span class=k>vec2</span><span class=p>(</span><span class=mo>0</span><span class=p>,</span> <span class=n>uRoughness</span><span class=p>)).</span><span class=n>xxx</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>  <span class=c1>// copper</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>  <span class=k>vec3</span> <span class=n>edgetint</span> <span class=o>=</span> <span class=k>vec3</span><span class=p>(</span><span class=mf>0.827</span><span class=p>,</span> <span class=mf>0.792</span><span class=p>,</span> <span class=mf>0.678</span><span class=p>);</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>  <span class=k>vec3</span> <span class=n>F_avg</span> <span class=o>=</span> <span class=n>AverageFresnel</span><span class=p>(</span><span class=n>albedo</span><span class=p>,</span> <span class=n>edgetint</span><span class=p>);</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>  
</span></span><span class=line><span class=ln>13</span><span class=cl>  <span class=c1>// calculate fms and missing energy here</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>  <span class=k>vec3</span> <span class=n>f_add</span> <span class=o>=</span> <span class=n>F_avg</span> <span class=o>*</span> <span class=n>E_avg</span> <span class=o>/</span> <span class=p>(</span><span class=mf>1.0</span> <span class=o>-</span> <span class=n>F_avg</span> <span class=o>*</span> <span class=p>(</span><span class=mf>1.0</span> <span class=o>-</span> <span class=n>E_avg</span><span class=p>));</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>  <span class=k>vec3</span> <span class=n>f_ms</span> <span class=o>=</span> <span class=p>(</span><span class=mf>1.0</span> <span class=o>-</span> <span class=n>E_o</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=mf>1.0</span> <span class=o>-</span> <span class=n>E_i</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>PI</span> <span class=o>*</span> <span class=p>(</span><span class=mf>1.0</span> <span class=o>-</span> <span class=n>E_avg</span><span class=p>));</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>  <span class=k>return</span> <span class=n>f_add</span><span class=o>*</span><span class=n>f_ms</span><span class=p>;</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>  
</span></span><span class=line><span class=ln>18</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>å®Œæˆåå³å¯è¾¾åˆ°å¦‚å›¾æ‰€ç¤ºçš„æ•ˆæœï¼š</p><p><img alt="ä¸Šï¼šKulla-Conty BSDF ä¸‹ï¼šMicrofacet BRDF" loading=lazy src=https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506152348032.png#center></p><hr><h2 id=0x06-split-sum>0x06 Split Sum<a hidden class=anchor aria-hidden=true href=#0x06-split-sum>#</a></h2><p>ä»ç„¶æ˜¯è®¡ç®— $E(\mu)$ï¼Œç»“æœä¿å­˜åˆ°ä¸€å¼ ä¸ roughness å’Œæ›²ç‡ç›¸å…³çš„ LUT ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ F é¡¹ä» BRDF ä¸­åˆ†ç¦»å‡ºæ¥ï¼ˆè¿™ä¸ªæ€è·¯åœ¨ Lecture5 Real-time Environment Mapping 1h 15min å·¦å³æœ‰æåŠï¼‰ï¼š</p><div>$$
\begin{aligned}
E&=\int_{\Omega^+}f_{r}(n\cdot i) d\omega_{i} \\
&=\int_{\Omega^+} \frac{f_{r}}{F}(n\cdot i) Fd\omega_{i}\\
&=\int_{\Omega^+} \frac{f_{r}}{F}(n\cdot i) (F_{0}+(1-F_{0})(1-\cos \theta)^5)d\omega_{i}\\
&=\int_{\Omega^+} \frac{f_{r}}{F}(n\cdot i) (F_{0}+(1-F_{0})\alpha)d\omega_{i}\\
&=\int_{\Omega^+} \frac{f_{r}}{F}(n\cdot i) (F_{0}(1-\alpha)+\alpha)d\omega_{i}\\
&=F_{0}\int_{\Omega^+} \frac{f_{r}}{F}(n\cdot i) (1-\alpha)d\omega_{i}+\int_{\Omega^+} \frac{f_{r}}{F}(n\cdot i) \alpha d\omega_{i}
\end{aligned}
$$</div><blockquote><p>è®° $\alpha=(1-\cos \theta)^5$</p></blockquote><p>æ›´æ”¹ä¸€ä¸‹ <code>IntegrateBRDF</code>ï¼Œå°†è¿™ä¸¤ä¸ª Split çš„ç»“æœåˆ†åˆ«å­˜å…¥ LUT çš„ GB é€šé“ï¼ŒR é€šé“ä»ç„¶å­˜åŸæ¥çš„ $E(\mu)$ï¼š</p><p><img loading=lazy src=https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506152232914.png#center></p><p>ç„¶ååœ¨å®æ—¶ç«¯é‡è½½ä¸€ä¸ª <code>MultiScatterBRDF</code>ï¼Œå¢åŠ ä¸€ä¸ª F0 ä½œä¸ºå‚æ•°ï¼Œç”¨ä¸¤ä¸ª Split çš„ç§¯åˆ†è¿˜åŸ $E(\mu),E_{avg}$ï¼š</p><p><img loading=lazy src=https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506160003257.png#center></p><p>è°ƒç”¨è¿™ä¸ªæ–°çš„å‡½æ•°å¹¶ä¼ å…¥ F0 å³å¯çœ‹åˆ°ä½¿ç”¨ Split Sum è®¡ç®—å‡ºæ¥çš„ç»“æœï¼š</p><p><img alt="ä¸Šï¼šSplit Sum ä¸‹ï¼šMicrofacet BRDF" loading=lazy src=https://raw.gitmirror.com/congyuxiaoyoudao/Picgo-ImageBed/main/Assignments/Assignment%207.GAMES202HW4/202506152350314.png#center></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://congyuxiaoyoudao.github.io/tags/games202/>GAMES202</a></li><li><a href=https://congyuxiaoyoudao.github.io/tags/brdf/>BRDF</a></li></ul><nav class=paginav><a class=next href=https://congyuxiaoyoudao.github.io/posts/assignments/games202-homework-3/><span class=title>ä¸‹ä¸€é¡µ Â»</span><br><span>Assignment 6. GAMES202 Homework 3</span></a></nav></footer><div id=tw-comment></div><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="light"?"light":"noborder_dark",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const s={src:"https://giscus.app/client.js","data-repo":"congyuxiaoyoudao/congyuxiaoyoudao.github.io","data-repo-id":"","data-category":"Announcements","data-category-id":"","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"","data-emit-metadata":"","data-input-position":"","data-theme":getStoredTheme(),"data-lang":"zh-CN","data-loading":"lazy",crossorigin:"anonymous"},e=document.createElement("script");Object.entries(s).forEach(([t,n])=>e.setAttribute(t,n)),document.querySelector("#tw-comment").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme);const n=document.querySelector("#theme-toggle-float");n&&n.addEventListener("click",setGiscusTheme)})</script></article></main><footer class=footer><span>&copy; 2025 <a href=https://congyuxiaoyoudao.github.io/>The Only Problem's Blog</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="å¤åˆ¶";function s(){t.innerHTML="å·²å¤åˆ¶ï¼",setTimeout(()=>{t.innerHTML="å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>